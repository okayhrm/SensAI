import{B as E,bm as Se,bn as $e,bo as qe,bp as Hl,D as at,r as m,j as e,u as Ll,aX as Sa,l as o,Q as J,R as fn,o as T,aH as Ce,aI as ln,aK as Ke,aL as W,ak as gn,T as H,bq as Me,q as Oe,af as Ve,br as bp,aj as G,U as X,V as ke,aF as Pa,F as K,ac as Ne,bs as Sp,bt as vp,bu as Fp,bv as Cp,aP as xe,ag as pi,bw as cr,bx as Jl,by as ve,aC as lt,bz as Qe,bA as Kp,a_ as In,bB as Tp,aO as Pp,bC as xp,J as ur,aN as ce,b2 as al,aZ as Ie,aY as Dn,bD as Fn,bE as pn,m as mo,$ as Ip,S as mr,G as gr,aV as go,I as Dp,X as Lp,bF as _p,bG as jt,bH as Ot,bI as ml,b4 as Ya,b3 as el,t as _l,bJ as Ap,b9 as Xl,bK as wp,bL as pr,bM as Rp,bN as Ep,bO as Mp,bP as Vp,bQ as zp,bR as Np,bS as $p,bT as jp,bU as Op,bV as Kl,E as Qp,bW as Bp,g as po,bX as qp,aE as tt,bY as yo,bZ as fo,b_ as Up,al as Hp,b$ as Gp,ah as Wp,ai as Jp,c0 as Xp,n as Zp}from"./vendor-ARQZvmz5.js";import{d as oe,s as xa,D as ue,C as q,b as nn,a as $n,T as Ee,r as ra,q as yi,L as it,t as rt,v as Yp,l as ho,P as ot,c as oa,E as st,n as $a,o as Al,e as Ia,p as dt,w as ey,x as ct,y as ny,z as ay,A as fi,B as hi,u as ly,G as ty}from"./vendor-arizeai-Ct6kvW4e.js";import{s as iy,l as ry,j as ki,a as Be,i as bi,b as oy,c as sy,d as va,e as jn,f as ko,D as bo,g as fa,h as vl,C as Gl,k as dy,m as Te,T as bn,n as cy,o as Si,p as yr,q as uy,r as fr,t as my,u as gy,P as wl,v as py,_ as v,G as Rl,w as b,x as F,y as M,I,E as ja,z as We,A as So,B as vo,R as he,F as be,H as me,J as ee,K as hr,L as kr,N as ha,M as Je,O as ka,Q as He,S as on,U as Ge,V as Xe,W as Ze,X as yn,Y as On,Z as ll,$ as an,a0 as Tn,a1 as De,a2 as ae,a3 as ge,a4 as sn,a5 as El,a6 as Fo,a7 as we,a8 as Co,a9 as ea,aa as na,ab as aa,ac as Oa,ad as Qa,ae as Re,af as _e,ag as vi,ah as Bn,ai as Ko,aj as dn,ak as le,al as re,am as cn,an as To,ao as Zl,ap as ze,aq as qn,ar as yy,as as fy,at as Po,au as li,av as Fi,aw as ut,ax as hy,ay as ky,az as ti,aA as Ol,aB as de,aC as xo,aD as Pn,aE as mt,aF as Un,aG as sa,aH as Io,aI as Do,aJ as by,aK as Sy,aL as xn,aM as vy,aN as En,aO as Fy,aP as Lo,aQ as gt,aR as Da,aS as Ci,aT as Ki,aU as Cy,aV as _o,aW as Ky,aX as Ty,aY as Py,aZ as xy,a_ as Iy,a$ as Dy,b0 as Ly,b1 as Fe,b2 as _y,b3 as Ay,b4 as Tl,b5 as pt,b6 as yt,b7 as la,b8 as Ml,b9 as Xn,ba as wy,bb as pe,bc as ii,bd as ye,be as fe,bf as Sn,bg as Ry,bh as Ey,bi as My,bj as Cn,bk as Vy,bl as zy,bm as Ny,bn as ft,bo as ht,bp as Ao,bq as $y,br as jy,bs as Oy,bt as tl,bu as Qy,bv as wo,bw as By,bx as kt,by as Ln,bz as qy,bA as Uy,bB as Hy,bC as Zn,bD as rn,bE as Ro,bF as je,bG as Eo,bH as ta,bI as bt,bJ as Ba,bK as Mo,bL as Gy,bM as _n,bN as Ti,bO as Ea,bP as Wy,bQ as Wa,bR as Jy,bS as Xy,bT as Pi,bU as St,bV as da,bW as La,bX as Vo,bY as ri,bZ as un,b_ as vt,b$ as zo,c0 as Ft,c1 as An,c2 as No,c3 as Ct,c4 as Zy,c5 as $o,c6 as jo,c7 as br,c8 as Sr,c9 as Yy,ca as Pl,cb as oi,cc as Kt,cd as nl,ce as ef,cf as nf,cg as il,ch as af,ci as lf,cj as xl,ck as Oo,cl as tf,cm as Qo,cn as Tt,co as Pt,cp as ca,cq as rf,cr as of,cs as Kn,ct as Qn,cu as Va,cv as xi,cw as Bo,cx as Ii,cy as qo,cz as sf,cA as df,cB as cf,cC as uf,cD as mf,cE as gf,cF as pf,cG as Di,cH as Uo,cI as Ho,cJ as Go,cK as Wo,cL as Ue,cM as Jo,cN as Xo,cO as si,cP as Li,cQ as _i,cR as yf,cS as ff,cT as hf,cU as Ai,cV as kf,cW as bf,cX as xt,cY as Sf,cZ as Zo,c_ as vf,c$ as Ff,d0 as Cf,d1 as Kf,d2 as Tf,d3 as Pf,d4 as xf,d5 as If,d6 as Df,d7 as Yo,d8 as vr,d9 as Lf,da as Hn,db as ua,dc as wi,dd as es,de as ns,df as Fr,dg as Cr,dh as _f,di as Af,dj as Y,dk as It,dl as rl,dm as as,dn as ol,dp as sl,dq as ls,dr as wf,ds as Rf,dt as Ri,du as Ef,dv as Mf,dw as Vf,dx as zf,dy as Nf,dz as Il,dA as ts,dB as is,dC as $f,dD as jf,dE as Kr,dF as Of,dG as Qf,dH as Bf,dI as qf,dJ as Uf,dK as Hf,dL as rs,dM as Gf,dN as Wf,dO as Jf,dP as Xf,dQ as Zf,dR as za,dS as Ei,dT as os,dU as Ja,dV as Qt,dW as Yf,dX as eh,dY as Mi,dZ as Dt,d_ as Mn,d$ as Yl,e0 as ss,e1 as nh,e2 as ah,e3 as ds,e4 as cs,e5 as lh,e6 as us,e7 as Vi,e8 as th,e9 as Tr,ea as ih,eb as rh,ec as oh,ed as sh,ee as dh,ef as ch,eg as Bt,eh as ms,ei as uh,ej as zi,ek as Ni,el as mh,em as Xa,en as gh,eo as ph,ep as yh,eq as gs,er as Vl,es as fh,et as hh,eu as kh,ev as ps,ew as Pr,ex as bh,ey as Sh,ez as vh,eA as Fh,eB as ys,eC as Ch,eD as Kh,eE as Th,eF as xr,eG as Ir}from"./components-DIL5A2s_.js";import{g as _a,i as Aa,d as Ph,E as fs,R as wa,k as $i,b as xh,p as zl,n as hs}from"./vendor-codemirror-BxoXtD6f.js";import{P as ks,C as bs,T as Gn,a as Ss,R as wn,X as Wn,Y as hn,b as Jn,B as Fa,c as Lt,d as dl,A as Dl,e as vs,L as ji,f as Ih}from"./vendor-recharts-Cl8AO7Np.js";const Dh=4,Lh="Unable to parse span input messages, expected messages which include a role and content.",_h="Unable to parse span output messages, expected messages which include a role and content.",Ah="Unable to parse span output expected output.value to be present.",wh="Unable to parse span attributes, attributes must be valid JSON.",Rh="Unable to parse model config, expected llm.model_name to be present.",Eh="Unable to parse model config, expected llm.invocation_parameters JSON string to be present.",Mh="Unable to parse invocation parameters response_format, expected llm.invocation_parameters.response_format to be a well formed json object or undefined.",Vh="Unable to parse tools, expected tools to be an array of valid tools.",zh="Unable to parse prompt template variables, expected prompt template variables to be a valid JSON object string.",Dr={AZURE_OPENAI:[],ANTHROPIC:["claude"],OPENAI:["gpt","o1"],GOOGLE:["gemini"],DEEPSEEK:["deepseek"],XAI:["grok"],OLLAMA:[]},ba="TOOL_CHOICE",Za="tool_choice",Nn="RESPONSE_FORMAT",Vn="response_format",Nh=[ba,Nn],$h=E.object({tool_call:E.object({id:E.string().optional(),function:E.object({name:E.string(),arguments:E.string()}).partial()}).partial()}).partial(),Fs=E.object({[Se.message]:E.object({[$e.role]:E.string(),[$e.content]:E.union([E.string(),E.array(E.record(E.string(),E.unknown()))]).default(""),[$e.contents]:E.array(E.object({message_content:E.record(E.string())})).optional(),[$e.tool_calls]:E.array($h).optional(),[$e.tool_call_id]:E.string().optional()})}),jh=E.object({[Se.llm]:E.object({[qe.input_messages]:E.array(Fs)})}),Oh=E.object({[Se.llm]:E.object({[qe.output_messages]:E.array(Fs)})}),Qh=E.object({[Se.output]:E.object({value:E.string()})}),Cs=iy()(E.enum(["user","ai","system","tool"])),Bh=E.object({id:E.number(),role:Cs,content:E.string().optional(),toolCallId:E.string().optional(),toolCalls:E.array(ry).optional()}),qh=E.array(Bh),Ks=E.lazy(()=>E.record(ki)),Uh=Ks,Ts=E.string().transform((n,a)=>{const{json:l}=Be(n);if(!bi(l))return a.addIssue({code:E.ZodIssueCode.custom,message:"The invocation parameters must be a valid JSON object"}),E.NEVER;const{success:t,data:i}=Uh.safeParse(l);return t?i:(a.addIssue({code:E.ZodIssueCode.custom,message:"The invocation parameters must be a valid JSON object"}),E.NEVER)}).default("{}"),Hh=E.object({[Se.llm]:E.object({[qe.provider]:E.string().optional(),[qe.model_name]:E.string()})}),Ps=E.object({[Se.llm]:E.object({[qe.invocation_parameters]:Ts})}),Gh=E.object({[Se.llm]:E.object({[qe.invocation_parameters]:Ts.pipe(E.object({response_format:Ks.optional()}))})}),Wh=E.object({url:E.object({full:E.string(),path:E.string().optional()})}),Jh=E.string().transform((n,a)=>{const{json:l}=Be(n);return l==null||!bi(l)?(a.addIssue({code:E.ZodIssueCode.custom,message:"The tool JSON schema must be a valid JSON object"}),E.NEVER):l}).transform((n,a)=>{const{data:l,success:t}=oy.safeParse(n);return t?l:(a.addIssue({code:E.ZodIssueCode.custom,message:"The tool JSON schema must be a valid tool schema"}),E.NEVER)}),Xh=E.object({[Se.llm]:E.object({[qe.tools]:E.array(E.object({[Se.tool]:E.object({[Hl.json_schema]:Jh})}).optional()).optional()}).optional()}).optional(),Zh=E.lazy(()=>E.object({type:E.literal("json_schema"),json_schema:E.object({name:E.string().describe("The name of the schema"),schema:sy.describe("The schema itself in JSON schema format"),strict:E.literal(!0).describe("The schema must be strict")})})),Yh=at(Zh,{removeAdditionalStrategy:"passthrough"}),e0=E.string().transform((n,a)=>{const{json:l}=Be(n);return va(l)?Object.entries(l).reduce((i,[r,s])=>{if(typeof s=="string")i[r]=s;else{const{json:d}=jn(s);d!=null&&(i[r]=d)}return i},{}):(a.addIssue({code:E.ZodIssueCode.custom,message:"The prompt template variables must be a valid JSON object"}),E.NEVER)}),n0=E.object({[Se.llm]:E.object({[qe.prompt_template]:E.object({variables:e0}).optional()}).optional()}).optional();function xs(n){return Cs.safeParse(n).success}function pa(n){const a=n.toLowerCase();if(xs(a))return a;for(const[l,t]of Object.entries(Gl))if(t.includes(a))return l;return dy}function a0({toolCalls:n,provider:a}){if(n!=null)return n.map(({tool_call:l})=>{var i,r,s,d;if(l==null)return null;let t={};if(((i=l.function)==null?void 0:i.arguments)!=null){const{json:c}=Be(l.function.arguments);va(c)&&(t=c)}switch(a){case"OPENAI":case"AZURE_OPENAI":case"DEEPSEEK":case"XAI":case"OLLAMA":return{id:l.id??"",type:"function",function:{name:((r=l.function)==null?void 0:r.name)??"",arguments:t}};case"ANTHROPIC":return{id:l.id??"",type:"tool_use",name:((s=l.function)==null?void 0:s.name)??"",input:t};case"GOOGLE":return{id:l.id??"",function:{name:((d=l.function)==null?void 0:d.name)??"",arguments:t}};default:Te()}}).filter(l=>l!=null)}function Is({messages:n,provider:a}){return n.map(({message:l})=>{var t,i;return{id:fa(),role:l.tool_call_id!=null?pa("tool"):pa(l.role),content:Array.isArray(l.contents)?((i=(t=l.contents.find(r=>r.message_content.type==="text"))==null?void 0:t.message_content)==null?void 0:i.text)??void 0:typeof l.content=="string"?l.content:void 0,toolCalls:a0({provider:a,toolCalls:l.tool_calls}),toolCallId:l.tool_call_id}})}function l0({provider:n,parsedAttributes:a}){var t;const l=jh.safeParse(a);if(!l.success)return{messageParsingErrors:[Lh],messages:null};if(n==="ANTHROPIC"){const{success:i,data:r}=Ps.safeParse(a);if(i){const s=l.data.llm.input_messages,d=(t=r.llm.invocation_parameters)==null?void 0:t.system;typeof d=="string"&&d&&(!s||s[0].message.role!=="system")&&l.data.llm.input_messages.unshift({message:{role:"system",content:d}})}}return{messageParsingErrors:[],messages:Is({provider:n,messages:l.data.llm.input_messages})}}function t0({provider:n,parsedAttributes:a}){const l=[],t=Oh.safeParse(a);if(t.success)return{output:Is({provider:n,messages:t.data.llm.output_messages}),outputParsingErrors:l};l.push(_h);const i=Qh.safeParse(a);return i.success?{output:i.data.output.value,outputParsingErrors:l}:(l.push(Ah),{output:void 0,outputParsingErrors:l})}function Ds(n){if(n==null)return null;switch(n.toLowerCase()){case"openai":return"OPENAI";case"anthropic":return"ANTHROPIC";case"google":return"GOOGLE";case"azure":return"AZURE_OPENAI";default:return null}}function i0(n){for(const a of Object.keys(Dr))if(Dr[a].some(t=>n.includes(t)))return a;return bo}function r0(n){const{success:a,data:l}=Hh.safeParse(n);if(a){const t=Ds(l.llm.provider)||i0(l.llm.model_name),i=o0(n);return{modelConfig:{...Object.fromEntries(Object.entries(i).filter(([r,s])=>s!==null)),modelName:l.llm.model_name,provider:t,invocationParameters:[],supportedInvocationParameters:[]},parsingErrors:[]}}return{modelConfig:null,parsingErrors:[Rh]}}function o0(n){const{success:a,data:l}=Wh.safeParse(n);if(a)try{const t=new URL(l.url.full);let i=t;if(l.url.path)try{i=new URL(l.url.full.split(l.url.path)[0])}catch{}return{baseUrl:`${i.origin}${i.pathname}`,endpoint:t.origin,apiVersion:t.searchParams.get("api-version")||null}}catch{}return{baseUrl:null,apiVersion:null,endpoint:null}}function s0(n,a=[]){const{success:l,data:t}=Ps.safeParse(n),i=[];return l||i.push(Eh),{invocationParameters:h0((t==null?void 0:t.llm.invocation_parameters)??{},a),parsingErrors:i}}function d0(n){const{success:a,data:l}=Gh.safeParse(n);return a?{responseFormat:l.llm.invocation_parameters.response_format,parsingErrors:[]}:{responseFormat:void 0,parsingErrors:[Mh]}}function c0(n){var a;return(((a=n==null?void 0:n.llm)==null?void 0:a.tools)??[]).map(l=>(l==null?void 0:l.tool)==null?null:{id:vl(),definition:l.tool.json_schema}).filter(l=>l!=null)}function u0(n){var t;const{data:a,success:l}=Xh.safeParse(n);return l?((t=a==null?void 0:a.llm)==null?void 0:t.tools)==null?{tools:null,parsingErrors:[]}:{tools:c0(a),parsingErrors:[]}:{tools:null,parsingErrors:[Vh]}}function m0(n){var t;const{success:a,data:l}=n0.safeParse(n);return a?((t=l==null?void 0:l.llm)==null?void 0:t.prompt_template)==null?{variables:null,parsingErrors:[]}:{variables:l.llm.prompt_template.variables,parsingErrors:[]}:{variables:null,parsingErrors:[zh]}}function g0(n){const{instance:a,instanceMessages:l}=ko(),t={...a,template:{__type:"chat",messages:Object.values(l)}},{json:i,parseError:r}=Be(n.attributes);if(r)return{playgroundInstance:{...t,spanId:(n==null?void 0:n.id)??null},parsingErrors:[wh]};const s=n.invocationParameters,d=r0(i);let{modelConfig:c}=d;const{parsingErrors:g}=d,{messages:f,messageParsingErrors:u}=l0({provider:(c==null?void 0:c.provider)??t.model.provider,parsedAttributes:i}),{output:p,outputParsingErrors:y}=t0({provider:(c==null?void 0:c.provider)??t.model.provider,parsedAttributes:i}),{invocationParameters:h,parsingErrors:k}=s0(i,s),{variables:S,parsingErrors:C}=m0(i),{parsingErrors:P}=d0(i);c=c!=null?{...c,invocationParameters:P.length>0?h.filter(V=>V.invocationName!==Vn&&V.canonicalName!==Nn):h}:null;const{tools:L,parsingErrors:_}=u0(i),w=f==null?void 0:f.map(V=>({...V,content:V.role==="tool"?Oi(V.content):V.content}));return{playgroundInstance:{...t,model:c??t.model,template:w!=null?{__type:"chat",messages:w}:t.template,output:p,spanId:n.id,tools:L??t.tools},playgroundInput:S!=null?{variablesValueCache:S}:void 0,parsingErrors:[...u,...y,...g,..._,...k,...P,...C]}}const p0=n=>qh.safeParse(n).success,Ls=({instance:n,templateFormat:a})=>{if(a==bn.NONE)return[];const l=new Set,t=n.template.__type,i=cy(a);switch(t){case"chat":{n.template.messages.forEach(r=>{(r.content==null?[]:i.extractVariables(r.content)).forEach(d=>{l.add(d)})});break}case"text_completion":{i.extractVariables(n.template.prompt).forEach(s=>{l.add(s)});break}default:Te()}return Array.from(l)},y0=({instances:n,templateFormat:a})=>a==bn.NONE?[]:Array.from(new Set(n.flatMap(l=>Ls({instance:l,templateFormat:a})))),_s=({instances:n,templateFormat:a,input:l})=>{if(a==bn.NONE)return{variablesMap:{},variableKeys:[]};const t=y0({instances:n,templateFormat:a}),i=l.variablesValueCache??{};return{variablesMap:t.reduce((s,d)=>(s[d]=i[d]||"",s),{}),variableKeys:t}};function Ca(n,a){return n.invocationName===a.invocationName||n.canonicalName!=null&&a.canonicalName!=null&&n.canonicalName===a.canonicalName}const f0=(n,a)=>n.filter(l=>a.some(t=>Ca(t,l))).map(l=>{var t;return{...l,invocationName:((t=a.find(i=>Ca(i,l)))==null?void 0:t.invocationName)??l.invocationName}}),cl=n=>n.replace(/_([a-z])/g,(a,l)=>l.toUpperCase()),h0=(n,a)=>Object.entries(n).map(([l,t])=>{const i=a.find(r=>r.canonicalName&&r.canonicalName.toLowerCase()===l.toLowerCase()||r.invocationName&&r.invocationName.toLowerCase()===l.toLowerCase());return i==null||i.invocationInputField==null||i.invocationName==null?null:{canonicalName:i.canonicalName,invocationName:i.invocationName,[cl(i.invocationInputField)]:t}}).filter(l=>l!=null),As=n=>{const{provider:a,validatedToolDefinition:l}=gy(n.definition);switch(a){case"OPENAI":case"AZURE_OPENAI":return l.function.name;case"ANTHROPIC":return l.name;case"UNKNOWN":return null;default:Te()}},k0=({provider:n,toolNumber:a})=>{switch(n){case"OPENAI":case"DEEPSEEK":case"XAI":case"OLLAMA":case"AZURE_OPENAI":return{id:vl(),definition:fr(a)};case"ANTHROPIC":return{id:vl(),definition:my(a)};case"GOOGLE":return{id:vl(),definition:fr(a)};default:Te()}},b0=n=>{switch(n){case"OPENAI":case"AZURE_OPENAI":case"DEEPSEEK":case"XAI":case"OLLAMA":return yr();case"ANTHROPIC":return uy();case"GOOGLE":return yr();default:Te()}};function S0(n){return{content:n.content,role:v0(n.role),toolCalls:n.toolCalls,toolCallId:n.toolCallId}}function v0(n){switch(n){case"system":return"SYSTEM";case"user":return"USER";case"tool":return"TOOL";case"ai":return"AI";default:Te()}}const ws=({playgroundStore:n,instanceId:a,credentials:l})=>{var u;const{instances:t,allInstanceMessages:i}=n.getState(),r=t.find(p=>p.id===a);if(!r)throw new Error(`No instance found for id ${a}`);if(r.template.__type!=="chat")throw new Error("We only support chat templates for now");const s=r.template.messageIds.map(p=>i[p]).filter(p=>p!=null),d=r.model.supportedInvocationParameters;let c=[...r.model.invocationParameters];const g=Si({toolChoice:r.toolChoice,targetProvider:r.model.provider});r.tools.length>0?(c=c.filter(p=>p.invocationName!==Za&&p.canonicalName!==ba),c.push({canonicalName:ba,invocationName:Za,valueJson:g})):c=c.filter(p=>p.invocationName!==Za&&p.canonicalName!==ba),c=d.length?f0(c,d):c;const f=r.model.provider==="AZURE_OPENAI"?{endpoint:r.model.endpoint,apiVersion:r.model.apiVersion}:{};return{messages:s.map(S0),model:{providerKey:r.model.provider,name:r.model.modelName||"",baseUrl:r.model.baseUrl,...f},invocationParameters:Es(c,r.model.provider,r.model.modelName),tools:r.tools.length?r.tools.map(p=>p.definition):void 0,credentials:F0(l,r.model.provider),promptName:(u=r.prompt)==null?void 0:u.name}},_t=(n,a)=>{if(n.template.__type==="chat"){const{messageIds:l,...t}=n.template;return{...n,template:{...t,messages:n.template.messageIds.map(i=>a[i])}}}return n};function F0(n,a){const l=n[a],t=wl[a];return l?t.length===0?[]:t.map(i=>({envVarName:i.envVarName,value:l[i.envVarName]??""})):[]}const C0=({playgroundStore:n,instanceId:a,credentials:l})=>{const t=ws({playgroundStore:n,instanceId:a,credentials:l}),{instances:i,templateFormat:r,input:s,allInstanceMessages:d}=n.getState(),c=i.map(f=>_t(f,d)),{variablesMap:g}=_s({instances:c,input:s,templateFormat:r});return{...t,template:{variables:g,format:r}}},Lr=({playgroundStore:n,instanceId:a,credentials:l,datasetId:t})=>({...ws({playgroundStore:n,instanceId:a,credentials:l}),templateFormat:n.getState().templateFormat,datasetId:t});function Oi(n){if(typeof n=="string"){const a=n.startsWith('"{')||n.startsWith('"[')||n.startsWith('"\\"');try{if(a){const t=JSON.parse(n),i=typeof t=="string"?JSON.parse(t):t;return JSON.stringify(i,null,2)}}catch{}if(/^\s*[0-9{[]|true|false|null/.test(n))return n}return JSON.stringify(n,null,2)}function Rs(n,a){return a.filter(l=>l.required).every(l=>n.some(t=>Ca(t,l)))}const K0=n=>{for(const[a,l]of Object.entries(n))if(a.endsWith("DefaultValue")&&l!=null)return n[a]};function mT(n,a){const l=new Map(n.map(t=>[t.invocationName,t]));return a.forEach(t=>{var c;const i=t.invocationName,r=K0(t),s=cl(t.invocationInputField||"");if(!t.invocationName||!t.invocationInputField||!i||r==null||((c=l.get(i))==null?void 0:c[s])!=null)return;const d={canonicalName:t.canonicalName,invocationName:t.invocationName,[s]:r};l.set(i,d)}),Array.from(l.values())}const T0=E.object({type:E.literal("enabled")}).passthrough(),P0=E.object({type:E.enum(["any","tool"])}).passthrough(),x0=(n,a)=>{if(!a)return n;const l=n.some(t=>t.canonicalName==="ANTHROPIC_EXTENDED_THINKING"&&t.valueJson&&T0.safeParse(t.valueJson).success);return n.filter(t=>{if(t.canonicalName==="ANTHROPIC_EXTENDED_THINKING"&&!t.valueJson)return!1;if(l){if(t.canonicalName==="TEMPERATURE"||t.canonicalName==="TOP_P")return!1;if(t.canonicalName===ba)return!P0.safeParse(t.valueJson).success}return!0})},I0=["frequency_penalty","presence_penalty"],D0=n=>n.filter(l=>l.invocationName&&I0.includes(l.invocationName)?!(l.valueFloat==0||l.valueInt==0):!0),Es=(n,a,l)=>{const t=D0(n);return a==="ANTHROPIC"?x0(t,l):t},Ms=m.createContext(null);function gT({children:n,...a}){const[l]=m.useState(()=>py(a));return e(Ms.Provider,{value:l,children:n})}function Na(n,a){const l=m.useContext(Ms);if(!l)throw new Error("Missing CredentialsContext.Provider in the tree");return Ll(l,n,a)}const Vs="arize-phoenix-feature-flags",qt={dashboards:!1};function L0(){const n=localStorage.getItem(Vs);if(!n)return qt;try{const a=JSON.parse(n);return Object.assign({},qt,a)}catch{return qt}}const zs=m.createContext(null);function Ns(){const n=fn.useContext(zs);if(n===null)throw new Error("useFeatureFlags must be used within a FeatureFlagsProvider");return n}function _0(n){const{featureFlags:a}=Ns();return a[n]}function pT(n){const[a,l]=m.useState(L0()),t=i=>{localStorage.setItem(Vs,JSON.stringify(i)),l(i)};return e(zs.Provider,{value:{featureFlags:a,setFeatureFlags:t},children:e(A0,{children:n.children})})}function A0(n){const{children:a}=n,{featureFlags:l,setFeatureFlags:t}=Ns(),[i,r]=m.useState(!1);return Sa("ctrl+shift+f",()=>r(!0)),o(J,{children:[a,e(ue,{type:"modal",isDismissable:!0,onDismiss:()=>r(!1),children:i&&e(oe,{title:"Feature Flags",children:e(v,{height:"size-1000",padding:"size-100",children:Object.keys(l).map(s=>e(xa,{isSelected:l[s],onChange:d=>t({...l,[s]:d}),children:s},s))})})})]})}const $s=m.createContext(null);function w0(){const n=m.useContext($s);if(n===null)throw new Error("useFunctionality must be used within a FunctionalityProvider");return n}function yT(n){return e($s.Provider,{value:{authenticationEnabled:window.Config.authenticationEnabled},children:n.children})}const js={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"GenerativeProvidersCard_data",selections:[{alias:null,args:null,concreteType:"GenerativeProvider",kind:"LinkedField",name:"modelProviders",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"key",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"dependenciesInstalled",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"dependencies",storageKey:null},{alias:null,args:null,concreteType:"GenerativeProviderCredentialConfig",kind:"LinkedField",name:"credentialRequirements",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"envVarName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"isRequired",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"credentialsSet",storageKey:null}],storageKey:null}],type:"Query",abstractKey:null};js.hash="4062531cfa3f77e541172a44101f5331";function R0({query:n}){const[a,l]=m.useState(null),t=Na(g=>g),i=T.useFragment(js,n),r=m.useMemo(()=>[...i.modelProviders],[i]),s=m.useMemo(()=>[{header:"Name",accessorKey:"name",cell:({row:g})=>o(b,{direction:"row",alignItems:"center",gap:"size-100",children:[e(Rl,{provider:g.original.key,height:18}),g.original.name]})},{header:"Environment Variables",accessorKey:"apiKeyEnvVar",cell:({row:g})=>{const f=wl[g.original.key],u=(f==null?void 0:f.map(p=>p.envVarName).join(", "))||g.original.credentialRequirements.map(p=>p.envVarName).join(", ")||"--";return e(F,{children:u})}},{header:"configuration",accessorKey:"credentialsSet",cell:({row:g})=>{if(!g.original.dependenciesInstalled)return e(F,{color:"warning",children:"missing dependencies"});const f=g.original.credentialRequirements,u=t[g.original.key];return f.every(({envVarName:y,isRequired:h})=>(u==null?void 0:u[y])!==void 0||!h)?e(F,{color:"success",children:"local"}):g.original.credentialsSet?e(F,{color:"success",children:"configured on the server"}):e(F,{color:"text-700",children:"not configured"})}},{header:"",accessorKey:"id",cell:({row:g})=>e(b,{direction:"row",justifyContent:"end",gap:"size-100",width:"100%",children:e(M,{size:"S",leadingVisual:e(I,{svg:e(ja,{})}),onPress:()=>{l(g.original)}})})}],[t]),d=Ce({columns:s,data:r,getCoreRowModel:Ke(),getSortedRowModel:ln()}),c=d.getRowModel().rows;return o(q,{title:"AI Providers",bodyStyle:{padding:0},variant:"compact",children:[o("table",{css:We,children:[e("thead",{children:d.getHeaderGroups().map(g=>e("tr",{children:g.headers.map(f=>e("th",{colSpan:f.colSpan,children:f.isPlaceholder?null:e("div",{children:W(f.column.columnDef.header,f.getContext())})},f.id))},g.id))}),e("tbody",{children:c.map(g=>e("tr",{children:g.getVisibleCells().map(f=>e("td",{children:W(f.column.columnDef.cell,f.getContext())},f.id))},g.id))})]}),e(ue,{type:"modal",isDismissable:!0,onDismiss:()=>l(null),children:a&&e(oe,{title:`Configure ${a.name} Credentials`,size:"S",children:o(v,{padding:"size-200",children:[e(v,{paddingBottom:"size-100",children:o(F,{size:"XS",children:["Set the credentials for the ",a.name," API. These credentials will be stored entirely in your browser and will only be sent to the server during API requests."]})}),o(gn,{onSubmit:g=>{g.preventDefault(),l(null)},children:[e(E0,{provider:a.key}),e(v,{paddingTop:"size-200",children:o(b,{direction:"row",justifyContent:"end",gap:"size-100",children:[e(M,{variant:"default",size:"S",onPress:()=>{l(null)},children:"Cancel"}),e(M,{variant:"primary",size:"S",onPress:()=>{l(null)},children:"Save Credentials"})]})})]})]})})})]})}function E0({provider:n}){const a=Na(i=>i.setCredential),l=wl[n],t=Na(i=>i[n]);return e(b,{direction:"column",gap:"size-100",children:l.map(i=>o(vo,{isRequired:i.isRequired,onChange:r=>{a({provider:n,envVarName:i.envVarName,value:r})},value:(t==null?void 0:t[i.envVarName])??void 0,children:[e(H,{children:i.envVarName}),e(So,{})]},i.envVarName))})}function fT(){const n=Me();return Oe(n),e(R0,{query:n})}const Os={fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"settingsAIProvidersPageLoaderQuery",selections:[{args:null,kind:"FragmentSpread",name:"GenerativeProvidersCard_data"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"settingsAIProvidersPageLoaderQuery",selections:[{alias:null,args:null,concreteType:"GenerativeProvider",kind:"LinkedField",name:"modelProviders",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"key",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"dependenciesInstalled",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"dependencies",storageKey:null},{alias:null,args:null,concreteType:"GenerativeProviderCredentialConfig",kind:"LinkedField",name:"credentialRequirements",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"envVarName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"isRequired",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"credentialsSet",storageKey:null}],storageKey:null}]},params:{cacheID:"1238ea27e05b70fd2c203ab4be6a1209",id:null,metadata:{},name:"settingsAIProvidersPageLoaderQuery",operationKind:"query",text:`query settingsAIProvidersPageLoaderQuery {
  ...GenerativeProvidersCard_data
}

fragment GenerativeProvidersCard_data on Query {
  modelProviders {
    name
    key
    dependenciesInstalled
    dependencies
    credentialRequirements {
      envVarName
      isRequired
    }
    credentialsSet
  }
}
`}};Os.hash="2c8eecb8897f8c7dadfdc3de4e2a41a8";async function hT(){return await T.fetchQuery(he,Os,{}).toPromise()}const Qs=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{kind:"Variable",name:"input",variableName:"input"}],l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},t=[l],i={kind:"InlineFragment",selections:t,type:"ContinuousAnnotationConfig",abstractKey:null},r={kind:"InlineFragment",selections:t,type:"CategoricalAnnotationConfig",abstractKey:null},s={kind:"InlineFragment",selections:t,type:"FreeformAnnotationConfig",abstractKey:null},d={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},c={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},g={alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},f={alias:null,args:null,kind:"ScalarField",name:"annotationType",storageKey:null},u={alias:null,args:null,kind:"ScalarField",name:"optimizationDirection",storageKey:null},p={kind:"InlineFragment",selections:t,type:"Node",abstractKey:"__isNode"};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"SettingsAnnotationsPageUpdateAnnotationConfigMutation",selections:[{alias:null,args:a,concreteType:"UpdateAnnotationConfigPayload",kind:"LinkedField",name:"updateAnnotationConfig",plural:!1,selections:[{alias:null,args:null,concreteType:"Query",kind:"LinkedField",name:"query",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"AnnotationConfigTableFragment"}],storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"annotationConfig",plural:!1,selections:[i,r,s],storageKey:null}],storageKey:null}],type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"SettingsAnnotationsPageUpdateAnnotationConfigMutation",selections:[{alias:null,args:a,concreteType:"UpdateAnnotationConfigPayload",kind:"LinkedField",name:"updateAnnotationConfig",plural:!1,selections:[{alias:null,args:null,concreteType:"Query",kind:"LinkedField",name:"query",plural:!1,selections:[{alias:null,args:null,concreteType:"AnnotationConfigConnection",kind:"LinkedField",name:"annotationConfigs",plural:!1,selections:[{alias:null,args:null,concreteType:"AnnotationConfigEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"annotationConfig",args:null,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[d,{kind:"InlineFragment",selections:[l,c,g,f,u,{alias:null,args:null,concreteType:"CategoricalAnnotationValue",kind:"LinkedField",name:"values",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"score",storageKey:null}],storageKey:null}],type:"CategoricalAnnotationConfig",abstractKey:null},{kind:"InlineFragment",selections:[l,c,g,f,u,{alias:null,args:null,kind:"ScalarField",name:"upperBound",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"lowerBound",storageKey:null}],type:"ContinuousAnnotationConfig",abstractKey:null},{kind:"InlineFragment",selections:[l,c,g,f],type:"FreeformAnnotationConfig",abstractKey:null},p],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"annotationConfig",plural:!1,selections:[d,i,r,s,p],storageKey:null}],storageKey:null}]},params:{cacheID:"257070989d0363192027975755cb6b4a",id:null,metadata:{},name:"SettingsAnnotationsPageUpdateAnnotationConfigMutation",operationKind:"mutation",text:`mutation SettingsAnnotationsPageUpdateAnnotationConfigMutation(
  $input: UpdateAnnotationConfigInput!
) {
  updateAnnotationConfig(input: $input) {
    query {
      ...AnnotationConfigTableFragment
    }
    annotationConfig {
      __typename
      ... on ContinuousAnnotationConfig {
        id
      }
      ... on CategoricalAnnotationConfig {
        id
      }
      ... on FreeformAnnotationConfig {
        id
      }
      ... on Node {
        __isNode: __typename
        id
      }
    }
  }
}

fragment AnnotationConfigTableFragment on Query {
  annotationConfigs {
    edges {
      annotationConfig: node {
        __typename
        ... on CategoricalAnnotationConfig {
          id
          name
          description
          annotationType
          optimizationDirection
          values {
            label
            score
          }
        }
        ... on ContinuousAnnotationConfig {
          id
          name
          description
          annotationType
          optimizationDirection
          upperBound
          lowerBound
        }
        ... on FreeformAnnotationConfig {
          id
          name
          description
          annotationType
        }
        ... on Node {
          __isNode: __typename
          id
        }
      }
    }
  }
}
`}}}();Qs.hash="c40b34d87894e9ff40a6b2d9dbfd035b";const Bs=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{kind:"Variable",name:"input",variableName:"input"}],l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},t=[l],i={kind:"InlineFragment",selections:t,type:"ContinuousAnnotationConfig",abstractKey:null},r={kind:"InlineFragment",selections:t,type:"CategoricalAnnotationConfig",abstractKey:null},s={kind:"InlineFragment",selections:t,type:"FreeformAnnotationConfig",abstractKey:null},d={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},c={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},g={alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},f={alias:null,args:null,kind:"ScalarField",name:"annotationType",storageKey:null},u={alias:null,args:null,kind:"ScalarField",name:"optimizationDirection",storageKey:null},p={kind:"InlineFragment",selections:t,type:"Node",abstractKey:"__isNode"};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"SettingsAnnotationsPageCreateAnnotationConfigMutation",selections:[{alias:null,args:a,concreteType:"CreateAnnotationConfigPayload",kind:"LinkedField",name:"createAnnotationConfig",plural:!1,selections:[{alias:null,args:null,concreteType:"Query",kind:"LinkedField",name:"query",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"AnnotationConfigTableFragment"}],storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"annotationConfig",plural:!1,selections:[i,r,s],storageKey:null}],storageKey:null}],type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"SettingsAnnotationsPageCreateAnnotationConfigMutation",selections:[{alias:null,args:a,concreteType:"CreateAnnotationConfigPayload",kind:"LinkedField",name:"createAnnotationConfig",plural:!1,selections:[{alias:null,args:null,concreteType:"Query",kind:"LinkedField",name:"query",plural:!1,selections:[{alias:null,args:null,concreteType:"AnnotationConfigConnection",kind:"LinkedField",name:"annotationConfigs",plural:!1,selections:[{alias:null,args:null,concreteType:"AnnotationConfigEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"annotationConfig",args:null,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[d,{kind:"InlineFragment",selections:[l,c,g,f,u,{alias:null,args:null,concreteType:"CategoricalAnnotationValue",kind:"LinkedField",name:"values",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"score",storageKey:null}],storageKey:null}],type:"CategoricalAnnotationConfig",abstractKey:null},{kind:"InlineFragment",selections:[l,c,g,f,u,{alias:null,args:null,kind:"ScalarField",name:"upperBound",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"lowerBound",storageKey:null}],type:"ContinuousAnnotationConfig",abstractKey:null},{kind:"InlineFragment",selections:[l,c,g,f],type:"FreeformAnnotationConfig",abstractKey:null},p],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"annotationConfig",plural:!1,selections:[d,i,r,s,p],storageKey:null}],storageKey:null}]},params:{cacheID:"4435e31203bf8e2b8e4f332973a4cd4e",id:null,metadata:{},name:"SettingsAnnotationsPageCreateAnnotationConfigMutation",operationKind:"mutation",text:`mutation SettingsAnnotationsPageCreateAnnotationConfigMutation(
  $input: CreateAnnotationConfigInput!
) {
  createAnnotationConfig(input: $input) {
    query {
      ...AnnotationConfigTableFragment
    }
    annotationConfig {
      __typename
      ... on ContinuousAnnotationConfig {
        id
      }
      ... on CategoricalAnnotationConfig {
        id
      }
      ... on FreeformAnnotationConfig {
        id
      }
      ... on Node {
        __isNode: __typename
        id
      }
    }
  }
}

fragment AnnotationConfigTableFragment on Query {
  annotationConfigs {
    edges {
      annotationConfig: node {
        __typename
        ... on CategoricalAnnotationConfig {
          id
          name
          description
          annotationType
          optimizationDirection
          values {
            label
            score
          }
        }
        ... on ContinuousAnnotationConfig {
          id
          name
          description
          annotationType
          optimizationDirection
          upperBound
          lowerBound
        }
        ... on FreeformAnnotationConfig {
          id
          name
          description
          annotationType
        }
        ... on Node {
          __isNode: __typename
          id
        }
      }
    }
  }
}
`}}}();Bs.hash="74c458f1e12e1bea2f151135710bbc9b";const qs=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{kind:"Variable",name:"input",variableName:"input"}],l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"annotationType",storageKey:null},s={alias:null,args:null,kind:"ScalarField",name:"optimizationDirection",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"SettingsAnnotationsPageDeleteAnnotationConfigsMutation",selections:[{alias:null,args:a,concreteType:"DeleteAnnotationConfigsPayload",kind:"LinkedField",name:"deleteAnnotationConfigs",plural:!1,selections:[{alias:null,args:null,concreteType:"Query",kind:"LinkedField",name:"query",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"AnnotationConfigTableFragment"}],storageKey:null}],storageKey:null}],type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"SettingsAnnotationsPageDeleteAnnotationConfigsMutation",selections:[{alias:null,args:a,concreteType:"DeleteAnnotationConfigsPayload",kind:"LinkedField",name:"deleteAnnotationConfigs",plural:!1,selections:[{alias:null,args:null,concreteType:"Query",kind:"LinkedField",name:"query",plural:!1,selections:[{alias:null,args:null,concreteType:"AnnotationConfigConnection",kind:"LinkedField",name:"annotationConfigs",plural:!1,selections:[{alias:null,args:null,concreteType:"AnnotationConfigEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"annotationConfig",args:null,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{kind:"InlineFragment",selections:[l,t,i,r,s,{alias:null,args:null,concreteType:"CategoricalAnnotationValue",kind:"LinkedField",name:"values",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"score",storageKey:null}],storageKey:null}],type:"CategoricalAnnotationConfig",abstractKey:null},{kind:"InlineFragment",selections:[l,t,i,r,s,{alias:null,args:null,kind:"ScalarField",name:"upperBound",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"lowerBound",storageKey:null}],type:"ContinuousAnnotationConfig",abstractKey:null},{kind:"InlineFragment",selections:[l,t,i,r],type:"FreeformAnnotationConfig",abstractKey:null},{kind:"InlineFragment",selections:[l],type:"Node",abstractKey:"__isNode"}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}]},params:{cacheID:"6e38d0b6b5719c234df5a3f833e19ba0",id:null,metadata:{},name:"SettingsAnnotationsPageDeleteAnnotationConfigsMutation",operationKind:"mutation",text:`mutation SettingsAnnotationsPageDeleteAnnotationConfigsMutation(
  $input: DeleteAnnotationConfigsInput!
) {
  deleteAnnotationConfigs(input: $input) {
    query {
      ...AnnotationConfigTableFragment
    }
  }
}

fragment AnnotationConfigTableFragment on Query {
  annotationConfigs {
    edges {
      annotationConfig: node {
        __typename
        ... on CategoricalAnnotationConfig {
          id
          name
          description
          annotationType
          optimizationDirection
          values {
            label
            score
          }
        }
        ... on ContinuousAnnotationConfig {
          id
          name
          description
          annotationType
          optimizationDirection
          upperBound
          lowerBound
        }
        ... on FreeformAnnotationConfig {
          id
          name
          description
          annotationType
        }
        ... on Node {
          __isNode: __typename
          id
        }
      }
    }
  }
}
`}}}();qs.hash="dd6584e233bd3299d9546d2bc1a7762f";const Us={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"SettingsAnnotationsPageFragment",selections:[{args:null,kind:"FragmentSpread",name:"AnnotationConfigTableFragment"}],type:"Query",abstractKey:null};Us.hash="899b97b5d6aabeea206cd9b4ffb1a773";const _r="ABCDEFGHIJKLMNOPQRSTUVWXYZ".split(""),M0=["MAXIMIZE","MINIMIZE","NONE"],V0=["CATEGORICAL","CONTINUOUS","FREEFORM"],Hs=({onAddAnnotationConfig:n,initialAnnotationConfig:a})=>{const l=be(),t=me(),i=a?"edit":"new",{control:r,handleSubmit:s,watch:d}=Ve({defaultValues:a||{annotationType:"CATEGORICAL",values:[{label:"",score:null},{label:"",score:null}],optimizationDirection:"MAXIMIZE"}}),{fields:c,append:g,remove:f}=bp({control:r,name:"values"}),u=(y,h)=>{const k=()=>{t({title:i==="new"?"Annotation config created!":"Annotation config updated!"}),h()},S=C=>{l({title:i==="new"?"Failed to create annotation config":"Failed to update annotation config",message:C})};switch(y.annotationType){case"CATEGORICAL":{const C={annotationType:"CATEGORICAL",name:y.name,values:y.values,id:(a==null?void 0:a.id)||"",optimizationDirection:y.optimizationDirection,description:y.description};n(C,{onCompleted:k,onError:S});break}case"CONTINUOUS":{const C={annotationType:"CONTINUOUS",name:y.name,lowerBound:y.lowerBound,upperBound:y.upperBound,id:(a==null?void 0:a.id)||"",optimizationDirection:y.optimizationDirection,description:y.description};n(C,{onCompleted:k,onError:S});break}case"FREEFORM":{const C={annotationType:"FREEFORM",name:y.name,id:(a==null?void 0:a.id)||"",description:y.description};n(C,{onCompleted:k,onError:S});break}}},p=d("annotationType");return e(He,{css:K`
        border: none;
        width: 700px;
        max-width: 90%;
      `,children:({close:y})=>e(q,{title:i==="new"?"New Annotation Config":"Edit Annotation Config",variant:"compact",bodyStyle:{padding:0},children:o(gn,{onSubmit:h=>{s(k=>{u(k,y)})(h)},children:[e(v,{minWidth:"200px",padding:"size-200",maxHeight:"620px",overflow:"auto",children:o(b,{direction:"column",gap:"size-200",className:"new-annotation-dialog-container",children:[e(G,{name:"name",control:r,rules:{required:"Name is required"},render:({field:h,fieldState:{error:k}})=>o(ee,{...h,isInvalid:!!k,autoFocus:!0,children:[e(H,{children:"Annotation Name"}),e(X,{placeholder:"e.g. correctness"}),e(ke,{children:k==null?void 0:k.message})]})}),e(G,{name:"description",control:r,render:({field:h})=>o(ee,{...h,value:h.value??void 0,css:K`
                        & .react-aria-TextArea {
                          resize: vertical;
                          transition: none;
                        }
                      `,children:[e(H,{children:"Description"}),e(Pa,{rows:2,placeholder:"A description of the annotation configuration"})]})}),e(G,{control:r,name:"annotationType",render:({field:h})=>o(hr,{...h,"aria-label":"Type","data-testid":"type-picker",isReadOnly:i==="edit",children:[e(H,{children:"Annotation Type"}),V0.filter(k=>i==="edit"?k===h.value:k).map(k=>e(kr,{value:k,children:k.charAt(0).toUpperCase()+k.slice(1).toLowerCase()},k)),o(F,{slot:"description",children:["Categorical - assign a category - e.g. grade, A, B, C",e("br",{}),"Continuous - assign a score within a range - e.g. 0-1, 0.5",e("br",{}),'Freeform - assign a freeform text comment, e.g. "good"']})]})}),(p==="CONTINUOUS"||p==="CATEGORICAL")&&e(G,{control:r,name:"optimizationDirection",render:({field:h})=>o(hr,{...h,"aria-label":"Optimization Direction","data-testid":"optimization-direction-picker",css:K`
                          height: 100%;
                        `,children:[e(H,{children:"Optimization Direction"}),M0.map(k=>e(kr,{value:k,children:k.charAt(0).toUpperCase()+k.slice(1).toLowerCase()},k)),o(F,{marginTop:"auto",slot:"description",children:["Maximize - higher the score the better - e.g., correctness",e("br",{}),"Minimize - lower the score the better - e.g., hallucinations",e("br",{}),"None - higher is not better or worse",e("br",{})]})]})}),p==="CONTINUOUS"&&o(b,{gap:"size-800",css:K`
                      // prevent input from growing when sibling inputs have errors
                      & input {
                        max-height: fit-content;
                      }
                    `,children:[e(G,{control:r,name:"lowerBound",rules:{required:"Min is required"},render:({field:{value:h,...k},fieldState:{error:S}})=>o(ha,{...k,value:typeof h=="number"?h:void 0,isInvalid:!!S,children:[e(H,{children:"Min"}),e(X,{placeholder:"0"}),e(ke,{children:S==null?void 0:S.message})]})}),e(G,{control:r,name:"upperBound",rules:{validate:h=>{const k=d("lowerBound");return k!=null&&h!=null&&h<=k?"Max must be greater than min":h!=null&&isNaN(h)?"Max is required":!0}},render:({field:{value:h,...k},fieldState:{error:S}})=>{const C=d("lowerBound");return o(ha,{...k,value:typeof h=="number"?h:void 0,isInvalid:!!S,minValue:typeof C=="number"?C:void 0,children:[e(H,{children:"Max"}),e(X,{placeholder:"1"}),e(ke,{children:S==null?void 0:S.message})]})}})]}),p==="CATEGORICAL"&&o(J,{children:[e(F,{size:"XS",weight:"heavy",children:"Categories"}),c.map((h,k)=>o(b,{direction:"row",gap:"size-100",alignItems:"start",children:[e(G,{control:r,name:`values.${k}.label`,rules:{required:"Category label is required"},render:({field:S,fieldState:{error:C}})=>o(ee,{...S,"aria-label":`Value ${k+1}`,isInvalid:!!C,autoFocus:k>0,children:[e(X,{placeholder:`e.g. ${_r[k%_r.length]}`}),e(ke,{children:C==null?void 0:C.message})]})}),e(G,{control:r,name:`values.${k}.score`,render:({field:S,fieldState:{error:C}})=>o(ha,{...S,value:typeof S.value=="number"?S.value:void 0,"aria-label":`Score ${k+1}`,isInvalid:!!C,children:[e(b,{direction:"row",gap:"size-100",alignItems:"center",children:e(X,{placeholder:`e.g. ${k} (optional)`})}),e(ke,{children:C==null?void 0:C.message})]})}),e(M,{type:"button",leadingVisual:e(I,{svg:e(Je,{})}),"aria-label":"Remove category",onPress:()=>f(k)})]},h.id)),e(b,{justifyContent:"end",width:"100%",children:e(M,{type:"button",onPress:()=>{g({label:"",score:null})},leadingVisual:e(I,{svg:e(ka,{})}),children:"Add category"})})]})]})}),e(v,{paddingX:"size-200",paddingY:"size-200",borderTopColor:"dark",borderTopWidth:"thin",children:o(b,{gap:"size-100",justifyContent:"end",children:[e(M,{type:"button",onPress:y,children:"Cancel"}),e(M,{type:"submit",variant:"primary",children:i==="new"?"Create Annotation Config":"Update Annotation Config"})]})})]})})})},Gs=function(){var n={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},a={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"annotationType",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"optimizationDirection",storageKey:null};return{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"AnnotationConfigTableFragment",selections:[{alias:null,args:null,concreteType:"AnnotationConfigConnection",kind:"LinkedField",name:"annotationConfigs",plural:!1,selections:[{alias:null,args:null,concreteType:"AnnotationConfigEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"annotationConfig",args:null,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{kind:"InlineFragment",selections:[n,a,l,t,i,{alias:null,args:null,concreteType:"CategoricalAnnotationValue",kind:"LinkedField",name:"values",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"score",storageKey:null}],storageKey:null}],type:"CategoricalAnnotationConfig",abstractKey:null},{kind:"InlineFragment",selections:[n,a,l,t,i,{alias:null,args:null,kind:"ScalarField",name:"upperBound",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"lowerBound",storageKey:null}],type:"ContinuousAnnotationConfig",abstractKey:null},{kind:"InlineFragment",selections:[n,a,l,t],type:"FreeformAnnotationConfig",abstractKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],type:"Query",abstractKey:null}}();Gs.hash="21da6fc76dc125423a2f4ecd8ef70866";const z0=({selectedConfig:n,onClearSelection:a,onEditAnnotationConfig:l,onDeleteAnnotationConfig:t})=>{const[i,r]=m.useState(!1);if(!n)return null;const s=n==null?void 0:n.id;return e("div",{"data-editing":i,css:K`
        position: fixed;
        bottom: var(--ac-global-dimension-size-600);
        left: 50%;
        transform: translateX(-50%);
        z-index: 1000;
        box-shadow: 8px 8px 20px 0 rgba(0, 0, 0, 0.4);
        border-radius: var(--ac-global-rounding-medium);
        &[data-editing="true"] {
          display: none;
        }
      `,children:e(v,{backgroundColor:"light",padding:"size-200",borderColor:"light",borderWidth:"thin",borderRadius:"medium",minWidth:"size-6000",children:o(b,{direction:"row",gap:"size-100",alignItems:"center",justifyContent:"space-between",children:[o(F,{children:['Config: "',n==null?void 0:n.name,'"']}),o(b,{direction:"row",gap:"size-100",children:[e(M,{variant:"quiet",onPress:a,children:"Clear Selection"}),o(Ne,{onOpenChange:d=>{r(d),d||a()},children:[o(M,{variant:"danger",children:[e(I,{svg:e(Je,{})}),"Delete"]}),e(on,{children:e(Ge,{children:e(He,{css:K`
                      border: none;
                    `,children:({close:d})=>o(q,{title:"Delete Annotation Config",bodyStyle:{padding:0},variant:"compact",children:[e(v,{padding:"size-200",children:e(F,{children:"Are you sure you want to delete this annotation config? Annotations made with this config will not be impacted."})}),e(v,{paddingX:"size-200",paddingY:"size-100",borderTopColor:"dark",borderTopWidth:"thin",children:o(b,{gap:"size-100",justifyContent:"end",children:[e(M,{variant:"quiet",onPress:d,children:"Cancel"}),e(M,{variant:"danger",onPress:()=>{s&&t(s,{onCompleted:()=>{d()}})},children:"Delete"})]})})]})})})})]}),o(Ne,{onOpenChange:d=>{r(d),d||a()},children:[o(M,{size:"S",variant:"primary",children:[e(I,{svg:e(ja,{})}),"Edit"]}),e(on,{children:e(Ge,{children:e(Hs,{initialAnnotationConfig:n,onAddAnnotationConfig:l})})})]})]})]})})})},N0=[{id:"select",maxSize:10,header:()=>null,cell:({row:n})=>e(On,{checked:n.getIsSelected(),disabled:!n.getCanSelect(),indeterminate:n.getIsSomeSelected(),onChange:n.getToggleSelectedHandler()})},{id:"name",header:"Name",accessorKey:"name",cell:({row:n})=>e(ll,{annotation:n.original,annotationDisplayPreference:"none",css:K`
            width: fit-content;
          `},n.original.id)},{id:"description",header:"Description",accessorKey:"description",sortUndefined:"last",accessorFn:n=>n.description??void 0,maxSize:150,cell:({row:n})=>e(an,{maxWidth:"100%",children:e(F,{children:n.original.description})})},{id:"annotationType",header:"Type",accessorKey:"annotationType",minSize:10,cell:({row:n})=>e(F,{children:n.original.annotationType.charAt(0).toUpperCase()+n.original.annotationType.slice(1).toLowerCase()})},{id:"values",header:"Values",enableSorting:!1,accessorFn:n=>{switch(n.annotationType){case"CATEGORICAL":{if(!n.values)return"";let a=n.values.map((l,t)=>e(Tn,{title:l.label,children:e(an,{maxWidth:"40px",children:l.label})},t));return n.values.length>5&&(a=[...a.slice(-4),o(Ee,{delay:64,placement:"bottom right",children:[e(nn,{children:o(Tn,{css:K`
                      white-space: nowrap;
                    `,children:["+ ",n.values.length-5," more"]},"ellipsis")}),e($n,{children:n.values.map(l=>l.label).join(", ")})]},"ellipsis")]),a}case"CONTINUOUS":return`from ${n.lowerBound} to ${n.upperBound}`;case"FREEFORM":return"";default:return""}},cell:({getValue:n})=>{const a=n();return e(b,{gap:"size-100",children:a})}}],$0=({annotationConfigs:n,onDeleteAnnotationConfig:a,onEditAnnotationConfig:l})=>{const[t,i]=m.useState({}),r=T.useFragment(Gs,n),s=m.useMemo(()=>r.annotationConfigs.edges.map(y=>y.annotationConfig),[r.annotationConfigs.edges]),d=Ce({data:s,columns:N0,getCoreRowModel:Ke(),getSortedRowModel:ln(),enableRowSelection:!0,onRowSelectionChange:i,enableMultiRowSelection:!1,state:{rowSelection:t}}),c=d.getRowCount()===0,g=d.getRowModel().rows,f=d.getSelectedRowModel().rows,u=f.map(y=>y.original),p=()=>{i({})};return o("div",{css:K`
        overflow: auto;
      `,children:[o("table",{css:We,style:{width:d.getTotalSize(),minWidth:"100%"},children:[e("thead",{children:d.getHeaderGroups().map(y=>e("tr",{children:y.headers.map(h=>e("th",{colSpan:h.colSpan,children:h.isPlaceholder?null:o("div",{className:h.column.getCanSort()?"sort":"",onClick:h.column.getToggleSortingHandler(),style:{left:h.getStart(),width:h.getSize()},children:[W(h.column.columnDef.header,h.getContext()),h.column.getIsSorted()?e(I,{className:"sort-icon",svg:h.column.getIsSorted()==="asc"?e(Xe,{}):e(Ze,{})}):null]})},h.id))},y.id))}),c?e(yn,{message:"No Annotation Configs"}):e("tbody",{children:g.map(y=>e("tr",{onClick:()=>{i({[y.id]:!(t!=null&&t[y.id])})},children:y.getVisibleCells().map(h=>e("td",{style:{width:h.column.getSize(),maxWidth:h.column.getSize()},children:W(h.column.columnDef.cell,h.getContext())},h.id))},y.id))})]}),f.length>0&&e(z0,{selectedConfig:u[0],onClearSelection:p,onEditAnnotationConfig:l,onDeleteAnnotationConfig:a})]})},kT=()=>{const n=Me();return e(j0,{annotations:n})},j0=({annotations:n})=>{const{revalidate:a}=Sp(),l=T.useFragment(Us,n),[t]=T.useMutation(qs),[i]=T.useMutation(Bs),r=f=>u=>{const p=De(u);f==null||f((p==null?void 0:p[0])??"Failed to create annotation config")},s=(f,{onCompleted:u,onError:p}={})=>{const{id:y,annotationType:h,...k}=f,S=h.toLowerCase();i({variables:{input:{annotationConfig:{[S]:k}}},onCompleted:u,onError:r(p)}),a()},[d]=T.useMutation(Qs);return e(q,{title:"Annotation Configs",variant:"compact",bodyStyle:{padding:0},extra:o(Ne,{children:[o(M,{size:"S",children:[e(I,{svg:e(ka,{})}),"New Configuration"]}),e(on,{children:e(Ge,{children:e(Hs,{onAddAnnotationConfig:s})})})]}),children:e($0,{annotationConfigs:l,onEditAnnotationConfig:(f,{onCompleted:u,onError:p}={})=>{const{id:y,annotationType:h,...k}=f,S=h.toLowerCase();d({variables:{input:{id:y,annotationConfig:{[S]:k}}},onCompleted:u,onError:r(p)}),a()},onDeleteAnnotationConfig:(f,{onCompleted:u,onError:p}={})=>{t({variables:{input:{ids:[f]}},onCompleted:u,onError:r(p)}),a()}})})},Ws=function(){var n={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},a={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"annotationType",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"optimizationDirection",storageKey:null};return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"settingsAnnotationsPageLoaderQuery",selections:[{args:null,kind:"FragmentSpread",name:"SettingsAnnotationsPageFragment"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"settingsAnnotationsPageLoaderQuery",selections:[{alias:null,args:null,concreteType:"AnnotationConfigConnection",kind:"LinkedField",name:"annotationConfigs",plural:!1,selections:[{alias:null,args:null,concreteType:"AnnotationConfigEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"annotationConfig",args:null,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{kind:"InlineFragment",selections:[n,a,l,t,i,{alias:null,args:null,concreteType:"CategoricalAnnotationValue",kind:"LinkedField",name:"values",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"score",storageKey:null}],storageKey:null}],type:"CategoricalAnnotationConfig",abstractKey:null},{kind:"InlineFragment",selections:[n,a,l,t,i,{alias:null,args:null,kind:"ScalarField",name:"upperBound",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"lowerBound",storageKey:null}],type:"ContinuousAnnotationConfig",abstractKey:null},{kind:"InlineFragment",selections:[n,a,l,t],type:"FreeformAnnotationConfig",abstractKey:null},{kind:"InlineFragment",selections:[n],type:"Node",abstractKey:"__isNode"}],storageKey:null}],storageKey:null}],storageKey:null}]},params:{cacheID:"38239699bb1676189730a7c5bfaf3e16",id:null,metadata:{},name:"settingsAnnotationsPageLoaderQuery",operationKind:"query",text:`query settingsAnnotationsPageLoaderQuery {
  ...SettingsAnnotationsPageFragment
}

fragment AnnotationConfigTableFragment on Query {
  annotationConfigs {
    edges {
      annotationConfig: node {
        __typename
        ... on CategoricalAnnotationConfig {
          id
          name
          description
          annotationType
          optimizationDirection
          values {
            label
            score
          }
        }
        ... on ContinuousAnnotationConfig {
          id
          name
          description
          annotationType
          optimizationDirection
          upperBound
          lowerBound
        }
        ... on FreeformAnnotationConfig {
          id
          name
          description
          annotationType
        }
        ... on Node {
          __isNode: __typename
          id
        }
      }
    }
  }
}

fragment SettingsAnnotationsPageFragment on Query {
  ...AnnotationConfigTableFragment
}
`}}}();Ws.hash="b14c2976ebc78d4709a4e54aa2a20132";async function bT(){return await T.fetchQuery(he,Ws,{}).toPromise()}const Js=function(){var n={defaultValue:null,kind:"LocalArgument",name:"connectionId"},a={defaultValue:null,kind:"LocalArgument",name:"input"},l=[{kind:"Variable",name:"input",variableName:"input"}],t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"maxCount",storageKey:null},s={alias:null,args:null,kind:"ScalarField",name:"maxDays",storageKey:null},d=[t,i,{alias:null,args:null,kind:"ScalarField",name:"cronExpression",storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"rule",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{kind:"InlineFragment",selections:[r],type:"TraceRetentionRuleMaxCount",abstractKey:null},{kind:"InlineFragment",selections:[s],type:"TraceRetentionRuleMaxDays",abstractKey:null},{kind:"InlineFragment",selections:[s,r],type:"TraceRetentionRuleMaxDaysOrCount",abstractKey:null}],storageKey:null},{alias:null,args:null,concreteType:"ProjectConnection",kind:"LinkedField",name:"projects",plural:!1,selections:[{alias:null,args:null,concreteType:"ProjectEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"node",plural:!1,selections:[i,t],storageKey:null}],storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:[n,a],kind:"Fragment",metadata:null,name:"CreateRetentionPolicyMutation",selections:[{alias:null,args:l,concreteType:"ProjectTraceRetentionPolicyMutationPayload",kind:"LinkedField",name:"createProjectTraceRetentionPolicy",plural:!1,selections:[{alias:null,args:null,concreteType:"ProjectTraceRetentionPolicy",kind:"LinkedField",name:"node",plural:!1,selections:[{kind:"InlineDataFragmentSpread",name:"RetentionPoliciesTable_retentionPolicy",selections:d,args:null,argumentDefinitions:[]}],storageKey:null}],storageKey:null}],type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[a,n],kind:"Operation",name:"CreateRetentionPolicyMutation",selections:[{alias:null,args:l,concreteType:"ProjectTraceRetentionPolicyMutationPayload",kind:"LinkedField",name:"createProjectTraceRetentionPolicy",plural:!1,selections:[{alias:null,args:null,concreteType:"ProjectTraceRetentionPolicy",kind:"LinkedField",name:"node",plural:!1,selections:d,storageKey:null},{alias:null,args:null,filters:null,handle:"prependNode",key:"",kind:"LinkedHandle",name:"node",handleArgs:[{items:[{kind:"Variable",name:"connections.0",variableName:"connectionId"}],kind:"ListValue",name:"connections"},{kind:"Literal",name:"edgeTypeName",value:"ProjectTraceRetentionPolicyEdge"}]}],storageKey:null}]},params:{cacheID:"e0981aca4bdf8872ca8bb16aba1f9b5c",id:null,metadata:{},name:"CreateRetentionPolicyMutation",operationKind:"mutation",text:`mutation CreateRetentionPolicyMutation(
  $input: CreateProjectTraceRetentionPolicyInput!
) {
  createProjectTraceRetentionPolicy(input: $input) {
    node {
      ...RetentionPoliciesTable_retentionPolicy
      id
    }
  }
}

fragment RetentionPoliciesTable_retentionPolicy on ProjectTraceRetentionPolicy {
  id
  name
  cronExpression
  rule {
    __typename
    ... on TraceRetentionRuleMaxCount {
      maxCount
    }
    ... on TraceRetentionRuleMaxDays {
      maxDays
    }
    ... on TraceRetentionRuleMaxDaysOrCount {
      maxDays
      maxCount
    }
  }
  projects {
    edges {
      node {
        name
        id
      }
    }
  }
}
`}}}();Js.hash="a111dbcaa8facd112289cd919cca3a3b";const Xs=({numberOfDays:n,numberOfTraces:a})=>{if(n===0&&!a)return"This policy will not delete any traces.";const l=typeof n=="number"?`older than ${n} days`:"",t=typeof a=="number"?`when there are more than ${a} traces`:"";return`This policy will delete traces ${l&&t?`${l} or ${t}`:l||t}`},Qi=({schedule:n})=>{let a="unknown";try{vp.parse(n)}catch{return"invalid schedule"}try{a=Fp.toString(n)}catch{return"invalid schedule"}return`${a} (UTC)`};function Zs(n){const{onSubmit:a,mode:l,isSubmitting:t,defaultValues:i}=n,{control:r,watch:s,handleSubmit:d}=Ve({defaultValues:i??{name:"New Policy",numberOfTraces:void 0,numberOfDays:400,schedule:"0 0 * * 0"},mode:"onChange"}),[c,g,f]=s(["numberOfDays","numberOfTraces","schedule"]);return o(gn,{onSubmit:d(a),children:[o(v,{padding:"size-200",children:[e("p",{children:"A retention policy can be defined so that either a certain number of traces or traces for a certain amount of time is retained in certain projects. If both are defined, the policy will delete traces that are either older than the number of days or have more than the number of traces, whichever comes first."}),e("p",{children:"Once a retention policy is defined, you can associate multiple projects to the same policy."}),o(b,{direction:"row",gap:"size-100",children:[o(v,{flex:"1 1 auto",children:[e(G,{control:r,name:"name",rules:{required:"Name is required"},render:({field:u})=>o(ee,{...u,size:"S",value:u.value,children:[e(H,{children:"Name"}),e(X,{}),e(F,{slot:"description",children:"The name of the retention policy"})]})}),e(G,{control:r,name:"numberOfDays",rules:{required:"Number of days is required. 0 means infinite.",min:{value:0,message:"Number of days must be at least 0"}},render:({field:u})=>o(ha,{step:1,size:"S",...u,children:[e(H,{children:"Number of Days"}),e(X,{}),e(F,{slot:"description",children:"The number of days that will be kept"})]})}),e(G,{control:r,name:"numberOfTraces",rules:{min:{value:0,message:"Number of traces must be at least 0"}},render:({field:u})=>o(ha,{step:1,size:"S",value:u.value??void 0,onChange:u.onChange,onBlur:u.onBlur,children:[e(H,{children:"Number of Traces"}),e(X,{}),e(F,{slot:"description",children:"The number of traces that will be kept"})]})}),e(G,{control:r,name:"schedule",rules:{required:"Schedule is required",validate:u=>{try{const p=Cp.CronExpressionParser.parse(u);if(!p.fields.dayOfMonth.isWildcard)return"Cannot set day of month, must be *";if(!p.fields.month.isWildcard)return"Cannot set month, must be *";if(p.fields.minute.values.length>=1&&p.fields.minute.values[0]!==0)return"Cannot set minute, must be 0"}catch(p){return p instanceof Error?p.message:"Invalid cron expression"}}},render:({field:u,fieldState:p})=>o(ee,{...u,size:"S",...u,isInvalid:!!p.error,children:[e(H,{children:"Schedule"}),e(X,{}),p.error?e(F,{slot:"errorMessage",color:"danger",children:p.error.message}):e(F,{slot:"description",children:"A cron expression for the hour of the week"})]})})]}),o(v,{width:"300px",paddingX:"size-200",children:[e(ae,{level:2,children:"Retention Policy"}),e("br",{}),e(F,{color:"text-700",children:Xs({numberOfDays:c,numberOfTraces:g})}),e("br",{}),e("br",{}),e(F,{color:"text-700",children:`Enforcement Schedule: ${Qi({schedule:f})}`})]})]})]}),e(v,{paddingY:"size-100",paddingX:"size-200",borderTopWidth:"thin",borderColor:"dark",children:o(b,{direction:"row",justifyContent:"end",gap:"size-100",children:[e(M,{size:"S",slot:"close",onPress:n.onCancel,children:"Cancel"}),e(M,{size:"S",variant:"primary",type:"submit",isDisabled:t,children:t?"Submitting...":l==="create"?"Create":"Update"})]})})]})}function O0(n){const a=me(),l=be(),[t,i]=T.useMutation(Js);return e(Zs,{onSubmit:s=>{let d;if(s.numberOfDays&&s.numberOfTraces)d={maxDaysOrCount:{maxDays:s.numberOfDays,maxCount:s.numberOfTraces}};else if(s.numberOfDays)d={maxDays:{maxDays:s.numberOfDays}};else if(s.numberOfTraces)d={maxCount:{maxCount:s.numberOfTraces}};else throw new Error("Invalid retention policy rule");const c=T.ConnectionHandler.getConnectionID(n.queryId,"RetentionPoliciesTable_projectTraceRetentionPolicies");t({variables:{input:{cronExpression:s.schedule,rule:d,name:s.name},connectionId:c},onCompleted:()=>{a({title:"Retention policy created successfully",message:"The retention policy has been created. You can now add this policy to projects."}),n.onCreate()},onError:()=>{l({title:"Error creating retention policy",message:"Please try again."})}})},isSubmitting:i,mode:"create"})}const Ys=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"after"},{defaultValue:1e3,kind:"LocalArgument",name:"first"}],a=[{kind:"Variable",name:"after",variableName:"after"},{kind:"Variable",name:"first",variableName:"first"}],l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"maxCount",storageKey:null},s={alias:null,args:null,kind:"ScalarField",name:"maxDays",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"RetentionPoliciesTablePoliciesQuery",selections:[{args:a,kind:"FragmentSpread",name:"RetentionPoliciesTable_policies"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"RetentionPoliciesTablePoliciesQuery",selections:[{alias:null,args:a,concreteType:"ProjectTraceRetentionPolicyConnection",kind:"LinkedField",name:"projectTraceRetentionPolicies",plural:!1,selections:[{alias:null,args:null,concreteType:"ProjectTraceRetentionPolicyEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"ProjectTraceRetentionPolicy",kind:"LinkedField",name:"node",plural:!1,selections:[l,t,{alias:null,args:null,kind:"ScalarField",name:"cronExpression",storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"rule",plural:!1,selections:[i,{kind:"InlineFragment",selections:[r],type:"TraceRetentionRuleMaxCount",abstractKey:null},{kind:"InlineFragment",selections:[s],type:"TraceRetentionRuleMaxDays",abstractKey:null},{kind:"InlineFragment",selections:[s,r],type:"TraceRetentionRuleMaxDaysOrCount",abstractKey:null}],storageKey:null},{alias:null,args:null,concreteType:"ProjectConnection",kind:"LinkedField",name:"projects",plural:!1,selections:[{alias:null,args:null,concreteType:"ProjectEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"node",plural:!1,selections:[t,l],storageKey:null}],storageKey:null}],storageKey:null},i],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null},{kind:"ClientExtension",selections:[{alias:null,args:null,kind:"ScalarField",name:"__id",storageKey:null}]}],storageKey:null},{alias:null,args:a,filters:null,handle:"connection",key:"RetentionPoliciesTable_projectTraceRetentionPolicies",kind:"LinkedHandle",name:"projectTraceRetentionPolicies"}]},params:{cacheID:"67d653235070dbcfe47baecdadd89b38",id:null,metadata:{},name:"RetentionPoliciesTablePoliciesQuery",operationKind:"query",text:`query RetentionPoliciesTablePoliciesQuery(
  $after: String = null
  $first: Int = 1000
) {
  ...RetentionPoliciesTable_policies_2HEEH6
}

fragment RetentionPoliciesTable_policies_2HEEH6 on Query {
  projectTraceRetentionPolicies(first: $first, after: $after) {
    edges {
      node {
        ...RetentionPoliciesTable_retentionPolicy
        id
        __typename
      }
      cursor
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
}

fragment RetentionPoliciesTable_retentionPolicy on ProjectTraceRetentionPolicy {
  id
  name
  cronExpression
  rule {
    __typename
    ... on TraceRetentionRuleMaxCount {
      maxCount
    }
    ... on TraceRetentionRuleMaxDays {
      maxDays
    }
    ... on TraceRetentionRuleMaxDaysOrCount {
      maxDays
      maxCount
    }
  }
  projects {
    edges {
      node {
        name
        id
      }
    }
  }
}
`}}}();Ys.hash="21f8b6156e669019ebb7877c04f48ade";const ed=function(){var n=["projectTraceRetentionPolicies"],a={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"maxCount",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"maxDays",storageKey:null};return{argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"after"},{defaultValue:1e3,kind:"LocalArgument",name:"first"}],kind:"Fragment",metadata:{connection:[{count:"first",cursor:"after",direction:"forward",path:n}],refetch:{connection:{forward:{count:"first",cursor:"after"},backward:null,path:n},fragmentPathInResult:[],operation:Ys}},name:"RetentionPoliciesTable_policies",selections:[{alias:"projectTraceRetentionPolicies",args:null,concreteType:"ProjectTraceRetentionPolicyConnection",kind:"LinkedField",name:"__RetentionPoliciesTable_projectTraceRetentionPolicies_connection",plural:!1,selections:[{alias:null,args:null,concreteType:"ProjectTraceRetentionPolicyEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"ProjectTraceRetentionPolicy",kind:"LinkedField",name:"node",plural:!1,selections:[{kind:"InlineDataFragmentSpread",name:"RetentionPoliciesTable_retentionPolicy",selections:[a,l,{alias:null,args:null,kind:"ScalarField",name:"cronExpression",storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"rule",plural:!1,selections:[t,{kind:"InlineFragment",selections:[i],type:"TraceRetentionRuleMaxCount",abstractKey:null},{kind:"InlineFragment",selections:[r],type:"TraceRetentionRuleMaxDays",abstractKey:null},{kind:"InlineFragment",selections:[r,i],type:"TraceRetentionRuleMaxDaysOrCount",abstractKey:null}],storageKey:null},{alias:null,args:null,concreteType:"ProjectConnection",kind:"LinkedField",name:"projects",plural:!1,selections:[{alias:null,args:null,concreteType:"ProjectEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"node",plural:!1,selections:[l,a],storageKey:null}],storageKey:null}],storageKey:null}],args:null,argumentDefinitions:[]},t],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null},{kind:"ClientExtension",selections:[{alias:null,args:null,kind:"ScalarField",name:"__id",storageKey:null}]}],storageKey:null}],type:"Query",abstractKey:null}}();ed.hash="21f8b6156e669019ebb7877c04f48ade";const nd={kind:"InlineDataFragment",name:"RetentionPoliciesTable_retentionPolicy"};nd.hash="f4bc351137b27b6a15a8ebbf0cdd8447";const ad=function(){var n={defaultValue:null,kind:"LocalArgument",name:"connectionId"},a={defaultValue:null,kind:"LocalArgument",name:"policyId"},l=[{fields:[{kind:"Variable",name:"id",variableName:"policyId"}],kind:"ObjectValue",name:"input"}],t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},i=[{kind:"Literal",name:"first",value:1e3}],r={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},s={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},d={alias:null,args:null,kind:"ScalarField",name:"maxCount",storageKey:null},c={alias:null,args:null,kind:"ScalarField",name:"maxDays",storageKey:null};return{fragment:{argumentDefinitions:[n,a],kind:"Fragment",metadata:null,name:"RetentionPolicyActionMenuDeletePolicyMutation",selections:[{alias:null,args:l,concreteType:"ProjectTraceRetentionPolicyMutationPayload",kind:"LinkedField",name:"deleteProjectTraceRetentionPolicy",plural:!1,selections:[{alias:null,args:null,concreteType:"Query",kind:"LinkedField",name:"query",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"RetentionPoliciesTable_policies"}],storageKey:null},{alias:null,args:null,concreteType:"ProjectTraceRetentionPolicy",kind:"LinkedField",name:"node",plural:!1,selections:[t],storageKey:null}],storageKey:null}],type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[a,n],kind:"Operation",name:"RetentionPolicyActionMenuDeletePolicyMutation",selections:[{alias:null,args:l,concreteType:"ProjectTraceRetentionPolicyMutationPayload",kind:"LinkedField",name:"deleteProjectTraceRetentionPolicy",plural:!1,selections:[{alias:null,args:null,concreteType:"Query",kind:"LinkedField",name:"query",plural:!1,selections:[{alias:null,args:i,concreteType:"ProjectTraceRetentionPolicyConnection",kind:"LinkedField",name:"projectTraceRetentionPolicies",plural:!1,selections:[{alias:null,args:null,concreteType:"ProjectTraceRetentionPolicyEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"ProjectTraceRetentionPolicy",kind:"LinkedField",name:"node",plural:!1,selections:[t,r,{alias:null,args:null,kind:"ScalarField",name:"cronExpression",storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"rule",plural:!1,selections:[s,{kind:"InlineFragment",selections:[d],type:"TraceRetentionRuleMaxCount",abstractKey:null},{kind:"InlineFragment",selections:[c],type:"TraceRetentionRuleMaxDays",abstractKey:null},{kind:"InlineFragment",selections:[c,d],type:"TraceRetentionRuleMaxDaysOrCount",abstractKey:null}],storageKey:null},{alias:null,args:null,concreteType:"ProjectConnection",kind:"LinkedField",name:"projects",plural:!1,selections:[{alias:null,args:null,concreteType:"ProjectEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"node",plural:!1,selections:[r,t],storageKey:null}],storageKey:null}],storageKey:null},s],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null},{kind:"ClientExtension",selections:[{alias:null,args:null,kind:"ScalarField",name:"__id",storageKey:null}]}],storageKey:"projectTraceRetentionPolicies(first:1000)"},{alias:null,args:i,filters:null,handle:"connection",key:"RetentionPoliciesTable_projectTraceRetentionPolicies",kind:"LinkedHandle",name:"projectTraceRetentionPolicies"}],storageKey:null},{alias:null,args:null,concreteType:"ProjectTraceRetentionPolicy",kind:"LinkedField",name:"node",plural:!1,selections:[t,{alias:null,args:null,filters:null,handle:"deleteEdge",key:"",kind:"ScalarHandle",name:"id",handleArgs:[{items:[{kind:"Variable",name:"connections.0",variableName:"connectionId"}],kind:"ListValue",name:"connections"}]}],storageKey:null}],storageKey:null}]},params:{cacheID:"25d6433327bd55427c59288866e3f402",id:null,metadata:{},name:"RetentionPolicyActionMenuDeletePolicyMutation",operationKind:"mutation",text:`mutation RetentionPolicyActionMenuDeletePolicyMutation(
  $policyId: ID!
) {
  deleteProjectTraceRetentionPolicy(input: {id: $policyId}) {
    query {
      ...RetentionPoliciesTable_policies
    }
    node {
      id
    }
  }
}

fragment RetentionPoliciesTable_policies on Query {
  projectTraceRetentionPolicies(first: 1000) {
    edges {
      node {
        ...RetentionPoliciesTable_retentionPolicy
        id
        __typename
      }
      cursor
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
}

fragment RetentionPoliciesTable_retentionPolicy on ProjectTraceRetentionPolicy {
  id
  name
  cronExpression
  rule {
    __typename
    ... on TraceRetentionRuleMaxCount {
      maxCount
    }
    ... on TraceRetentionRuleMaxDays {
      maxDays
    }
    ... on TraceRetentionRuleMaxDaysOrCount {
      maxDays
      maxCount
    }
  }
  projects {
    edges {
      node {
        name
        id
      }
    }
  }
}
`}}}();ad.hash="8bcb6bc7271304d7bf45d4a661cee1ff";const ld=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{kind:"Variable",name:"input",variableName:"input"}],l=[{kind:"Literal",name:"first",value:1e3}],t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},s={alias:null,args:null,kind:"ScalarField",name:"maxCount",storageKey:null},d={alias:null,args:null,kind:"ScalarField",name:"maxDays",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"EditRetentionPolicyMutation",selections:[{alias:null,args:a,concreteType:"ProjectTraceRetentionPolicyMutationPayload",kind:"LinkedField",name:"patchProjectTraceRetentionPolicy",plural:!1,selections:[{alias:null,args:null,concreteType:"Query",kind:"LinkedField",name:"query",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"RetentionPoliciesTable_policies"}],storageKey:null}],storageKey:null}],type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"EditRetentionPolicyMutation",selections:[{alias:null,args:a,concreteType:"ProjectTraceRetentionPolicyMutationPayload",kind:"LinkedField",name:"patchProjectTraceRetentionPolicy",plural:!1,selections:[{alias:null,args:null,concreteType:"Query",kind:"LinkedField",name:"query",plural:!1,selections:[{alias:null,args:l,concreteType:"ProjectTraceRetentionPolicyConnection",kind:"LinkedField",name:"projectTraceRetentionPolicies",plural:!1,selections:[{alias:null,args:null,concreteType:"ProjectTraceRetentionPolicyEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"ProjectTraceRetentionPolicy",kind:"LinkedField",name:"node",plural:!1,selections:[t,i,{alias:null,args:null,kind:"ScalarField",name:"cronExpression",storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"rule",plural:!1,selections:[r,{kind:"InlineFragment",selections:[s],type:"TraceRetentionRuleMaxCount",abstractKey:null},{kind:"InlineFragment",selections:[d],type:"TraceRetentionRuleMaxDays",abstractKey:null},{kind:"InlineFragment",selections:[d,s],type:"TraceRetentionRuleMaxDaysOrCount",abstractKey:null}],storageKey:null},{alias:null,args:null,concreteType:"ProjectConnection",kind:"LinkedField",name:"projects",plural:!1,selections:[{alias:null,args:null,concreteType:"ProjectEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"node",plural:!1,selections:[i,t],storageKey:null}],storageKey:null}],storageKey:null},r],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null},{kind:"ClientExtension",selections:[{alias:null,args:null,kind:"ScalarField",name:"__id",storageKey:null}]}],storageKey:"projectTraceRetentionPolicies(first:1000)"},{alias:null,args:l,filters:null,handle:"connection",key:"RetentionPoliciesTable_projectTraceRetentionPolicies",kind:"LinkedHandle",name:"projectTraceRetentionPolicies"}],storageKey:null}],storageKey:null}]},params:{cacheID:"33fe12216c505479e31745383b2089cb",id:null,metadata:{},name:"EditRetentionPolicyMutation",operationKind:"mutation",text:`mutation EditRetentionPolicyMutation(
  $input: PatchProjectTraceRetentionPolicyInput!
) {
  patchProjectTraceRetentionPolicy(input: $input) {
    query {
      ...RetentionPoliciesTable_policies
    }
  }
}

fragment RetentionPoliciesTable_policies on Query {
  projectTraceRetentionPolicies(first: 1000) {
    edges {
      node {
        ...RetentionPoliciesTable_retentionPolicy
        id
        __typename
      }
      cursor
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
}

fragment RetentionPoliciesTable_retentionPolicy on ProjectTraceRetentionPolicy {
  id
  name
  cronExpression
  rule {
    __typename
    ... on TraceRetentionRuleMaxCount {
      maxCount
    }
    ... on TraceRetentionRuleMaxDays {
      maxDays
    }
    ... on TraceRetentionRuleMaxDaysOrCount {
      maxDays
      maxCount
    }
  }
  projects {
    edges {
      node {
        name
        id
      }
    }
  }
}
`}}}();ld.hash="9abcdadabb062864df4609df1e0448fd";const td=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}],l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"cronExpression",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"maxCount",storageKey:null},s={kind:"InlineFragment",selections:[r],type:"TraceRetentionRuleMaxCount",abstractKey:null},d={alias:null,args:null,kind:"ScalarField",name:"maxDays",storageKey:null},c={kind:"InlineFragment",selections:[d],type:"TraceRetentionRuleMaxDays",abstractKey:null},g={kind:"InlineFragment",selections:[d,r],type:"TraceRetentionRuleMaxDaysOrCount",abstractKey:null},f={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"EditRetentionPolicyQuery",selections:[{alias:"retentionPolicy",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{kind:"InlineFragment",selections:[l,t,i,{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"rule",plural:!1,selections:[s,c,g],storageKey:null}],type:"ProjectTraceRetentionPolicy",abstractKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"EditRetentionPolicyQuery",selections:[{alias:"retentionPolicy",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[f,l,{kind:"InlineFragment",selections:[t,i,{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"rule",plural:!1,selections:[f,s,c,g],storageKey:null}],type:"ProjectTraceRetentionPolicy",abstractKey:null}],storageKey:null}]},params:{cacheID:"3fe25e8ebefb19f49627fe187ba0eb5d",id:null,metadata:{},name:"EditRetentionPolicyQuery",operationKind:"query",text:`query EditRetentionPolicyQuery(
  $id: ID!
) {
  retentionPolicy: node(id: $id) {
    __typename
    ... on ProjectTraceRetentionPolicy {
      id
      name
      cronExpression
      rule {
        __typename
        ... on TraceRetentionRuleMaxCount {
          maxCount
        }
        ... on TraceRetentionRuleMaxDays {
          maxDays
        }
        ... on TraceRetentionRuleMaxDaysOrCount {
          maxDays
          maxCount
        }
      }
    }
    id
  }
}
`}}}();td.hash="3bf941d551e8fb7a6940d8774075be73";function Q0(n){var d,c;const a=me(),l=be(),t=T.useLazyLoadQuery(td,{id:n.policyId});if(!(t!=null&&t.retentionPolicy))throw new Error("Retention policy not found");const[i,r]=T.useMutation(ld);return e(Zs,{onSubmit:g=>{let f;if(g.numberOfDays&&g.numberOfTraces)f={maxDaysOrCount:{maxDays:g.numberOfDays,maxCount:g.numberOfTraces}};else if(g.numberOfDays)f={maxDays:{maxDays:g.numberOfDays}};else if(g.numberOfTraces)f={maxCount:{maxCount:g.numberOfTraces}};else throw new Error("Invalid retention policy rule");i({variables:{input:{id:n.policyId,cronExpression:g.schedule,rule:f,name:g.name}},onCompleted:()=>{a({title:"Retention policy updated successfully",message:"The retention policy has been updated successfully."}),n.onEditCompleted()},onError:()=>{l({title:"Error updating retention policy",message:"Please try again."})}})},isSubmitting:r,mode:"edit",defaultValues:{name:t.retentionPolicy.name??"New Policy",schedule:t.retentionPolicy.cronExpression??"0 0 * * 0",numberOfDays:(d=t.retentionPolicy.rule)==null?void 0:d.maxDays,numberOfTraces:(c=t.retentionPolicy.rule)==null?void 0:c.maxCount},onCancel:n.onCancel})}const B0="Default",q0=({policyId:n,policyName:a,projectNames:l,onPolicyEdit:t,onPolicyDelete:i,connectionId:r})=>{const s=a!==B0,[d,c]=m.useState(null),g=m.useCallback(()=>{c(e(oe,{size:"M",title:"Edit Retention Policy",children:e(m.Suspense,{fallback:e(ge,{}),children:e(Q0,{policyId:n,onEditCompleted:()=>{t(),c(null)},onCancel:()=>{c(null)}})})}))},[t,n]),[f,u]=T.useMutation(ad),p=m.useCallback(()=>{c(o(oe,{size:"S",title:"Delete Retention Policy",children:[o(v,{padding:"size-200",children:[e(F,{color:"danger",children:`Are you sure you want to delete retention policy "${a}"? This cannot be undone.`}),e("br",{}),l.length>0&&e(F,{color:"danger",children:`This policy is associated with the following projects: ${l.join(", ")}. These projects will fall back to the default policy.`})]}),e(v,{paddingEnd:"size-200",paddingTop:"size-100",paddingBottom:"size-100",borderTopColor:"light",borderTopWidth:"thin",children:e(b,{direction:"row",justifyContent:"end",children:e(M,{variant:"danger",size:"S",onPress:()=>{f({variables:{policyId:n,connectionId:r}}),c(null),i()},isDisabled:u,leadingVisual:u?e(I,{svg:e(sn,{})}):void 0,children:u?"Deleting...":"Delete Policy"})})})]}))},[n,a,l,f,i,u,r]);return o(El,{children:[o(ra,{buttonSize:"compact",disabledKeys:s?[]:["deletePolicy"],align:"end",onAction:y=>{switch(y){case"editPolicy":return g();case"deletePolicy":return p()}},children:[e(xe,{textValue:"Edit Policy",children:o(b,{direction:"row",gap:"size-75",justifyContent:"start",alignItems:"center",children:[e(I,{svg:e(ja,{})}),e(F,{children:"Edit"})]})},"editPolicy"),e(xe,{textValue:"Delete Policy",children:o(b,{direction:"row",gap:"size-75",justifyContent:"start",alignItems:"center",children:[e(I,{svg:e(Je,{})}),e(F,{children:"Delete"})]})},"deletePolicy")]}),e(ue,{type:"modal",isDismissable:!0,onDismiss:()=>c(null),children:d})]})},U0=nd,H0=({query:n})=>{const a=me(),l=Fo(),{data:t}=T.usePaginationFragment(ed,n),i=t.projectTraceRetentionPolicies.__id,r=t.projectTraceRetentionPolicies.edges.map(g=>{const f=g.node;return T.readInlineData(U0,f)}),s=m.useMemo(()=>{const g=[{header:"Name",accessorKey:"name"},{header:"Schedule",accessorKey:"cronExpression",cell:({row:f})=>Qi({schedule:f.original.cronExpression})},{header:"Rule",accessorKey:"rule",cell:({row:f})=>{const u=f.original.rule;if(u.__typename==="TraceRetentionRuleMaxCount")return`${u.maxCount} traces`;if(u.__typename==="TraceRetentionRuleMaxDays")return u.maxDays===0?"Infinite":`${u.maxDays} days`;if(u.__typename==="TraceRetentionRuleMaxDaysOrCount")return`${u.maxDays} days or ${u.maxCount} traces`;if(u.__typename==="%other")return"Unknown";Te()}},{header:"Projects",accessorKey:"projects",cell:({row:f})=>e("ul",{css:K`
                li {
                  display: inline;
                }
                li:not(:first-child):before {
                  content: ", ";
                }
              `,children:f.original.projects.edges.map(u=>e("li",{children:e(we,{to:`/projects/${u.node.id}/config`,children:u.node.name})},u.node.id))})}];return l&&g.push({id:"actions",cell:({row:f})=>e(q0,{policyId:f.original.id,policyName:f.original.name,connectionId:i,projectNames:f.original.projects.edges.map(u=>u.node.name),onPolicyEdit:()=>{a({title:"Policy Updated",message:`Policy "${f.original.name}" was updated and will take effect shortly.`})},onPolicyDelete:()=>{a({title:"Policy deleted",message:`Policy "${f.original.name}" was deleted`})}})}),g},[l,a,i]),d=Ce({columns:s,data:r,getCoreRowModel:Ke(),getSortedRowModel:ln()}),c=d.getRowModel().rows;return o("table",{css:We,children:[e("thead",{children:d.getHeaderGroups().map(g=>e("tr",{children:g.headers.map(f=>e("th",{colSpan:f.colSpan,children:f.isPlaceholder?null:e("div",{children:W(f.column.columnDef.header,f.getContext())})},f.id))},g.id))}),e("tbody",{children:c.map(g=>e("tr",{children:g.getVisibleCells().map(f=>e("td",{children:W(f.column.columnDef.cell,f.getContext())},f.id))},g.id))})]})};function ST(){const n=Me();Oe(n);const a=n.__id;return e(q,{title:"Retention Policies",bodyStyle:{padding:0},variant:"compact",extra:e(Co,{children:o(Ne,{children:[e(M,{size:"S",leadingVisual:e(I,{svg:e(ka,{})}),children:"New Policy"}),e(on,{children:e(Ge,{children:e(He,{children:({close:l})=>o(ea,{children:[o(na,{children:[e(aa,{children:"New Retention Policy"}),e(Oa,{children:e(Qa,{slot:"close"})})]}),e(O0,{queryId:a,onCreate:()=>{l()}})]})})})})]})}),children:e(H0,{query:n})})}const id=function(){var n={defaultValue:null,kind:"LocalArgument",name:"description"},a={defaultValue:null,kind:"LocalArgument",name:"expiresAt"},l={defaultValue:null,kind:"LocalArgument",name:"name"},t=[{fields:[{kind:"Variable",name:"description",variableName:"description"},{kind:"Variable",name:"expiresAt",variableName:"expiresAt"},{kind:"Variable",name:"name",variableName:"name"}],kind:"ObjectValue",name:"input"}],i={alias:null,args:null,kind:"ScalarField",name:"jwt",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},s={alias:null,args:null,concreteType:"SystemApiKey",kind:"LinkedField",name:"apiKey",plural:!1,selections:[r],storageKey:null};return{fragment:{argumentDefinitions:[n,a,l],kind:"Fragment",metadata:null,name:"APIKeysCardCreateSystemAPIKeyMutation",selections:[{alias:null,args:t,concreteType:"CreateSystemApiKeyMutationPayload",kind:"LinkedField",name:"createSystemApiKey",plural:!1,selections:[i,{alias:null,args:null,concreteType:"Query",kind:"LinkedField",name:"query",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"SystemAPIKeysTableFragment"}],storageKey:null},s],storageKey:null}],type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[l,n,a],kind:"Operation",name:"APIKeysCardCreateSystemAPIKeyMutation",selections:[{alias:null,args:t,concreteType:"CreateSystemApiKeyMutationPayload",kind:"LinkedField",name:"createSystemApiKey",plural:!1,selections:[i,{alias:null,args:null,concreteType:"Query",kind:"LinkedField",name:"query",plural:!1,selections:[{alias:null,args:null,concreteType:"SystemApiKey",kind:"LinkedField",name:"systemApiKeys",plural:!0,selections:[r,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"expiresAt",storageKey:null}],storageKey:null}],storageKey:null},s],storageKey:null}]},params:{cacheID:"799e8f0a627c6ae06e2a87c051d299d0",id:null,metadata:{},name:"APIKeysCardCreateSystemAPIKeyMutation",operationKind:"mutation",text:`mutation APIKeysCardCreateSystemAPIKeyMutation(
  $name: String!
  $description: String = null
  $expiresAt: DateTime = null
) {
  createSystemApiKey(input: {name: $name, description: $description, expiresAt: $expiresAt}) {
    jwt
    query {
      ...SystemAPIKeysTableFragment
    }
    apiKey {
      id
    }
  }
}

fragment SystemAPIKeysTableFragment on Query {
  systemApiKeys {
    id
    name
    description
    createdAt
    expiresAt
  }
}
`}}}();id.hash="a6f84fa9e14f363d2e7317d3d6507590";const rd=function(){var n={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},a={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"expiresAt",storageKey:null};return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"APIKeysCardQuery",selections:[{args:null,kind:"FragmentSpread",name:"SystemAPIKeysTableFragment"},{args:null,kind:"FragmentSpread",name:"UserAPIKeysTableFragment"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"APIKeysCardQuery",selections:[{alias:null,args:null,concreteType:"SystemApiKey",kind:"LinkedField",name:"systemApiKeys",plural:!0,selections:[n,a,l,t,i],storageKey:null},{alias:null,args:null,concreteType:"UserApiKey",kind:"LinkedField",name:"userApiKeys",plural:!0,selections:[n,a,l,t,i,{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"user",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"email",storageKey:null},n],storageKey:null}],storageKey:null}]},params:{cacheID:"002d6c72a80b294266c909bd743a881c",id:null,metadata:{},name:"APIKeysCardQuery",operationKind:"query",text:`query APIKeysCardQuery {
  ...SystemAPIKeysTableFragment
  ...UserAPIKeysTableFragment
}

fragment SystemAPIKeysTableFragment on Query {
  systemApiKeys {
    id
    name
    description
    createdAt
    expiresAt
  }
}

fragment UserAPIKeysTableFragment on Query {
  userApiKeys {
    id
    name
    description
    createdAt
    expiresAt
    user {
      email
      id
    }
  }
}
`}}}();rd.hash="ad967afd45af0d5976982c70eaadb330";const od=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"DeleteApiKeyMutationPayload",kind:"LinkedField",name:"deleteSystemApiKey",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"apiKeyId",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"SystemAPIKeysTableDeleteAPIKeyMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"SystemAPIKeysTableDeleteAPIKeyMutation",selections:a},params:{cacheID:"a8c45c42b5becca8efa65334285a2f97",id:null,metadata:{},name:"SystemAPIKeysTableDeleteAPIKeyMutation",operationKind:"mutation",text:`mutation SystemAPIKeysTableDeleteAPIKeyMutation(
  $input: DeleteApiKeyInput!
) {
  deleteSystemApiKey(input: $input) {
    __typename
    apiKeyId
  }
}
`}}}();od.hash="55ab8200b5bfda0aa73594ad5cfce96f";const sd={fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"SystemAPIKeysTableQuery",selections:[{args:null,kind:"FragmentSpread",name:"SystemAPIKeysTableFragment"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"SystemAPIKeysTableQuery",selections:[{alias:null,args:null,concreteType:"SystemApiKey",kind:"LinkedField",name:"systemApiKeys",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"expiresAt",storageKey:null}],storageKey:null}]},params:{cacheID:"94e06b8cd5879701a5d73bee083ad614",id:null,metadata:{},name:"SystemAPIKeysTableQuery",operationKind:"query",text:`query SystemAPIKeysTableQuery {
  ...SystemAPIKeysTableFragment
}

fragment SystemAPIKeysTableFragment on Query {
  systemApiKeys {
    id
    name
    description
    createdAt
    expiresAt
  }
}
`}};sd.hash="de0fc04de739f0adfcbdeaff28b16265";const dd={argumentDefinitions:[],kind:"Fragment",metadata:{refetch:{connection:null,fragmentPathInResult:[],operation:sd}},name:"SystemAPIKeysTableFragment",selections:[{alias:null,args:null,concreteType:"SystemApiKey",kind:"LinkedField",name:"systemApiKeys",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"expiresAt",storageKey:null}],storageKey:null}],type:"Query",abstractKey:null};dd.hash="de0fc04de739f0adfcbdeaff28b16265";function G0({query:n}){const[a,l]=T.useRefetchableFragment(dd,n),t=be(),i=me(),[r]=T.useMutation(od),s=m.useCallback(p=>{r({variables:{input:{id:p}},onCompleted:()=>{i({title:"System key deleted",message:"The system key has been deleted and is no longer active."}),m.startTransition(()=>{l({},{fetchPolicy:"network-only"})})},onError:y=>{const h=De(y);t({title:"Error deleting system key",message:(h==null?void 0:h[0])??y.message})}})},[r,t,i,l]),d=m.useMemo(()=>[...a.systemApiKeys],[a]),c=m.useMemo(()=>[{header:"Name",accessorKey:"name"},{header:"Description",accessorKey:"description",cell:Re},{header:"Created At",accessorKey:"createdAt",cell:_e},{header:"Expires At",accessorKey:"expiresAt",cell:_e},{header:"",accessorKey:"id",size:10,cell:({row:y})=>e(b,{direction:"row",justifyContent:"end",width:"100%",children:e(vi,{handleDelete:()=>{s(y.original.id)}})}),meta:{textAlign:"right"}}],[s]),g=Ce({columns:c,data:d,getCoreRowModel:Ke()}),f=g.getRowModel().rows,u=g.getRowModel().rows.length===0;return o("table",{css:We,children:[e("thead",{children:g.getHeaderGroups().map(p=>e("tr",{children:p.headers.map(y=>e("th",{colSpan:y.colSpan,children:y.isPlaceholder?null:o("div",{className:y.column.getCanSort()?"sort":"",onClick:y.column.getToggleSortingHandler(),style:{left:y.getStart(),width:y.getSize()},children:[W(y.column.columnDef.header,y.getContext()),y.column.getIsSorted()?e(I,{className:"sort-icon",svg:y.column.getIsSorted()==="asc"?e(Xe,{}):e(Ze,{})}):null]})},y.id))},p.id))}),u?e(yn,{message:"No Keys"}):e("tbody",{children:f.map(p=>e("tr",{children:p.getVisibleCells().map(y=>e("td",{children:W(y.column.columnDef.cell,y.getContext())},y.id))},p.id))})]})}const cd=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"DeleteApiKeyMutationPayload",kind:"LinkedField",name:"deleteUserApiKey",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"apiKeyId",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"UserAPIKeysTableDeleteAPIKeyMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"UserAPIKeysTableDeleteAPIKeyMutation",selections:a},params:{cacheID:"d137498515ff43864f5525b3c1847376",id:null,metadata:{},name:"UserAPIKeysTableDeleteAPIKeyMutation",operationKind:"mutation",text:`mutation UserAPIKeysTableDeleteAPIKeyMutation(
  $input: DeleteApiKeyInput!
) {
  deleteUserApiKey(input: $input) {
    __typename
    apiKeyId
  }
}
`}}}();cd.hash="9b1d898d1d9858016bed85000ce3906e";const ud=function(){var n={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"UserAPIKeysTableQuery",selections:[{args:null,kind:"FragmentSpread",name:"UserAPIKeysTableFragment"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"UserAPIKeysTableQuery",selections:[{alias:null,args:null,concreteType:"UserApiKey",kind:"LinkedField",name:"userApiKeys",plural:!0,selections:[n,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"expiresAt",storageKey:null},{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"user",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"email",storageKey:null},n],storageKey:null}],storageKey:null}]},params:{cacheID:"a91e7a740880f47e1bcd063ede287ed6",id:null,metadata:{},name:"UserAPIKeysTableQuery",operationKind:"query",text:`query UserAPIKeysTableQuery {
  ...UserAPIKeysTableFragment
}

fragment UserAPIKeysTableFragment on Query {
  userApiKeys {
    id
    name
    description
    createdAt
    expiresAt
    user {
      email
      id
    }
  }
}
`}}}();ud.hash="c2b3a579bcb0ba915523ecb35cae3b44";const md={argumentDefinitions:[],kind:"Fragment",metadata:{refetch:{connection:null,fragmentPathInResult:[],operation:ud}},name:"UserAPIKeysTableFragment",selections:[{alias:null,args:null,concreteType:"UserApiKey",kind:"LinkedField",name:"userApiKeys",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"expiresAt",storageKey:null},{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"user",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"email",storageKey:null}],storageKey:null}],storageKey:null}],type:"Query",abstractKey:null};md.hash="c2b3a579bcb0ba915523ecb35cae3b44";const Ar=70;function W0({query:n}){const[a,l]=T.useRefetchableFragment(md,n),t=be(),i=me(),[r]=T.useMutation(cd),s=m.useCallback(p=>{r({variables:{input:{id:p}},onCompleted:()=>{i({title:"User key deleted",message:"The user key has been deleted and is no longer active."}),m.startTransition(()=>{l({},{fetchPolicy:"network-only"})})},onError:y=>{const h=De(y);t({title:"Error deleting user key",message:(h==null?void 0:h[0])??y.message})}})},[r,t,i,l]),d=m.useMemo(()=>[...a.userApiKeys],[a]),c=m.useMemo(()=>[{header:"Name",accessorKey:"name",size:100,cell:Re},{header:"Description",accessorKey:"description",cell:Re},{header:"Created At",accessorKey:"createdAt",size:Ar,cell:_e},{header:"Expires At",accessorKey:"expiresAt",size:Ar,cell:_e},{header:"User",size:120,accessorKey:"user.email",cell:Re},{header:"",accessorKey:"id",size:10,cell:({row:y})=>e(b,{direction:"row",justifyContent:"end",width:"100%",children:e(vi,{handleDelete:()=>{s(y.original.id)}})}),meta:{textAlign:"right"}}],[s]),g=Ce({columns:c,data:d,getCoreRowModel:Ke()}),f=g.getRowModel().rows,u=g.getRowModel().rows.length===0;return o("table",{css:We,children:[e("thead",{children:g.getHeaderGroups().map(p=>e("tr",{children:p.headers.map(y=>e("th",{colSpan:y.colSpan,children:y.isPlaceholder?null:o("div",{className:y.column.getCanSort()?"sort":"",onClick:y.column.getToggleSortingHandler(),style:{left:y.getStart(),width:y.getSize()},children:[W(y.column.columnDef.header,y.getContext()),y.column.getIsSorted()?e(I,{className:"sort-icon",svg:y.column.getIsSorted()==="asc"?e(Xe,{}):e(Ze,{})}):null]})},y.id))},p.id))}),u?e(yn,{message:"No Keys"}):e("tbody",{children:f.map(p=>e("tr",{children:p.getVisibleCells().map(y=>e("td",{children:W(y.column.columnDef.cell,y.getContext())},y.id))},p.id))})]})}function J0(){const n=T.useLazyLoadQuery(rd,{},{fetchPolicy:"network-only"});return o(cn,{children:[o(dn,{children:[e(le,{id:"system",children:"System Keys"}),e(le,{id:"user",children:"User Keys"})]}),e(re,{id:"system",children:e(G0,{query:n})}),e(re,{id:"user",children:e(W0,{query:n})})]})}function X0(){const[n,a]=m.useState(null),l=be(),t=c=>{a(e(Ko,{jwt:c}))},[i,r]=T.useMutation(id),s=m.useCallback(c=>{var g;i({variables:{...c,expiresAt:((g=c.expiresAt)==null?void 0:g.toDate(pi()).toISOString())||null},onCompleted:f=>{t(f.createSystemApiKey.jwt)},onError:f=>{l({title:"Error creating system key",message:f.message})}})},[i,l]);return o("div",{children:[e(yi,{title:"API Keys",variant:"compact",extra:e(M,{size:"S",leadingVisual:e(I,{svg:e(Bn,{})}),onPress:()=>{a(e(To,{onSubmit:s,isCommitting:r,defaultName:"System"}))},children:"System Key"}),children:e(m.Suspense,{fallback:e(v,{padding:"size-100",children:e(ge,{})}),children:e(J0,{})})}),e(ue,{onDismiss:()=>{a(null)},children:n})]})}const gd={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"DBUsagePieChart_data",selections:[{alias:null,args:null,concreteType:"DbTableStats",kind:"LinkedField",name:"dbTableStats",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"tableName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"numBytes",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"dbStorageCapacityBytes",storageKey:null}],type:"Query",abstractKey:null};gd.hash="922bf6de312a4be0c38025ffbb868d6d";function pd(n,a){const{si:l=!1,decimalPlaces:t=1}={},i=l?1e3:1024;if(Math.abs(n)<i)return n+" B";const r=l?["kB","MB","GB","TB","PB","EB","ZB","YB"]:["KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"];let s=-1;const d=10**t;do n/=i,++s;while(Math.round(Math.abs(n)*d)/d>=i&&s<r.length-1);return n.toFixed(t)+" "+r[s]}const wr="remaining";function Z0({active:n,payload:a}){return n&&a&&a.length?e(qn,{children:e(ze,{shape:"square",color:a[0].payload.fill||"transparent",name:a[0].name||"--",value:pd(a[0].value||0)})}):null}function Y0({query:n}){const a=T.useFragment(gd,n),l=a.dbTableStats.reduce((r,s)=>r+s.numBytes,0),t=typeof a.dbStorageCapacityBytes=="number"?a.dbStorageCapacityBytes-l:null,i=m.useMemo(()=>{const r=[...a.dbTableStats];return t!==null&&r.push({tableName:wr,numBytes:t}),r},[a.dbTableStats,t]);return e(wn,{width:"100%",height:245,children:o(Ss,{children:[e(ks,{data:i,dataKey:"numBytes",nameKey:"tableName",cx:"50%",cy:"50%",innerRadius:70,outerRadius:110,strokeWidth:0,stroke:"transparent",children:i.map((r,s)=>e(bs,{stroke:"0",fill:r.tableName===wr?"var(--ac-global-color-grey-200)":`${cr[s%cr.length]}`},`cell-${s}`))}),e(Gn,{content:e(Z0,{})}),e("text",{x:"50%",y:"50%",textAnchor:"middle",fill:"var(--ac-global-text-color-900",fontSize:"var(--ac-global-font-size-xl)",children:`${typeof a.dbStorageCapacityBytes=="number"?Zl(l/a.dbStorageCapacityBytes*100):pd(l)}`}),e("text",{x:"50%",y:"50%",dy:25,textAnchor:"middle",fill:"var(--ac-global-text-color-900",fontSize:"var(--ac-global-font-size-s)",children:"Used"}),e("g",{children:e("text",{x:"100%",y:"100%",dx:-80,dy:-2,textAnchor:"right",fill:"var(--ac-global-text-color-500)",fontSize:"var(--ac-global-font-size-xs)",children:"* approximate"})})]})})}const yd=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"ProjectTraceRetentionPolicyMutationPayload",kind:"LinkedField",name:"patchProjectTraceRetentionPolicy",plural:!1,selections:[{alias:null,args:null,concreteType:"ProjectTraceRetentionPolicy",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"rule",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"maxDays",storageKey:null}],type:"TraceRetentionRuleMaxDays",abstractKey:null}],storageKey:null}],storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"GlobalRetentionPolicyCardMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"GlobalRetentionPolicyCardMutation",selections:a},params:{cacheID:"096e3d4c546229fc771e14be03b168a3",id:null,metadata:{},name:"GlobalRetentionPolicyCardMutation",operationKind:"mutation",text:`mutation GlobalRetentionPolicyCardMutation(
  $input: PatchProjectTraceRetentionPolicyInput!
) {
  patchProjectTraceRetentionPolicy(input: $input) {
    node {
      id
      rule {
        __typename
        ... on TraceRetentionRuleMaxDays {
          maxDays
        }
      }
    }
  }
}
`}}}();yd.hash="d1757c8159d448039635f1fe035803c4";const fd=function(){var n=[{alias:null,args:null,concreteType:"ProjectTraceRetentionPolicy",kind:"LinkedField",name:"defaultProjectTraceRetentionPolicy",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"cronExpression",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"rule",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"maxDays",storageKey:null}],type:"TraceRetentionRuleMaxDays",abstractKey:null}],storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"GlobalRetentionPolicyCardQuery",selections:n,type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"GlobalRetentionPolicyCardQuery",selections:n},params:{cacheID:"cc26cab6fcf5acfdf11abdb30f7f937f",id:null,metadata:{},name:"GlobalRetentionPolicyCardQuery",operationKind:"query",text:`query GlobalRetentionPolicyCardQuery {
  defaultProjectTraceRetentionPolicy {
    cronExpression
    id
    name
    rule {
      __typename
      ... on TraceRetentionRuleMaxDays {
        maxDays
      }
    }
  }
}
`}}}();fd.hash="15a513ac6f9c30b739810e2e18d6f0ab";const ek=()=>{var f,u,p;const n=me(),a=be(),l=T.useLazyLoadQuery(fd,{}),[t]=T.useMutation(yd),{control:i,handleSubmit:r,formState:{isDirty:s},reset:d}=Ve({defaultValues:{maxDays:((u=(f=l.defaultProjectTraceRetentionPolicy)==null?void 0:f.rule)==null?void 0:u.__typename)==="TraceRetentionRuleMaxDays"?l.defaultProjectTraceRetentionPolicy.rule.maxDays:0}}),c=(p=l.defaultProjectTraceRetentionPolicy)==null?void 0:p.id,g=m.useCallback(y=>{t({variables:{input:{id:c,rule:{maxDays:{maxDays:y.maxDays}}}},onCompleted:h=>{var S,C,P;const k=((P=(C=(S=h.patchProjectTraceRetentionPolicy)==null?void 0:S.node)==null?void 0:C.rule)==null?void 0:P.__typename)==="TraceRetentionRuleMaxDays"?h.patchProjectTraceRetentionPolicy.node.rule.maxDays:null;k!==null&&d({maxDays:k}),n(k===0?{title:"Default retention policy disabled",expireMs:5e3}:{title:`Default retention policy has been set to ${k} ${k===1?"day":"days"}`,expireMs:5e3})},onError:()=>{a({title:"Failed to update default retention policy",expireMs:5e3})}})},[c,a,n,t,d]);return o(q,{title:"Default Project Retention Policy",variant:"compact",bodyStyle:{padding:0},children:[e(v,{padding:"size-200",children:o(b,{direction:"row",gap:"size-200",justifyContent:"space-between",children:[e(v,{paddingTop:"size-100",children:e(F,{children:"The default retention policy for all projects that do not have their own custom retention policy. Traces that are older than the specified number of days will be deleted automatically in order to free up storage space."})}),e(v,{width:"1000px",children:e(gn,{onSubmit:r(g),children:o(b,{gap:"size-100",direction:"row",alignItems:"center",children:[e(G,{control:i,name:"maxDays",rules:{validate:y=>isNaN(y)?"Maximum trace retention is required. Set to 0 to disable.":!0,min:{value:0,message:"Maximum trace retention must be at least 0 days"},required:"Maximum trace retention is required. Set to 0 to disable."},render:({field:y,fieldState:h})=>{var k;return o(ha,{...y,minValue:0,isInvalid:!!h.error,children:[e(H,{children:"Maximum Trace Retention in Days"}),e(X,{}),h.error?e(ke,{children:(k=h.error)==null?void 0:k.message}):e(F,{slot:"description",children:"0 days is equal to no policy."})]})}}),e("div",{css:K`
                    margin-top: 3px;
                  `,children:e(M,{type:"submit",isDisabled:!s,children:"Update"})})]})})})]})}),e(v,{paddingX:"size-200",paddingY:"size-100",borderTopWidth:"thin",borderColor:"dark",children:e(b,{direction:"row",justifyContent:"end",children:e(we,{to:"/settings/data",children:"All Retention Policies"})})})]})},hd=function(){var n={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"UsersCardQuery",selections:[{args:null,kind:"FragmentSpread",name:"UsersTable_users"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"UsersCardQuery",selections:[{alias:null,args:null,concreteType:"UserConnection",kind:"LinkedField",name:"users",plural:!1,selections:[{alias:null,args:null,concreteType:"UserEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"user",args:null,concreteType:"User",kind:"LinkedField",name:"node",plural:!1,selections:[n,{alias:null,args:null,kind:"ScalarField",name:"email",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"username",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"authMethod",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"profilePictureUrl",storageKey:null},{alias:null,args:null,concreteType:"UserRole",kind:"LinkedField",name:"role",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},n],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}]},params:{cacheID:"7198a3944688637f02a72e35643511d0",id:null,metadata:{},name:"UsersCardQuery",operationKind:"query",text:`query UsersCardQuery {
  ...UsersTable_users
}

fragment UsersTable_users on Query {
  users {
    edges {
      user: node {
        id
        email
        username
        createdAt
        authMethod
        profilePictureUrl
        role {
          name
          id
        }
      }
    }
  }
}
`}}}();hd.hash="2b3e260c950dd1a6a1a6883ff6fb78c4";const kd=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"UserMutationPayload",kind:"LinkedField",name:"createUser",plural:!1,selections:[{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"user",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"email",storageKey:null}],storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"NewUserDialogMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"NewUserDialogMutation",selections:a},params:{cacheID:"a9bf3794a5355d9d0e0a3acebe7f3809",id:null,metadata:{},name:"NewUserDialogMutation",operationKind:"mutation",text:`mutation NewUserDialogMutation(
  $input: CreateUserInput!
) {
  createUser(input: $input) {
    user {
      id
      email
    }
  }
}
`}}}();kd.hash="97d1aefa41e8831e57b6bb0d1a078a7c";function nk({onNewUserCreated:n,onNewUserCreationError:a,onDismiss:l}){const[t,i]=T.useMutation(kd),r=m.useCallback(d=>{t({variables:{input:{email:d.email,username:d.username,password:d.password,role:d.role,authMethod:"LOCAL",sendWelcomeEmail:!0}},onCompleted:c=>{n(c.createUser.user.email)},onError:c=>{a(c)}})},[t,n,a]),s=m.useCallback(d=>{t({variables:{input:{email:d.email,username:d.username,role:d.role,authMethod:"OAUTH2",sendWelcomeEmail:!0}},onCompleted:c=>{n(c.createUser.user.email)},onError:c=>{a(c)}})},[t,n,a]);return e(on,{isOpen:!0,onOpenChange:d=>{d||l()},children:e(Ge,{children:e(He,{children:o(ea,{children:[o(na,{children:[e(aa,{children:"Add User"}),e(Qa,{})]}),window.Config.basicAuthDisabled?e(yy,{onSubmit:s,isSubmitting:i},"oauth-form"):e(fy,{onSubmit:r,isSubmitting:i},"user-form")]})})})})}const bd=function(){var n={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"UsersTableQuery",selections:[{args:null,kind:"FragmentSpread",name:"UsersTable_users"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"UsersTableQuery",selections:[{alias:null,args:null,concreteType:"UserConnection",kind:"LinkedField",name:"users",plural:!1,selections:[{alias:null,args:null,concreteType:"UserEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"user",args:null,concreteType:"User",kind:"LinkedField",name:"node",plural:!1,selections:[n,{alias:null,args:null,kind:"ScalarField",name:"email",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"username",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"authMethod",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"profilePictureUrl",storageKey:null},{alias:null,args:null,concreteType:"UserRole",kind:"LinkedField",name:"role",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},n],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}]},params:{cacheID:"e5a1fa2cfeca95ac9f22b2c65d3a4548",id:null,metadata:{},name:"UsersTableQuery",operationKind:"query",text:`query UsersTableQuery {
  ...UsersTable_users
}

fragment UsersTable_users on Query {
  users {
    edges {
      user: node {
        id
        email
        username
        createdAt
        authMethod
        profilePictureUrl
        role {
          name
          id
        }
      }
    }
  }
}
`}}}();bd.hash="acd5e44c43deb927fea733697593c97d";const Sd={argumentDefinitions:[],kind:"Fragment",metadata:{refetch:{connection:null,fragmentPathInResult:[],operation:bd}},name:"UsersTable_users",selections:[{alias:null,args:null,concreteType:"UserConnection",kind:"LinkedField",name:"users",plural:!1,selections:[{alias:null,args:null,concreteType:"UserEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"user",args:null,concreteType:"User",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"email",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"username",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"authMethod",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"profilePictureUrl",storageKey:null},{alias:null,args:null,concreteType:"UserRole",kind:"LinkedField",name:"role",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],type:"Query",abstractKey:null};Sd.hash="acd5e44c43deb927fea733697593c97d";const vd=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],kind:"ScalarField",name:"deleteUsers",storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"DeleteUserDialogMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"DeleteUserDialogMutation",selections:a},params:{cacheID:"00d3d0f3855e92e529bc446d0f426123",id:null,metadata:{},name:"DeleteUserDialogMutation",operationKind:"mutation",text:`mutation DeleteUserDialogMutation(
  $input: DeleteUsersInput!
) {
  deleteUsers(input: $input)
}
`}}}();vd.hash="a718ceab0ec0a7d461f6cd5e5b178a1f";function ak({userId:n,onDeleted:a,onClose:l}){const[t,i]=T.useMutation(vd),r=me(),s=be(),d=m.useCallback(()=>{t({variables:{input:{userIds:[n]}},onCompleted:()=>{r({title:"User deleted",message:"User has been deleted."}),a(),l()},onError:c=>{const g=De(c);s({title:"Failed to delete user",message:(g==null?void 0:g[0])??c.message})}})},[t,s,r,l,a,n]);return o(oe,{title:"Delete User",isDismissable:!0,onDismiss:l,children:[e(v,{padding:"size-200",children:e(F,{color:"danger",children:"Are you sure you want to delete this user? This action cannot be undone."})}),e(v,{paddingEnd:"size-200",paddingTop:"size-100",paddingBottom:"size-100",borderTopColor:"light",borderTopWidth:"thin",children:o(b,{direction:"row",justifyContent:"end",gap:"size-100",children:[e(M,{variant:"default",onPress:l,children:"Cancel"}),e(M,{variant:"danger",onPress:()=>{d()},isDisabled:i,children:"Delete user"})]})})]})}const Fd=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"UserMutationPayload",kind:"LinkedField",name:"patchUser",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ResetPasswordDialogMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ResetPasswordDialogMutation",selections:a},params:{cacheID:"6ccff8dd53d97eeb41f656bcd2758da1",id:null,metadata:{},name:"ResetPasswordDialogMutation",operationKind:"mutation",text:`mutation ResetPasswordDialogMutation(
  $input: PatchUserInput!
) {
  patchUser(input: $input) {
    __typename
  }
}
`}}}();Fd.hash="85b22da61ec094c28e97db2759622b69";const gl=4;function lk({userId:n,onClose:a}){const l=be(),t=me(),[i,r]=T.useMutation(Fd),{control:s,handleSubmit:d,formState:{isDirty:c}}=Ve({defaultValues:{newPassword:"",confirmPassword:""}}),g=m.useCallback(f=>{i({variables:{input:{userId:n,newPassword:f.newPassword}},onCompleted:()=>{t({title:"Password reset",message:"Users password has been reset."}),a()},onError:u=>{l({title:"Failed to reset password",message:u.message})}})},[i,l,t,a,n]);return e(oe,{title:"Reset Password",isDismissable:!0,onDismiss:a,children:e(gn,{children:o(v,{padding:"size-200",children:[o(b,{direction:"column",gap:"size-100",children:[e(G,{name:"newPassword",control:s,rules:{required:"Password is required",minLength:{value:gl,message:`Password must be at least ${gl} characters`}},render:({field:{name:f,onChange:u,onBlur:p,value:y},fieldState:{invalid:h,error:k}})=>o(ee,{isInvalid:h,onChange:u,name:f,onBlur:p,value:y.toString(),type:"password",id:"new-password",autoComplete:"new-password",children:[e(H,{children:"New Password"}),e(X,{placeholder:"New password"}),k!=null&&k.message?e(ke,{children:k.message}):o(F,{slot:"description",children:["Password must be at least ",gl," characters"]})]})}),e(G,{name:"confirmPassword",control:s,rules:{required:"Password is required",minLength:{value:gl,message:`Password must be at least ${gl} characters`},validate:(f,u)=>f===u.newPassword||"Passwords do not match"},render:({field:{name:f,onChange:u,onBlur:p,value:y},fieldState:{invalid:h,error:k}})=>o(ee,{isInvalid:h,onChange:u,name:f,onBlur:p,value:y.toString(),type:"password",children:[e(H,{children:"Confirm Password"}),e(X,{placeholder:"Repeat new password"}),k!=null&&k.message?e(ke,{children:k.message}):e(F,{slot:"description",children:"Repeat new password to confirm"})]})})]}),e(v,{paddingTop:"size-200",children:e(b,{direction:"row",gap:"size-100",justifyContent:"end",children:e(M,{variant:c?"primary":"default",type:"submit",isDisabled:r,onPress:()=>d(g)(),children:r?"Resetting...":"Reset Password"})})})]})})})}function tk(n){return n==="LOCAL"}function ik(n){const{userId:a,onUserDeleted:l,authMethod:t}=n,[i,r]=m.useState(null),s=m.useCallback(()=>{r(e(ak,{userId:a,onClose:()=>r(null),onDeleted:()=>{l(),r(null)}}))},[a,l]),d=m.useCallback(()=>{r(e(lk,{userId:a,onClose:()=>r(null)}))},[a]),c=m.useMemo(()=>{const g=e(xe,{children:o(b,{direction:"row",gap:"size-75",justifyContent:"start",alignItems:"center",children:[e(I,{svg:e(Je,{})}),e(J,{children:"Delete"})]})},"deleteUser"),f=e(xe,{children:o(b,{direction:"row",gap:"size-75",justifyContent:"start",alignItems:"center",children:[e(I,{svg:e(Po,{})}),e(J,{children:"Reset Password"})]})},"resetPassword"),u=[g];return tk(t)&&u.push(f),u},[t]);return o("div",{onClick:g=>{g.preventDefault(),g.stopPropagation()},children:[e(ra,{align:"end","aria-label":"User Actions",buttonSize:"compact",onAction:g=>{switch(g){case"deleteUser":s();break;case"resetPassword":d();break}},children:c}),e(ue,{type:"modal",isDismissable:!0,onDismiss:()=>r(null),children:i})]})}const Cd=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"UserMutationPayload",kind:"LinkedField",name:"patchUser",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"UserRoleChangeDialogMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"UserRoleChangeDialogMutation",selections:a},params:{cacheID:"44e970c967f83a0b7a6bd1cbafc3a936",id:null,metadata:{},name:"UserRoleChangeDialogMutation",operationKind:"mutation",text:`mutation UserRoleChangeDialogMutation(
  $input: PatchUserInput!
) {
  patchUser(input: $input) {
    __typename
  }
}
`}}}();Cd.hash="468eff05b42e39b55f9aa5b9a7d2c483";function rk({userId:n,email:a,currentRole:l,newRole:t,onRoleChanged:i,onClose:r}){const[s,d]=T.useMutation(Cd),c=me(),g=be(),f=m.useCallback(()=>{s({variables:{input:{userId:n,newRole:t}},onCompleted:()=>{c({title:"Role Changed",message:"Users role has been changed."}),i(),r()},onError:u=>{g({title:"Failed to delete user",message:u.message})}})},[s,t,g,c,r,i,n]);return o(oe,{title:"Confirm role change",children:[e(v,{padding:"size-200",children:o(F,{children:[`Are you sure you want to change the role for ${a} from `," ",e("b",{children:li(l)})," to"," ",e("b",{children:li(t)}),"?"]})}),e(v,{paddingEnd:"size-200",paddingTop:"size-100",paddingBottom:"size-100",borderTopColor:"light",borderTopWidth:"thin",children:o(b,{direction:"row",justifyContent:"end",gap:"size-100",children:[e(M,{onPress:r,size:"S",children:"Cancel"}),e(M,{variant:"primary",size:"S",onPress:()=>{f()},isDisabled:d,children:"Change role"})]})})]})}const ok=55,sk=K`
  text-decoration: none;
  color: var(--ac-global-color-grey-600);
  font-size: 12px;
  &:hover {
    text-decoration: underline;
  }
`,dk=K`
  height: ${ok}px;
`,Rr=n=>n.email==="admin@localhost"||n.username==="admin";function ck({query:n}){const[a,l]=m.useState(null),[t,i]=T.useRefetchableFragment(Sd,n),r=m.useMemo(()=>t.users.edges.map(({user:p})=>({id:p.id,email:p.email,username:p.username,profilePictureUrl:p.profilePictureUrl,createdAt:p.createdAt,role:p.role.name,authMethod:p.authMethod})),[t]),s=m.useCallback(()=>{m.startTransition(()=>{i({},{fetchPolicy:"network-only"})})},[i]),{viewer:d}=Fi(),c=m.useMemo(()=>[{header:"user",accessorKey:"username",cell:({row:p})=>o(b,{direction:"row",gap:"size-50",alignItems:"center",children:[e(ut,{name:p.original.username,profilePictureUrl:p.original.profilePictureUrl,size:20}),e("span",{children:p.original.username}),e("a",{href:`mailto:${p.original.email}`,css:sk,children:p.original.email})]})},{header:"method",accessorKey:"authMethod",size:10,cell:({row:p})=>p.original.authMethod.toLowerCase()},{header:"role",accessorKey:"role",cell:({row:p})=>Rr(p.original)||d&&d.email==p.original.email?li(p.original.role):e(ky,{includeLabel:!1,size:"S",onChange:y=>{y!==p.original.role&&l(e(rk,{onClose:()=>l(null),onRoleChanged:s,currentRole:p.original.role,newRole:y,email:p.original.email,userId:p.original.id}))},role:hy(p.original.role)?p.original.role:void 0})},{header:"created at",accessorKey:"createdAt",cell:_e},{header:"",accessorKey:"id",size:10,cell:({row:p})=>Rr(p.original)?null:e(b,{direction:"row",justifyContent:"end",width:"100%",children:e(ik,{userId:p.original.id,onUserDeleted:s,authMethod:p.original.authMethod})}),meta:{textAlign:"right"}}],[s,d]),g=Ce({columns:c,data:r,getCoreRowModel:Ke(),getSortedRowModel:ln()}),f=g.getRowModel().rows,u=g.getRowModel().rows.length===0;return o("table",{css:We,children:[e("thead",{children:g.getHeaderGroups().map(p=>e("tr",{children:p.headers.map(y=>e("th",{colSpan:y.colSpan,children:y.isPlaceholder?null:o("div",{className:y.column.getCanSort()?"sort":"",onClick:y.column.getToggleSortingHandler(),style:{left:y.getStart(),width:y.getSize()},children:[W(y.column.columnDef.header,y.getContext()),y.column.getIsSorted()?e(I,{className:"sort-icon",svg:y.column.getIsSorted()==="asc"?e(Xe,{}):e(Ze,{})}):null]})},y.id))},p.id))}),u?e(yn,{}):e("tbody",{children:f.map(p=>e("tr",{css:dk,children:p.getVisibleCells().map(y=>e("td",{children:W(y.column.columnDef.cell,y.getContext())},y.id))},p.id))}),e(ue,{onDismiss:()=>l(null),isDismissable:!0,type:"modal",children:a})]})}function uk(){const[n,a]=m.useState(0),[l,t]=m.useState(null),i=me(),r=be(),s=T.useLazyLoadQuery(hd,{},{fetchKey:n,fetchPolicy:"store-and-network"});return o(q,{title:"Users",variant:"compact",bodyStyle:{padding:0,overflowX:"auto"},extra:e(M,{onPress:()=>{t(e(nk,{onDismiss:()=>{t(null)},onNewUserCreated:d=>{t(null),i({title:"User added",message:`User ${d} has been added.`}),a(c=>c+1)},onNewUserCreationError:d=>{const c=De(d);r({title:"Error adding user",message:(c==null?void 0:c[0])??d.message})}}))},size:"S",leadingVisual:e(I,{svg:e(Bn,{})}),children:"Add User"}),children:[e(m.Suspense,{fallback:e(v,{padding:"size-200",children:e(ge,{})}),children:e(ck,{query:s})}),e(ue,{onDismiss:()=>{t(null)},children:l})]})}const mk=K`
  .ac-field {
    // Hacky solution to make the text fields fill the remaining space
    width: calc(100% - var(--ac-global-dimension-size-600));
  }
`;function vT(){const n=Me();return Oe(n),o(b,{direction:"column",gap:"size-200",width:"100%",children:[o(b,{direction:"row",gap:"size-200",alignItems:"baseline",children:[e(v,{flex:"2",children:e(q,{title:"Platform Settings",variant:"compact",children:o("form",{css:mk,children:[o(b,{direction:"row",gap:"size-100",alignItems:"end",children:[o(ee,{value:ti,isReadOnly:!0,children:[e(H,{children:"Hostname"}),e(X,{}),e(F,{slot:"description",children:"Connect to Phoenix over HTTP"})]}),e(Er,{text:ti})]}),o(b,{direction:"row",gap:"size-100",alignItems:"end",children:[o(ee,{value:Ol,isReadOnly:!0,children:[e(H,{children:"Platform Version"}),e(X,{}),e(F,{slot:"description",children:"The version of the Phoenix server"})]}),e(Er,{text:Ol})]}),o(b,{direction:"row",gap:"size-100",alignItems:"start",children:[o(ee,{value:`pip install 'arize-phoenix==${Ol}'`,isReadOnly:!0,children:[e(H,{children:"Python Version"}),e(X,{}),e(F,{slot:"description",children:"The version of the Python client library to use to connect to this Phoenix"})]}),e(v,{flex:"none",paddingTop:"size-300",children:e(de,{size:"M",text:Ol})})]})]})})}),e(v,{flex:"1",minWidth:280,children:e(q,{title:"Database Usage",variant:"compact",children:e(Y0,{query:n})})})]}),o(xo,{children:[e(X0,{}),e(uk,{})]}),e(Co,{children:e(ek,{})})]})}function Er(n){return e(v,{paddingBottom:"20px",flex:"none",children:e(de,{text:n.text,size:"M"})})}const gk=[{name:"Page A",uv:4e3,pv:2400,amt:2400},{name:"Page B",uv:3e3,pv:1398,amt:2210},{name:"Page C",uv:2e3,pv:9800,amt:2290},{name:"Page D",uv:2780,pv:3908,amt:2e3},{name:"Page E",uv:1890,pv:4800,amt:2181},{name:"Page F",uv:2390,pv:3800,amt:2500},{name:"Page G",uv:3490,pv:4300,amt:2100}],Mr="#8884d8";function Fl(){return e(wn,{children:o(Lt,{data:gk,margin:{top:25,right:18,left:18,bottom:50},children:[e("defs",{children:o("linearGradient",{id:"dashboardBarColor",x1:"0",y1:"0",x2:"0",y2:"1",children:[e("stop",{offset:"5%",stopColor:Mr,stopOpacity:1}),e("stop",{offset:"95%",stopColor:Mr,stopOpacity:.5})]})}),e(Wn,{dataKey:"name",style:{fill:"var(--ac-global-text-color-700)"}}),e(hn,{stroke:"var(--ac-global-color-grey-500)",label:{value:"Value",angle:-90,position:"insideLeft",style:{textAnchor:"middle",fill:"var(--ac-global-text-color-900)"}},style:{fill:"var(--ac-global-text-color-700)"}}),e(Jn,{strokeDasharray:"4 4",stroke:"var(--ac-global-color-grey-500)",strokeOpacity:.5}),e(Fa,{dataKey:"pv",fill:"url(#dashboardBarColor)",spacing:15})]})})}function pk({title:n,subtitle:a}){return o("div",{css:K`
        padding: var(--ac-global-dimension-size-100)
          var(--ac-global-dimension-size-200);
        border-bottom: 1px solid var(--ac-global-color-grey-200);
        display: flex;
        flex-direction: row;
        gap: var(--ac-global-dimension-size-100);
      `,className:"dashboard-panel-header",children:[e(ae,{children:n}),a&&e(F,{children:a})]})}const Cl=m.forwardRef(function({title:a,children:l},t){return o(v,{borderWidth:"thin",borderColor:"dark",borderRadius:"medium",height:"100%",width:"100%","data-testid":"dashboard-panel",backgroundColor:"grey-75",ref:t,children:[e(pk,{title:a}),l]})}),yk=Jl.WidthProvider(Jl.Responsive),fk={lg:[{i:"a",x:0,y:0,w:4,h:2},{i:"b",x:4,y:0,w:4,h:2},{i:"c",x:8,y:0,w:4,h:2}]},hk=K`
  width: 100%;
  height: 100%;
  &[data-editable="true"] {
    background-color: var(--ac-global-color-grey-50);
    background-image: radial-gradient(
      var(--ac-global-color-grey-400) 1px,
      transparent 1px
    );
    background-size: 20px 20px;
  }
`;function FT(){const[n,a]=m.useState(!1);return o("main",{css:K`
        width: 100%;
        height: 100%;
        box-sizing: border-box;
      `,children:[e(v,{paddingX:"size-200",paddingY:"size-100",borderBottomWidth:"thin",borderBottomColor:"dark",flex:"none",children:o(b,{direction:"row",justifyContent:"space-between",alignItems:"center",children:[e(ae,{level:1,children:"Dashboard Title"}),o(b,{direction:"row",gap:"size-100",children:[e(Pn,{leadingVisual:e(I,{svg:e(ja,{})}),isSelected:n,onChange:l=>a(l)}),e(mt,{})]})]})}),e("div",{"data-editable":n,css:hk,children:o(yk,{className:"layout",layouts:fk,breakpoints:{lg:1200,md:996,sm:768,xs:480,xxs:0},cols:{lg:12,md:10,sm:6,xs:4,xxs:2},rowHeight:80,isResizable:n,isDraggable:n,containerPadding:[16,16],draggableHandle:".dashboard-panel-header",children:[e("div",{children:e(Cl,{title:"Grid Item A",children:e(Fl,{})})},"a"),e("div",{children:e(Cl,{title:"Grid Item B",children:e(Fl,{})})},"b"),e("div",{children:e(Cl,{title:"Grid Item C",children:e(Fl,{})})},"c")]})})]})}const kk=Jl.WidthProvider(Jl.Responsive),bk={lg:[{i:"a",x:0,y:0,w:12,h:4},{i:"b",x:0,y:4,w:12,h:4}]};function CT(){const{project:n}=Me();return o("main",{css:K`
        width: 100%;
        height: 100%;
        box-sizing: border-box;
      `,children:[e(v,{paddingX:"size-200",paddingY:"size-100",borderBottomWidth:"thin",borderBottomColor:"dark",flex:"none",children:o(b,{direction:"row",justifyContent:"space-between",alignItems:"center",children:[o(ae,{level:1,children:["Dashboard: ",n.name]}),e(mt,{})]})}),o(kk,{className:"layout",layouts:bk,breakpoints:{lg:1200,md:996,sm:768,xs:480,xxs:0},cols:{lg:12,md:10,sm:6,xs:4,xxs:2},rowHeight:80,containerPadding:[16,16],isResizable:!1,isDraggable:!1,draggableHandle:".dashboard-panel-header",children:[e("div",{children:e(Cl,{title:"Trace Counts",subtitle:"number of traces over time",children:e(Fl,{})})},"a"),e("div",{children:e(Cl,{title:"Grid Item B",children:e(Fl,{})})},"b")]})]})}const Kd=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"projectId"}],a=[{kind:"Variable",name:"id",variableName:"projectId"}],l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"projectDashboardLoaderQuery",selections:[{alias:"project",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{kind:"InlineFragment",selections:[l,t],type:"Project",abstractKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"projectDashboardLoaderQuery",selections:[{alias:"project",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},l,{kind:"InlineFragment",selections:[t],type:"Project",abstractKey:null}],storageKey:null}]},params:{cacheID:"0887353c068bc5b99dc87040ca8328fc",id:null,metadata:{},name:"projectDashboardLoaderQuery",operationKind:"query",text:`query projectDashboardLoaderQuery(
  $projectId: ID!
) {
  project: node(id: $projectId) {
    __typename
    ... on Project {
      id
      name
    }
    id
  }
}
`}}}();Kd.hash="0db45a204ecd1b95387ed3978ab69779";async function KT(n){const{projectId:a}=n.params,l=await T.fetchQuery(he,Kd,{projectId:a}).toPromise();return Oe(l),l}const Td=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"after"},{defaultValue:50,kind:"LocalArgument",name:"first"}],a=[{kind:"Variable",name:"after",variableName:"after"},{kind:"Variable",name:"first",variableName:"first"}],l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ProjectDashboardsTableProjectsQuery",selections:[{args:a,kind:"FragmentSpread",name:"ProjectDashboardsTable_projects"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ProjectDashboardsTableProjectsQuery",selections:[{alias:null,args:a,concreteType:"ProjectConnection",kind:"LinkedField",name:"projects",plural:!1,selections:[{alias:null,args:null,concreteType:"ProjectEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"project",args:null,concreteType:"Project",kind:"LinkedField",name:"node",plural:!1,selections:[l,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},l],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:a,filters:null,handle:"connection",key:"ProjectDashboardsTable_projects",kind:"LinkedHandle",name:"projects"}]},params:{cacheID:"b1c0d4dac4422f3e6fa1eefe59401c76",id:null,metadata:{},name:"ProjectDashboardsTableProjectsQuery",operationKind:"query",text:`query ProjectDashboardsTableProjectsQuery(
  $after: String = null
  $first: Int = 50
) {
  ...ProjectDashboardsTable_projects_2HEEH6
}

fragment ProjectDashboardsTable_projects_2HEEH6 on Query {
  projects(first: $first, after: $after) {
    edges {
      project: node {
        id
        name
      }
      cursor
      node {
        __typename
        id
      }
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
}
`}}}();Td.hash="7230783e4ba2832dc8133869d816638c";const Pd=function(){var n=["projects"];return{argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"after"},{defaultValue:50,kind:"LocalArgument",name:"first"}],kind:"Fragment",metadata:{connection:[{count:"first",cursor:"after",direction:"forward",path:n}],refetch:{connection:{forward:{count:"first",cursor:"after"},backward:null,path:n},fragmentPathInResult:[],operation:Td}},name:"ProjectDashboardsTable_projects",selections:[{alias:"projects",args:null,concreteType:"ProjectConnection",kind:"LinkedField",name:"__ProjectDashboardsTable_projects_connection",plural:!1,selections:[{alias:null,args:null,concreteType:"ProjectEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"project",args:null,concreteType:"Project",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null}],type:"Query",abstractKey:null}}();Pd.hash="7230783e4ba2832dc8133869d816638c";const Sk=50;function vk({query:n}){const a=m.useRef(null),{data:l,loadNext:t,hasNext:i,isLoadingNext:r}=T.usePaginationFragment(Pd,n),s=m.useMemo(()=>l.projects.edges.map(p=>p.project),[l]),d=m.useCallback(p=>{if(p){const{scrollHeight:y,scrollTop:h,clientHeight:k}=p;y-h-k<300&&!r&&i&&t(Sk)}},[i,r,t]),c=m.useMemo(()=>[{header:"Project",accessorKey:"name",cell:({row:p})=>e(we,{to:`/dashboards/projects/${p.original.id}`,children:p.original.name})}],[]),g=Ce({columns:c,data:s,getCoreRowModel:Ke(),getSortedRowModel:ln()}),f=g.getRowModel().rows,u=f.length===0;return e("div",{css:K`
        flex: 1 1 auto;
        overflow: auto;
      `,onScroll:p=>d(p.target),ref:a,children:o("table",{css:Un,children:[e("thead",{children:g.getHeaderGroups().map(p=>e("tr",{children:p.headers.map(y=>e("th",{colSpan:y.colSpan,children:y.isPlaceholder?null:e("div",{children:W(y.column.columnDef.header,y.getContext())})},y.id))},p.id))}),u?e(yn,{}):e("tbody",{children:f.map(p=>e("tr",{children:p.getVisibleCells().map(y=>{var h;return e("td",{align:(h=y.column.columnDef.meta)==null?void 0:h.textAlign,children:W(y.column.columnDef.cell,y.getContext())},y.id)})},p.id))})]})})}function Fk({dashboards:n}){const a=m.useRef(null),l=m.useMemo(()=>[{header:"name",accessorKey:"name",cell:({row:s})=>e(we,{to:`/dashboards/${s.original.id}`,children:s.original.name})},{header:"description",accessorKey:"description"},{header:"created at",accessorKey:"createdAt",cell:_e},{header:"last updated",accessorKey:"lastUpdatedAt",cell:_e}],[]),t=Ce({columns:l,data:n,getCoreRowModel:Ke(),getSortedRowModel:ln()}),i=t.getRowModel().rows,r=i.length===0;return e("div",{css:K`
        flex: 1 1 auto;
        overflow: auto;
      `,ref:a,children:o("table",{css:Un,children:[e("thead",{children:t.getHeaderGroups().map(s=>e("tr",{children:s.headers.map(d=>e("th",{colSpan:d.colSpan,children:d.isPlaceholder?null:e("div",{children:W(d.column.columnDef.header,d.getContext())})},d.id))},s.id))}),r?e(yn,{}):e("tbody",{children:i.map(s=>e("tr",{onClick:()=>window.location.assign(`/dashboards/${s.original.id}`),css:K`
                  cursor: pointer;
                `,children:s.getVisibleCells().map(d=>{var c;return e("td",{align:(c=d.column.columnDef.meta)==null?void 0:c.textAlign,children:W(d.column.columnDef.cell,d.getContext())},d.id)})},s.id))})]})})}function TT(){const n=Me(),a=[{id:"1",name:"Sales Dashboard",description:"Tracks sales KPIs",createdAt:new Date().toISOString(),lastUpdatedAt:new Date().toISOString()},{id:"2",name:"Marketing Dashboard",description:"Monitors marketing campaigns",createdAt:new Date().toISOString(),lastUpdatedAt:new Date().toISOString()}];return o(b,{direction:"column",height:"100%",children:[e(v,{padding:"size-200",flex:"none",children:o(b,{direction:"row",justifyContent:"space-between",alignItems:"center",children:[e(ae,{level:1,children:"Dashboards"}),e(sa,{size:"M",leadingVisual:e(I,{svg:e(Io,{})}),variant:"primary",to:"#",children:"Create Dashboard"})]})}),o(cn,{children:[o(dn,{children:[e(le,{id:"project-dashboards",children:"Project Dashboards"}),e(le,{id:"user-dashboards",children:"Custom Dashboards"})]}),e(re,{id:"project-dashboards",children:e(vk,{query:n})}),e(re,{id:"user-dashboards",children:e(Fk,{dashboards:a})})]})]})}const xd=function(){var n=[{kind:"Literal",name:"first",value:50}],a={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"dashboardsLoaderQuery",selections:[{args:null,kind:"FragmentSpread",name:"ProjectDashboardsTable_projects"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"dashboardsLoaderQuery",selections:[{alias:null,args:n,concreteType:"ProjectConnection",kind:"LinkedField",name:"projects",plural:!1,selections:[{alias:null,args:null,concreteType:"ProjectEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"project",args:null,concreteType:"Project",kind:"LinkedField",name:"node",plural:!1,selections:[a,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},a],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:"projects(first:50)"},{alias:null,args:n,filters:null,handle:"connection",key:"ProjectDashboardsTable_projects",kind:"LinkedHandle",name:"projects"}]},params:{cacheID:"4644a4f13fed205537d5cc9e1b4f1df8",id:null,metadata:{},name:"dashboardsLoaderQuery",operationKind:"query",text:`query dashboardsLoaderQuery {
  ...ProjectDashboardsTable_projects
}

fragment ProjectDashboardsTable_projects on Query {
  projects(first: 50) {
    edges {
      project: node {
        id
        name
      }
      cursor
      node {
        __typename
        id
      }
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
}
`}}}();xd.hash="93dabaadd9674b38d8c9c7051a25a8b1";async function PT(){const n=await T.fetchQuery(he,xd,{}).toPromise();return Oe(n),n}function xT(){return e(Do,{children:e(ve,{})})}const Ck=K`
  display: flex;
  direction: row;
  height: 100vh;
  overflow: hidden;
`,Kk=K`
  display: flex;
  flex-direction: column;
  flex: 1 1 auto;
  height: 100%;
  overflow: hidden;
  padding-left: var(--px-nav-collapsed-width);
`,Tk=K`
  flex: 1 1 auto;
  display: flex;
  flex-direction: column;
  height: 100%;
  overflow: hidden;
`,Pk=K`
  display: flex;
  flex-direction: column;
  margin: 0;
  list-style: none;
  gap: var(--ac-global-dimension-size-50);
  padding-inline-start: 0;
`,xk=K`
  display: flex;
  flex-direction: column;
  gap: var(--ac-global-dimension-size-50);
`;function IT(){return o("div",{css:Ck,"data-testid":"layout",children:[e(Ik,{}),o("div",{css:Kk,children:[e(Sy,{children:e(by,{})}),e("div",{"data-testid":"content",css:Tk,children:e(m.Suspense,{fallback:e(ge,{}),children:e(ve,{})})})]})]})}function Ik(){const n=_0("dashboards"),a=m.useMemo(()=>window.Config.hasInferences,[]),{authenticationEnabled:l}=w0(),t=m.useCallback(()=>{window.location.replace(xn("/auth/logout"))},[]);return o(Ly,{children:[e(vy,{}),o(b,{direction:"column",justifyContent:"space-between",flex:"1 1 auto",children:[o("ul",{css:xk,children:[a&&e("li",{children:e(En,{to:"/model",text:"Model",leadingVisual:e(I,{svg:e(Fy,{})})})},"model"),e("li",{children:e(En,{to:"/projects",text:"Projects",leadingVisual:e(I,{svg:e(Lo,{})})})}),n&&e("li",{children:e(En,{to:"/dashboards",text:"Dashboards",leadingVisual:e(I,{svg:e(Io,{})})})},"dashboards"),e("li",{children:e(En,{to:"/datasets",text:"Datasets",leadingVisual:e(I,{svg:e(gt,{})})})},"datasets"),e("li",{children:e(En,{to:"/playground",text:"Playground",leadingVisual:e(I,{svg:e(Da,{})})})},"playground"),e("li",{children:e(En,{to:"/prompts",text:"Prompts",leadingVisual:e(I,{svg:e(Ci,{})})})},"prompts"),e("li",{children:e(En,{to:"/apis",text:"APIs",leadingVisual:e(I,{svg:e(Ki,{})})})},"apis")]}),o("ul",{css:Pk,children:[e("li",{children:e(Cy,{})},"github"),e("li",{children:e(En,{to:"/settings/general",text:"Settings",leadingVisual:e(I,{svg:e(_o,{})})})},"settings"),e("li",{children:e(Ky,{})},"docs"),e("li",{children:e(En,{to:"/support",text:"Support",leadingVisual:e(I,{svg:e(Ty,{})})})},"support"),e("li",{children:e(Py,{})},"theme-toggle"),l&&o(J,{children:[e("li",{children:e(En,{to:"/profile",text:"Profile",leadingVisual:e(I,{svg:e(xy,{})})})},"profile"),e("li",{children:e(Iy,{text:"Log Out",leadingVisual:e(I,{svg:e(Dy,{})}),onClick:t})},"logout")]})]})]})]})}const Id=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ProjectConfigPageProjectConfigCardQuery",selections:[{alias:null,args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"ProjectConfigPage_projectConfigCard"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ProjectConfigPageProjectConfigCardQuery",selections:[{alias:null,args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"gradientStartColor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"gradientEndColor",storageKey:null}],type:"Project",abstractKey:null}],storageKey:null}]},params:{cacheID:"492e0693e4facc2052015087af2e9de5",id:null,metadata:{},name:"ProjectConfigPageProjectConfigCardQuery",operationKind:"query",text:`query ProjectConfigPageProjectConfigCardQuery(
  $id: ID!
) {
  node(id: $id) {
    __typename
    ...ProjectConfigPage_projectConfigCard
    id
  }
}

fragment ProjectConfigPage_projectConfigCard on Project {
  id
  name
  gradientStartColor
  gradientEndColor
}
`}}}();Id.hash="3bd54e77e19bb08ca53696b5fc9a5c22";const Dd={argumentDefinitions:[],kind:"Fragment",metadata:{refetch:{connection:null,fragmentPathInResult:["node"],operation:Id,identifierInfo:{identifierField:"id",identifierQueryVariableName:"id"}}},name:"ProjectConfigPage_projectConfigCard",selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"gradientStartColor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"gradientEndColor",storageKey:null}],type:"Project",abstractKey:null};Dd.hash="3bd54e77e19bb08ca53696b5fc9a5c22";const Dk=["traces","spans","sessions"],Bi=30,Ld=n=>Dk.includes(n),_d=function(){var n={defaultValue:null,kind:"LocalArgument",name:"annotationConfigId"},a={defaultValue:null,kind:"LocalArgument",name:"projectId"},l=[{fields:[{kind:"Variable",name:"annotationConfigId",variableName:"annotationConfigId"},{kind:"Variable",name:"projectId",variableName:"projectId"}],kind:"ObjectValue",name:"input"}],t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{fragment:{argumentDefinitions:[n,a],kind:"Fragment",metadata:null,name:"ProjectAnnotationConfigCardContentRemoveAnnotationConfigFromProjectMutation",selections:[{alias:null,args:l,concreteType:"RemoveAnnotationConfigFromProjectPayload",kind:"LinkedField",name:"removeAnnotationConfigFromProject",plural:!1,selections:[{alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"project",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"ProjectAnnotationConfigCardContent_project_annotations"}],storageKey:null}],storageKey:null}],type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[a,n],kind:"Operation",name:"ProjectAnnotationConfigCardContentRemoveAnnotationConfigFromProjectMutation",selections:[{alias:null,args:l,concreteType:"RemoveAnnotationConfigFromProjectPayload",kind:"LinkedField",name:"removeAnnotationConfigFromProject",plural:!1,selections:[{alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"project",plural:!1,selections:[{alias:null,args:null,concreteType:"AnnotationConfigConnection",kind:"LinkedField",name:"annotationConfigs",plural:!1,selections:[{alias:null,args:null,concreteType:"AnnotationConfigEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],type:"AnnotationConfigBase",abstractKey:"__isAnnotationConfigBase"},{kind:"InlineFragment",selections:[t],type:"Node",abstractKey:"__isNode"}],storageKey:null}],storageKey:null}],storageKey:null},t],storageKey:null}],storageKey:null}]},params:{cacheID:"e4d29747630390022d08f376ad4c9d58",id:null,metadata:{},name:"ProjectAnnotationConfigCardContentRemoveAnnotationConfigFromProjectMutation",operationKind:"mutation",text:`mutation ProjectAnnotationConfigCardContentRemoveAnnotationConfigFromProjectMutation(
  $projectId: ID!
  $annotationConfigId: ID!
) {
  removeAnnotationConfigFromProject(input: {projectId: $projectId, annotationConfigId: $annotationConfigId}) {
    project {
      ...ProjectAnnotationConfigCardContent_project_annotations
      id
    }
  }
}

fragment ProjectAnnotationConfigCardContent_project_annotations on Project {
  annotationConfigs {
    edges {
      node {
        __typename
        ... on AnnotationConfigBase {
          __isAnnotationConfigBase: __typename
          name
        }
        ... on Node {
          __isNode: __typename
          id
        }
      }
    }
  }
  id
}
`}}}();_d.hash="26b991be7525781487a7a64abcbf7e50";const Ad=function(){var n={defaultValue:null,kind:"LocalArgument",name:"annotationConfigId"},a={defaultValue:null,kind:"LocalArgument",name:"projectId"},l=[{fields:[{kind:"Variable",name:"annotationConfigId",variableName:"annotationConfigId"},{kind:"Variable",name:"projectId",variableName:"projectId"}],kind:"ObjectValue",name:"input"}],t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{fragment:{argumentDefinitions:[n,a],kind:"Fragment",metadata:null,name:"ProjectAnnotationConfigCardContentAddAnnotationConfigToProjectMutation",selections:[{alias:null,args:l,concreteType:"AddAnnotationConfigToProjectPayload",kind:"LinkedField",name:"addAnnotationConfigToProject",plural:!1,selections:[{alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"project",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"ProjectAnnotationConfigCardContent_project_annotations"}],storageKey:null}],storageKey:null}],type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[a,n],kind:"Operation",name:"ProjectAnnotationConfigCardContentAddAnnotationConfigToProjectMutation",selections:[{alias:null,args:l,concreteType:"AddAnnotationConfigToProjectPayload",kind:"LinkedField",name:"addAnnotationConfigToProject",plural:!1,selections:[{alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"project",plural:!1,selections:[{alias:null,args:null,concreteType:"AnnotationConfigConnection",kind:"LinkedField",name:"annotationConfigs",plural:!1,selections:[{alias:null,args:null,concreteType:"AnnotationConfigEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],type:"AnnotationConfigBase",abstractKey:"__isAnnotationConfigBase"},{kind:"InlineFragment",selections:[t],type:"Node",abstractKey:"__isNode"}],storageKey:null}],storageKey:null}],storageKey:null},t],storageKey:null}],storageKey:null}]},params:{cacheID:"e42b3ed6b172e28b34ecf4dd15c90da7",id:null,metadata:{},name:"ProjectAnnotationConfigCardContentAddAnnotationConfigToProjectMutation",operationKind:"mutation",text:`mutation ProjectAnnotationConfigCardContentAddAnnotationConfigToProjectMutation(
  $projectId: ID!
  $annotationConfigId: ID!
) {
  addAnnotationConfigToProject(input: {projectId: $projectId, annotationConfigId: $annotationConfigId}) {
    project {
      ...ProjectAnnotationConfigCardContent_project_annotations
      id
    }
  }
}

fragment ProjectAnnotationConfigCardContent_project_annotations on Project {
  annotationConfigs {
    edges {
      node {
        __typename
        ... on AnnotationConfigBase {
          __isAnnotationConfigBase: __typename
          name
        }
        ... on Node {
          __isNode: __typename
          id
        }
      }
    }
  }
  id
}
`}}}();Ad.hash="8ddedb3199b7bc0ad4ad95e2bcbbbb60";const wd=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}],l={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ProjectAnnotationConfigCardContentProjectAnnotationsQuery",selections:[{alias:null,args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"ProjectAnnotationConfigCardContent_project_annotations"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ProjectAnnotationConfigCardContentProjectAnnotationsQuery",selections:[{alias:null,args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[l,t,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"AnnotationConfigConnection",kind:"LinkedField",name:"annotationConfigs",plural:!1,selections:[{alias:null,args:null,concreteType:"AnnotationConfigEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[l,{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],type:"AnnotationConfigBase",abstractKey:"__isAnnotationConfigBase"},{kind:"InlineFragment",selections:[t],type:"Node",abstractKey:"__isNode"}],storageKey:null}],storageKey:null}],storageKey:null}],type:"Project",abstractKey:null}],storageKey:null}]},params:{cacheID:"55ea4da3484ae5175d964a89d943e42b",id:null,metadata:{},name:"ProjectAnnotationConfigCardContentProjectAnnotationsQuery",operationKind:"query",text:`query ProjectAnnotationConfigCardContentProjectAnnotationsQuery(
  $id: ID!
) {
  node(id: $id) {
    __typename
    ...ProjectAnnotationConfigCardContent_project_annotations
    id
  }
}

fragment ProjectAnnotationConfigCardContent_project_annotations on Project {
  annotationConfigs {
    edges {
      node {
        __typename
        ... on AnnotationConfigBase {
          __isAnnotationConfigBase: __typename
          name
        }
        ... on Node {
          __isNode: __typename
          id
        }
      }
    }
  }
  id
}
`}}}();wd.hash="f7049daf44d5f6a2e085c04cc187e86e";const Rd={argumentDefinitions:[],kind:"Fragment",metadata:{refetch:{connection:null,fragmentPathInResult:["node"],operation:wd,identifierInfo:{identifierField:"id",identifierQueryVariableName:"id"}}},name:"ProjectAnnotationConfigCardContent_project_annotations",selections:[{alias:null,args:null,concreteType:"AnnotationConfigConnection",kind:"LinkedField",name:"annotationConfigs",plural:!1,selections:[{alias:null,args:null,concreteType:"AnnotationConfigEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],type:"AnnotationConfigBase",abstractKey:"__isAnnotationConfigBase"}],storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],type:"Project",abstractKey:null};Rd.hash="f7049daf44d5f6a2e085c04cc187e86e";const Ed=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"projectId"}],a=[{kind:"Variable",name:"id",variableName:"projectId"}],l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},t={kind:"InlineFragment",selections:[l],type:"Node",abstractKey:"__isNode"},i={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},r={kind:"InlineFragment",selections:[i,{alias:null,args:null,kind:"ScalarField",name:"annotationType",storageKey:null}],type:"AnnotationConfigBase",abstractKey:"__isAnnotationConfigBase"},s={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ProjectAnnotationConfigCardContentQuery",selections:[{alias:"project",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{kind:"InlineFragment",selections:[{args:null,kind:"FragmentSpread",name:"ProjectAnnotationConfigCardContent_project_annotations"}],type:"Project",abstractKey:null}],storageKey:null},{alias:"allAnnotationConfigs",args:null,concreteType:"AnnotationConfigConnection",kind:"LinkedField",name:"annotationConfigs",plural:!1,selections:[{alias:null,args:null,concreteType:"AnnotationConfigEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[t,r],storageKey:null}],storageKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ProjectAnnotationConfigCardContentQuery",selections:[{alias:"project",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[s,l,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"AnnotationConfigConnection",kind:"LinkedField",name:"annotationConfigs",plural:!1,selections:[{alias:null,args:null,concreteType:"AnnotationConfigEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[s,{kind:"InlineFragment",selections:[i],type:"AnnotationConfigBase",abstractKey:"__isAnnotationConfigBase"},t],storageKey:null}],storageKey:null}],storageKey:null}],type:"Project",abstractKey:null}],storageKey:null},{alias:"allAnnotationConfigs",args:null,concreteType:"AnnotationConfigConnection",kind:"LinkedField",name:"annotationConfigs",plural:!1,selections:[{alias:null,args:null,concreteType:"AnnotationConfigEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[s,t,r],storageKey:null}],storageKey:null}],storageKey:null}]},params:{cacheID:"c276ca07c754114aa64bc34ec26f1174",id:null,metadata:{},name:"ProjectAnnotationConfigCardContentQuery",operationKind:"query",text:`query ProjectAnnotationConfigCardContentQuery(
  $projectId: ID!
) {
  project: node(id: $projectId) {
    __typename
    ... on Project {
      ...ProjectAnnotationConfigCardContent_project_annotations
    }
    id
  }
  allAnnotationConfigs: annotationConfigs {
    edges {
      node {
        __typename
        ... on Node {
          __isNode: __typename
          id
        }
        ... on AnnotationConfigBase {
          __isAnnotationConfigBase: __typename
          name
          annotationType
        }
      }
    }
  }
}

fragment ProjectAnnotationConfigCardContent_project_annotations on Project {
  annotationConfigs {
    edges {
      node {
        __typename
        ... on AnnotationConfigBase {
          __isAnnotationConfigBase: __typename
          name
        }
        ... on Node {
          __isNode: __typename
          id
        }
      }
    }
  }
  id
}
`}}}();Ed.hash="57a24bc659f8d1c2e7e761194c83231d";const Lk=n=>o(q,{title:"Project Annotations",variant:"compact",bodyStyle:{padding:0},children:[e(Fe,{variant:"info",banner:!0,children:"Annotation Configs are configured globally and can be associated with multiple projects. Select the annotation configs you want to use for this project."}),e(m.Suspense,{fallback:e(_y,{}),children:e(Ak,{projectId:n.projectId})}),e(v,{paddingX:"size-200",paddingY:"size-100",borderTopWidth:"thin",borderColor:"dark",children:e(b,{direction:"row",justifyContent:"end",children:e(we,{to:"/settings/annotations",children:"Configure Annotation Configs"})})})]}),_k=[{id:"select",maxSize:10,header:()=>null,cell:({row:n})=>e(On,{checked:n.original.isEnabled,disabled:n.original.isLoading,onChange:a=>{const l=n.original.id;if(!l)throw new Error("Annotation config ID is required");a.target.checked?n.original.onAdd(l):n.original.onRemove(l)}})},{id:"name",header:"Name",accessorKey:"name",cell:({row:n})=>e(ll,{annotation:{name:n.original.name||""},annotationDisplayPreference:"none",css:K`
            width: fit-content;
          `},n.original.name)},{id:"type",header:"Type",accessorKey:"annotationType",cell:({row:n})=>{var a,l;return e(F,{children:((a=n.original.annotationType)==null?void 0:a.charAt(0).toUpperCase())+((l=n.original.annotationType)==null?void 0:l.slice(1).toLowerCase())})}}],Ak=n=>{const{projectId:a}=n,[l,t]=m.useState({}),i=me(),r=be(),s=T.useLazyLoadQuery(Ed,{projectId:a}),[d]=T.useRefetchableFragment(Rd,s.project),[c]=T.useMutation(Ad),[g]=T.useMutation(_d),f=m.useCallback(k=>{t(S=>({...S,[k]:!0})),m.startTransition(()=>{c({variables:{projectId:a,annotationConfigId:k},onCompleted:()=>{t(S=>({...S,[k]:!1})),i({title:"Annotation config added",message:"The annotation config has been added to the project."})},onError:S=>{t(C=>({...C,[k]:!1})),r({title:"Failed to add annotation config",message:S.message||"An unknown error occurred"})}})})},[a,c,i,r]),u=m.useCallback(k=>{t(S=>({...S,[k]:!0})),g({variables:{projectId:a,annotationConfigId:k},onCompleted:()=>{t(S=>({...S,[k]:!1})),i({title:"Annotation config removed",message:"The annotation config has been removed from the project."})},onError:S=>{t(C=>({...C,[k]:!1})),r({title:"Failed to remove annotation config",message:S.message||"An unknown error occurred"})}})},[a,g,i,r]),{allAnnotationConfigs:p}=s,y=m.useMemo(()=>{var S;const k=((S=d==null?void 0:d.annotationConfigs)==null?void 0:S.edges.map(C=>{var P;return(P=C==null?void 0:C.node)==null?void 0:P.name}))||[];return p.edges.map(C=>({id:C.node.id||"",name:C.node.name||"",annotationType:C.node.annotationType||"",isEnabled:k.includes(C.node.name),isLoading:l[C.node.id||""],onAdd:f,onRemove:u}))},[p.edges,d,l,f,u]),h=Ce({data:y,columns:_k,getCoreRowModel:Ke()});return p.edges.length===0?e(b,{direction:"row",justifyContent:"center",children:e(F,{children:"No annotation configurations available."})}):e("div",{css:K`
        overflow: auto;
      `,children:o("table",{css:We,style:{width:h.getTotalSize(),minWidth:"100%"},children:[e("thead",{children:h.getHeaderGroups().map(k=>e("tr",{children:k.headers.map(S=>e("th",{colSpan:S.colSpan,children:S.isPlaceholder?null:e("div",{style:{left:S.getStart(),width:S.getSize()},children:W(S.column.columnDef.header,S.getContext())})},S.id))},k.id))}),e("tbody",{children:h.getRowModel().rows.map(k=>e("tr",{children:k.getVisibleCells().map(S=>e("td",{style:{width:S.column.getSize(),maxWidth:S.column.getSize()},children:W(S.column.columnDef.cell,S.getContext())},S.id))},k.id))})]})})},Md=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}],l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"cronExpression",storageKey:null},s={alias:null,args:null,kind:"ScalarField",name:"maxDays",storageKey:null},d={kind:"InlineFragment",selections:[s],type:"TraceRetentionRuleMaxDays",abstractKey:null},c={alias:null,args:null,kind:"ScalarField",name:"maxCount",storageKey:null},g={kind:"InlineFragment",selections:[c],type:"TraceRetentionRuleMaxCount",abstractKey:null},f={kind:"InlineFragment",selections:[s,c],type:"TraceRetentionRuleMaxDaysOrCount",abstractKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ProjectPageQueriesProjectConfigQuery",selections:[{alias:"project",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[l,{args:null,kind:"FragmentSpread",name:"ProjectConfigPage_projectConfigCard"},{args:null,kind:"FragmentSpread",name:"ProjectRetentionPolicyCard_policy"}],storageKey:null},{args:null,kind:"FragmentSpread",name:"ProjectRetentionPolicyCard_query"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ProjectPageQueriesProjectConfigQuery",selections:[{alias:"project",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[t,l,{kind:"InlineFragment",selections:[i,{alias:null,args:null,kind:"ScalarField",name:"gradientStartColor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"gradientEndColor",storageKey:null},{alias:null,args:null,concreteType:"ProjectTraceRetentionPolicy",kind:"LinkedField",name:"traceRetentionPolicy",plural:!1,selections:[l,i,r,{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"rule",plural:!1,selections:[t,d,g,f],storageKey:null}],storageKey:null}],type:"Project",abstractKey:null}],storageKey:null},{alias:null,args:null,concreteType:"ProjectTraceRetentionPolicyConnection",kind:"LinkedField",name:"projectTraceRetentionPolicies",plural:!1,selections:[{alias:null,args:null,concreteType:"ProjectTraceRetentionPolicyEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"ProjectTraceRetentionPolicy",kind:"LinkedField",name:"node",plural:!1,selections:[l,i,r,{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"rule",plural:!1,selections:[t,g,d,f],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}]},params:{cacheID:"21b6f510ef6ac701854b1c2f750f30ad",id:null,metadata:{},name:"ProjectPageQueriesProjectConfigQuery",operationKind:"query",text:`query ProjectPageQueriesProjectConfigQuery(
  $id: ID!
) {
  project: node(id: $id) {
    __typename
    id
    ...ProjectConfigPage_projectConfigCard
    ...ProjectRetentionPolicyCard_policy
  }
  ...ProjectRetentionPolicyCard_query
}

fragment ProjectConfigPage_projectConfigCard on Project {
  id
  name
  gradientStartColor
  gradientEndColor
}

fragment ProjectRetentionPolicyCard_policy on Project {
  id
  name
  traceRetentionPolicy {
    id
    name
    cronExpression
    rule {
      __typename
      ... on TraceRetentionRuleMaxDays {
        maxDays
      }
      ... on TraceRetentionRuleMaxCount {
        maxCount
      }
      ... on TraceRetentionRuleMaxDaysOrCount {
        maxDays
        maxCount
      }
    }
  }
}

fragment ProjectRetentionPolicyCard_query on Query {
  ...ProjectTraceRetentionPolicySelectFragment
}

fragment ProjectTraceRetentionPolicySelectFragment on Query {
  projectTraceRetentionPolicies {
    edges {
      node {
        id
        name
        cronExpression
        rule {
          __typename
          ... on TraceRetentionRuleMaxCount {
            maxCount
          }
          ... on TraceRetentionRuleMaxDays {
            maxDays
          }
          ... on TraceRetentionRuleMaxDaysOrCount {
            maxDays
            maxCount
          }
        }
      }
    }
  }
}
`}}}();Md.hash="3d4a317421ae07c5ad4ddd7f22b99771";const Vd=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"id"},{defaultValue:null,kind:"LocalArgument",name:"timeRange"}],a=[{kind:"Variable",name:"id",variableName:"id"}],l={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},i=[{kind:"Literal",name:"first",value:30},{kind:"Literal",name:"sort",value:{col:"startTime",dir:"desc"}},{kind:"Variable",name:"timeRange",variableName:"timeRange"}],r=[{alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ProjectPageQueriesSessionsQuery",selections:[{alias:"project",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"SessionsTable_sessions"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ProjectPageQueriesSessionsQuery",selections:[{alias:"project",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[l,t,{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:i,concreteType:"ProjectSessionConnection",kind:"LinkedField",name:"sessions",plural:!1,selections:[{alias:null,args:null,concreteType:"ProjectSessionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"session",args:null,concreteType:"ProjectSession",kind:"LinkedField",name:"node",plural:!1,selections:[t,{alias:null,args:null,kind:"ScalarField",name:"sessionId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"numTraces",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"endTime",storageKey:null},{alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"firstInput",plural:!1,selections:r,storageKey:null},{alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"lastOutput",plural:!1,selections:r,storageKey:null},{alias:null,args:null,concreteType:"TokenUsage",kind:"LinkedField",name:"tokenUsage",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"total",storageKey:null}],storageKey:null},{alias:"traceLatencyMsP50",args:[{kind:"Literal",name:"probability",value:.5}],kind:"ScalarField",name:"traceLatencyMsQuantile",storageKey:"traceLatencyMsQuantile(probability:0.5)"},{alias:"traceLatencyMsP99",args:[{kind:"Literal",name:"probability",value:.99}],kind:"ScalarField",name:"traceLatencyMsQuantile",storageKey:"traceLatencyMsQuantile(probability:0.99)"}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"ProjectSession",kind:"LinkedField",name:"node",plural:!1,selections:[l,t],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:i,filters:["sort","filterIoSubstring","timeRange"],handle:"connection",key:"SessionsTable_sessions",kind:"LinkedHandle",name:"sessions"}],type:"Project",abstractKey:null}],storageKey:null}]},params:{cacheID:"f6148dfd72fd9ac4e48b8cc3e29167e6",id:null,metadata:{},name:"ProjectPageQueriesSessionsQuery",operationKind:"query",text:`query ProjectPageQueriesSessionsQuery(
  $id: ID!
  $timeRange: TimeRange!
) {
  project: node(id: $id) {
    __typename
    ...SessionsTable_sessions
    id
  }
}

fragment SessionsTable_sessions on Project {
  name
  sessions(first: 30, sort: {col: startTime, dir: desc}, timeRange: $timeRange) {
    edges {
      session: node {
        id
        sessionId
        numTraces
        startTime
        endTime
        firstInput {
          value
        }
        lastOutput {
          value
        }
        tokenUsage {
          total
        }
        traceLatencyMsP50: traceLatencyMsQuantile(probability: 0.5)
        traceLatencyMsP99: traceLatencyMsQuantile(probability: 0.99)
      }
      cursor
      node {
        __typename
        id
      }
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
  id
}
`}}}();Vd.hash="f475282bbe180d5df7b013d618a4a7f7";const zd=function(){var n={defaultValue:null,kind:"LocalArgument",name:"id"},a={defaultValue:null,kind:"LocalArgument",name:"orphanSpanAsRootSpan"},l={defaultValue:null,kind:"LocalArgument",name:"timeRange"},t=[{kind:"Variable",name:"id",variableName:"id"}],i={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},s={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},d=[{kind:"Literal",name:"first",value:30},{kind:"Variable",name:"orphanSpanAsRootSpan",variableName:"orphanSpanAsRootSpan"},{kind:"Literal",name:"rootSpansOnly",value:!0},{kind:"Literal",name:"sort",value:{col:"startTime",dir:"desc"}},{kind:"Variable",name:"timeRange",variableName:"timeRange"}],c=[{alias:"value",args:null,kind:"ScalarField",name:"truncatedValue",storageKey:null}],g={alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},f={alias:null,args:null,kind:"ScalarField",name:"score",storageKey:null};return{fragment:{argumentDefinitions:[n,a,l],kind:"Fragment",metadata:null,name:"ProjectPageQueriesSpansQuery",selections:[{alias:"project",args:t,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"SpansTable_spans"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[n,l,a],kind:"Operation",name:"ProjectPageQueriesSpansQuery",selections:[{alias:"project",args:t,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[i,r,{kind:"InlineFragment",selections:[s,{alias:null,args:null,kind:"ScalarField",name:"spanAnnotationNames",storageKey:null},{alias:null,args:d,concreteType:"SpanConnection",kind:"LinkedField",name:"spans",plural:!1,selections:[{alias:null,args:null,concreteType:"SpanEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"span",args:null,concreteType:"Span",kind:"LinkedField",name:"node",plural:!1,selections:[r,{alias:null,args:null,kind:"ScalarField",name:"spanKind",storageKey:null},s,{alias:null,args:null,kind:"ScalarField",name:"metadata",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"statusCode",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"latencyMs",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"tokenCountTotal",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cumulativeTokenCountTotal",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"spanId",storageKey:null},{alias:null,args:null,concreteType:"Trace",kind:"LinkedField",name:"trace",plural:!1,selections:[r,{alias:null,args:null,kind:"ScalarField",name:"traceId",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"input",plural:!1,selections:c,storageKey:null},{alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"output",plural:!1,selections:c,storageKey:null},{alias:null,args:null,concreteType:"SpanAnnotation",kind:"LinkedField",name:"spanAnnotations",plural:!0,selections:[r,s,g,f,{alias:null,args:null,kind:"ScalarField",name:"annotatorKind",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"user",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"username",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"profilePictureUrl",storageKey:null},r],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"AnnotationSummary",kind:"LinkedField",name:"spanAnnotationSummaries",plural:!0,selections:[{alias:null,args:null,concreteType:"LabelFraction",kind:"LinkedField",name:"labelFractions",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"fraction",storageKey:null},g],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"meanScore",storageKey:null},s],storageKey:null},{alias:null,args:null,concreteType:"DocumentRetrievalMetrics",kind:"LinkedField",name:"documentRetrievalMetrics",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"evaluationName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"ndcg",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"precision",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hit",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"project",plural:!1,selections:[r,{alias:null,args:null,concreteType:"AnnotationConfigConnection",kind:"LinkedField",name:"annotationConfigs",plural:!1,selections:[{alias:null,args:null,concreteType:"AnnotationConfigEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[i,{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"annotationType",storageKey:null}],type:"AnnotationConfigBase",abstractKey:"__isAnnotationConfigBase"},{kind:"InlineFragment",selections:[r,s,{alias:null,args:null,kind:"ScalarField",name:"optimizationDirection",storageKey:null},{alias:null,args:null,concreteType:"CategoricalAnnotationValue",kind:"LinkedField",name:"values",plural:!0,selections:[g,f],storageKey:null}],type:"CategoricalAnnotationConfig",abstractKey:null},{kind:"InlineFragment",selections:[r],type:"Node",abstractKey:"__isNode"}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"Span",kind:"LinkedField",name:"node",plural:!1,selections:[i,r],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:d,filters:["sort","rootSpansOnly","filterCondition","orphanSpanAsRootSpan","timeRange"],handle:"connection",key:"SpansTable_spans",kind:"LinkedHandle",name:"spans"}],type:"Project",abstractKey:null}],storageKey:null}]},params:{cacheID:"37c4e5ea4ea6b3fa61cadca4a3dc3bf9",id:null,metadata:{},name:"ProjectPageQueriesSpansQuery",operationKind:"query",text:`query ProjectPageQueriesSpansQuery(
  $id: ID!
  $timeRange: TimeRange!
  $orphanSpanAsRootSpan: Boolean!
) {
  project: node(id: $id) {
    __typename
    ...SpansTable_spans
    id
  }
}

fragment AnnotationSummaryGroup on Span {
  project {
    id
    annotationConfigs {
      edges {
        node {
          __typename
          ... on AnnotationConfigBase {
            __isAnnotationConfigBase: __typename
            annotationType
          }
          ... on CategoricalAnnotationConfig {
            id
            name
            optimizationDirection
            values {
              label
              score
            }
          }
          ... on Node {
            __isNode: __typename
            id
          }
        }
      }
    }
  }
  spanAnnotations {
    id
    name
    label
    score
    annotatorKind
    createdAt
    user {
      username
      profilePictureUrl
      id
    }
  }
  spanAnnotationSummaries {
    labelFractions {
      fraction
      label
    }
    meanScore
    name
  }
}

fragment SpanColumnSelector_annotations on Project {
  spanAnnotationNames
}

fragment SpansTable_spans on Project {
  name
  ...SpanColumnSelector_annotations
  spans(first: 30, sort: {col: startTime, dir: desc}, rootSpansOnly: true, orphanSpanAsRootSpan: $orphanSpanAsRootSpan, timeRange: $timeRange) {
    edges {
      span: node {
        id
        spanKind
        name
        metadata
        statusCode
        startTime
        latencyMs
        tokenCountTotal
        cumulativeTokenCountTotal
        spanId
        trace {
          id
          traceId
        }
        input {
          value: truncatedValue
        }
        output {
          value: truncatedValue
        }
        spanAnnotations {
          id
          name
          label
          score
          annotatorKind
          createdAt
        }
        spanAnnotationSummaries {
          labelFractions {
            fraction
            label
          }
          meanScore
          name
        }
        documentRetrievalMetrics {
          evaluationName
          ndcg
          precision
          hit
        }
        ...AnnotationSummaryGroup
      }
      cursor
      node {
        __typename
        id
      }
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
  id
}
`}}}();zd.hash="6c31b031cf07047b2f02307de192ee3c";const Nd=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"id"},{defaultValue:null,kind:"LocalArgument",name:"timeRange"}],a=[{kind:"Variable",name:"id",variableName:"id"}],l={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},r=[{kind:"Literal",name:"first",value:30},{kind:"Literal",name:"rootSpansOnly",value:!0},{kind:"Literal",name:"sort",value:{col:"startTime",dir:"desc"}},{kind:"Variable",name:"timeRange",variableName:"timeRange"}],s={alias:null,args:null,kind:"ScalarField",name:"spanKind",storageKey:null},d={alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},c={alias:null,args:null,kind:"ScalarField",name:"latencyMs",storageKey:null},g={alias:null,args:null,kind:"ScalarField",name:"parentId",storageKey:null},f=[{alias:"value",args:null,kind:"ScalarField",name:"truncatedValue",storageKey:null}],u={alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"input",plural:!1,selections:f,storageKey:null},p={alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"output",plural:!1,selections:f,storageKey:null},y={alias:null,args:null,kind:"ScalarField",name:"spanId",storageKey:null},h={alias:null,args:null,kind:"ScalarField",name:"traceId",storageKey:null},k={alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},S={alias:null,args:null,kind:"ScalarField",name:"score",storageKey:null},C={alias:null,args:null,concreteType:"SpanAnnotation",kind:"LinkedField",name:"spanAnnotations",plural:!0,selections:[t,i,k,S,{alias:null,args:null,kind:"ScalarField",name:"annotatorKind",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"user",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"username",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"profilePictureUrl",storageKey:null},t],storageKey:null}],storageKey:null},P={alias:null,args:null,concreteType:"AnnotationSummary",kind:"LinkedField",name:"spanAnnotationSummaries",plural:!0,selections:[{alias:null,args:null,concreteType:"LabelFraction",kind:"LinkedField",name:"labelFractions",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"fraction",storageKey:null},k],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"meanScore",storageKey:null},i],storageKey:null},L={alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"project",plural:!1,selections:[t,{alias:null,args:null,concreteType:"AnnotationConfigConnection",kind:"LinkedField",name:"annotationConfigs",plural:!1,selections:[{alias:null,args:null,concreteType:"AnnotationConfigEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[l,{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"annotationType",storageKey:null}],type:"AnnotationConfigBase",abstractKey:"__isAnnotationConfigBase"},{kind:"InlineFragment",selections:[t,i,{alias:null,args:null,kind:"ScalarField",name:"optimizationDirection",storageKey:null},{alias:null,args:null,concreteType:"CategoricalAnnotationValue",kind:"LinkedField",name:"values",plural:!0,selections:[k,S],storageKey:null}],type:"CategoricalAnnotationConfig",abstractKey:null},{kind:"InlineFragment",selections:[t],type:"Node",abstractKey:"__isNode"}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null},_={alias:null,args:null,concreteType:"DocumentRetrievalMetrics",kind:"LinkedField",name:"documentRetrievalMetrics",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"evaluationName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"ndcg",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"precision",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hit",storageKey:null}],storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ProjectPageQueriesTracesQuery",selections:[{alias:"project",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"TracesTable_spans"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ProjectPageQueriesTracesQuery",selections:[{alias:"project",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[l,t,{kind:"InlineFragment",selections:[i,{alias:null,args:null,kind:"ScalarField",name:"spanAnnotationNames",storageKey:null},{alias:"rootSpans",args:r,concreteType:"SpanConnection",kind:"LinkedField",name:"spans",plural:!1,selections:[{alias:null,args:null,concreteType:"SpanEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"rootSpan",args:null,concreteType:"Span",kind:"LinkedField",name:"node",plural:!1,selections:[t,s,i,{alias:null,args:null,kind:"ScalarField",name:"metadata",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"statusCode",storageKey:null},d,c,{alias:null,args:null,kind:"ScalarField",name:"cumulativeTokenCountTotal",storageKey:null},g,u,p,y,{alias:null,args:null,concreteType:"Trace",kind:"LinkedField",name:"trace",plural:!1,selections:[t,h,{alias:null,args:null,kind:"ScalarField",name:"numSpans",storageKey:null}],storageKey:null},C,P,L,_,{alias:null,args:[{kind:"Literal",name:"first",value:50}],concreteType:"SpanConnection",kind:"LinkedField",name:"descendants",plural:!1,selections:[{alias:null,args:null,concreteType:"SpanEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"Span",kind:"LinkedField",name:"node",plural:!1,selections:[t,s,i,{alias:"statusCode",args:null,kind:"ScalarField",name:"propagatedStatusCode",storageKey:null},d,c,g,{alias:"cumulativeTokenCountTotal",args:null,kind:"ScalarField",name:"tokenCountTotal",storageKey:null},u,p,y,{alias:null,args:null,concreteType:"Trace",kind:"LinkedField",name:"trace",plural:!1,selections:[t,h],storageKey:null},C,L,P,_],storageKey:null}],storageKey:null}],storageKey:"descendants(first:50)"}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"Span",kind:"LinkedField",name:"node",plural:!1,selections:[l,t],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},{alias:"rootSpans",args:r,filters:["sort","rootSpansOnly","filterCondition","timeRange"],handle:"connection",key:"TracesTable_rootSpans",kind:"LinkedHandle",name:"spans"}],type:"Project",abstractKey:null}],storageKey:null}]},params:{cacheID:"188f2933f1b44a5ef8fcb93b791a9fcf",id:null,metadata:{},name:"ProjectPageQueriesTracesQuery",operationKind:"query",text:`query ProjectPageQueriesTracesQuery(
  $id: ID!
  $timeRange: TimeRange!
) {
  project: node(id: $id) {
    __typename
    ...TracesTable_spans
    id
  }
}

fragment AnnotationSummaryGroup on Span {
  project {
    id
    annotationConfigs {
      edges {
        node {
          __typename
          ... on AnnotationConfigBase {
            __isAnnotationConfigBase: __typename
            annotationType
          }
          ... on CategoricalAnnotationConfig {
            id
            name
            optimizationDirection
            values {
              label
              score
            }
          }
          ... on Node {
            __isNode: __typename
            id
          }
        }
      }
    }
  }
  spanAnnotations {
    id
    name
    label
    score
    annotatorKind
    createdAt
    user {
      username
      profilePictureUrl
      id
    }
  }
  spanAnnotationSummaries {
    labelFractions {
      fraction
      label
    }
    meanScore
    name
  }
}

fragment SpanColumnSelector_annotations on Project {
  spanAnnotationNames
}

fragment TraceHeaderRootSpanAnnotationsFragment on Span {
  ...AnnotationSummaryGroup
}

fragment TracesTable_spans on Project {
  name
  ...SpanColumnSelector_annotations
  rootSpans: spans(first: 30, sort: {col: startTime, dir: desc}, rootSpansOnly: true, timeRange: $timeRange) {
    edges {
      rootSpan: node {
        id
        spanKind
        name
        metadata
        statusCode
        startTime
        latencyMs
        cumulativeTokenCountTotal
        parentId
        input {
          value: truncatedValue
        }
        output {
          value: truncatedValue
        }
        spanId
        trace {
          id
          traceId
          numSpans
        }
        spanAnnotations {
          id
          name
          label
          score
          annotatorKind
          createdAt
        }
        spanAnnotationSummaries {
          labelFractions {
            fraction
            label
          }
          meanScore
          name
        }
        ...AnnotationSummaryGroup
        documentRetrievalMetrics {
          evaluationName
          ndcg
          precision
          hit
        }
        descendants(first: 50) {
          edges {
            node {
              id
              spanKind
              name
              statusCode: propagatedStatusCode
              startTime
              latencyMs
              parentId
              cumulativeTokenCountTotal: tokenCountTotal
              input {
                value: truncatedValue
              }
              output {
                value: truncatedValue
              }
              spanId
              trace {
                id
                traceId
              }
              spanAnnotations {
                id
                name
                label
                score
                annotatorKind
                createdAt
              }
              ...AnnotationSummaryGroup
              documentRetrievalMetrics {
                evaluationName
                ndcg
                precision
                hit
              }
              ...TraceHeaderRootSpanAnnotationsFragment
            }
          }
        }
      }
      cursor
      node {
        __typename
        id
      }
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
  id
}
`}}}();Nd.hash="a11623d043c2945903dbd3fd179886cb";const $d=Nd,jd=zd,Od=Vd,Qd=Md,Bd=m.createContext({spansQueryReference:null,sessionsQueryReference:null,tracesQueryReference:null,projectConfigQueryReference:null}),At=()=>{const n=m.useContext(Bd);if(!n)throw new Error("ProjectPageQueryReferenceContext not found");return n},qd=function(){var n={defaultValue:null,kind:"LocalArgument",name:"policyId"},a={defaultValue:null,kind:"LocalArgument",name:"projectId"},l=[{fields:[{items:[{kind:"Variable",name:"addProjects.0",variableName:"projectId"}],kind:"ListValue",name:"addProjects"},{kind:"Variable",name:"id",variableName:"policyId"}],kind:"ObjectValue",name:"input"}],t=[{kind:"Variable",name:"id",variableName:"projectId"}],i={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},s={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},d={alias:null,args:null,kind:"ScalarField",name:"maxDays",storageKey:null},c={alias:null,args:null,kind:"ScalarField",name:"maxCount",storageKey:null};return{fragment:{argumentDefinitions:[n,a],kind:"Fragment",metadata:null,name:"ProjectRetentionPolicyCardSetProjectRetentionPolicyMutation",selections:[{alias:null,args:l,concreteType:"ProjectTraceRetentionPolicyMutationPayload",kind:"LinkedField",name:"patchProjectTraceRetentionPolicy",plural:!1,selections:[{alias:null,args:null,concreteType:"Query",kind:"LinkedField",name:"query",plural:!1,selections:[{alias:null,args:t,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{kind:"InlineFragment",selections:[{args:null,kind:"FragmentSpread",name:"ProjectRetentionPolicyCard_policy"}],type:"Project",abstractKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[a,n],kind:"Operation",name:"ProjectRetentionPolicyCardSetProjectRetentionPolicyMutation",selections:[{alias:null,args:l,concreteType:"ProjectTraceRetentionPolicyMutationPayload",kind:"LinkedField",name:"patchProjectTraceRetentionPolicy",plural:!1,selections:[{alias:null,args:null,concreteType:"Query",kind:"LinkedField",name:"query",plural:!1,selections:[{alias:null,args:t,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[i,r,{kind:"InlineFragment",selections:[s,{alias:null,args:null,concreteType:"ProjectTraceRetentionPolicy",kind:"LinkedField",name:"traceRetentionPolicy",plural:!1,selections:[r,s,{alias:null,args:null,kind:"ScalarField",name:"cronExpression",storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"rule",plural:!1,selections:[i,{kind:"InlineFragment",selections:[d],type:"TraceRetentionRuleMaxDays",abstractKey:null},{kind:"InlineFragment",selections:[c],type:"TraceRetentionRuleMaxCount",abstractKey:null},{kind:"InlineFragment",selections:[d,c],type:"TraceRetentionRuleMaxDaysOrCount",abstractKey:null}],storageKey:null}],storageKey:null}],type:"Project",abstractKey:null}],storageKey:null}],storageKey:null}],storageKey:null}]},params:{cacheID:"a98d713987237f83deb503164dc5d9b2",id:null,metadata:{},name:"ProjectRetentionPolicyCardSetProjectRetentionPolicyMutation",operationKind:"mutation",text:`mutation ProjectRetentionPolicyCardSetProjectRetentionPolicyMutation(
  $projectId: ID!
  $policyId: ID!
) {
  patchProjectTraceRetentionPolicy(input: {id: $policyId, addProjects: [$projectId]}) {
    query {
      node(id: $projectId) {
        __typename
        ... on Project {
          ...ProjectRetentionPolicyCard_policy
        }
        id
      }
    }
  }
}

fragment ProjectRetentionPolicyCard_policy on Project {
  id
  name
  traceRetentionPolicy {
    id
    name
    cronExpression
    rule {
      __typename
      ... on TraceRetentionRuleMaxDays {
        maxDays
      }
      ... on TraceRetentionRuleMaxCount {
        maxCount
      }
      ... on TraceRetentionRuleMaxDaysOrCount {
        maxDays
        maxCount
      }
    }
  }
}
`}}}();qd.hash="7b5534147b50d4a3232a2d5d94705212";const Ud=function(){var n={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},a={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"maxDays",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"maxCount",storageKey:null};return{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"ProjectRetentionPolicyCard_policy",selections:[n,a,{alias:null,args:null,concreteType:"ProjectTraceRetentionPolicy",kind:"LinkedField",name:"traceRetentionPolicy",plural:!1,selections:[n,a,{alias:null,args:null,kind:"ScalarField",name:"cronExpression",storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"rule",plural:!1,selections:[{kind:"InlineFragment",selections:[l],type:"TraceRetentionRuleMaxDays",abstractKey:null},{kind:"InlineFragment",selections:[t],type:"TraceRetentionRuleMaxCount",abstractKey:null},{kind:"InlineFragment",selections:[l,t],type:"TraceRetentionRuleMaxDaysOrCount",abstractKey:null}],storageKey:null}],storageKey:null}],type:"Project",abstractKey:null}}();Ud.hash="6069a92b50f5083a8c8fbeee6982b6b5";const Hd={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"ProjectRetentionPolicyCard_query",selections:[{args:null,kind:"FragmentSpread",name:"ProjectTraceRetentionPolicySelectFragment"}],type:"Query",abstractKey:null};Hd.hash="ae8f95394a5ca83acf7326a90809b351";const wk=({project:n,query:a})=>{var u,p,y,h,k,S;const l=Fo(),t=me(),i=be(),r=T.useFragment(Hd,a),s=T.useFragment(Ud,n),[d,c]=T.useMutation(qd),g=m.useMemo(()=>{var C;return Qi({schedule:((C=s.traceRetentionPolicy)==null?void 0:C.cronExpression)||""})},[(u=s.traceRetentionPolicy)==null?void 0:u.cronExpression]),f=C=>{d({variables:{projectId:s.id,policyId:C},onCompleted:()=>{t({title:"Project retention policy updated",message:"The new policy will take effect at the configured schedule."})},onError:()=>{i({title:"Failed to update retention policy",message:"Please try again."})}})};return o(q,{title:"Data Retention",variant:"compact",bodyStyle:{padding:0},children:[e(v,{paddingX:"size-200",paddingY:"size-100",children:o(b,{direction:"row",gap:"size-400",alignItems:"center",children:[e("section",{children:e(Ay,{defaultValue:(p=s.traceRetentionPolicy)==null?void 0:p.id,onChange:f,query:r,isDisabled:c||!l})}),e("section",{children:o(b,{direction:"column",gap:"size-100",children:[e(F,{children:Xs({numberOfDays:(h=(y=s.traceRetentionPolicy)==null?void 0:y.rule)==null?void 0:h.maxDays,numberOfTraces:(S=(k=s.traceRetentionPolicy)==null?void 0:k.rule)==null?void 0:S.maxCount})}),o(F,{children:[e("b",{children:"Schedule:"})," ",g]})]})})]})}),e(v,{paddingX:"size-200",paddingY:"size-100",borderTopWidth:"thin",borderColor:"dark",children:e(b,{direction:"row",justifyContent:"end",children:e(we,{to:"/settings/data",children:"Configure Retention Policies"})})})]})},Rk=K`
  overflow-y: auto;
`,Ek=K`
  padding: var(--ac-global-dimension-size-400);
  max-width: 800px;
  min-width: 500px;
  box-sizing: border-box;
  width: 100%;
  margin-left: auto;
  margin-right: auto;
`,Mk=K`
  width: 75px;
  height: 75px;
  flex: none;
  border-radius: 50%;
  margin-top: var(--ac-global-dimension-size-100);
`,DT=()=>{const{projectConfigQueryReference:n}=At();return n?e("main",{css:Rk,children:e("div",{css:Ek,children:e(m.Suspense,{fallback:e(ge,{}),children:e(Vk,{project:n})})})}):null},Vk=({project:n})=>{const a=T.usePreloadedQuery(Qd,n);return o(b,{direction:"column",gap:"size-200",children:[e(zk,{project:a.project}),e(Lk,{projectId:a.project.id}),e(wk,{project:a.project,query:a})]})},zk=({project:n})=>{const[a]=T.useRefetchableFragment(Dd,n),{defaultTab:l,setDefaultTab:t}=Tl(i=>({defaultTab:i.defaultTab,setDefaultTab:i.setDefaultTab}));return e(q,{title:"Project Settings",variant:"compact",children:o(b,{direction:"row",gap:"size-200",children:[e("div",{css:[Mk,{background:`linear-gradient(136.27deg, ${a.gradientStartColor} 14.03%, ${a.gradientEndColor} 84.38%)`}]}),e("div",{css:K`
            width: 100%;
            .ac-dropdown,
            .ac-dropdown-button {
              width: 100%;
            }
          `,children:o(b,{direction:"column",gap:"size-100",width:"100%",children:[o(b,{direction:"row",gap:"size-100",alignItems:"end",width:"100%",children:[o(ee,{value:a.name,isReadOnly:!0,css:K`
                  width: 100%;
                `,children:[e(H,{children:"Project Name"}),e(X,{})]}),e(de,{text:a.name,size:"M"})]}),o(pt,{selectedKey:l,onSelectionChange:i=>{typeof i=="string"&&Ld(i)&&t(i)},placeholder:"Select a default tab",children:[e(H,{children:"Default Project Tab"}),o(M,{children:[e(lt,{}),e(yt,{})]}),e(la,{children:o(Ml,{children:[e(Xn,{id:"spans",children:"Spans"},"spans"),e(Xn,{id:"traces",children:"Traces"},"traces"),e(Xn,{id:"sessions",children:"Sessions"},"sessions")]})})]})]})})]})})};function LT(){const{projectId:n}=Qe();return Oe(n),e(wy,{projectId:n,children:e(ve,{})})}const Gd=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}],l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"promptConfigLoaderQuery",selections:[{alias:"prompt",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{kind:"InlineFragment",selections:[{args:null,kind:"FragmentSpread",name:"PromptVersionTagsConfigCard_data"}],type:"Prompt",abstractKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"promptConfigLoaderQuery",selections:[{alias:"prompt",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},l,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"PromptVersionTag",kind:"LinkedField",name:"versionTags",plural:!0,selections:[l,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"promptVersionId",storageKey:null}],storageKey:null}],type:"Prompt",abstractKey:null}],storageKey:null}]},params:{cacheID:"bb3d56ec191577418a8de0eaf53b6bde",id:null,metadata:{},name:"promptConfigLoaderQuery",operationKind:"query",text:`query promptConfigLoaderQuery(
  $id: ID!
) {
  prompt: node(id: $id) {
    __typename
    ... on Prompt {
      ...PromptVersionTagsConfigCard_data
    }
    id
  }
}

fragment PromptVersionTagsConfigCard_data on Prompt {
  id
  versionTags {
    id
    name
    description
    promptVersionId
  }
}
`}}}();Gd.hash="14c6b4bb4ca5f20cce70677746b16459";const _T=async({params:n})=>{const a=n.promptId;if(!a)throw new Error("Prompt ID is required");return await T.fetchQuery(he,Gd,{id:a}).toPromise()},Wd={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"PromptIndexPage__aside",selections:[{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{args:null,kind:"FragmentSpread",name:"PromptLatestVersionsListFragment"},{args:null,kind:"FragmentSpread",name:"EditPromptButton_data"}],type:"Prompt",abstractKey:null};Wd.hash="a77263d84d9add47173ed2e3d0243952";const Jd={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"PromptIndexPage__main",selections:[{alias:null,args:null,concreteType:"PromptVersionConnection",kind:"LinkedField",name:"promptVersions",plural:!1,selections:[{alias:null,args:null,concreteType:"PromptVersionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"PromptVersion",kind:"LinkedField",name:"node",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"PromptInvocationParameters__main"},{args:null,kind:"FragmentSpread",name:"PromptChatMessagesCard__main"},{args:null,kind:"FragmentSpread",name:"PromptCodeExportCard__main"},{args:null,kind:"FragmentSpread",name:"PromptModelConfigurationCard__main"}],storageKey:null}],storageKey:null}],storageKey:null},{args:null,kind:"FragmentSpread",name:"PromptIndexPage__aside"}],type:"Prompt",abstractKey:null};Jd.hash="a883b83f574448623a2b02a60d899d41";const Xd={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"PromptModelConfigurationCard__main",selections:[{alias:"model",args:null,kind:"ScalarField",name:"modelName",storageKey:null},{alias:"provider",args:null,kind:"ScalarField",name:"modelProvider",storageKey:null},{args:null,kind:"FragmentSpread",name:"PromptLLM__main"},{args:null,kind:"FragmentSpread",name:"PromptInvocationParameters__main"},{args:null,kind:"FragmentSpread",name:"PromptTools__main"},{args:null,kind:"FragmentSpread",name:"PromptResponseFormatFragment"}],type:"PromptVersion",abstractKey:null};Xd.hash="1c4202299f1f881250b17b75244fac54";const Zd={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"PromptInvocationParameters__main",selections:[{alias:null,args:null,kind:"ScalarField",name:"invocationParameters",storageKey:null}],type:"PromptVersion",abstractKey:null};Zd.hash="4f00ab4f0396fffb81a1b068e544cfcf";function Nk({keyName:n,value:a}){const{json:l,stringifyError:t}=jn(a);return t?null:e(v,{paddingStart:"size-100",paddingEnd:"size-100",children:o(b,{direction:"row",justifyContent:"space-between",children:[e(F,{size:"XS",color:"text-700",children:n}),e(F,{size:"XS",children:l})]})})}function $k({promptVersion:n}){const{invocationParameters:a}=T.useFragment(Zd,n),l=m.useMemo(()=>Kp(a)?Object.entries(a).map(([t,i])=>({key:t,value:i})):[],[a]);return l.length===0?e(v,{padding:"size-200",children:e(b,{justifyContent:"center",alignItems:"center",children:e(F,{color:"text-300",children:"No parameters saved for this prompt"})})}):e(rt,{listSize:"small",children:l.map(({key:t,value:i},r)=>e(it,{children:e(Nk,{keyName:t,value:i})},`${t}-${r}`))})}const Yd={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"PromptLLM__main",selections:[{alias:"model",args:null,kind:"ScalarField",name:"modelName",storageKey:null},{alias:"provider",args:null,kind:"ScalarField",name:"modelProvider",storageKey:null}],type:"PromptVersion",abstractKey:null};Yd.hash="acc90da43126218472d2fc19cd8d0512";const Vr=({keyName:n,children:a})=>e(it,{listSize:"small",children:e(v,{paddingStart:"size-100",paddingEnd:"size-100",children:o(b,{direction:"row",justifyContent:"space-between",children:[e(F,{size:"XS",color:"text-700",children:n}),e(F,{size:"XS",children:a})]})})});function jk({promptVersion:n}){const a=T.useFragment(Yd,n);return o(fe,{id:"llm",children:[e(pe,{children:"LLM"}),e(ye,{children:o(rt,{listSize:"small",children:[e(Vr,{keyName:"Model",children:a.model}),e(Vr,{keyName:"Provider",children:ii[a.provider]??a.provider})]})})]})}const ec={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"PromptResponseFormatFragment",selections:[{alias:null,args:null,concreteType:"ResponseFormat",kind:"LinkedField",name:"responseFormat",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"definition",storageKey:null}],storageKey:null}],type:"PromptVersion",abstractKey:null};ec.hash="154d745ec5e978e0dfc811ebfb9faa8c";function Ok({promptVersion:n}){const{responseFormat:a}=T.useFragment(ec,n),l=m.useMemo(()=>typeof(a==null?void 0:a.definition)=="string"?jn(Be(a==null?void 0:a.definition).json||"",null,2).json||"":jn(a==null?void 0:a.definition,null,2).json||"",[a==null?void 0:a.definition]);return l?o(fe,{id:"response-format",children:[e(pe,{children:"Response Format"}),e(ye,{children:e(Sn,{value:l})})]}):o(fe,{id:"response-format",children:[e(pe,{children:"Response Format"}),e(ye,{children:e(v,{padding:"size-200",children:e(b,{justifyContent:"center",alignItems:"center",children:e(F,{color:"text-300",children:"No response format specified for this prompt"})})})})]})}const nc={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"PromptTools__main",selections:[{alias:null,args:null,concreteType:"ToolDefinition",kind:"LinkedField",name:"tools",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"definition",storageKey:null}],storageKey:null}],type:"PromptVersion",abstractKey:null};nc.hash="aa512d962d83a58b70ae0e17f01242b3";function Qk({promptVersion:n}){const{tools:a}=T.useFragment(nc,n),l=m.useMemo(()=>a.map((t,i)=>{const r=t.definition;return{name:Ey(r)||`Tool ${i+1}`,description:Ry(r)||void 0,definition:jn(r,null,2).json||"{}"}}),[a]);return l.length===0?o(fe,{id:"tools",children:[e(pe,{children:"Tools"}),e(ye,{children:e(v,{padding:"size-200",children:e(b,{justifyContent:"center",alignItems:"center",children:e(F,{color:"text-300",children:"No tools specified for this prompt"})})})})]}):o(b,{direction:"column",children:[e(My,{bordered:!1,children:"Tools"}),e(Cn,{css:K`
          & {
            > .ac-disclosure:last-child {
              &[data-expanded="true"] {
                border-bottom: 1px solid var(--ac-global-border-color-default);
              }
            }
          }
        `,children:l.map((t,i)=>o(fe,{id:`tool-${i}`,children:[o(pe,{arrowPosition:"start",justifyContent:"space-between",children:[e(F,{children:t.name}),e(F,{children:t.description})]}),e(ye,{children:e(Sn,{value:t.definition})})]},`${t.name}-${i}`))})]})}function ac({promptVersion:n}){const a=T.useFragment(Xd,n);return e(q,{title:"Model Configuration",variant:"compact",bodyStyle:{padding:0},collapsible:!0,children:o(Cn,{defaultExpandedKeys:["llm","invocation-parameters","tools","response-format"],children:[e(jk,{promptVersion:a}),o(fe,{id:"invocation-parameters",children:[e(pe,{children:"Invocation Parameters"}),e(ye,{children:e($k,{promptVersion:a})})]}),e(Qk,{promptVersion:a}),e(Ok,{promptVersion:a})]})})}const lc=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{kind:"Variable",name:"input",variableName:"input"}],l={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"toolCallId",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},s=[{alias:null,args:null,kind:"ScalarField",name:"definition",storageKey:null}],d={alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"EditPromptButtonPatchPromptMutation",selections:[{alias:null,args:a,concreteType:"Prompt",kind:"LinkedField",name:"patchPrompt",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"PromptIndexPage__main"}],storageKey:null}],type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"EditPromptButtonPatchPromptMutation",selections:[{alias:null,args:a,concreteType:"Prompt",kind:"LinkedField",name:"patchPrompt",plural:!1,selections:[{alias:null,args:null,concreteType:"PromptVersionConnection",kind:"LinkedField",name:"promptVersions",plural:!1,selections:[{alias:null,args:null,concreteType:"PromptVersionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"PromptVersion",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"invocationParameters",storageKey:null},{alias:"provider",args:null,kind:"ScalarField",name:"modelProvider",storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"template",plural:!1,selections:[l,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"PromptMessage",kind:"LinkedField",name:"messages",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"role",storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"content",plural:!0,selections:[l,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"TextContentValue",kind:"LinkedField",name:"text",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"text",storageKey:null}],storageKey:null}],type:"TextContentPart",abstractKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"ToolCallContentValue",kind:"LinkedField",name:"toolCall",plural:!1,selections:[t,{alias:null,args:null,concreteType:"ToolCallFunction",kind:"LinkedField",name:"toolCall",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"arguments",storageKey:null},i],storageKey:null}],storageKey:null}],type:"ToolCallContentPart",abstractKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"ToolResultContentValue",kind:"LinkedField",name:"toolResult",plural:!1,selections:[t,{alias:null,args:null,kind:"ScalarField",name:"result",storageKey:null}],storageKey:null}],type:"ToolResultContentPart",abstractKey:null}],storageKey:null}],storageKey:null}],type:"PromptChatTemplate",abstractKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"template",storageKey:null}],type:"PromptStringTemplate",abstractKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"templateType",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"templateFormat",storageKey:null},r,{alias:null,args:null,kind:"ScalarField",name:"modelName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"modelProvider",storageKey:null},{alias:null,args:null,concreteType:"ResponseFormat",kind:"LinkedField",name:"responseFormat",plural:!1,selections:s,storageKey:null},{alias:null,args:null,concreteType:"ToolDefinition",kind:"LinkedField",name:"tools",plural:!0,selections:s,storageKey:null},{alias:"model",args:null,kind:"ScalarField",name:"modelName",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null},d,{alias:"latestVersions",args:[{kind:"Literal",name:"first",value:5}],concreteType:"PromptVersionConnection",kind:"LinkedField",name:"promptVersions",plural:!1,selections:[{alias:null,args:null,concreteType:"PromptVersionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"version",args:null,concreteType:"PromptVersion",kind:"LinkedField",name:"node",plural:!1,selections:[r,d,{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"sequenceNumber",storageKey:null},{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"user",plural:!1,selections:[r,{alias:null,args:null,kind:"ScalarField",name:"username",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"profilePictureUrl",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PromptVersionTag",kind:"LinkedField",name:"tags",plural:!0,selections:[r,i],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:"promptVersions(first:5)"},r],storageKey:null}]},params:{cacheID:"4c43e7052f5f6b399aee596f0f14da1b",id:null,metadata:{},name:"EditPromptButtonPatchPromptMutation",operationKind:"mutation",text:`mutation EditPromptButtonPatchPromptMutation(
  $input: PatchPromptInput!
) {
  patchPrompt(input: $input) {
    ...PromptIndexPage__main
    id
  }
}

fragment EditPromptButton_data on Prompt {
  id
  description
}

fragment PromptChatMessagesCard__main on PromptVersion {
  provider: modelProvider
  template {
    __typename
    ... on PromptChatTemplate {
      messages {
        role
        content {
          __typename
          ... on TextContentPart {
            text {
              text
            }
          }
          ... on ToolCallContentPart {
            toolCall {
              toolCallId
              toolCall {
                arguments
                name
              }
            }
          }
          ... on ToolResultContentPart {
            toolResult {
              toolCallId
              result
            }
          }
        }
      }
    }
    ... on PromptStringTemplate {
      template
    }
  }
  templateType
  templateFormat
}

fragment PromptCodeExportCard__main on PromptVersion {
  id
  invocationParameters
  modelName
  modelProvider
  responseFormat {
    definition
  }
  tools {
    definition
  }
  template {
    __typename
    ... on PromptChatTemplate {
      messages {
        role
        content {
          __typename
          ... on TextContentPart {
            __typename
            text {
              text
            }
          }
          ... on ToolCallContentPart {
            __typename
            toolCall {
              toolCallId
              toolCall {
                name
                arguments
              }
            }
          }
          ... on ToolResultContentPart {
            __typename
            toolResult {
              toolCallId
              result
            }
          }
        }
      }
    }
    ... on PromptStringTemplate {
      template
    }
  }
  templateFormat
  templateType
}

fragment PromptIndexPage__aside on Prompt {
  description
  ...PromptLatestVersionsListFragment
  ...EditPromptButton_data
}

fragment PromptIndexPage__main on Prompt {
  promptVersions {
    edges {
      node {
        ...PromptInvocationParameters__main
        ...PromptChatMessagesCard__main
        ...PromptCodeExportCard__main
        ...PromptModelConfigurationCard__main
        id
      }
    }
  }
  ...PromptIndexPage__aside
}

fragment PromptInvocationParameters__main on PromptVersion {
  invocationParameters
}

fragment PromptLLM__main on PromptVersion {
  model: modelName
  provider: modelProvider
}

fragment PromptLatestVersionsListFragment on Prompt {
  latestVersions: promptVersions(first: 5) {
    edges {
      version: node {
        id
        description
        createdAt
        sequenceNumber
        ...PromptVersionSummaryFragment
      }
    }
  }
}

fragment PromptModelConfigurationCard__main on PromptVersion {
  model: modelName
  provider: modelProvider
  ...PromptLLM__main
  ...PromptInvocationParameters__main
  ...PromptTools__main
  ...PromptResponseFormatFragment
}

fragment PromptResponseFormatFragment on PromptVersion {
  responseFormat {
    definition
  }
}

fragment PromptTools__main on PromptVersion {
  tools {
    definition
  }
}

fragment PromptVersionSummaryFragment on PromptVersion {
  id
  description
  sequenceNumber
  createdAt
  user {
    id
    username
    profilePictureUrl
  }
  ...PromptVersionTagsList_data
}

fragment PromptVersionTagsList_data on PromptVersion {
  tags {
    id
    name
  }
}
`}}}();lc.hash="3ce25c8fbe5598ec1ee037a9778a6957";const tc={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"EditPromptButton_data",selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null}],type:"Prompt",abstractKey:null};tc.hash="24788aacf7830c0e5037befe576f4968";function Bk(n){const[a,l]=m.useState(!1),t=me(),i=be(),r=T.useFragment(tc,n.prompt),[s,d]=T.useMutation(lc),{control:c,handleSubmit:g}=Ve({defaultValues:{description:r.description??""}}),f=m.useCallback(u=>{s({variables:{input:{promptId:r.id,description:u.description}},onCompleted:()=>{l(!1),t({title:"Prompt updated",message:"The prompt has been updated successfully"})},onError:p=>{var y;i({title:"Error updating prompt",message:(y=De(p))==null?void 0:y[0]})}})},[r.id,s,i,t]);return o(Ne,{isOpen:a,onOpenChange:l,children:[e(M,{size:"S",leadingVisual:e(I,{svg:e(_o,{})}),variant:"quiet","aria-label":"configure prompt",onPress:()=>l(!0)}),e(Ge,{size:"S",isDismissable:!0,children:o(He,{children:[e(ae,{slot:"title",children:"Edit Prompt Details"}),o(gn,{children:[e(v,{padding:"size-200",children:e(G,{name:"description",control:c,render:({field:u})=>o(ee,{value:u.value,onChange:u.onChange,children:[e(H,{children:"Prompt Description"}),e(Pa,{placeholder:"Enter a description for the prompt"}),e(F,{slot:"description",children:"A description of the prompt"})]})})}),e(v,{paddingX:"size-200",paddingY:"size-100",borderTopColor:"light",borderTopWidth:"thin",children:o(b,{direction:"row",gap:"size-100",justifyContent:"end",children:[e(M,{slot:"close",size:"S",children:"Cancel"}),e(M,{variant:"primary",size:"S",isDisabled:d,onPress:()=>g(f)(),children:d?"Saving...":"Save"})]})})]})]})})]})}const ic=function(){var n={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},a={alias:null,args:null,kind:"ScalarField",name:"toolCallId",storageKey:null};return{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"PromptChatMessagesCard__main",selections:[{alias:"provider",args:null,kind:"ScalarField",name:"modelProvider",storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"template",plural:!1,selections:[n,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"PromptMessage",kind:"LinkedField",name:"messages",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"role",storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"content",plural:!0,selections:[n,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"TextContentValue",kind:"LinkedField",name:"text",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"text",storageKey:null}],storageKey:null}],type:"TextContentPart",abstractKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"ToolCallContentValue",kind:"LinkedField",name:"toolCall",plural:!1,selections:[a,{alias:null,args:null,concreteType:"ToolCallFunction",kind:"LinkedField",name:"toolCall",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"arguments",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],storageKey:null}],storageKey:null}],type:"ToolCallContentPart",abstractKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"ToolResultContentValue",kind:"LinkedField",name:"toolResult",plural:!1,selections:[a,{alias:null,args:null,kind:"ScalarField",name:"result",storageKey:null}],storageKey:null}],type:"ToolResultContentPart",abstractKey:null}],storageKey:null}],storageKey:null}],type:"PromptChatTemplate",abstractKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"template",storageKey:null}],type:"PromptStringTemplate",abstractKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"templateType",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"templateFormat",storageKey:null}],type:"PromptVersion",abstractKey:null}}();ic.hash="e0d9c12926330e5e774cbc64de158a82";const qi=E.object({text:E.object({text:E.string()})}),Ui=E.object({toolCall:E.object({toolCallId:E.string(),toolCall:E.object({name:E.string(),arguments:E.string()})})}),Hi=E.object({toolResult:E.object({toolCallId:E.string(),result:ki})}),wt=n=>{const a=qi.safeParse(n);return a.success?a.data:null},rc=n=>{const a={text:{text:n}},l=qi.safeParse(a);return l.success?l.data:null},Gi=n=>{const a=Ui.safeParse(n);return a.success?a.data:null},oc=n=>{const a=Vy(n),l=zy(n),t=Ny(n);if(!a)return null;const i=jn(t).json||"",r={toolCall:{toolCallId:a,toolCall:{name:l||a,arguments:i}}},s=Ui.safeParse(r);return s.success?s.data:null},Wi=n=>{const a=Hi.safeParse(n);return a.success?a.data:null},sc=(n,a)=>{const l={toolResult:{toolCallId:n,result:a}},t=Hi.safeParse(l);return t.success?t.data:null};function Nl(n){return m.useMemo(()=>{const a=n.toLowerCase();return Gl.user.includes(a)?{backgroundColor:"grey-200",borderColor:"grey-500"}:Gl.ai.includes(a)?{backgroundColor:"blue-100",borderColor:"blue-700"}:Gl.system.includes(a)?{backgroundColor:"indigo-100",borderColor:"indigo-700"}:["function","tool"].includes(a)?{backgroundColor:"yellow-100",borderColor:"yellow-700"}:{backgroundColor:"grey-100",borderColor:"grey-700"}},[n])}const Rt={text:"Text",toolCall:"Tool Call",toolResult:"Tool Result"},qk=Object.values(Rt);function Uk({toolResult:n,isOnlyChild:a}){const l=m.useMemo(()=>{const t=n.toolResult.result;return Oi(t)},[n]);return e(Ji,{title:Rt.toolResult,isOnlyChild:a,children:o(b,{direction:"column",children:[e(v,{paddingX:"size-200",paddingTop:"size-100",children:o(b,{direction:"column",justifyContent:"start",gap:"size-100",children:[e(F,{weight:"heavy",size:"XS",children:"Tool ID"}),e(v,{paddingX:"size-300",children:e(F,{size:"XS",children:n.toolResult.toolCallId})})]})}),o(b,{direction:"column",children:[e(v,{paddingX:"size-200",paddingTop:"size-100",children:e(F,{weight:"heavy",size:"XS",children:"Tool Result"})}),e(ft,{readOnly:!0,children:e(ht,{readOnly:!0,height:"100%",defaultValue:l,templateFormat:bn.NONE})})]})]})})}function Hk({provider:n,toolCall:a,isOnlyChild:l}){const t=m.useMemo(()=>{const i=Ao(a,n);return jn(i,null,2).json||""},[n,a]);return e(Ji,{title:Rt.toolCall,isOnlyChild:l,children:e(ft,{readOnly:!0,children:e(ht,{readOnly:!0,height:"100%",defaultValue:t,templateFormat:bn.NONE})})})}function Gk(n){const{text:a,templateFormat:l,isOnlyChild:t}=n;return e(Ji,{title:Rt.text,isOnlyChild:t,children:e(ft,{readOnly:!0,children:e(ht,{readOnly:!0,height:"100%",defaultValue:a,templateFormat:l})})})}function Ji({title:n,children:a,isOnlyChild:l}){return l?e(J,{children:a}):o(fe,{id:n,children:[e(pe,{children:e(F,{weight:"heavy",size:"S",children:n})}),e(ye,{children:a})]})}function Wk(n){const{role:a,children:l}=n,t=Nl(a);return e(q,{title:a,variant:"compact",...t,bodyStyle:{padding:0},collapsible:!0,children:e(Cn,{defaultExpandedKeys:qk,children:l})})}function Jk({promptVersion:n}){const{template:a,templateFormat:l,provider:t}=T.useFragment(ic,n);if(a.__typename==="PromptStringTemplate")return e(F,{children:a.template});if(a.__typename==="PromptChatTemplate")return e(Zk,{template:a,templateFormat:l,provider:Ds(t)||bo});if(a.__typename==="%other")throw new Error("Unknown template type"+a.__typename)}function Xk({part:n,templateFormat:a,provider:l,isOnlyChild:t}){let i=wt(n);return i?e(Gk,{text:i.text.text,templateFormat:a,isOnlyChild:t}):(i=Gi(n),i?e(Hk,{toolCall:i,provider:l,isOnlyChild:t}):(i=Wi(n),i?e(Uk,{toolResult:i,isOnlyChild:t}):null))}function Zk({template:n,templateFormat:a,provider:l}){const{messages:t}=n;return e(b,{direction:"column",gap:"size-100","data-testid":"chat-messages",children:t.map((i,r)=>{const s=i.content.length===1&&i.content.find(wt)!=null;return e(Wk,{role:i.role,children:i.content.map((d,c)=>e(Xk,{part:d,templateFormat:a,provider:l,isOnlyChild:s},`${c}-${d.__typename}`))},r)})})}function dc({title:n="Prompt",promptVersion:a}){return e(q,{title:n,variant:"compact",collapsible:!0,"data-testid":"prompt-chat-messages-card",children:e(Jk,{promptVersion:a})})}const cc=function(){var n=[{alias:null,args:null,kind:"ScalarField",name:"definition",storageKey:null}],a={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"toolCallId",storageKey:null};return{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"PromptCodeExportCard__main",selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"invocationParameters",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"modelName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"modelProvider",storageKey:null},{alias:null,args:null,concreteType:"ResponseFormat",kind:"LinkedField",name:"responseFormat",plural:!1,selections:n,storageKey:null},{alias:null,args:null,concreteType:"ToolDefinition",kind:"LinkedField",name:"tools",plural:!0,selections:n,storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"template",plural:!1,selections:[a,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"PromptMessage",kind:"LinkedField",name:"messages",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"role",storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"content",plural:!0,selections:[{kind:"InlineFragment",selections:[a,{alias:null,args:null,concreteType:"TextContentValue",kind:"LinkedField",name:"text",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"text",storageKey:null}],storageKey:null}],type:"TextContentPart",abstractKey:null},{kind:"InlineFragment",selections:[a,{alias:null,args:null,concreteType:"ToolCallContentValue",kind:"LinkedField",name:"toolCall",plural:!1,selections:[l,{alias:null,args:null,concreteType:"ToolCallFunction",kind:"LinkedField",name:"toolCall",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"arguments",storageKey:null}],storageKey:null}],storageKey:null}],type:"ToolCallContentPart",abstractKey:null},{kind:"InlineFragment",selections:[a,{alias:null,args:null,concreteType:"ToolResultContentValue",kind:"LinkedField",name:"toolResult",plural:!1,selections:[l,{alias:null,args:null,kind:"ScalarField",name:"result",storageKey:null}],storageKey:null}],type:"ToolResultContentPart",abstractKey:null}],storageKey:null}],storageKey:null}],type:"PromptChatTemplate",abstractKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"template",storageKey:null}],type:"PromptStringTemplate",abstractKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"templateFormat",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"templateType",storageKey:null}],type:"PromptVersion",abstractKey:null}}();cc.hash="3fa95713c234bb0cfa4c36e8e4f9cea0";const Yk=E.enum(["system","user","assistant","developer","tool","function"]),Et=E.object({role:Yk,content:E.string().nullable(),name:E.string().optional(),tool_call_id:E.string().optional(),tool_calls:E.array($y).optional()}).passthrough(),e1=E.array(Et);at(e1,{removeAdditionalStrategy:"passthrough"});const n1=E.enum(["user","assistant","tool"]),a1=jy.extend({type:E.string(),text:E.string().optional(),id:E.string().optional(),tool_use_id:E.string().optional(),name:E.string().optional(),input:E.record(E.unknown()).optional(),source:E.object({type:E.string(),media_type:E.string().optional(),data:E.string().optional()}).optional()}),uc=E.object({role:n1,content:E.union([E.string(),E.array(a1)])}),l1=E.array(uc);at(l1,{removeAdditionalStrategy:"passthrough"});const t1=E.enum(["SYSTEM","USER","AI","TOOL"]),i1=E.object({image:E.object({url:E.string()})}),r1=E.discriminatedUnion("__typename",[qi.extend({__typename:E.literal("TextContentPart")}),i1.extend({__typename:E.literal("ImageContentPart")}),Ui.extend({__typename:E.literal("ToolCallContentPart")}),Hi.extend({__typename:E.literal("ToolResultContentPart")})]),Mt=E.object({role:t1,content:E.array(r1)}).passthrough(),o1=E.array(Mt);at(o1,{removeAdditionalStrategy:"passthrough"});const mc=Et.transform(n=>{const a={role:n.role==="assistant"?"assistant":"user",content:n.content?[{type:"text",text:n.content}]:[]};return n.tool_calls?{...a,content:[...a.content,...n.tool_calls.map(l=>Oy.parse(l))]}:n.tool_call_id?{...a,content:[{type:"tool_result",tool_use_id:n.tool_call_id,content:n.content}]}:a}),gc=Mt.transform(n=>{if(n.role==="TOOL"){const t=n.content.map(i=>Wi(i)).find(i=>!!i);if(!t)throw new Error("TOOL role message must have a ToolResultContentPart");return{role:"tool",content:Oi(t.toolResult.result),tool_call_id:t.toolResult.toolCallId}}const a={role:{SYSTEM:"system",USER:"user",AI:"assistant",TOOL:"tool"}[n.role],content:n.content.map(t=>wt(t)).filter(t=>!!t).map(t=>t.text.text).join(`
`)},l=n.content.map(t=>Gi(t)).filter(t=>!!t).map(t=>({id:t.toolCall.toolCallId,type:"function",function:{name:t.toolCall.toolCall.name,arguments:typeof t.toolCall.toolCall.arguments=="string"?JSON.parse(t.toolCall.toolCall.arguments):t.toolCall.toolCall.arguments}}));return l.length>0?{...a,tool_calls:l}:a});Et.transform(n=>{const a=[];if(n.role==="tool"&&n.tool_call_id){const t=sc(n.tool_call_id,n.content);return t&&a.push({__typename:"ToolResultContentPart",...t}),{role:"TOOL",content:a}}if(n.content){const t=rc(n.content);t&&a.push({__typename:"TextContentPart",...t})}return n.tool_calls&&n.tool_calls.forEach(t=>{const i=oc({id:t.id,name:t.function.name,arguments:t.function.arguments});i&&a.push({__typename:"ToolCallContentPart",...i})}),{role:{system:"SYSTEM",user:"USER",assistant:"AI",tool:"TOOL",developer:"SYSTEM",function:"TOOL"}[n.role],content:a}});const s1=({message:n,targetProvider:a})=>{switch(a){case"AZURE_OPENAI":case"OPENAI":case"DEEPSEEK":case"XAI":case"OLLAMA":return n;case"ANTHROPIC":return mc.parse(n);case"GOOGLE":return n;default:return Te()}};E.union([Et,uc,Mt,ki]);Mt.transform(n=>mc.parse(gc.parse(n)));const zn="  ",Ql=({json:n,level:a,removeKeyQuotes:l=!1})=>{const t=zn.repeat(a);let i=JSON.stringify(n,null,zn);return i=i.split(`
`).map((r,s)=>s>0?t+r:r).join(`
`),l&&(i=i.replace(/"([a-zA-Z_$][a-zA-Z0-9_$]*)"\s*:/g,"$1:")),i},d1=In.template(`
from openai import OpenAI

client = OpenAI()

messages=<%= messages %>
# ^ apply additional templating to messages if needed

completion = client.chat.completions.create(
<% _.forEach(args, function(arg) { %><%= tab %><%= arg %>,
<% }); %>)

print(completion.choices[0].message)
`.trim()),c1=In.template(`
import OpenAI from "openai";

const openai = new OpenAI();

const messages = <%= messages %>;
// ^ apply additional templating to messages if needed

const response = openai.chat.completions.create({
<% _.forEach(args, function(arg) { %><%= tab %><%= arg %>,
<% }); %>});

response.then((completion) => console.log(completion.choices[0].message));
`.trim()),u1=In.template(`
from openai import OpenAI
from phoenix.client import Client

prompt = Client().prompts.get(prompt_version_id="<%= versionId %>")

# Format the prompt template with the appropriate variables
response = OpenAI().chat.completions.create(**prompt.format(variables={ "variable": "value" }))
print(response.choices[0].message.content)
  `.trim()),m1=In.template(`
from openai import OpenAI;
import { Client } from "@arizeai/phoenix-client";
import { toSDK, getPrompt } from "@arizeai/phoenix-client/prompts";

const client = new Client();
const openai = new OpenAI();

const prompt = await getPrompt({
  client,
  prompt: {
    versionId: "<%= versionId %>",
  },
});

const openAIParams = toSDK({
  prompt,
  sdk: "openai",
  // Apply the prompt template variables
  variables: {
    key: "value",
  },
});

const response = await openai.chat.completions.create({
  ...openAIParams,
});

console.log(response.choices[0]?.message.content);
`.trim()),g1=In.template(`
from anthropic import Anthropic

client = Anthropic()

messages=<%= messages %>
# ^ apply additional templating to messages if needed

completion = client.messages.create(
<% _.forEach(args, function(arg) { %><%= tab %><%= arg %>,
<% }); %>)

print(completion.content)
`.trim()),p1=In.template(`
import Anthropic from "@anthropic-ai/sdk";

const client = new Anthropic();

const messages = <%= messages %>;
// ^ apply additional templating to messages if needed

const response = await client.messages.create({
<% _.forEach(args, function(arg) { %><%= tab %><%= arg %>,
<% }); %>});

console.log(response.content);
`.trim()),y1=In.template(`
from anthropic import Anthropic
from phoenix.client import Client

prompt = Client().prompts.get(prompt_version_id="<%= versionId %>")
# Format the prompt template with the appropriate variables
resp = Anthropic().messages.create(**prompt.format(variables={ "variable": "value" }))
  `.trim()),f1=In.template(`
import Anthropic from "@anthropic-ai/sdk";
import { Client } from "@arizeai/phoenix-client";
import { toSDK, getPrompt } from "@arizeai/phoenix-client/prompts";

const client = new Client();
const anthropic = new Anthropic();

const prompt = await getPrompt({
  client,
  prompt: {
    versionId: "<%= versionId %>",
  },
});

const anthropicParams = toSDK({
  prompt,
  sdk: "anthropic",
  // Apply the prompt template variables
  variables: {
    key: "value",
  },
});

const response = await anthropic.messages.create({
  ...anthropicParams,
});

console.log(response.content);
`.trim()),ya={python:{openai:{assignmentOperator:"=",removeKeyQuotes:!1,stringQuote:'"',sdkTemplate:d1,clientTemplate:u1},anthropic:{assignmentOperator:"=",removeKeyQuotes:!1,stringQuote:'"',sdkTemplate:g1,clientTemplate:y1}},typescript:{openai:{assignmentOperator:": ",removeKeyQuotes:!0,stringQuote:'"',sdkTemplate:c1,clientTemplate:m1},anthropic:{assignmentOperator:": ",removeKeyQuotes:!0,stringQuote:'"',sdkTemplate:p1,clientTemplate:f1}}},Bl=(n,a)=>{if(!("messages"in n.template))throw new Error("Prompt template does not contain messages");const l=[],{assignmentOperator:t,removeKeyQuotes:i,stringQuote:r}=a;if(n.modelName&&l.push(`model${t}${r}${n.modelName}${r}`),n.invocationParameters){const d=Object.entries(n.invocationParameters).map(([c,g])=>typeof g=="string"?`${c}${t}${r}${g}${r}`:bi(g)?`${c}${t}${Ql({json:g,level:1,removeKeyQuotes:i})}`:`${c}${t}${g}`);l.push(...d)}let s="";if(n.template.messages.length>0&&(s=Ql({json:n.template.messages,level:0,removeKeyQuotes:i}),l.push(t==="="?"messages=messages":"messages")),n.tools&&n.tools.length>0){const d=Ql({json:n.tools.map(c=>c.definition),level:1,removeKeyQuotes:i});l.push(`tools${t}${d}`)}if(n.responseFormat&&"definition"in n.responseFormat){const d=Ql({json:n.responseFormat.definition,level:1,removeKeyQuotes:i});l.push(`response_format${t}${d}`)}return{args:l,messages:s}},zr=n=>"tool_calls"in n&&n.tool_calls?{...n,tool_calls:n.tool_calls.map(a=>({...a,function:{...a.function,arguments:JSON.stringify(a.function.arguments)}}))}:n,h1={python:{openai:n=>{const a=ya.python.openai,l={...n,template:{...n.template,messages:n.template.messages.map(r=>zr(r))}},{args:t,messages:i}=Bl(l,a);return a.sdkTemplate({tab:zn,args:t,messages:i})},anthropic:n=>{const a=ya.python.anthropic,{args:l,messages:t}=Bl(n,a);return a.sdkTemplate({tab:zn,args:l,messages:t})}},typescript:{openai:n=>{const a=ya.typescript.openai,l={...n,template:{...n.template,messages:n.template.messages.map(r=>zr(r))}},{args:t,messages:i}=Bl(l,a);return a.sdkTemplate({tab:zn,args:t,messages:i})},anthropic:n=>{const a=ya.typescript.anthropic,{args:l,messages:t}=Bl(n,a);return a.sdkTemplate({tab:zn,args:l,messages:t})}}},k1={python:{openai:n=>ya.python.openai.clientTemplate({tab:zn,versionId:n.versionId}),anthropic:n=>ya.python.openai.clientTemplate({tab:zn,versionId:n.versionId})},typescript:{openai:n=>ya.typescript.openai.clientTemplate({tab:zn,versionId:n.versionId}),anthropic:n=>ya.typescript.anthropic.clientTemplate({tab:zn,versionId:n.versionId})}},b1=({promptVersion:n,language:a})=>{var i;const l=h1[a.toLocaleLowerCase()][(i=n.modelProvider)==null?void 0:i.toLocaleLowerCase()];if(!l||!("messages"in n.template))return null;const t={...n,template:{...n.template,messages:n.template.messages.map(r=>{try{return s1({message:gc.parse(r),targetProvider:n.modelProvider})}catch(s){return console.warn("Cannot convert message"),console.error(s),null}}).filter(Boolean)}};return l(t)};function S1({promptVersion:n,language:a}){var i;const l=k1[a.toLocaleLowerCase()][(i=n.modelProvider)==null?void 0:i.toLocaleLowerCase()];if(!l)return null;const t={versionId:n.id};return l(t)}function pc({promptVersion:n}){const[a,l]=m.useState("Python"),t=T.useFragment(cc,n),i=m.useMemo(()=>b1({promptVersion:t,language:a}),[t,a]),r=m.useMemo(()=>S1({promptVersion:t,language:a}),[t,a]);return e(q,{title:"Code",variant:"compact",bodyStyle:{padding:0},extra:e(b,{gap:"size-100",alignItems:"center",children:e(tl,{language:a,onChange:l,size:"S"})}),children:o(Cn,{defaultExpandedKeys:["sdk-inline","client"],children:[o(fe,{id:"sdk-inline",children:[e(pe,{arrowPosition:"start",children:o(b,{direction:"row",justifyContent:"space-between",alignItems:"center",gap:"size-100",width:"100%",children:[e(F,{children:"SDK Inline"}),i?e(de,{text:i}):null]})}),e(ye,{children:i==null?e(v,{width:"100%",padding:"size-200",children:e(F,{color:"text-300",children:"No code snippet available for this prompt"})}):e(Nr,{language:a,value:i})})]}),o(fe,{id:"client",children:[e(pe,{arrowPosition:"start",children:o(b,{direction:"row",justifyContent:"space-between",alignItems:"center",width:"100%",gap:"size-100",children:[e(F,{children:"Using the Client"}),r?e(de,{text:r}):null]})}),e(ye,{children:r==null?e(v,{width:"100%",padding:"size-200",children:e(F,{color:"text-300",children:"No client code snippet available for this prompt"})}):e(Nr,{language:a,value:r})})]})]})})}function Nr({language:n,value:a}){switch(n){case"Python":return e(wo,{value:a,basicSetup:{lineNumbers:!0}});case"TypeScript":return e(Qy,{value:a,basicSetup:{lineNumbers:!0}});default:Te()}}const yc={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"PromptLatestVersionsListFragment",selections:[{alias:"latestVersions",args:[{kind:"Literal",name:"first",value:5}],concreteType:"PromptVersionConnection",kind:"LinkedField",name:"promptVersions",plural:!1,selections:[{alias:null,args:null,concreteType:"PromptVersionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"version",args:null,concreteType:"PromptVersion",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"sequenceNumber",storageKey:null},{args:null,kind:"FragmentSpread",name:"PromptVersionSummaryFragment"}],storageKey:null}],storageKey:null}],storageKey:"promptVersions(first:5)"}],type:"Prompt",abstractKey:null};yc.hash="a473a6f0d927379542694312449a4c63";const fc=function(){var n={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"PromptVersionSummaryFragment",selections:[n,{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"sequenceNumber",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"user",plural:!1,selections:[n,{alias:null,args:null,kind:"ScalarField",name:"username",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"profilePictureUrl",storageKey:null}],storageKey:null},{args:null,kind:"FragmentSpread",name:"PromptVersionTagsList_data"}],type:"PromptVersion",abstractKey:null}}();fc.hash="80901eff49852a413f643ee876638174";const hc={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"PromptVersionTagsList_data",selections:[{alias:null,args:null,concreteType:"PromptVersionTag",kind:"LinkedField",name:"tags",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],storageKey:null}],type:"PromptVersion",abstractKey:null};hc.hash="25265fbc7ea915534615a56b4331236e";function kc({promptVersion:n}){const a=T.useFragment(hc,n);return e(b,{direction:"row",gap:"size-50",alignItems:"center",wrap:"wrap",children:a.tags.map(l=>e(v1,{children:l.name},l.id))})}function v1({children:n}){const a=m.useMemo(()=>{switch(n){case"production":return"var(--ac-global-color-green-1000)";case"staging":return"var(--ac-global-color-yellow-1000)";case"development":return"var(--ac-global-color-blue-1000)";default:return"var(--ac-global-color-grey-900)"}},[n]);return e(Tn,{color:a,children:n})}function bc(n){const a=T.useFragment(fc,n.promptVersion);return o(b,{direction:"column",gap:"size-50",children:[e(v,{width:"100%",children:e(b,{direction:"row",justifyContent:"space-between",alignItems:"center",width:"100%",children:o(b,{direction:"row",gap:"size-100",alignItems:"center",children:[e(Tn,{color:"var(--ac-global-color-blue-900)",children:a.sequenceNumber}),e("span",{children:`${a.id}`})]})})}),e(v,{"data-testid":"prompt-version-item-description",paddingStart:"size-400",children:o(b,{direction:"column",gap:"size-100",children:[e(an,{maxWidth:"100%",children:e(F,{color:"text-700",size:"XS",children:a.description||"No Description"})}),o(b,{justifyContent:"space-between",alignItems:"center",gap:"size-100",children:[e(kc,{promptVersion:a}),o(b,{direction:"row",gap:"size-100",alignItems:"center",flex:"none",children:[a.user&&o(b,{direction:"row",gap:"size-50",alignItems:"center",children:[e(ut,{size:14,name:a.user.username,profilePictureUrl:a.user.profilePictureUrl}),e(F,{size:"XS",children:a.user.username})]}),e(F,{color:"text-300",size:"XS",children:Tp(a.createdAt,Date.now())})]})]})]})})]})}const F1=5,C1=K`
  padding-bottom: var(--ac-global-dimension-size-200);
  position: relative;
`;function K1(n){const{prompt:a}=n,l=T.useFragment(yc,a),t=m.useMemo(()=>{var i,r;return(r=(i=l==null?void 0:l.latestVersions)==null?void 0:i.edges)==null?void 0:r.map(s=>s.version)},[l]);if(!t)throw new Error("Expected prompt versions to be defined");return o("div",{children:[e("ul",{children:t.map((i,r)=>{const s=r===F1-1;return o("li",{css:C1,children:[e(bc,{promptVersion:i}),i.sequenceNumber!=1?e(P1,{isLastConnector:s}):null]},i.id)})}),e(b,{direction:"row",justifyContent:"end",children:e(we,{to:"versions",children:"View all versions"})})]})}const T1=K`
  position: absolute;
  top: 25px;
  left: 11px;
  height: calc(100% - 32px);
  width: 2px;
  --connector-color: var(--ac-global-color-grey-400);
  background: repeating-linear-gradient(
      to bottom,
      transparent 0 4px,
      var(--ac-global-color-grey-50) 4px 8px
    ),
    var(--connector-color);
  background-size: 4px 100%;
  background-position: 80%;
  background-repeat: no-repeat;
  &[data-last="true"] {
    background: repeating-linear-gradient(
        to bottom,
        transparent 0 4px,
        var(--ac-global-color-grey-50) 4px 8px
      ),
      linear-gradient(to bottom, var(--connector-color), transparent);
  }
`;function P1({isLastConnector:n}){return e("div",{css:T1,"data-last":n})}const Xi=()=>{const a=Pp().find(l=>l.pathname.split("/prompts/").length===2);if(!a)throw new Error("usePromptIdLoader must be used within a /prompts/:promptId route");return xp(a.id)};function AT(){const n=Xi();return e(x1,{prompt:n.prompt})}function x1({prompt:n}){var t,i,r;const a=T.useFragment(Jd,n),l=(r=(i=(t=a==null?void 0:a.promptVersions)==null?void 0:t.edges)==null?void 0:i[0])==null?void 0:r.node;return o(b,{direction:"row",height:"100%",children:[e(v,{height:"100%",overflow:"auto",width:"100%","data-testid":"scroll-container",children:e(v,{padding:"size-200",children:o(b,{direction:"column",gap:"size-200",marginStart:"auto",marginEnd:"auto",maxWidth:900,children:[e(dc,{title:"Prompt Template",promptVersion:l}),e(ac,{promptVersion:l}),e(pc,{promptVersion:l})]})})}),e(I1,{prompt:a})]})}function I1({prompt:n}){const a=T.useFragment(Wd,n),l=!!(a!=null&&a.description);return e(v,{flex:"none",width:400,borderStartColor:"dark",borderStartWidth:"thin",children:o(v,{paddingStart:"size-200",paddingEnd:"size-200",children:[o(b,{direction:"row",justifyContent:"space-between",alignItems:"center",children:[e(ur,{level:3,children:"Description"}),e(Bk,{prompt:a})]}),e(F,{color:l?"text-900":"text-700",children:a.description||"No Description"}),o("section",{children:[e(ur,{level:3,children:"Latest Versions"}),e(K1,{prompt:a})]})]})})}const Sc=function(){var n={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},a={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null};return{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"PromptLayout__main",selections:[n,a,{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,concreteType:"Prompt",kind:"LinkedField",name:"sourcePrompt",plural:!1,selections:[n,a],storageKey:null},{alias:null,args:null,concreteType:"PromptVersionConnection",kind:"LinkedField",name:"promptVersions",plural:!1,selections:[{alias:null,args:null,concreteType:"PromptVersionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"PromptVersion",kind:"LinkedField",name:"node",plural:!1,selections:[n],storageKey:null}],storageKey:null}],storageKey:null}],type:"Prompt",abstractKey:null}}();Sc.hash="3f2a7eb87a4a433362def455a9151d45";const vc=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"Prompt",kind:"LinkedField",name:"clonePrompt",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ClonePromptDialogMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ClonePromptDialogMutation",selections:a},params:{cacheID:"6ad0382f6acd0f00125307c887c0f4f2",id:null,metadata:{},name:"ClonePromptDialogMutation",operationKind:"mutation",text:`mutation ClonePromptDialogMutation(
  $input: ClonePromptInput!
) {
  clonePrompt(input: $input) {
    id
  }
}
`}}}();vc.hash="081b8cf05c35b46579fe5cbb85f7a761";const D1=({promptId:n,promptName:a,promptDescription:l,setDialog:t})=>{var k;const i=me(),r=ce(),[s,d]=T.useMutation(vc),c=Ve({disabled:d,reValidateMode:"onBlur",mode:"onChange",defaultValues:{name:`${a}-clone`,description:l}}),{control:g,handleSubmit:f,formState:{isValid:u,errors:p},setError:y}=c,h=f(S=>{s({variables:{input:{promptId:n,name:S.name,description:S.description}},onCompleted:C=>{t(null),i({title:"Prompt cloned successfully",action:{text:"View Prompt",onClick:()=>{r(`/prompts/${C.clonePrompt.id}`)}}})},onError:C=>{var L;const P=De(C);(L=P==null?void 0:P[0])!=null&&L.includes("already exists")?y("name",{message:P==null?void 0:P[0]}):y("root",{message:P==null?void 0:P[0]})}})});return e(oe,{title:"Clone Prompt",children:e(m.Suspense,{fallback:e(ge,{}),children:e(v,{padding:"size-200",children:o("form",{onSubmit:h,children:[e(G,{control:g,name:"name",rules:{required:{message:"Name is required",value:!0},validate:{unique:S=>S.trim()===a.trim()?"Name must be different from the original prompt name":!0}},render:({field:{onChange:S,onBlur:C,value:P,disabled:L},fieldState:{error:_}})=>o(ee,{isInvalid:!!(_!=null&&_.message),children:[e(H,{children:"Name"}),e(X,{name:"name",type:"text",onChange:S,onBlur:C,value:P,disabled:L}),!_&&e(F,{slot:"description",children:"A name for the cloned prompt."}),e(ke,{children:_==null?void 0:_.message})]})}),e(G,{control:g,name:"description",render:({field:{onChange:S,onBlur:C,value:P,disabled:L},fieldState:{error:_}})=>o(ee,{isInvalid:!!(_!=null&&_.message),isDisabled:L,value:P,onChange:S,onBlur:C,children:[e(H,{children:"Description"}),e(Pa,{name:"description"}),!_&&e(F,{slot:"description",children:"A description for the cloned prompt."}),e(ke,{children:_==null?void 0:_.message})]})}),(p==null?void 0:p.root)&&e(F,{color:"danger",children:(k=p==null?void 0:p.root)==null?void 0:k.message}),o(b,{direction:"row",justifyContent:"end",gap:"size-100",children:[e(M,{variant:"default",onPress:()=>t(null),isDisabled:d,children:"Cancel"}),e(M,{type:"submit",variant:"primary",isDisabled:!u,isPending:d,children:"Clone"})]})]})})})})},L1=K`
  flex: 1 1 auto;
  display: flex;
  flex-direction: column;
  overflow: hidden;
  .ac-tabs {
    flex: 1 1 auto;
    overflow: hidden;
    display: flex;
    flex-direction: column;
    div[role="tablist"] {
      flex: none;
    }
    .ac-tabs__pane-container {
      flex: 1 1 auto;
      display: flex;
      flex-direction: column;
      overflow: hidden;
      div[role="tabpanel"]:not([hidden]) {
        flex: 1 1 auto;
        display: flex;
        flex-direction: column;
        overflow: hidden;
      }
    }
  }
`;function wT(){const[n,a]=m.useState(null),l=Xi(),t=ce(),{pathname:i}=al();let r="prompt";i.includes("versions")?r="versions":i.includes("config")&&(r="config");const s=T.useFragment(Sc,l.prompt);return o("main",{css:L1,children:[e(v,{paddingStart:"size-200",paddingEnd:"size-200",paddingTop:"size-100",paddingBottom:"size-100",flex:"none",children:o(b,{direction:"row",justifyContent:"space-between",alignItems:"center",children:[o(b,{direction:"column",children:[e(ae,{level:1,children:l.prompt.name}),s.sourcePrompt&&o(F,{color:"text-700",children:["cloned from"," ",e(we,{to:`/prompts/${s.sourcePrompt.id}`,children:s.sourcePrompt.name})]})]}),o(b,{direction:"row",gap:"size-100",children:[e(M,{size:"S",leadingVisual:e(I,{svg:e(By,{})}),onPress:()=>{a(e(D1,{promptId:s.id,promptName:s.name,promptDescription:s.description??void 0,setDialog:a}))},children:"Clone"}),e(M,{size:"S",leadingVisual:e(I,{svg:e(kt,{})}),onPress:()=>{t(`/prompts/${l.prompt.id}/playground`)},children:"Edit in Playground"})]})]})}),o(cn,{defaultSelectedKey:r,onSelectionChange:d=>{let c;d==="versions"?c=`/prompts/${l.prompt.id}/versions`:d==="config"?c=`/prompts/${l.prompt.id}/config`:c=`/prompts/${l.prompt.id}`,t(c)},children:[o(dn,{children:[e(le,{id:"prompt",children:"Prompt"}),o(le,{id:"versions",children:["Versions ",e(Ln,{children:s.promptVersions.edges.length})]}),e(le,{id:"config",children:"Config"})]}),e(re,{id:"prompt",children:e(ve,{})}),e(re,{id:"versions",children:e(ve,{})}),e(re,{id:"config",children:e(ve,{})})]}),e(ue,{onDismiss:()=>a(null),children:n})]})}const Fc=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"modelsInput"}],a={alias:null,args:null,kind:"ScalarField",name:"invocationInputField",storageKey:null},l={alias:"floatDefaultValue",args:null,kind:"ScalarField",name:"defaultValue",storageKey:null},t=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"modelsInput"}],concreteType:null,kind:"LinkedField",name:"modelInvocationParameters",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"invocationName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"canonicalName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"required",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null}],type:"InvocationParameterBase",abstractKey:"__isInvocationParameterBase"},{kind:"InlineFragment",selections:[{alias:"booleanDefaultValue",args:null,kind:"ScalarField",name:"defaultValue",storageKey:null},a],type:"BooleanInvocationParameter",abstractKey:null},{kind:"InlineFragment",selections:[l,a,{alias:null,args:null,kind:"ScalarField",name:"minValue",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"maxValue",storageKey:null}],type:"BoundedFloatInvocationParameter",abstractKey:null},{kind:"InlineFragment",selections:[l,a],type:"FloatInvocationParameter",abstractKey:null},{kind:"InlineFragment",selections:[{alias:"intDefaultValue",args:null,kind:"ScalarField",name:"defaultValue",storageKey:null},a],type:"IntInvocationParameter",abstractKey:null},{kind:"InlineFragment",selections:[{alias:"jsonDefaultValue",args:null,kind:"ScalarField",name:"defaultValue",storageKey:null},a],type:"JSONInvocationParameter",abstractKey:null},{kind:"InlineFragment",selections:[{alias:"stringDefaultValue",args:null,kind:"ScalarField",name:"defaultValue",storageKey:null},a],type:"StringInvocationParameter",abstractKey:null},{kind:"InlineFragment",selections:[{alias:"stringListDefaultValue",args:null,kind:"ScalarField",name:"defaultValue",storageKey:null},a],type:"StringListInvocationParameter",abstractKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"fetchPlaygroundPromptSupportedInvocationParametersQuery",selections:t,type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"fetchPlaygroundPromptSupportedInvocationParametersQuery",selections:t},params:{cacheID:"530366c9a8cc3b47d685ca0600a39bb5",id:null,metadata:{},name:"fetchPlaygroundPromptSupportedInvocationParametersQuery",operationKind:"query",text:`query fetchPlaygroundPromptSupportedInvocationParametersQuery(
  $modelsInput: ModelsInput!
) {
  modelInvocationParameters(input: $modelsInput) {
    __typename
    ... on InvocationParameterBase {
      __isInvocationParameterBase: __typename
      invocationName
      canonicalName
      required
      label
    }
    ... on BooleanInvocationParameter {
      booleanDefaultValue: defaultValue
      invocationInputField
    }
    ... on BoundedFloatInvocationParameter {
      floatDefaultValue: defaultValue
      invocationInputField
      minValue
      maxValue
    }
    ... on FloatInvocationParameter {
      floatDefaultValue: defaultValue
      invocationInputField
    }
    ... on IntInvocationParameter {
      intDefaultValue: defaultValue
      invocationInputField
    }
    ... on JSONInvocationParameter {
      jsonDefaultValue: defaultValue
      invocationInputField
    }
    ... on StringInvocationParameter {
      stringDefaultValue: defaultValue
      invocationInputField
    }
    ... on StringListInvocationParameter {
      stringListDefaultValue: defaultValue
      invocationInputField
    }
  }
}
`}}}();Fc.hash="1138fb98386e86196eaa52c12a6bb27c";const Cc=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"promptId"}],a=[{kind:"Variable",name:"id",variableName:"promptId"}],l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},s=[{alias:null,args:null,kind:"ScalarField",name:"definition",storageKey:null}],d={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},c={alias:null,args:null,kind:"ScalarField",name:"toolCallId",storageKey:null},g={alias:null,args:null,concreteType:"PromptVersion",kind:"LinkedField",name:"version",plural:!1,selections:[l,r,{alias:null,args:null,kind:"ScalarField",name:"modelName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"modelProvider",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"invocationParameters",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"templateType",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"templateFormat",storageKey:null},{alias:null,args:null,concreteType:"ResponseFormat",kind:"LinkedField",name:"responseFormat",plural:!1,selections:s,storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"template",plural:!1,selections:[d,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"PromptMessage",kind:"LinkedField",name:"messages",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"role",storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"content",plural:!0,selections:[d,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"TextContentValue",kind:"LinkedField",name:"text",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"text",storageKey:null}],storageKey:null}],type:"TextContentPart",abstractKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"ToolCallContentValue",kind:"LinkedField",name:"toolCall",plural:!1,selections:[c,{alias:null,args:null,concreteType:"ToolCallFunction",kind:"LinkedField",name:"toolCall",plural:!1,selections:[t,{alias:null,args:null,kind:"ScalarField",name:"arguments",storageKey:null}],storageKey:null}],storageKey:null}],type:"ToolCallContentPart",abstractKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"ToolResultContentValue",kind:"LinkedField",name:"toolResult",plural:!1,selections:[c,{alias:null,args:null,kind:"ScalarField",name:"result",storageKey:null}],storageKey:null}],type:"ToolResultContentPart",abstractKey:null}],storageKey:null}],storageKey:null}],type:"PromptChatTemplate",abstractKey:null}],storageKey:null},{alias:null,args:null,concreteType:"ToolDefinition",kind:"LinkedField",name:"tools",plural:!0,selections:s,storageKey:null}],storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"fetchPlaygroundPromptQuery",selections:[{alias:"prompt",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{kind:"InlineFragment",selections:[l,t,i,r,g],type:"Prompt",abstractKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"fetchPlaygroundPromptQuery",selections:[{alias:"prompt",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[d,l,{kind:"InlineFragment",selections:[t,i,r,g],type:"Prompt",abstractKey:null}],storageKey:null}]},params:{cacheID:"3d4a14b5f7a3b1c5629e3bf47645a2b4",id:null,metadata:{},name:"fetchPlaygroundPromptQuery",operationKind:"query",text:`query fetchPlaygroundPromptQuery(
  $promptId: ID!
) {
  prompt: node(id: $promptId) {
    __typename
    ... on Prompt {
      id
      name
      createdAt
      description
      version {
        id
        description
        modelName
        modelProvider
        invocationParameters
        templateType
        templateFormat
        responseFormat {
          definition
        }
        template {
          __typename
          ... on PromptChatTemplate {
            messages {
              role
              content {
                __typename
                ... on TextContentPart {
                  text {
                    text
                  }
                }
                ... on ToolCallContentPart {
                  toolCall {
                    toolCallId
                    toolCall {
                      name
                      arguments
                    }
                  }
                }
                ... on ToolResultContentPart {
                  toolResult {
                    toolCallId
                    result
                  }
                }
              }
            }
          }
        }
        tools {
          definition
        }
      }
    }
    id
  }
}
`}}}();Cc.hash="5b21b9860cae9ec899aaa18ba9c73787";const _1=n=>{switch(n){case"user":return"USER";case"ai":return"AI";case"system":return"SYSTEM";case"tool":return"TOOL";default:return"USER"}},A1=(n,a)=>{const l=a.length>0?a.reduce((t,i)=>(i.invocationName&&(t[i.invocationName]=i),t),{}):{};return Object.entries(n).map(([t,i])=>{const r=l[t];return!r||!r.invocationInputField?{invocationName:t,valueJson:i}:{invocationName:t,canonicalName:r.canonicalName,[cl(r.invocationInputField)]:i}})},w1=({promptId:n,promptName:a,promptVersion:l,supportedInvocationParameters:t})=>{var c,g;const i={...qy(),prompt:{id:n,name:a}},r=l.modelName,s=l.modelProvider,d=Si({toolChoice:(c=l.invocationParameters)==null?void 0:c.tool_choice,targetProvider:s})??void 0;return{...i,model:{...i.model,modelName:r,provider:s,supportedInvocationParameters:t||[],invocationParameters:A1({...l.invocationParameters,...(g=l.responseFormat)!=null&&g.definition?{response_format:l.responseFormat.definition}:{}},t||[])},template:{__type:"chat",messages:"messages"in l.template?l.template.messages.map(f=>{const u=f.content.map(wt).filter(Boolean).map(S=>S.text.text).join(""),p=f.content.filter(Gi).filter(Boolean),h=f.content.filter(Wi).filter(Boolean).at(0),k=pa(f.role);return k==="tool"&&h?{id:fa(),role:pa(f.role),content:typeof h.toolResult.result=="string"?h.toolResult.result:jn(h.toolResult.result,null,2).json||"",toolCallId:h.toolResult.toolCallId}:k==="ai"&&p.length>0?{id:fa(),role:pa(f.role),toolCalls:p.map(S=>Ao(S,s))}:{id:fa(),role:pa(f.role),content:u}}):[]},tools:l.tools.map(f=>({id:vl(),definition:f.definition})),toolChoice:d}},R1=(n,a)=>{const l=a.length>0?a.reduce((t,i)=>((i.canonicalName||i.invocationName)&&(t[i.canonicalName||i.invocationName]=i),t),{}):{};return n.reduce((t,i)=>{const r=l[i.canonicalName||i.invocationName];return r&&(t[i.invocationName]=i[cl(r.invocationInputField)]),t},{})},E1=[{invocationName:Za,canonicalName:ba},{invocationName:Vn,canonicalName:Nn}],M1=n=>{if(n.template.__type==="text_completion")return console.warn("Instance to prompt version conversion not supported for text completion"),null;const a=n.template.messages.map(t=>{var d;let i=[t.content?rc(t.content):null];const r=((d=t.toolCalls)==null?void 0:d.map(oc))||[],s=t.toolCallId?[sc(t.toolCallId,t.content)]:[];return(r.length>0||s.length>0)&&(i=[]),{content:[...i,...r,...s].filter(c=>c!==null),role:_1(t.role)}});return{modelName:n.model.modelName||Uy,modelProvider:n.model.provider,template:{messages:a},tools:n.tools.map(t=>({definition:t.definition})),responseFormat:n.model.invocationParameters.filter(t=>t.canonicalName===Nn||t.invocationName===Vn).map(t=>({definition:t.valueJson})).at(0)||void 0,invocationParameters:R1(Es(n.model.invocationParameters.filter(t=>!E1.some(i=>Ca(i,t))).concat(n.toolChoice?[{invocationName:Za,valueJson:n.toolChoice,canonicalName:ba}]:[]),n.model.provider,n.model.modelName),n.model.supportedInvocationParameters)}},V1=Cc,z1=Fc,N1=async({modelName:n,providerKey:a})=>{const l=await T.fetchQuery(he,z1,{modelsInput:{modelName:n,providerKey:a}}).toPromise();return l==null?void 0:l.modelInvocationParameters},$1=async n=>T.fetchQuery(he,V1,{promptId:n}).toPromise(),j1=n=>n?n==null?void 0:n.version:null,Kc=async n=>{var t;if(!n)return null;const a=await $1(n),l=j1(a==null?void 0:a.prompt);if(l&&l.templateType==="CHAT"){const i=await N1({modelName:l.modelName,providerKey:l.modelProvider}),r=(t=a==null?void 0:a.prompt)==null?void 0:t.name;if(!r)throw new Error("Prompt name is required");return{instance:w1({promptId:n,promptName:r,promptVersion:l,supportedInvocationParameters:i}),promptVersion:l}}return null},RT=async({params:n})=>{const{promptId:a}=n;if(!a)throw new Error("Prompt ID is required");const l=await Kc(a);if(!l)throw new Error("Prompt not found");return{instanceWithPrompt:l.instance,templateFormat:l.promptVersion.templateFormat}},Tc=function(){var n=[{alias:null,args:null,concreteType:"GenerativeProvider",kind:"LinkedField",name:"modelProviders",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"dependenciesInstalled",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"dependencies",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"PlaygroundQuery",selections:n,type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"PlaygroundQuery",selections:n},params:{cacheID:"f19ebe151a3a9794fa2566c66751d259",id:null,metadata:{},name:"PlaygroundQuery",operationKind:"query",text:`query PlaygroundQuery {
  modelProviders {
    name
    dependenciesInstalled
    dependencies
  }
}
`}}}();Tc.hash="9802d9d44657ca300abc1be4d0938560";const Zi=m.createContext(null);function O1({children:n,...a}){const[l]=m.useState(()=>Hy(a));return e(Zi.Provider,{value:l,children:n})}function O(n,a){const l=m.useContext(Zi);if(!l)throw new Error("Missing PlaygroundContext.Provider in the tree");return Ll(l,n,a)}function ul(){const n=m.useContext(Zi);if(!n)throw new Error("Missing PlaygroundContext.Provider in the tree");return n}const Pc=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"exampleId"}],a=[{kind:"Variable",name:"id",variableName:"exampleId"}],l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"output",storageKey:null},i={alias:"latestRevision",args:null,concreteType:"DatasetExampleRevision",kind:"LinkedField",name:"revision",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"input",storageKey:null},t,{alias:null,args:null,kind:"ScalarField",name:"metadata",storageKey:null}],storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"traceId",storageKey:null},s={alias:null,args:null,concreteType:"Span",kind:"LinkedField",name:"span",plural:!1,selections:[l,{alias:null,args:null,concreteType:"Trace",kind:"LinkedField",name:"trace",plural:!1,selections:[l,r,{alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"project",plural:!1,selections:[l],storageKey:null}],storageKey:null}],storageKey:null},d={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},c=[{kind:"Literal",name:"first",value:100}],g={alias:null,args:null,concreteType:"Trace",kind:"LinkedField",name:"trace",plural:!1,selections:[l,r,{alias:null,args:null,kind:"ScalarField",name:"projectId",storageKey:null}],storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ExampleDetailsDialogQuery",selections:[{alias:"example",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{kind:"InlineFragment",selections:[l,i,s],type:"DatasetExample",abstractKey:null},{args:null,kind:"FragmentSpread",name:"ExampleExperimentRunsTableFragment"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ExampleDetailsDialogQuery",selections:[{alias:"example",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[d,l,{kind:"InlineFragment",selections:[i,s,{alias:null,args:c,concreteType:"ExperimentRunConnection",kind:"LinkedField",name:"experimentRuns",plural:!1,selections:[{alias:null,args:null,concreteType:"ExperimentRunEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"run",args:null,concreteType:"ExperimentRun",kind:"LinkedField",name:"node",plural:!1,selections:[l,{alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"endTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"error",storageKey:null},t,g,{alias:null,args:null,concreteType:"ExperimentRunAnnotationConnection",kind:"LinkedField",name:"annotations",plural:!1,selections:[{alias:null,args:null,concreteType:"ExperimentRunAnnotationEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"annotation",args:null,concreteType:"ExperimentRunAnnotation",kind:"LinkedField",name:"node",plural:!1,selections:[l,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"score",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"explanation",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"annotatorKind",storageKey:null},g],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"ExperimentRun",kind:"LinkedField",name:"node",plural:!1,selections:[d,l],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:"experimentRuns(first:100)"},{alias:null,args:c,filters:null,handle:"connection",key:"ExampleExperimentRunsTable_experimentRuns",kind:"LinkedHandle",name:"experimentRuns"}],type:"DatasetExample",abstractKey:null}],storageKey:null}]},params:{cacheID:"f869d5bb867a61b662bb547718dd69e2",id:null,metadata:{},name:"ExampleDetailsDialogQuery",operationKind:"query",text:`query ExampleDetailsDialogQuery(
  $exampleId: ID!
) {
  example: node(id: $exampleId) {
    __typename
    ... on DatasetExample {
      id
      latestRevision: revision {
        input
        output
        metadata
      }
      span {
        id
        trace {
          id
          traceId
          project {
            id
          }
        }
      }
    }
    ...ExampleExperimentRunsTableFragment
    id
  }
}

fragment ExampleExperimentRunsTableFragment on DatasetExample {
  experimentRuns(first: 100) {
    edges {
      run: node {
        id
        startTime
        endTime
        error
        output
        trace {
          id
          traceId
          projectId
        }
        annotations {
          edges {
            annotation: node {
              id
              name
              label
              score
              explanation
              annotatorKind
              trace {
                id
                traceId
                projectId
              }
            }
          }
        }
      }
      cursor
      node {
        __typename
        id
      }
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
  id
}
`}}}();Pc.hash="6d46e4ae967aef17925132308b2b0573";const mn="selectedSpanNodeId",xc=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"DatasetMutationPayload",kind:"LinkedField",name:"patchDatasetExamples",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"EditExampleDialogMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"EditExampleDialogMutation",selections:a},params:{cacheID:"7217082d3d3796ecb60481d17133c351",id:null,metadata:{},name:"EditExampleDialogMutation",operationKind:"mutation",text:`mutation EditExampleDialogMutation(
  $input: PatchDatasetExamplesInput!
) {
  patchDatasetExamples(input: $input) {
    __typename
  }
}
`}}}();xc.hash="a5e0e601ed24ffaa37a99ba358f960d3";const Ut={backgroundColor:"light",borderColor:"light",collapsible:!0,bodyStyle:{padding:0}};function Q1(n){const{exampleId:a,onCompleted:l}=n,[t,i]=m.useState(null),[r,s]=T.useMutation(xc),{control:d,setError:c,handleSubmit:g,formState:{isValid:f}}=Ve({defaultValues:n.currentRevision}),u=m.useCallback(p=>{if(i(null),!Zn(p==null?void 0:p.input))return c("input",{message:"Input must be a valid JSON object"});if(!Zn(p==null?void 0:p.output))return c("output",{message:"Output must be a valid JSON object"});if(!Zn(p==null?void 0:p.metadata))return c("metadata",{message:"Metadata must be a valid JSON object"});r({variables:{input:{patches:[{exampleId:a,input:JSON.parse(p.input),output:JSON.parse(p.output),metadata:JSON.parse(p.metadata)}],versionDescription:p.description}},onCompleted:()=>{l()},onError:y=>{i(y.message)}})},[r,a,c,l]);return e(oe,{size:"fullscreen",title:`Edit Example: ${a}`,extra:e(M,{variant:"primary",size:"S",isDisabled:!f||s,leadingVisual:e(I,{svg:s?e(sn,{}):e(Ro,{})}),onPress:()=>g(u)(),children:"Save Changes"}),children:e("div",{css:K`
          overflow-y: auto;
          padding: var(--ac-global-dimension-size-400);
          /* Make widths configurable */
          .dataset-picker {
            width: 100%;
            .ac-dropdown--picker,
            .ac-dropdown-button {
              width: 100%;
            }
          }
        `,children:e(b,{direction:"row",justifyContent:"center",children:e(v,{width:"900px",paddingStart:"auto",paddingEnd:"auto",children:o(b,{direction:"column",gap:"size-200",children:[t?e(Fe,{variant:"danger",children:t}):null,e(G,{control:d,name:"input",render:({field:{onChange:p,onBlur:y,value:h},fieldState:{invalid:k,error:S}})=>o(q,{title:"Input",subTitle:"The input to the LLM, retriever, program, etc.",...Ut,children:[k?e(Fe,{variant:"danger",banner:!0,children:S==null?void 0:S.message}):null,e(rn,{value:h,onChange:p,onBlur:y})]})}),e(G,{control:d,name:"output",render:({field:{onChange:p,onBlur:y,value:h},fieldState:{invalid:k,error:S}})=>o(q,{title:"Output",subTitle:"The output of the LLM or program to be used as an expected output",...Ut,backgroundColor:"green-100",borderColor:"green-700",children:[k?e(Fe,{variant:"danger",banner:!0,children:S==null?void 0:S.message}):null,e(rn,{value:h,onChange:p,onBlur:y})]})}),e(G,{control:d,name:"metadata",render:({field:{onChange:p,onBlur:y,value:h},fieldState:{invalid:k,error:S}})=>o(q,{title:"Metadata",subTitle:"All data from the span to use during experimentation or evaluation",...Ut,children:[k?e(Fe,{variant:"danger",banner:!0,children:S==null?void 0:S.message}):null,e(rn,{value:h,onChange:p,onBlur:y})]})}),e(G,{control:d,name:"description",render:({field:{onChange:p,onBlur:y,value:h},fieldState:{invalid:k,error:S}})=>o(ee,{value:h,onChange:p,onBlur:y,isInvalid:k,children:[e(H,{children:"Revision Description"}),e(Pa,{}),S?e(ke,{children:S==null?void 0:S.message}):e(F,{slot:"description",children:"A description of the changes made in this revision. Will be displayed in the version history."})]})})]})})})})})}function B1(n){const{onCompleted:a,...l}=n,[t,i]=m.useState(null);return o(J,{children:[e(M,{size:"S",leadingVisual:e(I,{svg:e(ja,{})}),onPress:()=>i(e(Q1,{...l,onCompleted:()=>{i(null),a()}})),children:"Edit Example"}),e(ue,{type:"slideOver",isDismissable:!0,onDismiss:()=>i(null),children:t})]})}const Ic=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"after"},{defaultValue:100,kind:"LocalArgument",name:"first"},{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}],l=[{kind:"Variable",name:"after",variableName:"after"},{kind:"Variable",name:"first",variableName:"first"}],t={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},r={alias:null,args:null,concreteType:"Trace",kind:"LinkedField",name:"trace",plural:!1,selections:[i,{alias:null,args:null,kind:"ScalarField",name:"traceId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"projectId",storageKey:null}],storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ExampleExperimentRunsTableQuery",selections:[{alias:null,args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:l,kind:"FragmentSpread",name:"ExampleExperimentRunsTableFragment"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ExampleExperimentRunsTableQuery",selections:[{alias:null,args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[t,i,{kind:"InlineFragment",selections:[{alias:null,args:l,concreteType:"ExperimentRunConnection",kind:"LinkedField",name:"experimentRuns",plural:!1,selections:[{alias:null,args:null,concreteType:"ExperimentRunEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"run",args:null,concreteType:"ExperimentRun",kind:"LinkedField",name:"node",plural:!1,selections:[i,{alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"endTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"error",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"output",storageKey:null},r,{alias:null,args:null,concreteType:"ExperimentRunAnnotationConnection",kind:"LinkedField",name:"annotations",plural:!1,selections:[{alias:null,args:null,concreteType:"ExperimentRunAnnotationEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"annotation",args:null,concreteType:"ExperimentRunAnnotation",kind:"LinkedField",name:"node",plural:!1,selections:[i,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"score",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"explanation",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"annotatorKind",storageKey:null},r],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"ExperimentRun",kind:"LinkedField",name:"node",plural:!1,selections:[t,i],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:l,filters:null,handle:"connection",key:"ExampleExperimentRunsTable_experimentRuns",kind:"LinkedHandle",name:"experimentRuns"}],type:"DatasetExample",abstractKey:null}],storageKey:null}]},params:{cacheID:"0b278c0b360ced38183ea75b27edca2d",id:null,metadata:{},name:"ExampleExperimentRunsTableQuery",operationKind:"query",text:`query ExampleExperimentRunsTableQuery(
  $after: String = null
  $first: Int = 100
  $id: ID!
) {
  node(id: $id) {
    __typename
    ...ExampleExperimentRunsTableFragment_2HEEH6
    id
  }
}

fragment ExampleExperimentRunsTableFragment_2HEEH6 on DatasetExample {
  experimentRuns(first: $first, after: $after) {
    edges {
      run: node {
        id
        startTime
        endTime
        error
        output
        trace {
          id
          traceId
          projectId
        }
        annotations {
          edges {
            annotation: node {
              id
              name
              label
              score
              explanation
              annotatorKind
              trace {
                id
                traceId
                projectId
              }
            }
          }
        }
      }
      cursor
      node {
        __typename
        id
      }
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
  id
}
`}}}();Ic.hash="73457524533365ed047cb575ee6c93ab";const Dc=function(){var n=["experimentRuns"],a={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},l={alias:null,args:null,concreteType:"Trace",kind:"LinkedField",name:"trace",plural:!1,selections:[a,{alias:null,args:null,kind:"ScalarField",name:"traceId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"projectId",storageKey:null}],storageKey:null};return{argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"after"},{defaultValue:100,kind:"LocalArgument",name:"first"}],kind:"Fragment",metadata:{connection:[{count:"first",cursor:"after",direction:"forward",path:n}],refetch:{connection:{forward:{count:"first",cursor:"after"},backward:null,path:n},fragmentPathInResult:["node"],operation:Ic,identifierInfo:{identifierField:"id",identifierQueryVariableName:"id"}}},name:"ExampleExperimentRunsTableFragment",selections:[{alias:"experimentRuns",args:null,concreteType:"ExperimentRunConnection",kind:"LinkedField",name:"__ExampleExperimentRunsTable_experimentRuns_connection",plural:!1,selections:[{alias:null,args:null,concreteType:"ExperimentRunEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"run",args:null,concreteType:"ExperimentRun",kind:"LinkedField",name:"node",plural:!1,selections:[a,{alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"endTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"error",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"output",storageKey:null},l,{alias:null,args:null,concreteType:"ExperimentRunAnnotationConnection",kind:"LinkedField",name:"annotations",plural:!1,selections:[{alias:null,args:null,concreteType:"ExperimentRunAnnotationEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"annotation",args:null,concreteType:"ExperimentRunAnnotation",kind:"LinkedField",name:"node",plural:!1,selections:[a,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"score",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"explanation",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"annotatorKind",storageKey:null},l],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"ExperimentRun",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},a],type:"DatasetExample",abstractKey:null}}();Dc.hash="73457524533365ed047cb575ee6c93ab";const q1=100;function U1(){return e("tbody",{className:"is-empty",children:e("tr",{children:e("td",{colSpan:100,css:K`
            text-align: center;
            padding: var(--ac-global-dimension-size-300)
              var(--ac-global-dimension-size-300) !important;
          `,children:"No experiments have been run for this example."})})})}const H1=K`
  display: flex;
  flex-direction: row;
  align-items: center;
  color: var(--ac-global-color-primary);
  gap: var(--ac-global-dimension-size-50);
`;function G1({example:n}){const a=m.useRef(null),l=ce(),{data:t,loadNext:i,hasNext:r,isLoadingNext:s}=T.usePaginationFragment(Dc,n),d=m.useMemo(()=>t.experimentRuns.edges.map(y=>{let h=null;return y.run.startTime&&y.run.endTime&&(h=new Date(y.run.endTime).getTime()-new Date(y.run.startTime).getTime()),{...y.run,output:JSON.stringify(y.run.output),latencyMs:h}}),[t]),g=Ce({columns:[{header:"start time",accessorKey:"startTime",cell:_e},{header:"output",accessorKey:"output",cell:y=>{var k;const h=(k=y.row.original)==null?void 0:k.error;return h!==null?e(F,{color:"danger",children:h}):e(Re,{...y})}},{header:"latency",accessorKey:"latencyMs",cell:({getValue:y})=>{const h=y();return h===null||typeof h!="number"?"--":e(je,{latencyMs:h})}},{header:"evaluations",accessorKey:"annotations",cell:({row:y})=>e(b,{direction:"row",gap:"size-50",wrap:"wrap",children:y.original.annotations.edges.map((h,k)=>{const S=h.annotation;return e(Eo,{annotation:S,extra:S.trace&&e(v,{paddingTop:"size-100",children:o("div",{css:H1,children:[e(I,{svg:e(ta,{})}),e("span",{children:"Click to view evaluator trace"})]})}),children:e(ll,{annotation:S,onClick:()=>{S.trace&&l(`/projects/${S.trace.projectId}/traces/${S.trace.traceId}`)}},k)},k)})})},{id:"actions",cell:({row:y})=>{const h=y.original.trace;if(h)return e(M,{size:"S",leadingVisual:e(I,{svg:e(bt,{})}),onPress:()=>{l(`/projects/${h.projectId}/traces/${h.traceId}`)},"aria-label":"view trace"})}}],data:d,getCoreRowModel:Ke()}),f=g.getRowModel().rows,u=f.length===0,p=m.useCallback(y=>{if(y){const{scrollHeight:h,scrollTop:k,clientHeight:S}=y;h-k-S<300&&!s&&r&&i(q1)}},[r,s,i]);return e("div",{css:K`
        flex: 1 1 auto;
        overflow: auto;
      `,ref:a,onScroll:y=>p(y.target),children:o("table",{css:Un,children:[e("thead",{children:g.getHeaderGroups().map(y=>e("tr",{children:y.headers.map(h=>e("th",{children:e("div",{children:W(h.column.columnDef.header,h.getContext())})},h.id))},y.id))}),u?e(U1,{}):e("tbody",{children:f.map(y=>e("tr",{children:y.getVisibleCells().map(h=>e("td",{children:W(h.column.columnDef.cell,h.getContext())},h.id))},y.id))})]})})}function Yi({exampleId:n,onDismiss:a}){const[l,t]=m.useState(0),i=T.useLazyLoadQuery(Pc,{exampleId:n},{fetchKey:l,fetchPolicy:"store-and-network"}),r=m.useMemo(()=>{const u=i.example.latestRevision;return{input:JSON.stringify(u==null?void 0:u.input,null,2),output:JSON.stringify(u==null?void 0:u.output,null,2),metadata:JSON.stringify(u==null?void 0:u.metadata,null,2)}},[i]),s=m.useMemo(()=>{const u=i.example.span;return u?{id:u.id,traceId:u.trace.traceId,projectId:u.trace.project.id}:null},[i]),{input:d,output:c,metadata:g}=r,f=me();return e(ue,{type:"slideOver",isDismissable:!0,onDismiss:a,children:e(oe,{size:"XL",title:`Example: ${n}`,extra:o(b,{direction:"row",gap:"size-100",children:[s?e(sa,{size:"S",to:`/projects/${s.projectId}/traces/${s.traceId}?${mn}=${s.id}`,children:"View Source Span"}):null,e(B1,{exampleId:n,currentRevision:r,onCompleted:()=>{f({title:"Example updated",message:`Example ${n} has been updated.`}),t(u=>u+1)}})]}),children:o(Fn,{direction:"vertical",autoSaveId:"example-panel-group",children:[e(Ie,{defaultSize:65,children:e("div",{css:K`
                overflow-y: auto;
                height: 100%;
              `,children:e(b,{direction:"row",justifyContent:"center",children:e(v,{width:"900px",paddingStart:"auto",paddingEnd:"auto",paddingTop:"size-200",paddingBottom:"size-200",children:o(b,{direction:"column",gap:"size-200",children:[e(q,{title:"Input",...Ht,extra:e(de,{text:d}),children:e(Sn,{value:d})}),e(q,{title:"Output",...Ht,extra:e(de,{text:c}),children:e(Sn,{value:c})}),e(q,{title:"Metadata",...Ht,extra:e(de,{text:g}),children:e(Sn,{value:g})})]})})})})}),e(Dn,{css:Ba}),e(Ie,{defaultSize:35,children:o(b,{direction:"column",height:"100%",children:[e(v,{paddingStart:"size-200",paddingEnd:"size-200",paddingTop:"size-100",paddingBottom:"size-100",borderBottomColor:"dark",borderBottomWidth:"thin",flex:"none",children:e(ae,{level:3,children:"Experiment Runs"})}),e(G1,{example:i.example})]})})]})})})}const Ht={backgroundColor:"light",borderColor:"light",variant:"compact",collapsible:!0,bodyStyle:{padding:0}};function W1(){const[n,a]=pn(),l=n.get("exampleId"),t=n.get("datasetId");return!l||!t?null:e(Yi,{exampleId:l,onDismiss:()=>{a(i=>(i.delete("exampleId"),i))}})}const J1=`
The playground is not available until an LLM provider client is installed on the server.
`,X1=n=>`
# Installing one or more of the clients will enable the playground
${Array.from(n.reduce((a,l)=>(l.dependencies.forEach(t=>a.add(t)),a),new Set)).map(a=>`pip install ${a}`).join(`
`)}
`,Z1=n=>e(v,{height:"100%",width:"100%",children:o(b,{direction:"column",alignItems:"center",justifyContent:"center",gap:"size-200",children:[e(Mo,{message:J1,graphicKey:"not found",size:"L"}),e(F,{children:"The following clients are supported:"}),e(wo,{value:X1(n.availableProviders)})]})});function Y1(){const n=O(i=>Array.from(new Set(i.instances.map(r=>r.model.provider)))),a=O(i=>i.instances.some(r=>r.activeRunId!=null)),[l,t]=m.useState(!1);return e("div",{css:K`
        .ac-dropdown-button {
          min-width: 0px;
        }
      `,children:o(ot,{placement:"bottom",isOpen:l,onOpenChange:i=>{t(i)},children:[e(Yp,{size:"compact",isDisabled:a,children:"API Keys"}),e(ho,{children:e(v,{padding:"size-200",children:o(gn,{onSubmit:i=>{i.preventDefault(),t(!1)},children:[e(ae,{level:2,weight:"heavy",children:"API Keys"}),e(v,{paddingY:"size-50",children:e(F,{color:"text-700",size:"XS",children:"API keys are stored in your browser and used to communicate with their respective API's."})}),e(b,{direction:"column",gap:"size-100",children:n.map(i=>wl[i].length?o(v,{paddingY:"size-50",children:[o(b,{direction:"row",gap:"size-100",alignItems:"center",children:[e(Rl,{provider:i}),e(ae,{level:3,weight:"heavy",children:Gy(i)})]}),e(v,{paddingBottom:"size-100",paddingTop:"size-100",children:e(eb,{provider:i})})]},i):null)}),e(v,{paddingTop:"size-100",children:e(b,{direction:"row",gap:"size-100",width:"100%",justifyContent:"end",children:e(_n,{href:"/settings/providers",children:"View all AI provider configurations"})})})]})})})]})})}function eb({provider:n}){const a=Na(r=>r.setCredential),l=wl[n],t=Na(r=>r[n]),i=O(r=>r.instances.some(s=>s.activeRunId!=null));return e(v,{children:l.map(r=>o(vo,{size:"S",isRequired:r.isRequired,onChange:s=>{a({provider:n,envVarName:r.envVarName,value:s})},value:(t==null?void 0:t[r.envVarName])??"",isDisabled:i,children:[e(H,{children:r.envVarName}),e(So,{}),e(F,{slot:"description",children:`Alternatively, you can set the "${r.envVarName}" environment variable on the server.`})]},r.envVarName))})}const Lc=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"datasetId"}],a=[{kind:"Variable",name:"id",variableName:"datasetId"}],l={kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"exampleCount",storageKey:null}],type:"Dataset",abstractKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"PlaygroundDatasetSectionQuery",selections:[{alias:"dataset",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[l],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"PlaygroundDatasetSectionQuery",selections:[{alias:"dataset",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},l,{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null}]},params:{cacheID:"2430234746cf1242506d2053fa26bcb5",id:null,metadata:{},name:"PlaygroundDatasetSectionQuery",operationKind:"query",text:`query PlaygroundDatasetSectionQuery(
  $datasetId: ID!
) {
  dataset: node(id: $datasetId) {
    __typename
    ... on Dataset {
      name
      exampleCount
    }
    id
  }
}
`}}}();Lc.hash="908dc4074c43c03dfea50a060690df11";const _c=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},t=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"ChatCompletionOverDatasetMutationPayload",kind:"LinkedField",name:"chatCompletionOverDataset",plural:!1,selections:[a,{alias:null,args:null,kind:"ScalarField",name:"experimentId",storageKey:null},{alias:null,args:null,concreteType:"ChatCompletionOverDatasetMutationExamplePayload",kind:"LinkedField",name:"examples",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"datasetExampleId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"experimentRunId",storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"result",plural:!1,selections:[a,{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"message",storageKey:null}],type:"ChatCompletionMutationError",abstractKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"content",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"errorMessage",storageKey:null},{alias:null,args:null,concreteType:"Span",kind:"LinkedField",name:"span",plural:!1,selections:[l,{alias:null,args:null,kind:"ScalarField",name:"tokenCountTotal",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"latencyMs",storageKey:null},{alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"project",plural:!1,selections:[l],storageKey:null},{alias:null,args:null,concreteType:"SpanContext",kind:"LinkedField",name:"context",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"traceId",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"ChatCompletionToolCall",kind:"LinkedField",name:"toolCalls",plural:!0,selections:[l,{alias:null,args:null,concreteType:"ChatCompletionFunctionCall",kind:"LinkedField",name:"function",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"arguments",storageKey:null}],storageKey:null}],storageKey:null}],type:"ChatCompletionMutationPayload",abstractKey:null}],storageKey:null}],storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"PlaygroundDatasetExamplesTableMutation",selections:t,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"PlaygroundDatasetExamplesTableMutation",selections:t},params:{cacheID:"a5d1d9b9e0ebf2f32f8398b5bca3b281",id:null,metadata:{},name:"PlaygroundDatasetExamplesTableMutation",operationKind:"mutation",text:`mutation PlaygroundDatasetExamplesTableMutation(
  $input: ChatCompletionOverDatasetInput!
) {
  chatCompletionOverDataset(input: $input) {
    __typename
    experimentId
    examples {
      datasetExampleId
      experimentRunId
      result {
        __typename
        ... on ChatCompletionMutationError {
          message
        }
        ... on ChatCompletionMutationPayload {
          content
          errorMessage
          span {
            id
            tokenCountTotal
            latencyMs
            project {
              id
            }
            context {
              traceId
            }
          }
          toolCalls {
            id
            function {
              name
              arguments
            }
          }
        }
      }
    }
  }
}
`}}}();_c.hash="4ecdd2ca5fbbdf4a9ae185fa02f8b013";const Ac=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a={alias:null,args:null,kind:"ScalarField",name:"datasetExampleId",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},t=[l],i=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:null,kind:"LinkedField",name:"chatCompletionOverDataset",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"content",storageKey:null},a],type:"TextChunk",abstractKey:null},{kind:"InlineFragment",selections:[l,a,{alias:null,args:null,concreteType:"FunctionCallChunk",kind:"LinkedField",name:"function",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"arguments",storageKey:null}],storageKey:null}],type:"ToolCallChunk",abstractKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"Experiment",kind:"LinkedField",name:"experiment",plural:!1,selections:t,storageKey:null}],type:"ChatCompletionSubscriptionExperiment",abstractKey:null},{kind:"InlineFragment",selections:[a,{alias:null,args:null,concreteType:"Span",kind:"LinkedField",name:"span",plural:!1,selections:[l,{alias:null,args:null,kind:"ScalarField",name:"tokenCountTotal",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"latencyMs",storageKey:null},{alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"project",plural:!1,selections:t,storageKey:null},{alias:null,args:null,concreteType:"SpanContext",kind:"LinkedField",name:"context",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"traceId",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"ExperimentRun",kind:"LinkedField",name:"experimentRun",plural:!1,selections:t,storageKey:null}],type:"ChatCompletionSubscriptionResult",abstractKey:null},{kind:"InlineFragment",selections:[a,{alias:null,args:null,kind:"ScalarField",name:"message",storageKey:null}],type:"ChatCompletionSubscriptionError",abstractKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"PlaygroundDatasetExamplesTableSubscription",selections:i,type:"Subscription",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"PlaygroundDatasetExamplesTableSubscription",selections:i},params:{cacheID:"bb84c1ad8f99fe16260cf38ec9dee07b",id:null,metadata:{},name:"PlaygroundDatasetExamplesTableSubscription",operationKind:"subscription",text:`subscription PlaygroundDatasetExamplesTableSubscription(
  $input: ChatCompletionOverDatasetInput!
) {
  chatCompletionOverDataset(input: $input) {
    __typename
    ... on TextChunk {
      content
      datasetExampleId
    }
    ... on ToolCallChunk {
      id
      datasetExampleId
      function {
        name
        arguments
      }
    }
    ... on ChatCompletionSubscriptionExperiment {
      experiment {
        id
      }
    }
    ... on ChatCompletionSubscriptionResult {
      datasetExampleId
      span {
        id
        tokenCountTotal
        latencyMs
        project {
          id
        }
        context {
          traceId
        }
      }
      experimentRun {
        id
      }
    }
    ... on ChatCompletionSubscriptionError {
      datasetExampleId
      message
    }
  }
}
`}}}();Ac.hash="b6c2a6c5c219eec0eb92826f7df62d24";const wc=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"after"},{defaultValue:null,kind:"LocalArgument",name:"datasetVersionId"},{defaultValue:20,kind:"LocalArgument",name:"first"},{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}],l=[{kind:"Variable",name:"after",variableName:"after"},{kind:"Variable",name:"datasetVersionId",variableName:"datasetVersionId"},{kind:"Variable",name:"first",variableName:"first"}],t={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"PlaygroundDatasetExamplesTableRefetchQuery",selections:[{alias:null,args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:l,kind:"FragmentSpread",name:"PlaygroundDatasetExamplesTableFragment"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"PlaygroundDatasetExamplesTableRefetchQuery",selections:[{alias:null,args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[t,i,{kind:"InlineFragment",selections:[{alias:null,args:l,concreteType:"DatasetExampleConnection",kind:"LinkedField",name:"examples",plural:!1,selections:[{alias:null,args:null,concreteType:"DatasetExampleEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"example",args:null,concreteType:"DatasetExample",kind:"LinkedField",name:"node",plural:!1,selections:[i,{alias:null,args:null,concreteType:"DatasetExampleRevision",kind:"LinkedField",name:"revision",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"input",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"output",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"DatasetExample",kind:"LinkedField",name:"node",plural:!1,selections:[t,i],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:l,filters:["datasetVersionId"],handle:"connection",key:"PlaygroundDatasetExamplesTable_examples",kind:"LinkedHandle",name:"examples"}],type:"Dataset",abstractKey:null}],storageKey:null}]},params:{cacheID:"cad3c5e20cfff93d4f7f192d908ad5dc",id:null,metadata:{},name:"PlaygroundDatasetExamplesTableRefetchQuery",operationKind:"query",text:`query PlaygroundDatasetExamplesTableRefetchQuery(
  $after: String = null
  $datasetVersionId: ID
  $first: Int = 20
  $id: ID!
) {
  node(id: $id) {
    __typename
    ...PlaygroundDatasetExamplesTableFragment_4a6F8Z
    id
  }
}

fragment PlaygroundDatasetExamplesTableFragment_4a6F8Z on Dataset {
  examples(datasetVersionId: $datasetVersionId, first: $first, after: $after) {
    edges {
      example: node {
        id
        revision {
          input
          output
        }
      }
      cursor
      node {
        __typename
        id
      }
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
  id
}
`}}}();wc.hash="0d0e6fa0e812e73491de28f6e9743f74";const Rc=function(){var n=["examples"],a={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"after"},{defaultValue:null,kind:"LocalArgument",name:"datasetVersionId"},{defaultValue:20,kind:"LocalArgument",name:"first"}],kind:"Fragment",metadata:{connection:[{count:"first",cursor:"after",direction:"forward",path:n}],refetch:{connection:{forward:{count:"first",cursor:"after"},backward:null,path:n},fragmentPathInResult:["node"],operation:wc,identifierInfo:{identifierField:"id",identifierQueryVariableName:"id"}}},name:"PlaygroundDatasetExamplesTableFragment",selections:[{alias:"examples",args:[{kind:"Variable",name:"datasetVersionId",variableName:"datasetVersionId"}],concreteType:"DatasetExampleConnection",kind:"LinkedField",name:"__PlaygroundDatasetExamplesTable_examples_connection",plural:!1,selections:[{alias:null,args:null,concreteType:"DatasetExampleEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"example",args:null,concreteType:"DatasetExample",kind:"LinkedField",name:"node",plural:!1,selections:[a,{alias:null,args:null,concreteType:"DatasetExampleRevision",kind:"LinkedField",name:"revision",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"input",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"output",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"DatasetExample",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},a],type:"Dataset",abstractKey:null}}();Rc.hash="0d0e6fa0e812e73491de28f6e9743f74";const Ec=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"datasetId"}],a=[{kind:"Variable",name:"id",variableName:"datasetId"}],l={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},i=[{kind:"Literal",name:"first",value:20}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"PlaygroundDatasetExamplesTableQuery",selections:[{alias:"dataset",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"PlaygroundDatasetExamplesTableFragment"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"PlaygroundDatasetExamplesTableQuery",selections:[{alias:"dataset",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[l,t,{kind:"InlineFragment",selections:[{alias:null,args:i,concreteType:"DatasetExampleConnection",kind:"LinkedField",name:"examples",plural:!1,selections:[{alias:null,args:null,concreteType:"DatasetExampleEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"example",args:null,concreteType:"DatasetExample",kind:"LinkedField",name:"node",plural:!1,selections:[t,{alias:null,args:null,concreteType:"DatasetExampleRevision",kind:"LinkedField",name:"revision",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"input",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"output",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"DatasetExample",kind:"LinkedField",name:"node",plural:!1,selections:[l,t],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:"examples(first:20)"},{alias:null,args:i,filters:["datasetVersionId"],handle:"connection",key:"PlaygroundDatasetExamplesTable_examples",kind:"LinkedHandle",name:"examples"}],type:"Dataset",abstractKey:null}],storageKey:null}]},params:{cacheID:"4542fde74f9abf1ade84ed347ac5a767",id:null,metadata:{},name:"PlaygroundDatasetExamplesTableQuery",operationKind:"query",text:`query PlaygroundDatasetExamplesTableQuery(
  $datasetId: ID!
) {
  dataset: node(id: $datasetId) {
    __typename
    ...PlaygroundDatasetExamplesTableFragment
    id
  }
}

fragment PlaygroundDatasetExamplesTableFragment on Dataset {
  examples(first: 20) {
    edges {
      example: node {
        id
        revision {
          input
          output
        }
      }
      cursor
      node {
        __typename
        id
      }
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
  id
}
`}}}();Ec.hash="45aac1ecf30dcedfbeea2321ee6e3c35";const nb=()=>{const n=(a,l)=>({exampleResponsesMap:{},updateExampleData:({instanceId:t,exampleId:i,patch:r})=>{const s=l().exampleResponsesMap,d=s[t]??{},c=d[i]??{};a({exampleResponsesMap:{...s,[t]:{...d,[i]:{...c,...r}}}})},appendExampleDataTextChunk:({instanceId:t,exampleId:i,textChunk:r})=>{const s=l().exampleResponsesMap,d=s[t]??{},c=d[i]??{},g=c.content??"";a({exampleResponsesMap:{...s,[t]:{...d,[i]:{...c,content:g+r}}}})},appendExampleDataToolCallChunk:({instanceId:t,exampleId:i,toolCallChunk:r})=>{var h;const s=l().exampleResponsesMap,d=s[t]??{},c=d[i]??{},g=c.toolCalls??{},{id:f,function:u}=r,p=g[f],y={...p,id:f,function:{name:((h=p==null?void 0:p.function)==null?void 0:h.name)??u.name,arguments:(p==null?void 0:p.function.arguments)!=null?p.function.arguments+u.arguments:u.arguments}};a({exampleResponsesMap:{...s,[t]:{...d,[i]:{...c,toolCalls:{...g,[f]:y}}}}})},setExampleDataForInstance:({instanceId:t,data:i})=>{const r=l().exampleResponsesMap;a({exampleResponsesMap:{...r,[t]:i}})},resetExampleData:()=>{a({exampleResponsesMap:{}})}});return mo()(n)},Mc=fn.createContext(null);function ab({children:n}){const[a]=m.useState(()=>nb());return e(Mc.Provider,{value:a,children:n})}function Ha(n,a){const l=fn.useContext(Mc);if(!l)throw new Error("Missing PlaygroundDatasetExamplesTableContext.Provider in the tree");return Ll(l,n,a)}function er({children:n}){return o(b,{direction:"row",gap:"size-50",alignItems:"center",children:[e(I,{svg:e(Ti,{}),color:"danger"}),e(F,{color:"danger",children:n})]})}const Vc=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"runId"}],a=[{kind:"Variable",name:"id",variableName:"runId"}],l={alias:null,args:null,kind:"ScalarField",name:"output",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},i={kind:"InlineFragment",selections:[l,{alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"endTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"error",storageKey:null},{alias:null,args:null,concreteType:"DatasetExample",kind:"LinkedField",name:"example",plural:!1,selections:[t,{alias:null,args:null,concreteType:"DatasetExampleRevision",kind:"LinkedField",name:"revision",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"input",storageKey:null},l],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"ExperimentRunAnnotationConnection",kind:"LinkedField",name:"annotations",plural:!1,selections:[{alias:null,args:null,concreteType:"ExperimentRunAnnotationEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"annotation",args:null,concreteType:"ExperimentRunAnnotation",kind:"LinkedField",name:"node",plural:!1,selections:[t,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"score",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"explanation",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"annotatorKind",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],type:"ExperimentRun",abstractKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"PlaygroundExperimentRunDetailsDialogQuery",selections:[{alias:"run",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[i],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"PlaygroundExperimentRunDetailsDialogQuery",selections:[{alias:"run",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},i,t],storageKey:null}]},params:{cacheID:"a0e03785a6ab482250d20af95ca7ef91",id:null,metadata:{},name:"PlaygroundExperimentRunDetailsDialogQuery",operationKind:"query",text:`query PlaygroundExperimentRunDetailsDialogQuery(
  $runId: ID!
) {
  run: node(id: $runId) {
    __typename
    ... on ExperimentRun {
      output
      startTime
      endTime
      error
      example {
        id
        revision {
          input
          output
        }
      }
      annotations {
        edges {
          annotation: node {
            id
            name
            label
            score
            explanation
            annotatorKind
          }
        }
      }
    }
    id
  }
}
`}}}();Vc.hash="e2203e071e6fce91c764fa6fee48dfc1";function lb({runId:n}){var d,c,g;const l=T.useLazyLoadQuery(Vc,{runId:n}).run,t=(d=l.example)==null?void 0:d.id,i=(c=l.example)==null?void 0:c.revision,r=i==null?void 0:i.input,s=i==null?void 0:i.output;return e(oe,{title:`Experiment Run for Example: ${t}`,size:"fullscreen",children:o(Fn,{direction:"vertical",autoSaveId:"example-compare-panel-group",children:[e(Ie,{defaultSize:33,children:e(v,{overflow:"auto",height:"100%",padding:"size-200",children:o(b,{direction:"row",gap:"size-200",flex:"1 1 auto",children:[e(v,{width:"50%",children:e(q,{title:"Input",...$r,bodyStyle:{padding:0,maxHeight:"300px",overflowY:"auto"},extra:e(de,{text:JSON.stringify(r)}),children:e(Sn,{value:JSON.stringify(r,null,2)})})}),e(v,{width:"50%",children:e(q,{title:"Reference Output",...$r,extra:e(de,{text:JSON.stringify(s)}),bodyStyle:{padding:0,maxHeight:"300px",overflowY:"auto"},children:e(Sn,{value:JSON.stringify(s,null,2)})})})]})})}),e(Dn,{css:Ba}),e(Ie,{defaultSize:67,children:o(b,{direction:"column",height:"100%",children:[e(v,{paddingStart:"size-200",paddingEnd:"size-200",paddingTop:"size-100",paddingBottom:"size-100",borderBottomColor:"dark",borderBottomWidth:"thin",flex:"none",children:e(ae,{level:2,children:"Experiment Run Output"})}),e("div",{css:K`
                overflow-y: auto;
                height: 100%;
                padding: var(--ac-global-dimension-static-size-200);
              `,children:o(b,{direction:"row",children:[e(v,{flex:!0,children:l.error?e(v,{padding:"size-200",children:e(ib,{error:l.error})}):e(Sn,{value:JSON.stringify(l.output,null,2)})}),o(Ea,{width:"size-3000",children:[l.startTime&&l.endTime&&e(tb,{startTime:l.startTime,endTime:l.endTime}),e("ul",{css:K`
                      margin-top: var(--ac-global-dimension-static-size-100);
                      display: flex;
                      flex-direction: column;
                      justify-content: flex-start;
                      align-items: flex-end;
                      gap: var(--ac-global-dimension-static-size-100);
                    `,children:(g=l.annotations)==null?void 0:g.edges.map(f=>e("li",{children:e(ll,{annotation:f.annotation})},f.annotation.id))})]})]})})]})})]})})}function tb({startTime:n,endTime:a}){const l=m.useMemo(()=>{let t=null;return n&&a&&(t=new Date(a).getTime()-new Date(n).getTime()),t},[n,a]);return l===null?null:e(je,{latencyMs:l})}function ib({error:n}){return o(b,{direction:"row",gap:"size-50",alignItems:"center",children:[e(I,{svg:e(Ti,{}),color:"danger"}),e(F,{color:"danger",children:n})]})}const $r={backgroundColor:"light",borderColor:"light",variant:"compact",collapsible:!0,bodyStyle:{padding:0}},zc=function(){var n={defaultValue:null,kind:"LocalArgument",name:"id"},a={defaultValue:null,kind:"LocalArgument",name:"traceId"},l=[{kind:"Variable",name:"id",variableName:"id"}],t=[{kind:"Variable",name:"traceId",variableName:"traceId"}],i={alias:null,args:null,kind:"ScalarField",name:"projectSessionId",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},s={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},d={alias:null,args:null,kind:"ScalarField",name:"latencyMs",storageKey:null},c={alias:null,args:[{kind:"Literal",name:"first",value:1e3}],concreteType:"SpanConnection",kind:"LinkedField",name:"spans",plural:!1,selections:[{alias:null,args:null,concreteType:"SpanEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"span",args:null,concreteType:"Span",kind:"LinkedField",name:"node",plural:!1,selections:[r,{alias:null,args:null,kind:"ScalarField",name:"spanId",storageKey:null},s,{alias:null,args:null,kind:"ScalarField",name:"spanKind",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"statusCode",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"parentId",storageKey:null},d,{alias:null,args:null,kind:"ScalarField",name:"tokenCountTotal",storageKey:null},{alias:null,args:null,concreteType:"AnnotationSummary",kind:"LinkedField",name:"spanAnnotationSummaries",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"labels",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"count",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"labelCount",storageKey:null},{alias:null,args:null,concreteType:"LabelFraction",kind:"LinkedField",name:"labelFractions",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"fraction",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null}],storageKey:null},s,{alias:null,args:null,kind:"ScalarField",name:"scoreCount",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"meanScore",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:"spans(first:1000)"};return{fragment:{argumentDefinitions:[n,a],kind:"Fragment",metadata:null,name:"TraceDetailsQuery",selections:[{alias:"project",args:l,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{kind:"InlineFragment",selections:[{alias:null,args:t,concreteType:"Trace",kind:"LinkedField",name:"trace",plural:!1,selections:[i,c,d],storageKey:null}],type:"Project",abstractKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[a,n],kind:"Operation",name:"TraceDetailsQuery",selections:[{alias:"project",args:l,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{kind:"InlineFragment",selections:[{alias:null,args:t,concreteType:"Trace",kind:"LinkedField",name:"trace",plural:!1,selections:[i,c,d,r],storageKey:null}],type:"Project",abstractKey:null},r],storageKey:null}]},params:{cacheID:"18662a3774f2ad488c41a0262fabf5a9",id:null,metadata:{},name:"TraceDetailsQuery",operationKind:"query",text:`query TraceDetailsQuery(
  $traceId: ID!
  $id: ID!
) {
  project: node(id: $id) {
    __typename
    ... on Project {
      trace(traceId: $traceId) {
        projectSessionId
        spans(first: 1000) {
          edges {
            span: node {
              id
              spanId
              name
              spanKind
              statusCode
              startTime
              parentId
              latencyMs
              tokenCountTotal
              spanAnnotationSummaries {
                labels
                count
                labelCount
                labelFractions {
                  fraction
                  label
                }
                name
                scoreCount
                meanScore
              }
            }
          }
        }
        latencyMs
        id
      }
    }
    id
  }
}
`}}}();zc.hash="7f8f1e64c42b5e66d51dc1325c064d8c";const Nc=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}],l={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"spanId",storageKey:null},r={alias:null,args:null,concreteType:"Trace",kind:"LinkedField",name:"trace",plural:!1,selections:[t,{alias:null,args:null,kind:"ScalarField",name:"traceId",storageKey:null}],storageKey:null},s={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},d={alias:null,args:null,kind:"ScalarField",name:"spanKind",storageKey:null},c={alias:"statusCode",args:null,kind:"ScalarField",name:"propagatedStatusCode",storageKey:null},g={alias:null,args:null,kind:"ScalarField",name:"statusMessage",storageKey:null},f={alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},u={alias:null,args:null,kind:"ScalarField",name:"parentId",storageKey:null},p={alias:null,args:null,kind:"ScalarField",name:"latencyMs",storageKey:null},y={alias:null,args:null,kind:"ScalarField",name:"tokenCountTotal",storageKey:null},h={alias:null,args:null,kind:"ScalarField",name:"endTime",storageKey:null},k=[{alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"mimeType",storageKey:null}],S={alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"input",plural:!1,selections:k,storageKey:null},C={alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"output",plural:!1,selections:k,storageKey:null},P={alias:null,args:null,kind:"ScalarField",name:"attributes",storageKey:null},L={alias:null,args:null,concreteType:"SpanEvent",kind:"LinkedField",name:"events",plural:!0,selections:[s,{alias:null,args:null,kind:"ScalarField",name:"message",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"timestamp",storageKey:null}],storageKey:null},_={alias:null,args:null,concreteType:"DocumentRetrievalMetrics",kind:"LinkedField",name:"documentRetrievalMetrics",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"evaluationName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"ndcg",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"precision",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hit",storageKey:null}],storageKey:null},w={alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},V={alias:null,args:null,kind:"ScalarField",name:"score",storageKey:null},Q={alias:null,args:null,kind:"ScalarField",name:"explanation",storageKey:null},x={alias:null,args:null,concreteType:"DocumentEvaluation",kind:"LinkedField",name:"documentEvaluations",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"documentPosition",storageKey:null},s,w,V,Q],storageKey:null},R={kind:"InlineFragment",selections:[t],type:"Node",abstractKey:"__isNode"},A={alias:null,args:null,kind:"ScalarField",name:"annotationType",storageKey:null},z={alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},N={alias:null,args:null,concreteType:"CategoricalAnnotationValue",kind:"LinkedField",name:"values",plural:!0,selections:[w,V],storageKey:null},j={alias:null,args:null,kind:"ScalarField",name:"optimizationDirection",storageKey:null},Z={kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"lowerBound",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"upperBound",storageKey:null},j],type:"ContinuousAnnotationConfig",abstractKey:null},se={kind:"InlineFragment",selections:[s],type:"FreeformAnnotationConfig",abstractKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"SpanDetailsQuery",selections:[{alias:"span",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[l,{kind:"InlineFragment",selections:[t,i,r,s,d,c,g,f,u,p,y,h,S,C,P,{kind:"RequiredField",field:L,action:"THROW"},_,x,{alias:null,args:null,concreteType:"SpanAnnotation",kind:"LinkedField",name:"spanAnnotations",plural:!0,selections:[t,s],storageKey:null},{args:null,kind:"FragmentSpread",name:"SpanHeader_span"},{args:null,kind:"FragmentSpread",name:"SpanFeedback_annotations"},{args:null,kind:"FragmentSpread",name:"SpanAside_span"}],type:"Span",abstractKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"SpanDetailsQuery",selections:[{alias:"span",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[l,t,{kind:"InlineFragment",selections:[i,r,s,d,c,g,f,u,p,y,h,S,C,P,L,_,x,{alias:null,args:null,concreteType:"SpanAnnotation",kind:"LinkedField",name:"spanAnnotations",plural:!0,selections:[t,s,w,V,Q,{alias:null,args:null,kind:"ScalarField",name:"metadata",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"annotatorKind",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"identifier",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"source",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"updatedAt",storageKey:null},{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"user",plural:!1,selections:[t,{alias:null,args:null,kind:"ScalarField",name:"username",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"profilePictureUrl",storageKey:null}],storageKey:null}],storageKey:null},{alias:"code",args:null,kind:"ScalarField",name:"statusCode",storageKey:null},{alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"project",plural:!1,selections:[t,{alias:null,args:null,concreteType:"AnnotationConfigConnection",kind:"LinkedField",name:"annotationConfigs",plural:!1,selections:[{alias:null,args:null,concreteType:"AnnotationConfigEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[l,R,{kind:"InlineFragment",selections:[s,A,z],type:"AnnotationConfigBase",abstractKey:"__isAnnotationConfigBase"},{kind:"InlineFragment",selections:[N,t,s,j],type:"CategoricalAnnotationConfig",abstractKey:null},Z,se],storageKey:null}],storageKey:null},{alias:"configs",args:null,concreteType:"AnnotationConfigEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"config",args:null,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[l,R,{kind:"InlineFragment",selections:[s,z,A],type:"AnnotationConfigBase",abstractKey:"__isAnnotationConfigBase"},{kind:"InlineFragment",selections:[N],type:"CategoricalAnnotationConfig",abstractKey:null},Z,se],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"AnnotationSummary",kind:"LinkedField",name:"spanAnnotationSummaries",plural:!0,selections:[{alias:null,args:null,concreteType:"LabelFraction",kind:"LinkedField",name:"labelFractions",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"fraction",storageKey:null},w],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"meanScore",storageKey:null},s],storageKey:null}],type:"Span",abstractKey:null}],storageKey:null}]},params:{cacheID:"ba00d31f2c648dcb3b2afdc351c20bda",id:null,metadata:{},name:"SpanDetailsQuery",operationKind:"query",text:`query SpanDetailsQuery(
  $id: ID!
) {
  span: node(id: $id) {
    __typename
    ... on Span {
      id
      spanId
      trace {
        id
        traceId
      }
      name
      spanKind
      statusCode: propagatedStatusCode
      statusMessage
      startTime
      parentId
      latencyMs
      tokenCountTotal
      endTime
      input {
        value
        mimeType
      }
      output {
        value
        mimeType
      }
      attributes
      events {
        name
        message
        timestamp
      }
      documentRetrievalMetrics {
        evaluationName
        ndcg
        precision
        hit
      }
      documentEvaluations {
        documentPosition
        name
        label
        score
        explanation
      }
      spanAnnotations {
        id
        name
      }
      ...SpanHeader_span
      ...SpanFeedback_annotations
      ...SpanAside_span
    }
    id
  }
}

fragment AnnotationConfigListProjectAnnotationConfigFragment on Project {
  annotationConfigs {
    edges {
      node {
        __typename
        ... on Node {
          __isNode: __typename
          id
        }
        ... on AnnotationConfigBase {
          __isAnnotationConfigBase: __typename
          name
          annotationType
          description
        }
        ... on CategoricalAnnotationConfig {
          values {
            label
            score
          }
        }
        ... on ContinuousAnnotationConfig {
          lowerBound
          upperBound
          optimizationDirection
        }
        ... on FreeformAnnotationConfig {
          name
        }
      }
    }
  }
}

fragment AnnotationSummaryGroup on Span {
  project {
    id
    annotationConfigs {
      edges {
        node {
          __typename
          ... on AnnotationConfigBase {
            __isAnnotationConfigBase: __typename
            annotationType
          }
          ... on CategoricalAnnotationConfig {
            id
            name
            optimizationDirection
            values {
              label
              score
            }
          }
          ... on Node {
            __isNode: __typename
            id
          }
        }
      }
    }
  }
  spanAnnotations {
    id
    name
    label
    score
    annotatorKind
    createdAt
    user {
      username
      profilePictureUrl
      id
    }
  }
  spanAnnotationSummaries {
    labelFractions {
      fraction
      label
    }
    meanScore
    name
  }
}

fragment SpanAsideAnnotationList_span on Span {
  project {
    id
    annotationConfigs {
      configs: edges {
        config: node {
          __typename
          ... on Node {
            __isNode: __typename
            id
          }
          ... on AnnotationConfigBase {
            __isAnnotationConfigBase: __typename
            name
          }
        }
      }
    }
  }
  spanAnnotations {
    id
  }
  ...AnnotationSummaryGroup
}

fragment SpanAside_span on Span {
  id
  project {
    id
    ...AnnotationConfigListProjectAnnotationConfigFragment
    annotationConfigs {
      configs: edges {
        config: node {
          __typename
          ... on Node {
            __isNode: __typename
            id
          }
          ... on AnnotationConfigBase {
            __isAnnotationConfigBase: __typename
            name
            description
            annotationType
          }
          ... on CategoricalAnnotationConfig {
            values {
              label
              score
            }
          }
          ... on ContinuousAnnotationConfig {
            lowerBound
            upperBound
            optimizationDirection
          }
          ... on FreeformAnnotationConfig {
            name
          }
        }
      }
    }
  }
  code: statusCode
  startTime
  endTime
  tokenCountTotal
  ...TraceHeaderRootSpanAnnotationsFragment
  ...SpanAsideAnnotationList_span
  ...AnnotationSummaryGroup
}

fragment SpanFeedback_annotations on Span {
  id
  spanAnnotations {
    id
    name
    label
    score
    explanation
    metadata
    annotatorKind
    identifier
    source
    createdAt
    updatedAt
    user {
      id
      username
      profilePictureUrl
    }
  }
}

fragment SpanHeader_span on Span {
  id
  name
  spanKind
  code: statusCode
  latencyMs
  startTime
  tokenCountTotal
}

fragment TraceHeaderRootSpanAnnotationsFragment on Span {
  ...AnnotationSummaryGroup
}
`}}}();Nc.hash="e2fbe3f1daee23ca2ad099cc7c5f0d90";function rb(n,a){const l=m.useRef(null);m.useEffect(()=>{l.current=n},[n]),m.useEffect(()=>{function t(){l.current&&l.current()}{const i=setInterval(t,a);return()=>clearInterval(i)}},[a])}function ob(){const{locale:n}=Ip();return m.useMemo(()=>Wy(n),[n])}const sb=n=>{const[a,l]=m.useState(null);return m.useEffect(()=>{if(!n.current)return;const t=new ResizeObserver(i=>{if(!i||i.length===0)return;const{width:r,height:s}=i[0].contentRect;l({width:r,height:s})});return t.observe(n.current),()=>{t.disconnect()}},[n]),a};function jr(n){return Array.isArray(n)&&n.every(a=>typeof a=="object"&&Se.message in a&&db(a[Se.message]))}function db(n){return typeof n=="object"&&n!==null&&$e.role in n}const Gt=K`
  display: flex;
  align-items: center;
  .ac-text {
    display: inline-block;
    max-width: 9rem;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }
`;function vn(n){const{name:a,metric:l,k:t,score:i}=n,r=typeof t=="number"?`${l}@${t}`:l,s=m.useMemo(()=>l==="hit"?i?"true":"false":typeof i=="number"&&Wa(i)||"--",[i,l]);return o(Ee,{delay:500,offset:3,children:[e(nn,{children:e("div",{css:Jy,children:o(b,{direction:"row",gap:"size-100",alignItems:"center",children:[e(Xy,{color:"var(--ac-global-color-seafoam-1000)"}),a?e("div",{css:Gt,children:e(F,{weight:"heavy",size:"XS",color:"inherit",children:a})}):null,e("div",{css:Gt,children:e(F,{size:"XS",color:"inherit",children:r})}),e("div",{css:Gt,children:e(F,{size:"XS",children:s})})]})})}),e(oa,{children:o(b,{direction:"row",gap:"size-100",children:[o(F,{weight:"heavy",color:"inherit",children:[a," ",r]}),e(F,{color:"inherit",children:s})]})})]})}const $c={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"SpanHeader_span",selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"spanKind",storageKey:null},{alias:"code",args:null,kind:"ScalarField",name:"statusCode",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"latencyMs",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"tokenCountTotal",storageKey:null}],type:"Span",abstractKey:null};$c.hash="521c85902b5ffee719617ed60be1a3b4";function cb(n){const a=T.useFragment($c,n.span),l=m.useMemo(()=>new Date(a.startTime),[a.startTime]);return e(b,{direction:"row",gap:"size-100",width:"100%",height:"100%",alignItems:"center",children:o(b,{direction:"column",gap:"size-50",children:[o(b,{direction:"row",gap:"size-100",alignItems:"center",children:[e(Pi,{spanKind:a.spanKind}),e(F,{size:"L",children:a.name}),e(St,{statusCode:a.code,css:K`
              font-size: var(--ac-global-font-size-m);
            `})]}),o(b,{direction:"row",gap:"size-100",alignItems:"center",children:[typeof a.latencyMs=="number"?e(je,{latencyMs:a.latencyMs,size:"S"}):null,o(F,{color:"text-500",size:"S",children:["at ",da(l)]}),a.tokenCountTotal?e(La,{tokenCountTotal:a.tokenCountTotal,nodeId:a.id,size:"S"}):null]})]})})}function ub(n){const{spanId:a,traceId:l}=n,t=me();return o(Ne,{children:[e(M,{size:"S",leadingVisual:e(I,{svg:e(Vo,{})})}),e(la,{children:e(He,{children:({close:i})=>o(Ml,{style:{minHeight:"auto"},onAction:r=>{switch(r){case"COPY_SPAN_ID":{gr(a),t({title:"Span ID Copied",message:`The Span ID ${a} has been copied to your clipboard`});break}case"COPY_TRACE_ID":{gr(l),t({title:"Trace ID Copied",message:`The Trace ID ${l} has been copied to your clipboard`});break}default:Te()}i()},children:[e(mr,{id:"COPY_SPAN_ID",children:o(b,{direction:"row",gap:"size-75",justifyContent:"start",alignItems:"center",children:[e(I,{svg:e(ri,{})}),e(F,{children:"Copy Span ID"})]})}),e(mr,{id:"COPY_TRACE_ID",children:o(b,{direction:"row",gap:"size-75",justifyContent:"start",alignItems:"center",children:[e(I,{svg:e(ri,{})}),e(F,{children:"Copy Trace ID"})]})})]})})})]})}const jc=function(){var n={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},a=[n];return{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"SpanAsideAnnotationList_span",selections:[{alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"project",plural:!1,selections:[n,{alias:null,args:null,concreteType:"AnnotationConfigConnection",kind:"LinkedField",name:"annotationConfigs",plural:!1,selections:[{alias:"configs",args:null,concreteType:"AnnotationConfigEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"config",args:null,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{kind:"InlineFragment",selections:a,type:"Node",abstractKey:"__isNode"},{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],type:"AnnotationConfigBase",abstractKey:"__isAnnotationConfigBase"}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"SpanAnnotation",kind:"LinkedField",name:"spanAnnotations",plural:!0,selections:a,storageKey:null},{args:null,kind:"FragmentSpread",name:"AnnotationSummaryGroup"}],type:"Span",abstractKey:null}}();jc.hash="8db090103425204eda8bf8e16580f622";const Oc=function(){var n={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},a={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null};return{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"SpanAside_span",selections:[n,{alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"project",plural:!1,selections:[n,{args:null,kind:"FragmentSpread",name:"AnnotationConfigListProjectAnnotationConfigFragment"},{alias:null,args:null,concreteType:"AnnotationConfigConnection",kind:"LinkedField",name:"annotationConfigs",plural:!1,selections:[{alias:"configs",args:null,concreteType:"AnnotationConfigEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"config",args:null,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{kind:"InlineFragment",selections:[n],type:"Node",abstractKey:"__isNode"},{kind:"InlineFragment",selections:[a,{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"annotationType",storageKey:null}],type:"AnnotationConfigBase",abstractKey:"__isAnnotationConfigBase"},{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"CategoricalAnnotationValue",kind:"LinkedField",name:"values",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"score",storageKey:null}],storageKey:null}],type:"CategoricalAnnotationConfig",abstractKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"lowerBound",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"upperBound",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"optimizationDirection",storageKey:null}],type:"ContinuousAnnotationConfig",abstractKey:null},{kind:"InlineFragment",selections:[a],type:"FreeformAnnotationConfig",abstractKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null},{alias:"code",args:null,kind:"ScalarField",name:"statusCode",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"endTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"tokenCountTotal",storageKey:null},{args:null,kind:"FragmentSpread",name:"TraceHeaderRootSpanAnnotationsFragment"},{args:null,kind:"FragmentSpread",name:"SpanAsideAnnotationList_span"},{args:null,kind:"FragmentSpread",name:"AnnotationSummaryGroup"}],type:"Span",abstractKey:null}}();Oc.hash="eddd0b1c2288899c1d97948a29207944";const Qc=m.createContext(null);function Vt(){const n=m.useContext(Qc);if(n===null)throw new Error("useSpanFilterCondition must be used within a SpanFilterConditionProvider");return n}function nr(n){const[a,l]=m.useState(""),t=m.useCallback(r=>{m.startTransition(()=>{l(r)})},[]),i=m.useCallback(r=>{m.startTransition(()=>{a.length>0?l(a+" and "+r):l(r)})},[a]);return e(Qc.Provider,{value:{filterCondition:a,setFilterCondition:t,appendFilterCondition:i},children:n.children})}function ET(n){const{appendFilterCondition:a}=Vt(),{annotation:l,className:t}=n,{name:i,label:r,score:s}=l,d=m.useMemo(()=>{const c=[];return typeof s=="number"?(c.push({filterName:"greater than",filterCondition:`annotations['${i}'].score > ${s}`}),c.push({filterName:"less than",filterCondition:`annotations['${i}'].score < ${s}`}),c.push({filterName:"equals",filterCondition:`annotations['${i}'].score == ${s}`})):r!=null&&(c.push({filterName:"match",filterCondition:`annotations['${i}'].label == "${r}"`}),c.push({filterName:"exclude",filterCondition:`annotations['${i}'].label != "${r}"`})),c},[i,r,s]);return d.length===0?null:e("ul",{className:t,css:K`
        display: flex;
        height: 100%;
        flex-direction: row;
        gap: var(--ac-global-dimension-size-100);

        flex-wrap: wrap;
      `,children:d.map(c=>e("li",{children:e(Tn,{onPress:()=>{a(c.filterCondition)},children:c.filterName})},c.filterName))})}const Bc=function(){var n={defaultValue:null,kind:"LocalArgument",name:"annotationName"},a={defaultValue:null,kind:"LocalArgument",name:"id"},l={defaultValue:null,kind:"LocalArgument",name:"timeRange"},t=[{kind:"Variable",name:"id",variableName:"id"}],i=[{kind:"Variable",name:"annotationName",variableName:"annotationName"},{kind:"Variable",name:"timeRange",variableName:"timeRange"}],r={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},s={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},d={alias:null,args:null,kind:"ScalarField",name:"annotationType",storageKey:null},c={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},g={alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null};return{fragment:{argumentDefinitions:[n,a,l],kind:"Fragment",metadata:null,name:"AnnotationSummaryValueQuery",selections:[{alias:null,args:t,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:i,kind:"FragmentSpread",name:"AnnotationSummaryValueFragment"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[n,l,a],kind:"Operation",name:"AnnotationSummaryValueQuery",selections:[{alias:null,args:t,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[r,s,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"AnnotationConfigConnection",kind:"LinkedField",name:"annotationConfigs",plural:!1,selections:[{alias:null,args:null,concreteType:"AnnotationConfigEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[r,{kind:"InlineFragment",selections:[d],type:"AnnotationConfigBase",abstractKey:"__isAnnotationConfigBase"},{kind:"InlineFragment",selections:[d,s,{alias:null,args:null,kind:"ScalarField",name:"optimizationDirection",storageKey:null},c,{alias:null,args:null,concreteType:"CategoricalAnnotationValue",kind:"LinkedField",name:"values",plural:!0,selections:[g,{alias:null,args:null,kind:"ScalarField",name:"score",storageKey:null}],storageKey:null}],type:"CategoricalAnnotationConfig",abstractKey:null},{kind:"InlineFragment",selections:[s],type:"Node",abstractKey:"__isNode"}],storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:i,concreteType:"AnnotationSummary",kind:"LinkedField",name:"spanAnnotationSummary",plural:!1,selections:[c,{alias:null,args:null,concreteType:"LabelFraction",kind:"LinkedField",name:"labelFractions",plural:!0,selections:[g,{alias:null,args:null,kind:"ScalarField",name:"fraction",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"meanScore",storageKey:null}],storageKey:null}],type:"Project",abstractKey:null}],storageKey:null}]},params:{cacheID:"c867c2c9c74b0c472ca6763b8fc50752",id:null,metadata:{},name:"AnnotationSummaryValueQuery",operationKind:"query",text:`query AnnotationSummaryValueQuery(
  $annotationName: String!
  $timeRange: TimeRange!
  $id: ID!
) {
  node(id: $id) {
    __typename
    ...AnnotationSummaryValueFragment_4BTVrq
    id
  }
}

fragment AnnotationSummaryValueFragment_4BTVrq on Project {
  annotationConfigs {
    edges {
      node {
        __typename
        ... on AnnotationConfigBase {
          __isAnnotationConfigBase: __typename
          annotationType
        }
        ... on CategoricalAnnotationConfig {
          annotationType
          id
          optimizationDirection
          name
          values {
            label
            score
          }
        }
        ... on Node {
          __isNode: __typename
          id
        }
      }
    }
  }
  spanAnnotationSummary(annotationName: $annotationName, timeRange: $timeRange) {
    name
    labelFractions {
      label
      fraction
    }
    meanScore
  }
  id
}
`}}}();Bc.hash="5d114f6c3ea85467bd6c915907c07d87";const qc=function(){var n={alias:null,args:null,kind:"ScalarField",name:"annotationType",storageKey:null},a={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null};return{argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"annotationName"},{defaultValue:null,kind:"LocalArgument",name:"timeRange"}],kind:"Fragment",metadata:{refetch:{connection:null,fragmentPathInResult:["node"],operation:Bc,identifierInfo:{identifierField:"id",identifierQueryVariableName:"id"}}},name:"AnnotationSummaryValueFragment",selections:[{alias:null,args:null,concreteType:"AnnotationConfigConnection",kind:"LinkedField",name:"annotationConfigs",plural:!1,selections:[{alias:null,args:null,concreteType:"AnnotationConfigEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{kind:"InlineFragment",selections:[n],type:"AnnotationConfigBase",abstractKey:"__isAnnotationConfigBase"},{kind:"InlineFragment",selections:[n,a,{alias:null,args:null,kind:"ScalarField",name:"optimizationDirection",storageKey:null},l,{alias:null,args:null,concreteType:"CategoricalAnnotationValue",kind:"LinkedField",name:"values",plural:!0,selections:[t,{alias:null,args:null,kind:"ScalarField",name:"score",storageKey:null}],storageKey:null}],type:"CategoricalAnnotationConfig",abstractKey:null}],storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:[{kind:"Variable",name:"annotationName",variableName:"annotationName"},{kind:"Variable",name:"timeRange",variableName:"timeRange"}],concreteType:"AnnotationSummary",kind:"LinkedField",name:"spanAnnotationSummary",plural:!1,selections:[l,{alias:null,args:null,concreteType:"LabelFraction",kind:"LinkedField",name:"labelFractions",plural:!0,selections:[t,{alias:null,args:null,kind:"ScalarField",name:"fraction",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"meanScore",storageKey:null}],storageKey:null},a],type:"Project",abstractKey:null}}();qc.hash="5d114f6c3ea85467bd6c915907c07d87";const Uc=function(){var n={defaultValue:null,kind:"LocalArgument",name:"annotationName"},a={defaultValue:null,kind:"LocalArgument",name:"id"},l={defaultValue:null,kind:"LocalArgument",name:"timeRange"},t=[{kind:"Variable",name:"id",variableName:"id"}],i=[{kind:"Variable",name:"annotationName",variableName:"annotationName"},{kind:"Variable",name:"timeRange",variableName:"timeRange"}],r={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},s={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},d={alias:null,args:null,kind:"ScalarField",name:"annotationType",storageKey:null},c={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},g={alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null};return{fragment:{argumentDefinitions:[n,a,l],kind:"Fragment",metadata:null,name:"AnnotationSummaryQuery",selections:[{alias:"project",args:t,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:i,kind:"FragmentSpread",name:"AnnotationSummaryValueFragment"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[a,n,l],kind:"Operation",name:"AnnotationSummaryQuery",selections:[{alias:"project",args:t,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[r,s,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"AnnotationConfigConnection",kind:"LinkedField",name:"annotationConfigs",plural:!1,selections:[{alias:null,args:null,concreteType:"AnnotationConfigEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[r,{kind:"InlineFragment",selections:[d],type:"AnnotationConfigBase",abstractKey:"__isAnnotationConfigBase"},{kind:"InlineFragment",selections:[d,s,{alias:null,args:null,kind:"ScalarField",name:"optimizationDirection",storageKey:null},c,{alias:null,args:null,concreteType:"CategoricalAnnotationValue",kind:"LinkedField",name:"values",plural:!0,selections:[g,{alias:null,args:null,kind:"ScalarField",name:"score",storageKey:null}],storageKey:null}],type:"CategoricalAnnotationConfig",abstractKey:null},{kind:"InlineFragment",selections:[s],type:"Node",abstractKey:"__isNode"}],storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:i,concreteType:"AnnotationSummary",kind:"LinkedField",name:"spanAnnotationSummary",plural:!1,selections:[c,{alias:null,args:null,concreteType:"LabelFraction",kind:"LinkedField",name:"labelFractions",plural:!0,selections:[g,{alias:null,args:null,kind:"ScalarField",name:"fraction",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"meanScore",storageKey:null}],storageKey:null}],type:"Project",abstractKey:null}],storageKey:null}]},params:{cacheID:"b3fefe401db2ed0b6c2b65edec511205",id:null,metadata:{},name:"AnnotationSummaryQuery",operationKind:"query",text:`query AnnotationSummaryQuery(
  $id: ID!
  $annotationName: String!
  $timeRange: TimeRange!
) {
  project: node(id: $id) {
    __typename
    ...AnnotationSummaryValueFragment_4BTVrq
    id
  }
}

fragment AnnotationSummaryValueFragment_4BTVrq on Project {
  annotationConfigs {
    edges {
      node {
        __typename
        ... on AnnotationConfigBase {
          __isAnnotationConfigBase: __typename
          annotationType
        }
        ... on CategoricalAnnotationConfig {
          annotationType
          id
          optimizationDirection
          name
          values {
            label
            score
          }
        }
        ... on Node {
          __isNode: __typename
          id
        }
      }
    }
  }
  spanAnnotationSummary(annotationName: $annotationName, timeRange: $timeRange) {
    name
    labelFractions {
      label
      fraction
    }
    meanScore
  }
  id
}
`}}}();Uc.hash="3853ce97f7a810755cb61812e309942d";const Hc=m.createContext(null);function qa(){const n=m.useContext(Hc);if(n===null)throw new Error("useStreamState must be used within a StreamStateProvider");return n}function mb({initialFetchKey:n="initial",children:a}){const l=un(d=>d.traceStreamingEnabled),t=un(d=>d.setTraceStreamingEnabled),[i,r]=m.useState(n),s=m.useCallback(d=>{m.startTransition(()=>{r(d)})},[r]);return e(Hc.Provider,{value:{isStreaming:l,setIsStreaming:t,fetchKey:i,setFetchKey:s},children:a})}function gb({annotationName:n}){var i,r;const{projectId:a}=Qe(),{timeRange:l}=Ct(),t=T.useLazyLoadQuery(Uc,{annotationName:n,id:a,timeRange:{start:(i=l==null?void 0:l.start)==null?void 0:i.toISOString(),end:(r=l==null?void 0:l.end)==null?void 0:r.toISOString()}});return e(yb,{name:n,children:e(pb,{annotationName:n,project:t.project})})}function pb(n){var s,d,c,g;const{project:a,annotationName:l}=n,{fetchKey:t}=qa(),[i,r]=T.useRefetchableFragment(qc,a);return m.useEffect(()=>{m.startTransition(()=>{r({},{fetchPolicy:"store-and-network"})})},[t,r]),e(fb,{name:l,meanScore:(s=i==null?void 0:i.spanAnnotationSummary)==null?void 0:s.meanScore,labelFractions:(d=i==null?void 0:i.spanAnnotationSummary)==null?void 0:d.labelFractions,annotationConfig:(g=(c=i==null?void 0:i.annotationConfigs)==null?void 0:c.edges.find(f=>f.node.name===l))==null?void 0:g.node})}function yb({children:n,name:a}){return o(b,{direction:"column",flex:"none",children:[e(F,{elementType:"h3",size:"S",color:"text-700",children:e(an,{maxWidth:"120px",children:a})}),e(m.Suspense,{fallback:e(F,{size:"L",children:"--"}),children:n})]})}const Or={M:{chart:{width:24,height:24},pie:{innerRadius:8,outerRadius:11}},S:{chart:{width:16,height:16},pie:{innerRadius:6,outerRadius:8}},L:{chart:{width:32,height:32},pie:{innerRadius:10,outerRadius:13}}};function Gc(n,a,l,t){if(!t||t.annotationType!=="CATEGORICAL"||!t.values)return n[a%n.length];const r=[...t.values].sort((s,d)=>{const c=s.score??0,g=d.score??0;return(t.optimizationDirection==="MAXIMIZE"?-1:1)*(c-g)}).map(s=>s.label).indexOf(l);return n[r%n.length]}function Wc(n){const a=An();return[No(n),a.default,a.gray600,a.gray400,a.gray200]}function fb({name:n,meanScore:a,labelFractions:l,size:t="M",disableAnimation:i=!1,meanScoreFallback:r,annotationConfig:s}){const d=typeof a=="number",c=Array.isArray(l)&&l.length>0;return!d&&!c?e(F,{size:"L",children:"--"}):o(Ee,{delay:0,placement:"bottom",children:[e(nn,{children:e(hb,{name:n,meanScore:a,labelFractions:l,size:t,disableAnimation:i,meanScoreFallback:r,annotationConfig:s})}),e(oa,{children:e(Jc,{annotationName:n,labelFractions:l,meanScore:a,annotationConfig:s})})]})}function hb({name:n,meanScore:a,labelFractions:l,size:t="M",disableAnimation:i,meanScoreFallback:r,annotationConfig:s}){const d=Wc(n),c=typeof a=="number",g=l&&l.length>0;if(!c&&!g)return e(F,{size:"L",children:"--"});const f=Or[t].chart,u=Or[t].pie;return o(b,{direction:"row",alignItems:"center",justifyContent:"space-between",gap:"size-100",children:[g?e(Ss,{...f,children:e(ks,{data:l,dataKey:"fraction",nameKey:"label",cx:"50%",cy:"50%",...u,strokeWidth:0,stroke:"transparent",animationDuration:i?0:void 0,children:l.map((p,y)=>e(bs,{fill:Gc(d,y,p.label,s)},`cell-${y}`))})}):null,e(vt,{fallback:r,value:a,size:t==="S"?t:"L"})]})}function Jc({annotationName:n,labelFractions:a,meanScore:l,annotationConfig:t}){const i=Wc(n),r=typeof l=="number"&&!isNaN(l),s=a&&a.length>0;return e(v,{width:"size-2400",children:o(b,{direction:"column",gap:"size-50",children:[s&&e("ul",{children:a.map((d,c)=>e("li",{children:e(ze,{color:Gc(i,c,d.label,t),name:d.label,shape:"square",value:zo(d.fraction*100)})},d.label))}),s&&r?e(Ft,{}):null,r?o(b,{direction:"row",justifyContent:"space-between",children:[e(F,{children:"mean score"}),e(vt,{value:l})]}):null]})})}function Xc({name:n,labelFractions:a,annotationConfig:l}){var d;const t=a.reduce((c,g)=>Math.max(c,g.fraction),0),i=(d=a.find(c=>c.fraction===t))==null?void 0:d.label,r=a.length-1,s=r>0;return i?o(Ee,{delay:0,placement:"bottom",children:[e(nn,{children:o(b,{direction:"row",alignItems:"center",gap:"size-50",maxWidth:s?"80%":"99%",children:[e(Tn,{style:{maxWidth:"100%"},children:e(an,{maxWidth:"100%",children:i})}),s&&o(Tn,{children:["+ ",r]})]})}),e(oa,{children:e(Jc,{annotationName:n,labelFractions:a,annotationConfig:l})})]}):null}const MT=n=>Object.values(n.reduce((a,l)=>(a[l.name]?new Date(a[l.name].createdAt)<new Date(l.createdAt)&&(a[l.name]=l):a[l.name]=l,a),{})),Zc=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{alias:null,args:[{kind:"Variable",name:"annotationInput",variableName:"input"}],concreteType:"SpanAnnotationMutationPayload",kind:"LinkedField",name:"createSpanNote",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"SpanNotesEditorAddNoteMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"SpanNotesEditorAddNoteMutation",selections:a},params:{cacheID:"855aa00f68b36e86f375e7765413ac81",id:null,metadata:{},name:"SpanNotesEditorAddNoteMutation",operationKind:"mutation",text:`mutation SpanNotesEditorAddNoteMutation(
  $input: CreateSpanNoteInput!
) {
  createSpanNote(annotationInput: $input) {
    __typename
  }
}
`}}}();Zc.hash="fc7452182db44527c3f68ba81dd53e58";const Yc=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"spanNodeId"}],a={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},l=[a,{alias:null,args:null,kind:"ScalarField",name:"username",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"profilePictureUrl",storageKey:null}],t={alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"viewer",plural:!1,selections:l,storageKey:null},i=[{kind:"Variable",name:"id",variableName:"spanNodeId"}],r={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},s={alias:null,args:null,kind:"ScalarField",name:"explanation",storageKey:null},d={alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},c={alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"user",plural:!1,selections:l,storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"SpanNotesEditorQuery",selections:[t,{alias:"span",args:i,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"SpanAnnotation",kind:"LinkedField",name:"spanAnnotations",plural:!0,selections:[a,r,s,d,c],storageKey:null},{args:null,kind:"FragmentSpread",name:"SpanFeedback_annotations"}],type:"Span",abstractKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"SpanNotesEditorQuery",selections:[t,{alias:"span",args:i,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},a,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"SpanAnnotation",kind:"LinkedField",name:"spanAnnotations",plural:!0,selections:[a,r,s,d,c,{alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"score",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"metadata",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"annotatorKind",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"identifier",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"source",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"updatedAt",storageKey:null}],storageKey:null}],type:"Span",abstractKey:null}],storageKey:null}]},params:{cacheID:"1ee3e2486d1f2ef0b65f6f2fbbb82ec1",id:null,metadata:{},name:"SpanNotesEditorQuery",operationKind:"query",text:`query SpanNotesEditorQuery(
  $spanNodeId: ID!
) {
  viewer {
    id
    username
    profilePictureUrl
  }
  span: node(id: $spanNodeId) {
    __typename
    ... on Span {
      spanAnnotations {
        id
        name
        explanation
        createdAt
        user {
          id
          username
          profilePictureUrl
        }
      }
      ...SpanFeedback_annotations
    }
    id
  }
}

fragment SpanFeedback_annotations on Span {
  id
  spanAnnotations {
    id
    name
    label
    score
    explanation
    metadata
    annotatorKind
    identifier
    source
    createdAt
    updatedAt
    user {
      id
      username
      profilePictureUrl
    }
  }
}
`}}}();Yc.hash="5ef72854a1deefb62cd963735947309d";const di="n",kb=K`
  width: 100%;
  height: 100%;
  max-height: 100%;
  overflow: auto;
  display: flex;
  flex-direction: column;
  gap: var(--ac-global-dimension-size-100);
  padding: var(--ac-global-dimension-size-100);
  box-sizing: border-box;
  li {
    width: 100%;
  }
`;function bb(n){var f;const[a,l]=m.useState(0),t=m.useRef(null),i=T.useLazyLoadQuery(Yc,{spanNodeId:n.spanNodeId},{fetchKey:a,fetchPolicy:"store-and-network"}),[r,s]=T.useMutation(Zc),d=u=>{m.startTransition(()=>{r({variables:{input:{note:u,spanId:n.spanNodeId}}}),l(a+1)})},g=(((f=i.span)==null?void 0:f.spanAnnotations)||[]).filter(u=>u.name==="note");return m.useEffect(()=>{t.current&&t.current.scrollIntoView({behavior:"smooth"})},[g]),o(b,{direction:"column",height:"100%",justifyContent:"space-between",children:[o("ul",{css:kb,children:[g.map(u=>{var p,y,h,k;return e("li",{children:e(Zy,{text:u.explanation||"",timestamp:new Date(u.createdAt),userName:((p=u.user)==null?void 0:p.username)||"system",userPicture:(y=u.user)==null?void 0:y.profilePictureUrl,isOutgoing:((h=u.user)==null?void 0:h.id)===((k=i.viewer)==null?void 0:k.id)})},u.id)}),e("div",{ref:t,"aria-hidden":"true"})]}),o(go,{restoreFocus:!0,children:[e($o,{hotkey:di}),e(jo,{onSendMessage:d,placeholder:"Add a note",isSending:s})]})]})}function Sb(){return o(b,{direction:"column",height:"100%",justifyContent:"space-between",children:[e(v,{padding:"size-100",children:o(b,{direction:"column",gap:"size-100",height:"100%",children:[e(br,{isOutgoing:!1,height:70}),e(br,{isOutgoing:!0,height:40})]})}),e(jo,{onSendMessage:()=>{},placeholder:"Add a note"})]})}const Wt="s";function vb(n){const a=T.useFragment(Oc,n.span),l=m.useRef(null),t=m.useRef(null);return Sa(Sr,()=>{l.current&&l.current.isCollapsed()&&l.current.expand(50)}),Sa(di,()=>{t.current&&t.current.isCollapsed()&&t.current.expand(50)}),o(Fn,{direction:"vertical",autoSaveId:"span-aside-layout",children:[e(m.Suspense,{children:e(Fb,{span:a})}),e(oi,{ref:l,resizable:!0,title:o(b,{direction:"row",gap:"size-100",alignItems:"center",children:[e("span",{children:"Edit Annotations"}),e(Pl,{children:Sr})]}),panelProps:{order:2,minSize:10},children:e(v,{height:"100%",maxHeight:"100%",children:e(Yy,{projectId:a.project.id,spanNodeId:a.id},a.id)})}),e(oi,{ref:t,resizable:!0,title:o(b,{direction:"row",gap:"size-100",alignItems:"center",children:[e("span",{children:"Notes"}),e(Pl,{children:di})]}),panelProps:{order:3,minSize:10},children:e(v,{height:"100%",maxHeight:"100%",padding:"size-100",children:e(m.Suspense,{fallback:e(Sb,{}),children:e(bb,{spanNodeId:a.id})})})})]})}function Fb(n){const a=T.useFragment(jc,n.span),l=m.useRef(null);Sa(Wt,()=>{l.current&&l.current.isCollapsed()&&l.current.expand(50)});const t=a.spanAnnotations.length>0;return e(oi,{ref:l,title:o(b,{direction:"row",gap:"size-100",alignItems:"center",children:[e("span",{children:"Annotation Summary"}),e(Pl,{children:Wt})]}),disabled:!t,panelProps:{order:1,defaultSize:t?20:0,minSize:t?20:0},children:o(go,{children:[e($o,{hotkey:Wt}),e(v,{paddingY:"size-200",paddingX:"size-200",overflow:"auto",maxHeight:"100%",children:e(Kt,{span:a})})]})})}const eu=function(){var n={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"SpanFeedback_annotations",selections:[n,{alias:null,args:null,concreteType:"SpanAnnotation",kind:"LinkedField",name:"spanAnnotations",plural:!0,selections:[n,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"score",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"explanation",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"metadata",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"annotatorKind",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"identifier",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"source",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"updatedAt",storageKey:null},{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"user",plural:!1,selections:[n,{alias:null,args:null,kind:"ScalarField",name:"username",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"profilePictureUrl",storageKey:null}],storageKey:null}],storageKey:null}],type:"Span",abstractKey:null}}();eu.hash="9a73b57370acadba7a0398c1439e9893";function Cb(){return e(v,{padding:"size-200",children:o(b,{direction:"column",gap:"size-100",alignItems:"center",children:[e(st,{graphicKey:"documents"}),e(F,{children:"No annotations for this span"}),e(nl,{leadingVisual:e(I,{svg:e(kt,{})}),href:"https://arize.com/docs/phoenix/tracing/concepts-tracing/how-to-evaluate-traces",size:"S",children:"How to Annotate"})]})})}const Kb=K`
  overflow: auto;
`;function Tb({annotations:n,spanNodeId:a}){const l=m.useMemo(()=>n.map(u=>({...u,spanNodeId:a})),[n,a]),t=me(),i=be(),r=m.useMemo(()=>[{header:"name",accessorKey:"name",size:100},{header:"annotator kind",accessorKey:"annotatorKind",size:100,cell:({row:u})=>{const p=u.original.annotatorKind;return e(nf,{kind:p})}},{header:"user",accessorKey:"user",size:100,cell:({row:u})=>{const p=u.original.user,y=(p==null?void 0:p.username)||"system";return o(b,{direction:"row",gap:"size-100",alignItems:"center",children:[e(ut,{name:y,profilePictureUrl:(p==null?void 0:p.profilePictureUrl)||null,size:18}),e("span",{children:y})]})}},{header:"label",accessorKey:"label",size:100},{header:"score",accessorKey:"score",size:100},{header:"explanation",accessorKey:"explanation",cell:ef,size:400},{header:"source",accessorKey:"source",size:100},{header:"identifier",accessorKey:"identifier",size:100},{header:"metadata",accessorKey:"metadata",minSize:100,cell:({row:u})=>{const p=u.original.metadata;return p?e(il,{json:p,collapseSingleKey:!1}):"--"}},{header:"created at",accessorKey:"createdAt",size:100,cell:_e},{header:"updated at",accessorKey:"updatedAt",size:100,cell:_e},{header:"",accessorKey:"actions",size:100,cell:({row:u})=>e(af,{annotationId:u.original.id,spanNodeId:u.original.spanNodeId,annotationName:u.original.name,onSpanAnnotationActionSuccess:t,onSpanAnnotationActionError:p=>{i({title:"Failed to update span annotation",message:p.message})}})}],[i,t]),[s,d]=m.useState([{id:"createdAt",desc:!0}]),c=Ce({columns:r,data:l,getCoreRowModel:Ke(),getSortedRowModel:ln(),onSortingChange:d,state:{sorting:s}}),f=c.getRowModel().rows.length===0;return e("div",{css:Kb,children:o("table",{css:We,"data-testid":"span-annotations-table",children:[e("thead",{children:c.getHeaderGroups().map(u=>e("tr",{children:u.headers.map(p=>e("th",{colSpan:p.colSpan,children:p.isPlaceholder?null:e(J,{children:o("div",{className:p.column.getCanSort()?"sort":"",onClick:p.column.getToggleSortingHandler(),style:{display:"flex",alignItems:"center",left:p.getStart(),width:p.getSize()},children:[e(an,{maxWidth:"100%",children:W(p.column.columnDef.header,p.getContext())}),p.column.getIsSorted()?e(I,{className:"sort-icon",svg:p.column.getIsSorted()==="asc"?e(Xe,{}):e(Ze,{})}):null]})})},p.id))},u.id))}),f?e(yn,{}):e("tbody",{children:c.getRowModel().rows.map(u=>e("tr",{children:u.getVisibleCells().map(p=>e("td",{style:{width:p.column.getSize()},children:W(p.column.columnDef.cell,p.getContext())},p.id))},u.id))})]})})}function Pb({span:n}){const a=T.useFragment(eu,n),l=a.spanAnnotations;return a.spanAnnotations.length>0?e(Tb,{annotations:l,spanNodeId:a.id}):e(Cb,{})}function xb(n){return n==="__REDACTED__"}const Ib=K`
  position: relative;
  overflow: hidden;
  width: 200px;
  height: 200px;
  border-radius: var(--ac-global-rounding-small);
  border: 1px solid var(--ac-global-color-grey-500);
  background-color: var(--ac-global-color-grey-200);
  overflow: hidden;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  transition:
    width 0.1s ease-in-out,
    height 0.1s ease-in-out opacity 0.1s ease-in-out;
  button {
    position: absolute;
    right: var(--ac-global-dimension-size-100);
    top: var(--ac-global-dimension-size-100);
    z-index: 1;
    opacity: 0;
  }
  &:hover button {
    opacity: 1;
  }
  img {
    width: inherit;
    height: inherit;
    object-fit: contain;
  }

  &.is-expanded {
    width: 100%;
    height: 100%;
    img {
      object-fit: cover;
    }
  }
`;function Db(n){const[a,l]=m.useState(!1);let t;const i=xb(n.url);return i?t=e(Lb,{}):t=e("img",{src:n.url}),o("div",{className:Dp({"is-expanded":a}),css:Ib,children:[!i&&e(M,{variant:"default",size:"S",onPress:()=>l(!a),leadingVisual:e(I,{svg:a?e(lf,{}):e(xl,{})}),"aria-label":"Expand / Collapse Image"}),t]})}const Lb=()=>o("svg",{width:"130",height:"130",viewBox:"0 0 130 130",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[e("rect",{x:"1.5",y:"1.5",width:"127",height:"127",rx:"6.5",strokeOpacity:"0.8",strokeWidth:"3"}),e("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M40 27.5H90C96.8917 27.5 102.5 33.1083 102.5 40V90C102.5 96.8917 96.8917 102.5 90 102.5H40C33.1083 102.5 27.5 96.8917 27.5 90V40C27.5 33.1083 33.1083 27.5 40 27.5ZM40 35.8333H90C92.3 35.8333 94.1667 37.7 94.1667 40V74.85L80.8208 63.4667C76.6958 59.9583 70.2417 59.9583 66.1542 63.4417L35.8333 88.7417V40C35.8333 37.7 37.7 35.8333 40 35.8333ZM54.5833 50.4167C54.5833 53.8667 51.7833 56.6667 48.3333 56.6667C44.8833 56.6667 42.0833 53.8667 42.0833 50.4167C42.0833 46.9667 44.8833 44.1667 48.3333 44.1667C51.7833 44.1667 54.5833 46.9667 54.5833 50.4167ZM42.3375 94.1667H90C92.3 94.1667 94.1667 92.3 94.1667 90V85.8083L75.4125 69.8083C74.4083 68.9458 72.55 68.9417 71.525 69.8125L42.3375 94.1667Z",fill:"var(--ac-global-color-grey-300)"})]}),nu=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"DatasetMutationPayload",kind:"LinkedField",name:"addExamplesToDataset",plural:!1,selections:[{alias:null,args:null,concreteType:"Dataset",kind:"LinkedField",name:"dataset",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"SpanToDatasetExampleDialogAddExampleToDatasetMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"SpanToDatasetExampleDialogAddExampleToDatasetMutation",selections:a},params:{cacheID:"d93c9d47668fc266ba09ecb14c2b72ae",id:null,metadata:{},name:"SpanToDatasetExampleDialogAddExampleToDatasetMutation",operationKind:"mutation",text:`mutation SpanToDatasetExampleDialogAddExampleToDatasetMutation(
  $input: AddExamplesToDatasetInput!
) {
  addExamplesToDataset(input: $input) {
    dataset {
      id
    }
  }
}
`}}}();nu.hash="75120065d239f28304e9dd91fc34bec9";const au=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"spanId"}],a=[{kind:"Variable",name:"id",variableName:"spanId"}],l={kind:"InlineFragment",selections:[{alias:"revision",args:null,concreteType:"SpanAsExampleRevision",kind:"LinkedField",name:"asExampleRevision",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"input",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"output",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"metadata",storageKey:null}],storageKey:null}],type:"Span",abstractKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"SpanToDatasetExampleDialogQuery",selections:[{alias:"span",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[l],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"SpanToDatasetExampleDialogQuery",selections:[{alias:"span",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},l,{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null}]},params:{cacheID:"48a0d4811a4c4fd2cf3c7114f1b04fc9",id:null,metadata:{},name:"SpanToDatasetExampleDialogQuery",operationKind:"query",text:`query SpanToDatasetExampleDialogQuery(
  $spanId: ID!
) {
  span: node(id: $spanId) {
    __typename
    ... on Span {
      revision: asExampleRevision {
        input
        output
        metadata
      }
    }
    id
  }
}
`}}}();au.hash="9ff195bb3e4302feb10eb48b22dfdcb1";const Jt={backgroundColor:"light",borderColor:"light",collapsible:!0,bodyStyle:{padding:0}};function _b({spanId:n,onCompleted:a}){const[l,t]=m.useState(null),i=T.useLazyLoadQuery(au,{spanId:n},{fetchPolicy:"store-and-network"}),{span:{revision:r}}=i,[s,d]=T.useMutation(nu),{control:c,setError:g,handleSubmit:f,formState:{isValid:u}}=Ve({defaultValues:{input:JSON.stringify(r==null?void 0:r.input,null,2),output:JSON.stringify(r==null?void 0:r.output,null,2),metadata:JSON.stringify(r==null?void 0:r.metadata,null,2),datasetId:""}}),p=m.useCallback(y=>{if(t(null),!Zn(y==null?void 0:y.input))return g("input",{message:"Input must be a valid JSON object"});if(!Zn(y==null?void 0:y.output))return g("output",{message:"Output must be a valid JSON object"});if(!Zn(y==null?void 0:y.metadata))return g("metadata",{message:"Metadata must be a valid JSON object"});if(!(y!=null&&y.datasetId))return g("datasetId",{message:"Dataset is required"});s({variables:{input:{datasetId:y.datasetId,examples:[{input:JSON.parse(y.input),output:JSON.parse(y.output),metadata:JSON.parse(y.metadata),spanId:n}]}},onCompleted:()=>{a(y.datasetId)},onError:h=>{const k=De(h);t((k==null?void 0:k[0])??h.message)}})},[s,g,n,a]);return e(He,{children:({close:y})=>o(ea,{children:[o(na,{children:[e(aa,{children:"Add Example to Dataset"}),o(Oa,{children:[e(M,{variant:"primary",size:"S",isDisabled:!u||d,onPress:()=>{f(p)(),y()},leadingVisual:e(I,{svg:d?e(sn,{}):e(ka,{})}),children:"Add Example"}),e(Qa,{slot:"close"})]})]}),e("div",{css:K`
              overflow-y: auto;
              padding: var(--ac-global-dimension-size-400);
              /* Make widths configurable */
              .dataset-picker {
                width: 100%;
              }
            `,children:e(b,{direction:"row",justifyContent:"center",children:e(v,{width:"900px",paddingStart:"auto",paddingEnd:"auto",children:o(b,{direction:"column",gap:"size-200",children:[l?e(Fe,{variant:"danger",children:l}):null,e(G,{control:c,name:"datasetId",render:({field:{onChange:h,onBlur:k},fieldState:{invalid:S,error:C}})=>o(b,{direction:"row",gap:"size-100",alignItems:"end",children:[e(Oo,{isRequired:!0,onSelectionChange:h,onBlur:k,validationState:S?"invalid":"valid",errorMessage:C==null?void 0:C.message,label:"Dataset"}),e(tf,{})]})}),e(G,{control:c,name:"input",render:({field:{onChange:h,onBlur:k,value:S},fieldState:{invalid:C,error:P}})=>o(q,{title:"Input",subTitle:"The input to the LLM, retriever, program, etc.",...Jt,children:[C?e(Fe,{variant:"danger",banner:!0,children:P==null?void 0:P.message}):null,e(rn,{value:S,onChange:h,onBlur:k})]})}),e(G,{control:c,name:"output",render:({field:{onChange:h,onBlur:k,value:S},fieldState:{invalid:C,error:P}})=>o(q,{title:"Output",subTitle:"The output of the LLM or program to be used as an expected output",...Jt,backgroundColor:"green-100",borderColor:"green-700",children:[C?e(Fe,{variant:"danger",banner:!0,children:P==null?void 0:P.message}):null,e(rn,{value:S,onChange:h,onBlur:k})]})}),e(G,{control:c,name:"metadata",render:({field:{onChange:h,onBlur:k,value:S},fieldState:{invalid:C,error:P}})=>o(q,{title:"Metadata",subTitle:"All data from the span to use during experimentation or evaluation",...Jt,children:[C?e(Fe,{variant:"danger",banner:!0,children:P==null?void 0:P.message}):null,e(rn,{value:S,onChange:h,onBlur:k})]})})]})})})})]})})}const Ab=n=>m.useMemo(()=>Be(n),[n]),wb=n=>n.events.some(a=>a.name==="exception"),Le={backgroundColor:"light",borderColor:"light",variant:"compact",collapsible:!0,bodyStyle:{padding:0}},Rb=900,Xt=33,Qr="e";function Eb({spanNodeId:n}){const a=un(g=>g.isAnnotatingSpans),l=un(g=>g.setIsAnnotatingSpans),t=m.useRef(null),i=m.useRef(null),r=sb(i),s=r!=null&&r.width?r.width<Rb:!0,{span:d}=T.useLazyLoadQuery(Nc,{id:n});if(d.__typename!=="Span")throw new Error("Expected a span, but got a different type"+d.__typename);Sa(Qr,()=>{a||l(!0)},{preventDefault:!0});const c=m.useMemo(()=>wb(d),[d]);return o(Fn,{direction:"horizontal",autoSaveId:"span-details-layout",children:[e(Ie,{order:1,children:o(b,{direction:"column",flex:"1 1 auto",height:"100%",ref:i,children:[e(v,{paddingTop:"size-100",paddingBottom:"size-50",paddingStart:"size-150",paddingEnd:"size-200",flex:"none",children:o(b,{direction:"row",alignItems:"center","data-testid":"span-header-row",children:[e(cb,{span:d}),o(b,{flex:"none",direction:"row",alignItems:"center",gap:"size-100",children:[e(sa,{variant:d.spanKind!=="llm"?"default":"primary",leadingVisual:e(I,{svg:e(Da,{})}),isDisabled:d.spanKind!=="llm",to:`/playground/spans/${d.id}`,size:"S","aria-label":"Prompt Playground",children:s?null:"Playground"}),e(zb,{span:d,buttonText:s?null:"Add to Dataset"}),e(Pn,{size:"S",isSelected:a,onPress:()=>{l(!a);const g=t.current;g&&g.getSize()<Xt&&g.resize(Xt)},leadingVisual:e(I,{svg:e(kt,{})}),trailingVisual:!s&&!a&&e(Qo,{children:Qr}),children:s?null:"Annotate"}),e(ub,{traceId:d.trace.traceId,spanId:d.spanId})]})]})}),o(cn,{children:[o(dn,{children:[e(le,{id:"info",children:"Info"}),o(le,{id:"annotations",children:["Annotations ",e(Ln,{children:d.spanAnnotations.length})]}),e(le,{id:"attributes",children:"Attributes"}),o(le,{id:"events",children:["Events"," ",e(Ln,{variant:c?"danger":"default",children:d.events.length})]})]}),e(re,{id:"info",children:e(b,{direction:"row",height:"100%",children:e(Vb,{children:e(Tt,{children:e(Nb,{span:d})})})})}),e(re,{id:"annotations",children:e(Pb,{span:d})}),e(re,{id:"attributes",children:e(v,{padding:"size-200",height:"100%",maxHeight:"100%",overflow:"auto",children:e(q,{title:"All Attributes",...Le,titleExtra:iu,extra:e(de,{text:d.attributes}),children:e(Ka,{children:d.attributes})})})}),e(re,{id:"events",children:e(aS,{events:d.events})})]})]})}),a&&e(Dn,{css:Pt}),a&&e(Ie,{order:2,ref:t,defaultSize:Xt,minSize:10,collapsible:!0,onCollapse:()=>{l(!1)},children:e(vb,{span:d})})]})}const Mb=K`
  flex: 1 1 auto;
  overflow-y: auto;
  // Overflow fails to take into account padding
  & > *:after {
    content: "";
    display: block;
    height: var(--ac-global-dimension-static-size-400);
  }
`;function Vb({children:n}){return e("div",{css:Mb,"data-testid":"span-info-wrap",children:n})}function zb({span:n,buttonText:a}){const l=me(),t=ce();return o(Ne,{children:[e(M,{variant:"default",size:"S",leadingVisual:e(I,{svg:e(gt,{})}),children:a}),e(Lp,{children:e(Ge,{variant:"slideover",size:"L",children:e(m.Suspense,{fallback:e(ge,{}),children:e(_b,{spanId:n.id,onCompleted:i=>{l({title:"Span Added to Dataset",message:"Successfully added span to dataset",action:{text:"View Dataset",onClick:()=>{t(`/datasets/${i}/examples`)}}})}})})})})]})}function Nb({span:n}){const{spanKind:a,attributes:l}=n,{json:t,parseError:i}=Ab(l),r=m.useMemo(()=>n.statusMessage?e(Fe,{variant:"danger",title:"Status Description",children:n.statusMessage}):null,[n]);if(i||!t)return e(v,{padding:"size-200",children:o(b,{direction:"column",gap:"size-200",children:[r,e(Fe,{variant:"warning",title:"Un-parsable attributes",children:`Failed to parse span attributes. ${i instanceof Error?i.message:""}`}),e(q,{...Le,title:"Attributes",children:e(v,{padding:"size-100",children:l})})]})});let s;switch(a){case"llm":{s=e($b,{span:n,spanAttributes:t});break}case"retriever":{s=e(jb,{span:n,spanAttributes:t});break}case"reranker":{s=e(Ob,{span:n,spanAttributes:t});break}case"embedding":{s=e(Qb,{span:n,spanAttributes:t});break}case"tool":{s=e(Bb,{span:n,spanAttributes:t});break}default:s=e(lu,{span:n})}return e(v,{padding:"size-200",children:o(b,{direction:"column",gap:"size-200",children:[r,s,t!=null&&t.metadata?e(q,{...Le,title:"Metadata",children:e(Ka,{children:JSON.stringify(t.metadata)})}):null]})})}function $b(n){const{spanAttributes:a,span:l}=n,{input:t,output:i}=l,r=m.useMemo(()=>a[Se.llm]||null,[a]),s=r==null?void 0:r[qe.provider],d=m.useMemo(()=>{if(r==null)return null;const x=r[qe.model_name];return typeof x=="string"?x:null},[r]),c=m.useMemo(()=>{if(r==null)return[];const x=r[qe.input_messages];return jr(x)?(x==null?void 0:x.map(R=>R[Se.message]).filter(Boolean))||[]:[]},[r]),g=m.useMemo(()=>{if(r==null)return[];const x=r[qe.tools];return Array.isArray(x)?x==null?void 0:x.map(A=>A[Se.tool]).filter(Boolean):[]},[r]),f=m.useMemo(()=>g.reduce((x,R)=>(R!=null&&R.json_schema&&x.push(R.json_schema),x),[]),[g]),u=m.useMemo(()=>{if(r==null)return[];const x=r[qe.output_messages];return jr(x)?x.map(R=>R[Se.message]).filter(Boolean)||[]:[]},[r]),p=m.useMemo(()=>{if(r==null)return[];const x=r[qe.prompts];return of(x)?x:[]},[r]),y=m.useMemo(()=>{if(r==null)return null;const x=r[qe.prompt_template];return x??null},[r]),h=m.useMemo(()=>r==null?"{}":r[qe.invocation_parameters]||"{}",[r]),k=m.useMemo(()=>{if(d==null)return null;let x=e(Ii,{spanKind:"llm"});const R=s==null?void 0:s.toUpperCase();return typeof R=="string"&&qo(R)&&(x=e(Rl,{provider:R})),o(b,{direction:"row",gap:"size-100",alignItems:"center",children:[x,e(F,{size:"M",weight:"heavy",children:d})]})},[d,s]),S=t!=null&&t.value!=null,C=c.length>0,P=f.length>0,L=i!=null&&i.value!=null,_=u.length>0,w=p.length>0,V=Object.keys(Be(h).json||{}).length>0,Q=y!=null;return o(b,{direction:"column",gap:"size-200",children:[e(q,{collapsible:!0,backgroundColor:"light",borderColor:"light",bodyStyle:{padding:0},titleSeparator:!1,variant:"compact",title:k,children:o(cn,{children:[o(dn,{children:[C&&e(le,{id:"input-messages",children:"Input Messages"}),P&&e(le,{id:"tools",children:"Tools"}),S&&e(le,{id:"input",children:"Input"}),Q&&e(le,{id:"prompt-template",children:"Prompt Template"}),w&&e(le,{id:"prompts",children:"Prompts"}),V&&e(le,{id:"invocation-params",children:"Invocation Params"})]}),C&&e(re,{id:"input-messages",children:e(Br,{messages:c})}),P&&e(re,{id:"tools",children:e(Gb,{toolSchemas:f})}),S&&e(re,{id:"input",children:e(v,{padding:"size-200",children:e(Kn,{children:e(q,{...Le,title:"LLM Input",extra:o(b,{direction:"row",gap:"size-100",children:[e(Qn,{}),e(de,{text:t.value})]}),children:e(ia,{...t})})})})}),Q&&e(re,{id:"prompt-template",children:e(v,{padding:"size-200",children:o(b,{direction:"column",gap:"size-100",children:[e(v,{borderRadius:"medium",borderColor:"light",backgroundColor:"light",borderWidth:"thin",padding:"size-200",children:o(Wl,{text:y.template,children:[e(F,{color:"text-700",fontStyle:"italic",children:"prompt template"}),e(tu,{children:y.template})]})}),e(v,{borderRadius:"medium",borderColor:"light",backgroundColor:"light",borderWidth:"thin",padding:"size-200",children:o(Wl,{text:JSON.stringify(y.variables),children:[e(F,{color:"text-700",fontStyle:"italic",children:"template variables"}),e(Ka,{children:JSON.stringify(y.variables)})]})})]})})}),w&&e(re,{id:"prompts",children:e(Wb,{prompts:p})}),V&&e(re,{id:"invocation-params",children:e(Wl,{text:h,padding:"size-100",children:e(Ka,{children:h})})})]})}),L||_?e(yi,{...Le,children:o(cn,{children:[o(dn,{children:[_&&e(le,{id:"output-messages",children:"Output Messages"}),L&&e(le,{id:"output",children:"Output"})]}),_&&e(re,{id:"output-messages",children:e(Br,{messages:u})}),L&&e(re,{id:"output",children:e(v,{padding:"size-200",children:e(Kn,{children:e(q,{...Le,title:"LLM Output",extra:o(b,{direction:"row",gap:"size-100",children:[e(Qn,{}),e(de,{text:i.value})]}),children:e(ia,{...i})})})})})]})}):null]})}function jb(n){const{spanAttributes:a,span:l}=n,{input:t}=l,i=m.useMemo(()=>a[Se.retrieval]||null,[a]),r=m.useMemo(()=>{var u;return i==null?[]:((u=i[_p.documents])==null?void 0:u.map(p=>p[Se.document]).filter(Boolean))||[]},[i]),s=m.useMemo(()=>l.documentEvaluations.reduce((p,y)=>{const h=y.documentPosition,k=p[h]||[];return{...p,[h]:[...k,y]}},{}),[l.documentEvaluations]),d=t!=null&&t.value!=null,c=d&&t.mimeType==="text",g=r.length>0,f=l.documentRetrievalMetrics.length>0;return o(b,{direction:"column",gap:"size-200",children:[d?e(Kn,{children:e(q,{title:"Input",...Le,extra:e(b,{direction:"row",gap:"size-100",alignItems:"center",children:c?e(Qn,{}):e(de,{text:t.value})}),children:e(ia,{...t})})}):null,g?e(Kn,{children:e(q,{title:"Documents",...Le,titleExtra:f&&e(b,{direction:"row",alignItems:"center",gap:"size-100",children:l.documentRetrievalMetrics.map(u=>o(J,{children:[e(vn,{name:u.evaluationName,metric:"ndcg",score:u.ndcg},"ndcg"),e(vn,{name:u.evaluationName,metric:"precision",score:u.precision},"precision"),e(vn,{name:u.evaluationName,metric:"hit",score:u.hit},"hit")]}))}),extra:e(Qn,{}),children:e("ul",{css:K`
                display: flex;
                flex-direction: column;
                gap: var(--ac-global-dimension-static-size-200);
                padding: var(--ac-global-dimension-static-size-200);
              `,children:r.map((u,p)=>e("li",{children:e(ci,{document:u,documentEvaluations:s[p],borderColor:"seafoam-700",backgroundColor:"seafoam-100",tokenColor:"var(--ac-global-color-seafoam-1000)"})},p))})})}):null]})}function Ob(n){const{spanAttributes:a}=n,l=m.useMemo(()=>a[Se.reranker]||null,[a]),t=m.useMemo(()=>l==null?null:l[jt.query]||null,[l]),i=m.useMemo(()=>{var c;return l==null?[]:((c=l[jt.input_documents])==null?void 0:c.map(g=>g[Se.document]).filter(Boolean))||[]},[l]),r=m.useMemo(()=>{var c;return l==null?[]:((c=l[jt.output_documents])==null?void 0:c.map(g=>g[Se.document]).filter(Boolean))||[]},[l]),s=i.length,d=r.length;return o(b,{direction:"column",gap:"size-200",children:[e(Kn,{children:t&&e(q,{title:"Query",...Le,children:e(v,{padding:"size-200",children:e(Va,{children:t})})})}),e(q,{title:"Input Documents",titleExtra:e(Ln,{children:s}),...Le,defaultOpen:!1,bodyStyle:{padding:0},children:e("ul",{css:K`
              padding: var(--ac-global-dimension-static-size-200);
              display: flex;
              flex-direction: column;
              gap: var(--ac-global-dimension-static-size-200);
            `,children:i.map((c,g)=>e("li",{children:e(ci,{document:c,borderColor:"seafoam-700",backgroundColor:"seafoam-100",tokenColor:"var(--ac-global-color-seafoam-1000)"})},g))})}),e(q,{title:"Output Documents",titleExtra:e(Ln,{children:d}),...Le,bodyStyle:{padding:0},children:e("ul",{css:K`
              padding: var(--ac-global-dimension-static-size-200);
              display: flex;
              flex-direction: column;
              gap: var(--ac-global-dimension-static-size-200);
            `,children:r.map((c,g)=>e("li",{children:e(ci,{document:c,borderColor:"celery-700",backgroundColor:"celery-100",tokenColor:"var(--ac-global-color-celery-1000)"})},g))})})]})}function Qb(n){const{spanAttributes:a}=n,l=m.useMemo(()=>a[Se.embedding]||null,[a]),t=m.useMemo(()=>{var s;return l==null?[]:((s=l[Ot.embeddings])==null?void 0:s.map(d=>d[Se.embedding]).filter(Boolean))||[]},[l]),i=t.length>0,r=l==null?void 0:l[Ot.model_name];return e(b,{direction:"column",gap:"size-200",children:i?e(q,{title:"Embeddings"+(typeof r=="string"?`: ${r}`:""),...Le,children:e("ul",{css:K`
                display: flex;
                flex-direction: column;
                gap: var(--ac-global-dimension-static-size-200);
                padding: var(--ac-global-dimension-static-size-200);
              `,children:t.map((s,d)=>e("li",{children:e(Kn,{children:e(q,{...Le,backgroundColor:"purple-100",borderColor:"purple-700",title:"Embedded Text",children:e(Va,{children:s[Ot.text]||""})})})},d))})}):e(lu,{span:n.span})})}function Bb(n){const{span:a,spanAttributes:l}=n,{input:t,output:i}=a,r=typeof(t==null?void 0:t.value)=="string",s=typeof(i==null?void 0:i.value)=="string",d=(t==null?void 0:t.mimeType)==="text",c=(i==null?void 0:i.mimeType)==="text",g=m.useMemo(()=>l[Se.tool]||{},[l]),f=Object.keys(g).length>0,u=g[Hl.name],p=g[Hl.description],y=g[Hl.parameters];return!r&&!s&&!f?null:o(b,{direction:"column",gap:"size-200",children:[r?e(Kn,{children:e(q,{title:"Input",...Le,extra:o(b,{direction:"row",gap:"size-100",alignItems:"center",children:[d?e(Qn,{}):null,e(de,{text:t.value})]}),children:e(ia,{...t})})}):null,s?e(Kn,{children:e(q,{title:"Output",...Le,backgroundColor:"green-100",borderColor:"green-700",extra:o(b,{direction:"row",gap:"size-100",alignItems:"center",children:[c?e(Qn,{}):null,e(de,{text:i.value})]}),children:e(ia,{...i})})}):null,f?e(q,{title:"Tool"+(typeof u=="string"?`: ${u}`:""),...Le,children:o(b,{direction:"column",children:[p!=null?e(v,{paddingStart:"size-200",paddingEnd:"size-200",paddingTop:"size-100",paddingBottom:"size-100",borderBottomColor:"dark",borderBottomWidth:"thin",backgroundColor:"light",children:o(b,{direction:"column",alignItems:"start",gap:"size-50",children:[e(F,{color:"text-700",fontStyle:"italic",children:"Description"}),e(F,{children:p})]})}):null,y!=null?e(v,{paddingStart:"size-200",paddingEnd:"size-200",paddingTop:"size-100",paddingBottom:"size-100",borderBottomColor:"dark",borderBottomWidth:"thin",children:o(b,{direction:"column",alignItems:"start",width:"100%",children:[e(F,{color:"text-700",fontStyle:"italic",children:"Parameters"}),e("div",{css:K`
                      .cm-editor {
                        background-color: transparent !important;
                      }
                    `,children:e(Ka,{basicSetup:{lineNumbers:!1,foldGutter:!1},children:JSON.stringify(y)})})]})}):null]})}):null]})}const qb=["irrelevant","unrelated"];function ci({document:n,documentEvaluations:a,backgroundColor:l,borderColor:t,tokenColor:i}){const r=n[ml.metadata],s=a&&a.length,d=n[ml.content];return e(q,{...Le,backgroundColor:l,borderColor:t,bodyStyle:{padding:0},title:o(b,{direction:"row",gap:"size-50",alignItems:"center",children:[e(I,{svg:e(Bo,{})}),o(ae,{level:4,children:["document ",n[ml.id]]})]}),extra:typeof n[ml.score]=="number"&&e(Tn,{color:i,children:`score ${xi(n[ml.score])}`}),children:o(b,{direction:"column",children:[d&&e(Va,{children:d}),r&&e(J,{children:o(v,{borderColor:t,borderTopWidth:"thin",children:[e(v,{paddingX:"size-200",paddingY:"size-100",borderColor:t,borderBottomWidth:"thin",children:e(ae,{level:4,children:"Document Metadata"})}),e(Ka,{basicSetup:{lineNumbers:!1},children:JSON.stringify(r)})]})}),s&&e(v,{borderColor:t,borderTopWidth:"thin",padding:"size-200",children:o(b,{direction:"column",gap:"size-100",children:[e(ae,{level:3,weight:"heavy",children:"Evaluations"}),e("ul",{children:a.map((c,g)=>{const f=c.label&&qb.includes(c.label)?"var(--ac-global-color-danger)":i;return e("li",{children:e(v,{padding:"size-200",borderWidth:"thin",borderColor:t,borderRadius:"medium",children:o(b,{direction:"column",gap:"size-50",children:[o(b,{direction:"row",gap:"size-100",children:[e(F,{weight:"heavy",elementType:"h5",children:c.name}),c.label&&e(Tn,{color:f,children:c.label}),typeof c.score=="number"&&e(Tn,{color:f,children:o(b,{direction:"row",gap:"size-50",children:[e(F,{size:"XS",weight:"heavy",color:"inherit",children:"score"}),e(F,{size:"XS",children:Wa(c.score)})]})})]}),typeof c.explanation&&e("p",{css:K`
                                margin-top: var(
                                  --ac-global-dimension-static-size-100
                                );
                                margin-bottom: 0;
                              `,children:c.explanation})]})})},g)})})]})})]})})}function Ub({message:n}){var g;const a=n[$e.content],l=n[$e.contents],t=(g=n[$e.tool_calls])==null?void 0:g.map(f=>f[Se.tool_call]).filter(Boolean),i=n[$e.function_call_arguments_json]&&n[$e.function_call_name],r=n[$e.role]||"unknown",s=Nl(r),d=m.useMemo(()=>(t==null?void 0:t.map((f,u)=>`tool-call-${u}`))||[],[t]),c=n[$e.tool_call_id];return e(Kn,{children:o(q,{...Le,...s,title:r+(n[$e.name]?`: ${n[$e.name]}`:""),extra:o(b,{direction:"row",gap:"size-100",alignItems:"center",children:[e(Qn,{}),e(de,{text:a||JSON.stringify(n)})]}),children:[e(Tt,{children:l?e(Xb,{messageContents:l}):null}),e(b,{direction:"column",alignItems:"start",children:o(Cn,{css:K`
              width: 100%;
              // when any .ac-disclosure-trigger is hovered, show the child .copy-to-clipboard-button
              .ac-disclosure-trigger {
                width: 100%;
                .copy-to-clipboard-button {
                  visibility: hidden;
                }
              }
              .ac-disclosure-trigger:hover,
              .ac-disclosure-trigger:focus-within,
              .ac-disclosure-trigger:focus-visible {
                .copy-to-clipboard-button {
                  visibility: visible;
                }
              }
            `,defaultExpandedKeys:["tool-content",...d,"function-call"],children:[a&&r.toLowerCase()==="tool"?o(fe,{id:"tool-content",children:[o(pe,{arrowPosition:"start",justifyContent:"space-between",children:[o(F,{children:["Tool Result",c?`: ${c}`:""]}),c?e(de,{text:c}):null]}),e(ye,{children:e(v,{width:"100%",children:e(Va,{children:a})})})]}):a?e(v,{width:"100%",children:e(Va,{children:a})}):null,((t==null?void 0:t.length)??0)>0?t==null?void 0:t.map((f,u)=>{var h,k,S;if(!f)return null;const p=f.id,y=Be((h=f==null?void 0:f.function)==null?void 0:h.arguments);return o(fe,{id:d[u],css:u===0?K`
                              border-top: 1px solid
                                var(--ac-global-border-color-default);
                            `:null,children:[o(pe,{arrowPosition:"start",justifyContent:"space-between",children:[o("span",{children:["Tool Call",p?`: ${p}`:""]}),p?e(de,{text:p}):null]}),e(ye,{children:o("pre",{css:K`
                            text-wrap: wrap;
                            margin: var(--ac-global-dimension-static-size-100) 0;
                            padding: var(--ac-global-dimension-static-size-200);
                          `,children:[(k=f==null?void 0:f.function)==null?void 0:k.name,"(",y.json?JSON.stringify(y.json,null,2):`${(S=f==null?void 0:f.function)==null?void 0:S.arguments}`,")"]},u)})]},u)}):null,i?o(fe,{id:"function-call",children:[e(pe,{children:e(F,{children:"Function Call"})}),e(ye,{children:o("pre",{css:K`
                      text-wrap: wrap;
                      margin: var(--ac-global-dimension-static-size-100) 0;
                    `,children:[n[$e.function_call_name],"(",JSON.stringify(JSON.parse(n[$e.function_call_arguments_json]),null,2),")"]})})]}):null]})})]})})}function Hb({toolSchema:n,index:a}){return e(q,{title:o(b,{direction:"row",gap:"size-100",alignItems:"center",children:[e(Ii,{spanKind:"tool"}),e(F,{weight:"heavy",children:"Tool"})]}),titleExtra:o(Ln,{children:["#",a+1]}),...Le,backgroundColor:"yellow-100",borderColor:"yellow-700",bodyStyle:{padding:0},extra:e(de,{text:n}),children:e(ia,{value:n,mimeType:"json"})})}function Br({messages:n}){return e("ul",{css:K`
        display: flex;
        flex-direction: column;
        gap: var(--ac-global-dimension-static-size-100);
        padding: var(--ac-global-dimension-static-size-200);
      `,children:n.map((a,l)=>e("li",{children:e(Ub,{message:a})},l))})}function Gb({toolSchemas:n}){return e("ul",{css:K`
        display: flex;
        flex-direction: column;
        gap: var(--ac-global-dimension-static-size-100);
        padding: var(--ac-global-dimension-static-size-200);
      `,children:n.map((a,l)=>e("li",{children:e(Hb,{toolSchema:a,index:l})},l))})}function Wb({prompts:n}){return e("ul",{"data-testid":"llm-prompts-list",css:K`
        padding: var(--ac-global-dimension-size-200);
        display: flex;
        flex-direction: column;
        gap: var(--ac-global-dimension-size-100);
      `,children:n.map((a,l)=>e("li",{children:e(v,{backgroundColor:"grey-100",borderColor:"grey-500",borderWidth:"thin",borderRadius:"medium",padding:"size-100",children:e(Wl,{text:a,children:e(ia,{value:a,mimeType:"text"})})})},l))})}const Jb=K`
  display: flex;
  flex-direction: row;
  gap: var(--ac-global-dimension-size-200);
  flex-wrap: wrap;
`;function Xb({messageContents:n}){return e("ul",{css:Jb,"data-testid":"message-content-list",children:n.map((a,l)=>e(Yb,{messageContentAttribute:a},l))})}const Zb=K`
  flex: 1 1 100%;
  padding: var(--ac-global-dimension-static-size-200);
`;function Yb({messageContentAttribute:n}){var r;const{message_content:a}=n,l=a==null?void 0:a.text,t=a==null?void 0:a.image,i=(r=t==null?void 0:t.image)==null?void 0:r.url;return o("li",{css:l?Zb:null,children:[l?e("pre",{css:K`
            white-space: pre-wrap;
            padding: 0;
            margin: 0;
          `,children:l}):null,i?e(Db,{url:i}):null]})}function lu({span:n}){const{input:a,output:l}=n,t=a==null&&l==null,i=(a==null?void 0:a.mimeType)==="text",r=(l==null?void 0:l.mimeType)==="text";return o(b,{direction:"column",gap:"size-200",children:[a&&a.value!=null?e(Kn,{children:e(q,{title:"Input",...Le,extra:o(b,{direction:"row",gap:"size-100",alignItems:"center",children:[i?e(Qn,{}):null,e(de,{text:a.value})]}),children:e(ia,{...a})})}):null,l&&l.value!=null?e(Kn,{children:e(q,{title:"Output",...Le,backgroundColor:"green-100",borderColor:"green-700",extra:o(b,{direction:"row",gap:"size-100",alignItems:"center",children:[r?e(Qn,{}):null,e(de,{text:l.value})]}),children:e(ia,{...l})})}):null,t?e(q,{title:"All Attributes",titleExtra:iu,...Le,extra:e(de,{text:n.attributes}),children:e(Ka,{children:n.attributes})}):null]})}const eS=K`
  width: 100%;
  .cm-editor,
  .cm-gutters {
    background-color: transparent;
  }
`;function Wl({text:n,children:a,padding:l}){const t=l?`var(--ac-global-dimension-${l})`:"0";return o("div",{css:K`
        position: relative;
        .copy-to-clipboard-button {
          transition: opacity 0.2s ease-in-out;
          opacity: 0;
          position: absolute;
          right: ${t};
          top: ${t};
          z-index: 1;
        }
        &:hover .copy-to-clipboard-button {
          opacity: 1;
        }
      `,children:[e(de,{text:n}),a]})}function Ka({children:n,basicSetup:a={}}){const{theme:l}=ca(),t=l==="light"?_a:Aa,{value:i,mimeType:r}=m.useMemo(()=>{try{return{value:JSON.stringify(JSON.parse(n),null,2),mimeType:"json"}}catch{return{value:n,mimeType:"text"}}},[n]);return r==="json"?e(wa,{value:i,basicSetup:{lineNumbers:!0,foldGutter:!0,bracketMatching:!0,syntaxHighlighting:!0,highlightActiveLine:!1,highlightActiveLineGutter:!1,...a},extensions:[Ph.json(),fs.lineWrapping],editable:!1,theme:t,css:eS}):e(tu,{children:i})}function tu({children:n}){return e("pre",{"data-testid":"pre-block",css:K`
        white-space: pre-wrap;
        padding: var(--ac-global-dimension-static-size-200);
        font-size: var(--ac-global-font-size-s);
      `,children:n})}function ia({value:n,mimeType:a}){let l;switch(a){case"json":l=e(Ka,{children:n});break;case"text":l=e(Va,{children:n});break;default:Te()}return l}function nS({text:n}){return o(b,{direction:"column",alignItems:"center",flex:"1 1 auto",height:"size-2400",justifyContent:"center",gap:"size-100",children:[e(st,{graphicKey:"documents"}),e(F,{children:n})]})}function aS({events:n}){return n.length===0?e(nS,{text:"No events"}):e(rt,{children:n.map((a,l)=>{const t=a.name==="exception";return e(it,{children:o(b,{direction:"row",alignItems:"center",gap:"size-100",children:[e(v,{flex:"none",children:e("div",{"data-event-type":t?"exception":"info",css:K`
                    &[data-event-type="exception"] {
                      --px-event-icon-color: var(--ac-global-color-danger);
                    }
                    &[data-event-type="info"] {
                      --px-event-icon-color: var(--ac-global-color-info);
                    }
                    .ac-icon-wrap {
                      color: var(--px-event-icon-color);
                    }
                  `,children:e(I,{svg:t?e(rf,{}):e(ta,{})})})}),o(b,{direction:"column",gap:"size-25",flex:"1 1 auto",children:[e(F,{weight:"heavy",children:a.name}),e(F,{color:"text-700",children:a.message})]}),e(v,{children:e(F,{color:"text-700",children:new Date(a.timestamp).toLocaleString()})})]})},l)})})}const iu=e(b,{alignItems:"center",justifyContent:"center",children:e(v,{marginStart:"size-100",children:o(Al,{children:[e(ae,{weight:"heavy",level:4,children:"Span Attributes"}),e($a,{children:e(F,{children:"Attributes are key-value pairs that represent metadata associated with a span. For detailed descriptions of specific attributes, consult the semantic conventions section of the OpenInference tracing specification."})}),e("footer",{children:e(_n,{href:"https://github.com/Arize-ai/openinference/blob/main/spec/semantic_conventions.md",children:"Semantic Conventions"})})]})})}),ru={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"TraceHeaderRootSpanAnnotationsFragment",selections:[{args:null,kind:"FragmentSpread",name:"AnnotationSummaryGroup"}],type:"Span",abstractKey:null};ru.hash="1926def8a20ce2131c00ccd01efe9fb6";const ou=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"spanId"}],a=[{kind:"Variable",name:"id",variableName:"spanId"}],l={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},s={alias:null,args:null,kind:"ScalarField",name:"score",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"TraceHeaderRootSpanAnnotationsQuery",selections:[{alias:"span",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{kind:"InlineFragment",selections:[{args:null,kind:"FragmentSpread",name:"TraceHeaderRootSpanAnnotationsFragment"}],type:"Span",abstractKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"TraceHeaderRootSpanAnnotationsQuery",selections:[{alias:"span",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[l,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"project",plural:!1,selections:[t,{alias:null,args:null,concreteType:"AnnotationConfigConnection",kind:"LinkedField",name:"annotationConfigs",plural:!1,selections:[{alias:null,args:null,concreteType:"AnnotationConfigEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[l,{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"annotationType",storageKey:null}],type:"AnnotationConfigBase",abstractKey:"__isAnnotationConfigBase"},{kind:"InlineFragment",selections:[t,i,{alias:null,args:null,kind:"ScalarField",name:"optimizationDirection",storageKey:null},{alias:null,args:null,concreteType:"CategoricalAnnotationValue",kind:"LinkedField",name:"values",plural:!0,selections:[r,s],storageKey:null}],type:"CategoricalAnnotationConfig",abstractKey:null},{kind:"InlineFragment",selections:[t],type:"Node",abstractKey:"__isNode"}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"SpanAnnotation",kind:"LinkedField",name:"spanAnnotations",plural:!0,selections:[t,i,r,s,{alias:null,args:null,kind:"ScalarField",name:"annotatorKind",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"user",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"username",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"profilePictureUrl",storageKey:null},t],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"AnnotationSummary",kind:"LinkedField",name:"spanAnnotationSummaries",plural:!0,selections:[{alias:null,args:null,concreteType:"LabelFraction",kind:"LinkedField",name:"labelFractions",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"fraction",storageKey:null},r],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"meanScore",storageKey:null},i],storageKey:null}],type:"Span",abstractKey:null},t],storageKey:null}]},params:{cacheID:"e9ed5ba3e066bebd2161b440786fb0b9",id:null,metadata:{},name:"TraceHeaderRootSpanAnnotationsQuery",operationKind:"query",text:`query TraceHeaderRootSpanAnnotationsQuery(
  $spanId: ID!
) {
  span: node(id: $spanId) {
    __typename
    ... on Span {
      ...TraceHeaderRootSpanAnnotationsFragment
    }
    id
  }
}

fragment AnnotationSummaryGroup on Span {
  project {
    id
    annotationConfigs {
      edges {
        node {
          __typename
          ... on AnnotationConfigBase {
            __isAnnotationConfigBase: __typename
            annotationType
          }
          ... on CategoricalAnnotationConfig {
            id
            name
            optimizationDirection
            values {
              label
              score
            }
          }
          ... on Node {
            __isNode: __typename
            id
          }
        }
      }
    }
  }
  spanAnnotations {
    id
    name
    label
    score
    annotatorKind
    createdAt
    user {
      username
      profilePictureUrl
      id
    }
  }
  spanAnnotationSummaries {
    labelFractions {
      fraction
      label
    }
    meanScore
    name
  }
}

fragment TraceHeaderRootSpanAnnotationsFragment on Span {
  ...AnnotationSummaryGroup
}
`}}}();ou.hash="1b00ac674154cf26ad588b2f17f82305";function lS({spanId:n}){const a=T.useLazyLoadQuery(ou,{spanId:n},{fetchPolicy:"store-and-network"}),l=T.useFragment(ru,a.span);return e(sf,{span:l,renderEmptyState:()=>null})}function tS(n){const a=n.find(i=>i.parentId==null);if(a)return a;const l=new Set(n.map(i=>i.spanId)),t=n.filter(i=>i.parentId!=null&&!l.has(i.parentId));return t.length===1?t[0]:null}function ar(n){var u,p;const{traceId:a,projectId:l}=n,[t,i]=pn(),r=T.useLazyLoadQuery(zc,{traceId:a,id:l},{fetchPolicy:"store-and-network"}),s=((u=r.project.trace)==null?void 0:u.latencyMs)!=null?r.project.trace.latencyMs:null,d=m.useMemo(()=>{var h;return(((h=r.project.trace)==null?void 0:h.spans.edges)||[]).map(k=>k.span)},[r]),g=t.get(mn)??d[0].id,f=m.useMemo(()=>tS(d),[d]);return o("main",{css:K`
        flex: 1 1 auto;
        overflow: hidden;
        display: flex;
        flex-direction: column;
      `,children:[e(iS,{rootSpan:f,latencyMs:s,sessionId:(p=r.project.trace)==null?void 0:p.projectSessionId}),o(Fn,{direction:"horizontal",autoSaveId:"trace-panel-group",css:K`
          flex: 1 1 auto;
          overflow: hidden;
        `,children:[e(Ie,{defaultSize:30,minSize:5,children:e(oS,{children:e(df,{spans:d,selectedSpanNodeId:g,onSpanClick:y=>{i(h=>(h.set(mn,y.id),h),{replace:!0})}})})}),e(Dn,{css:Pt}),e(Ie,{children:e(rS,{children:g?e(m.Suspense,{fallback:e(ge,{}),children:e(Eb,{spanNodeId:g})}):null})})]})]})}function iS({rootSpan:n,latencyMs:a,sessionId:l}){const{projectId:t}=Qe(),{statusCode:i}=n??{statusCode:"UNSET"},r=cf(i);return e(v,{paddingTop:"size-100",paddingBottom:"size-150",paddingX:"size-200",borderBottomWidth:"thin",borderBottomColor:"dark",children:o(b,{direction:"row",gap:"size-400",alignItems:"center",css:K`
          box-sizing: content-box;
        `,children:[o(b,{direction:"column",children:[e(F,{elementType:"h3",size:"S",color:"text-700",children:"Trace Status"}),e(F,{size:"XL",children:o(b,{direction:"row",gap:"size-50",alignItems:"center",children:[e(St,{statusCode:i}),e(F,{size:"L",color:r,children:i})]})})]}),o(b,{direction:"column",children:[e(F,{elementType:"h3",size:"S",color:"text-700",children:"Latency"}),e(F,{size:"XL",children:typeof a=="number"?e(je,{latencyMs:a,size:"L"}):"--"})]}),n?e(lS,{spanId:n.id}):null,l&&e("span",{css:K`
              margin-left: auto;
            `,children:e(sa,{size:"S",variant:"primary",to:`/projects/${t}/sessions/${l}`,children:"View Session"})})]})})}function rS({children:n}){return e("div",{"data-testid":"scrolling-tabs-wrapper",css:K`
        height: 100%;
        overflow: hidden;
        .ac-tabs {
          height: 100%;
          overflow: hidden;
          .ac-tabs__extra {
            width: 100%;
            padding-right: var(--ac-global-dimension-size-200);
            padding-bottom: var(--ac-global-dimension-size-50);
          }
          .ac-tabs__pane-container {
            min-height: 100%;
            height: 100%;
            overflow-y: auto;
            div[role="tabpanel"] {
              height: 100%;
            }
          }
        }
      `,children:n})}function oS({children:n}){return e("div",{"data-testid":"scrolling-panel-content",css:K`
        height: 100%;
        overflow-y: auto;
      `,children:n})}const zt=()=>{const{projectId:n}=Qe();if(!n)throw new Error("projectId is required");const l=al().pathname.split("/"),t=l.indexOf(n);if(t===-1)throw new Error("projectId not found in path");const i=l.slice(0,t+1).join("/"),r=l[t+1];return{rootPath:i,tab:r}},su=m.createContext(null),lr=()=>m.useContext(su),du=(n,a)=>{const l=n.findIndex(({traceId:d,spanId:c})=>a&&(d===a||c===a)),t=l-1,i=l+1,r=n[t],s=n[i];return{nextTraceId:s==null?void 0:s.traceId,nextSpanId:s==null?void 0:s.spanId,previousTraceId:r==null?void 0:r.traceId,previousSpanId:r==null?void 0:r.spanId}},qr=(n,a,l)=>{const{nextTraceId:t,previousTraceId:i,nextSpanId:r,previousSpanId:s}=du(a,l),[d,c,g]=n.pathname.split("/").filter(y=>y!==""),f=(y,h)=>{let k=`/${d}/${c}/${g}/${y}`;return h&&(k+=`?${mn}=${h}`),k},u=!!t,p=!!i;return{nextTracePath:u?f(t,r):null,previousTracePath:p?f(i,s):null}},cu=({children:n})=>{const a=ce(),l=al(),[t,i]=m.useState([]),r=m.useCallback(d=>{const{nextTracePath:c}=qr(l,t,d);c&&a(c)},[a,l,t]),s=m.useCallback(d=>{const{previousTracePath:c}=qr(l,t,d);c&&a(c)},[a,l,t]);return e(su.Provider,{value:{traceSequence:t,next:r,previous:s,setTraceSequence:i},children:n})},Ur="j",Hr="k",sS=({currentId:n})=>{const a=lr();if(Sa(Ur,()=>{a&&a.next(n)}),Sa(Hr,()=>{a&&a.previous(n)}),!a||!a.traceSequence.length)return null;const{previous:l,next:t,traceSequence:i}=a,{nextTraceId:r,previousTraceId:s}=du(i,n),d=!!s,c=!!r;return e(b,{gap:"size-50",css:K`
        button {
          // either the icons or the trigger wrap are making the buttons slightly too small
          // so just spot adjust the min height here
          min-height: 31px;
        }
      `,children:o(b,{direction:"row",gap:"size-50",alignItems:"center",children:[o(Ya,{delay:100,children:[e(M,{size:"S",id:"next",leadingVisual:e(I,{svg:e(uf,{})}),"aria-label":"Next trace",isDisabled:!c,onPress:()=>{m.startTransition(()=>{t(n)})}}),e(el,{offset:4,children:e(v,{backgroundColor:"dark",borderWidth:"thin",borderColor:"dark",borderRadius:"medium",padding:"size-100",children:o(b,{direction:"row",gap:"size-100",alignItems:"center",children:[e("span",{children:"Next trace"}),e(Pl,{children:Ur})]})})})]}),o(Ya,{delay:100,children:[e(M,{size:"S",id:"previous",leadingVisual:e(I,{svg:e(mf,{})}),"aria-label":"Previous trace",isDisabled:!d,onPress:()=>{m.startTransition(()=>{l(n)})}}),e(el,{offset:4,children:e(v,{backgroundColor:"dark",borderWidth:"thin",borderColor:"dark",borderRadius:"medium",padding:"size-100",children:o(b,{direction:"row",gap:"size-100",alignItems:"center",children:[e("span",{children:"Previous trace"}),e(Pl,{children:Hr})]})})})]})]})})};function VT(){const{traceId:n,projectId:a}=Qe(),[l]=pn(),t=ce(),{rootPath:i,tab:r}=zt(),d=l.get(mn)||n;return e(on,{isOpen:!0,onOpenChange:c=>{c||t(`${i}/${r}`)},children:e(Ge,{variant:"slideover",size:"fullscreen",children:e(He,{children:({close:c})=>o(ea,{children:[o(na,{children:[e(aa,{children:"Trace Details"}),o(Oa,{children:[e(sS,{currentId:d}),e(gf,{preserveSearchParams:!0,buttonText:"Share",tooltipText:"Copy trace link to clipboard",successText:"Trace link copied to clipboard"}),e(Qa,{close:c})]})]}),e(m.Suspense,{fallback:e(ge,{}),children:e(ar,{traceId:n,projectId:a})})]})})})})}function uu({traceId:n,projectId:a,title:l}){return e(He,{children:({close:t})=>o(ea,{children:[o(na,{children:[e(aa,{children:l}),o(Oa,{children:[e(sa,{size:"S",to:`/projects/${a}/traces/${n}`,children:"View Trace in Project"}),e(Qa,{close:t})]})]}),e(m.Suspense,{fallback:e(ge,{}),children:e(ar,{traceId:n,projectId:a})})]})})}const dS=n=>{const a=n;return va(a.function)?typeof a.function.arguments=="string":!1};function mu({toolCall:n}){const a=m.useMemo(()=>{const{provider:l,validatedToolCall:t}=pf(n);switch(l){case"OPENAI":case"AZURE_OPENAI":return{name:t.function.name,input:t.function.arguments};case"ANTHROPIC":return{name:t.name,input:t.input};case"UNKNOWN":{if(!dS(n))return null;const{json:i}=Be(n.function.arguments);return{name:n.function.name??"",input:va(i)?i:n.function.arguments}}default:return Te()}},[n]);return a==null?o(F,{children:["Invalid tool call format: ",JSON.stringify(n)]}):o("pre",{css:K`
        text-wrap: wrap;
        margin: var(--ac-global-dimension-static-size-100) 0;
      `,children:[a.name,"(",typeof a.input=="string"?a.input:JSON.stringify(a.input,null,2),")"]})}const cS=10,uS=n=>n.examples.reduce((a,l)=>{const{datasetExampleId:t,result:i,experimentRunId:r}=l,s={experimentRunId:r};switch(i.__typename){case"ChatCompletionMutationError":return{...a,[t]:{...s,errorMessage:i.message}};case"ChatCompletionMutationPayload":{const{errorMessage:d,content:c,span:g,toolCalls:f}=i;return{...a,[t]:{...s,span:g,content:c,errorMessage:d,toolCalls:f.reduce((u,p)=>(u[p.id]=p,u),{})}}}case"%other":return a;default:Te()}},{}),mS=K`
  position: relative;
  display: flex;
  flex-direction: column;
  justify-content: center;
  height: 100%;
  min-height: 75px;
  .controls {
    transition: opacity 0.2s ease-in-out;
    opacity: 0;
    display: none;
    z-index: 1;
  }
  &:hover .controls {
    opacity: 1;
    display: flex;
    // make them stand out
    button {
      border-color: var(--ac-global-color-primary);
    }
  }
`,gS=K`
  position: absolute;
  top: -4px;
  right: var(--ac-global-dimension-static-size-100);
  display: flex;
  flex-direction: row;
  gap: var(--ac-global-dimension-static-size-100);
`;function gu(n){return o("div",{css:mS,children:[n.children,e("div",{css:gS,className:"controls",children:n.controls})]})}function pu({children:n}){return e("div",{css:K`
        max-height: 300px;
        overflow-y: auto;
        padding: var(--ac-global-dimension-static-size-100)
          var(--ac-global-dimension-static-size-200);
      `,children:n})}function pS({getValue:n,collapseSingleKey:a}){const l=n();return e(pu,{children:e(il,{json:l,space:2,collapseSingleKey:a})})}function yS({isRunning:n,instanceVariables:a,datasetExampleInput:l}){const t=m.useMemo(()=>{const i=va(l)?l:{};return a.filter(r=>i[r]==null)},[l,a]);return n?e(ge,{}):t.length===0?null:e(er,{children:`Missing input for variable${t.length>1?"s":""}: ${t.join(", ")}`})}function fS({exampleData:n,setDialog:a}){const{span:l,content:t,toolCalls:i,errorMessage:r,experimentRunId:s}=n,d=l!=null,c=s!=null,g=m.useMemo(()=>{if(d||c)return o(J,{children:[c&&o(Ee,{children:[e(M,{size:"S","aria-label":"View experiment run details",leadingVisual:e(I,{svg:e(xl,{})}),onPress:()=>{m.startTransition(()=>{a(e(lb,{runId:s}))})}}),e($n,{children:"View run details"})]}),d&&e(J,{children:o(Ne,{children:[e(M,{size:"S","aria-label":"View run trace",leadingVisual:e(I,{svg:e(bt,{})})}),e(on,{children:e(Ge,{size:"fullscreen",variant:"slideover",children:e(uu,{traceId:l.context.traceId,projectId:l.project.id,title:"Experiment Run Trace"})})})]})})]})},[s,c,d,a,l]);return e(gu,{controls:g,children:e(v,{padding:"size-200",children:o(b,{direction:"column",gap:"size-200",children:[r!=null?e(er,{children:r}):null,e(F,{children:t}),i!=null?Object.values(i).map(f=>f==null?null:e(mu,{toolCall:f},f.id)):null,d?e(kS,{span:l}):null]})})})}const hS=m.memo(function({isRunning:a,instanceId:l,exampleId:t,setDialog:i,instanceVariables:r,datasetExampleInput:s}){const d=Ha(c=>{var g;return(g=c.exampleResponsesMap[l])==null?void 0:g[t]});return d==null?e(yS,{isRunning:a,instanceVariables:r,datasetExampleInput:s}):e(fS,{exampleData:d,setDialog:i})});function kS({span:n}){return o(b,{direction:"row",gap:"size-100",alignItems:"center",children:[e(La,{tokenCountTotal:n.tokenCountTotal||0,nodeId:n.id}),e(je,{latencyMs:n.latencyMs||0})]})}function yu({table:n}){return e("tbody",{children:n.getRowModel().rows.map(a=>e("tr",{children:a.getVisibleCells().map(l=>e("td",{style:{padding:0,width:`calc(var(--col-${l.column.id}-size) * 1px)`,wordBreak:"break-all"},children:W(l.column.columnDef.cell,l.getContext())},l.id))},a.id))})}const bS=fn.memo(yu,(n,a)=>n.table.options.data===a.table.options.data);function SS({datasetId:n}){const a=T.useRelayEnvironment(),l=O(B=>B.instances),t=O(B=>B.allInstanceMessages),i=O(B=>B.templateFormat),r=O(B=>B.updateInstance),s=Ha(B=>B.updateExampleData),d=Ha(B=>B.setExampleDataForInstance),c=Ha(B=>B.resetExampleData),g=Ha(B=>B.appendExampleDataToolCallChunk),f=Ha(B=>B.appendExampleDataTextChunk),[u,p]=m.useState(null),[,y]=pn(),h=l.some(B=>B.activeRunId!==null),k=Na(B=>B),S=O(B=>B.markPlaygroundInstanceComplete),C=ul(),P=be(),L=m.useCallback(B=>ie=>{var Ae;if(ie==null)return;const te=ie.chatCompletionOverDataset;switch(te.__typename){case"ChatCompletionSubscriptionExperiment":r({instanceId:B,patch:{experimentId:te.experiment.id},dirty:null});break;case"ChatCompletionSubscriptionResult":if(te.datasetExampleId==null)return;s({instanceId:B,exampleId:te.datasetExampleId,patch:{span:te.span,experimentRunId:(Ae=te.experimentRun)==null?void 0:Ae.id}});break;case"ChatCompletionSubscriptionError":if(te.datasetExampleId==null)return;s({instanceId:B,exampleId:te.datasetExampleId,patch:{errorMessage:te.message}});break;case"TextChunk":if(te.datasetExampleId==null)return;f({instanceId:B,exampleId:te.datasetExampleId,textChunk:te.content});break;case"ToolCallChunk":{if(te.datasetExampleId==null)return;g({instanceId:B,exampleId:te.datasetExampleId,toolCallChunk:te});break}case"%other":return;default:return Te()}},[f,g,s,r]),[_]=T.useMutation(_c),w=m.useCallback(B=>(ie,te)=>{if(S(B),te){P({title:"Chat completion failed",message:te[0].message});return}r({instanceId:B,patch:{experimentId:ie.chatCompletionOverDataset.experimentId},dirty:null}),d({instanceId:B,data:uS(ie.chatCompletionOverDataset)})},[S,P,d,r]);m.useEffect(()=>{if(!h)return;const{instances:B,streaming:ie,updateInstance:te}=C.getState();if(c(),ie){const Ae=[];for(const Pe of B){const{activeRunId:D}=Pe;if(te({instanceId:Pe.id,patch:{experimentId:null},dirty:null}),D===null)continue;const $={input:Lr({credentials:k,instanceId:Pe.id,playgroundStore:C,datasetId:n})},U={subscription:Ac,variables:$,onNext:L(Pe.id),onCompleted:()=>{S(Pe.id)},onError:tn=>{S(Pe.id);const $t=Ho(tn);$t!=null&&$t.length>0?P({title:"Failed to get output",message:$t.join(`
`),expireMs:1e4}):P({title:"Failed to get output",message:tn.message,expireMs:1e4})}},ne=_l.requestSubscription(a,U);Ae.push(ne)}return()=>{for(const Pe of Ae)Pe.dispose()}}else{const Ae=[];for(const Pe of B){const{activeRunId:D}=Pe;if(D===null)continue;te({instanceId:Pe.id,patch:{experimentId:null},dirty:null});const $={input:Lr({credentials:k,instanceId:Pe.id,playgroundStore:C,datasetId:n})},U=_({variables:$,onCompleted:w(Pe.id),onError(ne){S(Pe.id);const tn=De(ne);tn!=null&&tn.length>0?P({title:"Failed to get output",message:tn.join(`
`),expireMs:1e4}):P({title:"Failed to get output",message:ne.message,expireMs:1e4})}});Ae.push(U)}return()=>{for(const Pe of Ae)Pe.dispose()}}},[k,n,a,_,h,S,P,w,L,C,c]);const{dataset:V}=T.useLazyLoadQuery(Ec,{datasetId:n}),Q=m.useRef(null),{data:x,loadNext:R,hasNext:A,isLoadingNext:z}=T.usePaginationFragment(Rc,V),N=m.useMemo(()=>x.examples.edges.map(B=>{const ie=B.example,te=ie.revision;return{id:ie.id,input:te.input,output:te.output}}),[x]),j=m.useMemo(()=>l.map((B,ie)=>{const te=_t(B,t),Ae=Ls({instance:te,templateFormat:i});return{id:`instance-${B.id}`,header:()=>o(b,{direction:"row",gap:"size-100",alignItems:"center",children:[e(Di,{index:ie}),e("span",{children:"Output"})]}),cell:({row:Pe})=>e(hS,{instanceId:B.id,exampleId:Pe.original.id,isRunning:h,setDialog:p,instanceVariables:Ae,datasetExampleInput:Pe.original.input}),size:500}}),[h,l,i,t]),Z=[{header:"input",accessorKey:"input",cell:({row:B})=>e(gu,{controls:o(Ee,{children:[e(M,{size:"S","aria-label":"View example details",leadingVisual:e(I,{svg:e(xl,{})}),onPress:()=>{y(ie=>(ie.set("exampleId",B.original.id),ie))}}),e($n,{children:"View Example"})]}),children:e(pu,{children:e(il,{json:B.original.input,disableTitle:!0,space:2,collapseSingleKey:!1})})}),size:200},{header:"reference output",accessorKey:"output",cell:B=>pS({...B,collapseSingleKey:!0}),size:200},...j],se=Ce({columns:Z,data:N,getCoreRowModel:Ke(),columnResizeMode:"onChange"}),kn=se.getRowModel().rows.length===0,ma=m.useCallback(B=>{if(B){const{scrollHeight:ie,scrollTop:te,clientHeight:Ae}=B;ie-te-Ae<300&&!z&&A&&R(cS)}},[A,z,R]),Rn=fn.useMemo(()=>{const B=se.getFlatHeaders(),ie={};for(let te=0;te<B.length;te++){const Ae=B[te];ie[`--header-${Ae.id}-size`]=Ae.getSize(),ie[`--col-${Ae.column.id}-size`]=Ae.column.getSize()}return ie},[se.getState().columnSizingInfo,se.getState().columnSizing,Z.length]);return o("div",{css:K`
        flex: 1 1 auto;
        overflow: auto;
        height: 100%;
      `,ref:Q,onScroll:B=>ma(B.target),children:[o("table",{css:K(We,Uo),style:{...Rn,width:se.getTotalSize(),minWidth:"100%"},children:[e("thead",{children:se.getHeaderGroups().map(B=>e("tr",{children:B.headers.map(ie=>o("th",{style:{width:`calc(var(--header-${ie==null?void 0:ie.id}-size) * 1px)`},children:[e("div",{children:W(ie.column.columnDef.header,ie.getContext())}),e("div",{onMouseDown:ie.getResizeHandler(),onTouchStart:ie.getResizeHandler(),className:`resizer ${ie.column.getIsResizing()?"isResizing":""}`})]},ie.id))},B.id))}),kn?e(yn,{}):se.getState().columnSizingInfo.isResizingColumn?e(bS,{table:se}):e(yu,{table:se})]}),e(ue,{isDismissable:!0,type:"slideOver",onDismiss:()=>{p(null),y(B=>(B.delete(mn),B))},children:u})]})}function vS({datasetId:n}){const a=O(s=>s.instances),l=a.some(s=>s.activeRunId!=null),t=m.useMemo(()=>a.map(s=>s.experimentId).filter(s=>s!=null),[a]),i=ce(),r=T.useLazyLoadQuery(Lc,{datasetId:n});return o(b,{direction:"column",height:"100%",children:[e(v,{flex:"none",backgroundColor:"dark",paddingX:"size-200",paddingY:"size-100",borderBottomColor:"light",borderBottomWidth:"thin",height:50,children:o(b,{justifyContent:"space-between",alignItems:"center",height:"100%",children:[o(b,{gap:"size-100",children:[o(F,{children:[r.dataset.name??"Dataset"," results"]}),r.dataset.exampleCount!=null?o(F,{fontStyle:"italic",color:"text-700",children:[r.dataset.exampleCount," examples"]}):null]}),t.length>0&&o(M,{size:"S",isDisabled:l,leadingVisual:e(I,{svg:l?e(sn,{}):e(Go,{})}),onPress:()=>{i(`/datasets/${n}/compare?experimentId=${t.join("&experimentId=")}`)},children:["View Experiment",a.length>1?"s":""]})]})}),e(ab,{children:e(SS,{datasetId:n})})]})}const Gr=30,FS=K`
  display: flex;
  direction: row;
  align-items: center;
  & .dataset-picker-button {
    border-top-right-radius: 0;
    border-bottom-right-radius: 0;
    height: ${Gr}px;
    &[data-pressed],
    &:hover {
      // remove the bright hover border effect so that it matches the "clear" button
      // next to the dataset picker
      --button-border-color: var(--ac-global-input-field-border-color);
    }
  }
  & > button {
    border-top-left-radius: 0;
    border-bottom-left-radius: 0;
    border-left: none;
    height: ${Gr}px;
  }
`;function CS(){const[n,a]=pn(),l=n.get("datasetId")??"";return o("div",{css:FS,children:[e(Oo,{size:"S",placeholder:"Test over a dataset",selectedKey:l,onSelectionChange:t=>{if(l!==null&&t===l){a(i=>(i.delete("datasetId"),i));return}a(i=>(i.set("datasetId",String(t)),i))}}),e(M,{size:"S",leadingVisual:e(I,{svg:e(Wo,{})}),onPress:()=>{a(t=>(t.delete("datasetId"),t))}})]})}const KS=()=>{const n=O(d=>d.input),a=O(d=>d.instances),l=O(d=>d.allInstanceMessages),t=O(d=>d.templateFormat),i=m.useMemo(()=>a.map(d=>_t(d,l)),[a,l]),{variableKeys:r,variablesMap:s}=m.useMemo(()=>_s({instances:i,templateFormat:t,input:n}),[n,i,t]);return{variableKeys:r,variablesMap:s}},TS={lineNumbers:!1,highlightActiveLine:!1,foldGutter:!1,highlightActiveLineGutter:!1,bracketMatching:!1,syntaxHighlighting:!1,defaultKeymap:!1},PS=[fs.lineWrapping,$i.of([...xh.filter(n=>n.key!=="Mod-Enter")])],xS=({label:n,defaultValue:a,onChange:l})=>{const{theme:t}=ca(),i=m.useRef(a),[r,s]=m.useState(0),[d,c]=m.useState(()=>a);return m.useEffect(()=>{a==null&&(c(""),s(f=>f+1)),i.current=a},[a]),m.useEffect(()=>{c(i.current),s(f=>f+1)},[n]),e(Ia,{label:n,children:e(Ue,{width:"100%",children:e(wa,{theme:t==="light"?_a:Aa,basicSetup:TS,value:d,extensions:PS,onChange:l},r)})})};function IS(){const{variableKeys:n,variablesMap:a}=KS(),l=O(i=>i.setVariableValue),t=O(i=>i.templateFormat);if(n.length===0){let i="";switch(t){case bn.FString:{i="{input name}";break}case bn.Mustache:{i="{{input name}}";break}case bn.NONE:return null;default:Te()}return e(v,{padding:"size-100",children:e(b,{direction:"column",justifyContent:"center",alignItems:"center",children:o(F,{color:"text-700",children:["Add variable inputs to your prompt using"," ",e(F,{color:"text-900",children:i})," within your prompt template."]})})})}return e(b,{direction:"column",gap:"size-200",width:"100%",children:n.map((i,r)=>e(xS,{label:i,defaultValue:a[i]??"",onChange:s=>l(i,s)},r))})}const fu=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},l=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"ChatCompletionMutationPayload",kind:"LinkedField",name:"chatCompletion",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"content",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"errorMessage",storageKey:null},{alias:null,args:null,concreteType:"Span",kind:"LinkedField",name:"span",plural:!1,selections:[a],storageKey:null},{alias:null,args:null,concreteType:"ChatCompletionToolCall",kind:"LinkedField",name:"toolCalls",plural:!0,selections:[a,{alias:null,args:null,concreteType:"ChatCompletionFunctionCall",kind:"LinkedField",name:"function",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"arguments",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"PlaygroundOutputMutation",selections:l,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"PlaygroundOutputMutation",selections:l},params:{cacheID:"9dc63d3e40081b276c1cbd5f21405c6f",id:null,metadata:{},name:"PlaygroundOutputMutation",operationKind:"mutation",text:`mutation PlaygroundOutputMutation(
  $input: ChatCompletionInput!
) {
  chatCompletion(input: $input) {
    __typename
    content
    errorMessage
    span {
      id
    }
    toolCalls {
      id
      function {
        name
        arguments
      }
    }
  }
}
`}}}();fu.hash="085e7cb2bebd2c6c6e44b511364c6dd9";const hu=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},l=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:null,kind:"LinkedField",name:"chatCompletion",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"content",storageKey:null}],type:"TextChunk",abstractKey:null},{kind:"InlineFragment",selections:[a,{alias:null,args:null,concreteType:"FunctionCallChunk",kind:"LinkedField",name:"function",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"arguments",storageKey:null}],storageKey:null}],type:"ToolCallChunk",abstractKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"Span",kind:"LinkedField",name:"span",plural:!1,selections:[a],storageKey:null}],type:"ChatCompletionSubscriptionResult",abstractKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"message",storageKey:null}],type:"ChatCompletionSubscriptionError",abstractKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"PlaygroundOutputSubscription",selections:l,type:"Subscription",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"PlaygroundOutputSubscription",selections:l},params:{cacheID:"aca7bf342ad2dc5db66b07e236a68268",id:null,metadata:{},name:"PlaygroundOutputSubscription",operationKind:"subscription",text:`subscription PlaygroundOutputSubscription(
  $input: ChatCompletionInput!
) {
  chatCompletion(input: $input) {
    __typename
    ... on TextChunk {
      content
    }
    ... on ToolCallChunk {
      id
      function {
        name
        arguments
      }
    }
    ... on ChatCompletionSubscriptionResult {
      span {
        id
      }
    }
    ... on ChatCompletionSubscriptionError {
      message
    }
  }
}
`}}}();hu.hash="bb5936a61a0e99dbb4a298a6e552a01c";const DS=({instance:n,outputContent:a,toolCalls:l,cleanupOutput:t})=>{const i=n.id,r=O(s=>s.addMessage);return o(Ee,{delay:500,offset:10,children:[e(M,{size:"S",leadingVisual:e(I,{svg:e(Bn,{})}),"aria-label":"Move the output message to the end of the prompt",onPress:()=>{if(n.template.__type!=="chat")return;const s=Array.isArray(a)?a:a?[{id:fa(),role:pa("ai"),content:a}]:[];l.length>0&&s.push({id:fa(),role:pa("ai"),toolCalls:Jo({provider:n.model.provider,toolCalls:l.map(d=>{var c;return{...d,function:{...d.function,arguments:((c=Be(d.function.arguments))==null?void 0:c.json)??d.function.arguments}}})})}),r({playgroundInstanceId:i,messages:s}),t()},children:"Prompt"}),e($n,{children:"Move the output message to the end of the prompt"})]})},ku=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"spanId"}],a=[{kind:"Variable",name:"id",variableName:"spanId"}],l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},t={kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"spanId",storageKey:null},{alias:null,args:null,concreteType:"Trace",kind:"LinkedField",name:"trace",plural:!1,selections:[l,{alias:null,args:null,kind:"ScalarField",name:"traceId",storageKey:null},{alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"project",plural:!1,selections:[l],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"tokenCountTotal",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"latencyMs",storageKey:null}],type:"Span",abstractKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"RunMetadataFooterQuery",selections:[{alias:"span",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[l,t],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"RunMetadataFooterQuery",selections:[{alias:"span",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},l,t],storageKey:null}]},params:{cacheID:"24fe0e0ac8fe3f88cbbce31e0dd43e12",id:null,metadata:{},name:"RunMetadataFooterQuery",operationKind:"query",text:`query RunMetadataFooterQuery(
  $spanId: ID!
) {
  span: node(id: $spanId) {
    __typename
    id
    ... on Span {
      spanId
      trace {
        id
        traceId
        project {
          id
        }
      }
      tokenCountTotal
      latencyMs
    }
  }
}
`}}}();ku.hash="f511626560567f113e6b977bfea1efd3";function LS({spanId:n}){const[,a]=pn(),l=T.useLazyLoadQuery(ku,{spanId:n},{fetchPolicy:"store-and-network"});if(!l.span||!l.span.trace||!l.span.trace.project)return null;const{trace:t}=l.span;return e(v,{borderTopColor:"light",borderTopWidth:"thin",paddingStart:"size-200",paddingEnd:"size-200",paddingTop:"size-100",paddingBottom:"size-100",children:o(b,{direction:"row",gap:"size-200",justifyContent:"space-between",children:[o(b,{direction:"row",gap:"size-100",alignItems:"center",children:[e(La,{tokenCountTotal:l.span.tokenCountTotal||0,nodeId:l.span.id}),e(je,{latencyMs:l.span.latencyMs||0})]}),o(b,{direction:"row",gap:"size-100",alignItems:"center",children:[o(Ne,{children:[e(M,{size:"S",leadingVisual:e(I,{svg:e(ja,{})}),children:"Annotate"}),e(on,{children:e(Ge,{variant:"slideover",size:"S",children:e(Xo,{spanNodeId:n,projectId:t.project.id})})})]}),o(Ne,{onOpenChange:i=>{i||a(r=>(r.delete(mn),r))},children:[e(M,{size:"S",leadingVisual:e(I,{svg:e(bt,{})}),children:"View Trace"}),e(on,{children:e(Ge,{variant:"slideover",size:"fullscreen",children:e(m.Suspense,{fallback:e(ge,{}),children:e(uu,{traceId:t.traceId,projectId:t.project.id,title:"Playground Trace"})})})})]})]})]})})}function _S({index:n,title:a}){return o(b,{direction:"row",gap:"size-100",alignItems:"center",children:[e(Di,{index:n}),e("span",{children:a})]})}const AS=n=>va(n)&&(typeof n.id=="string"||typeof n.id=="number")?n.id:JSON.stringify(n);function Wr({message:n}){const{role:a,content:l,toolCalls:t}=n,i=Nl(a);return o(q,{title:a,...i,variant:"compact",extra:e(Qn,{}),bodyStyle:{padding:0},children:[l!=null&&!Array.isArray(l)&&e(Va,{children:l}),t&&t.length>0?t.map(r=>e(mu,{toolCall:r},AS(r))):null]})}function wS({content:n,partialToolCalls:a}){return p0(n)?n.map((l,t)=>e(Wr,{message:l},t)):typeof n=="string"||a.length>0?e(Wr,{message:{id:fa(),content:n,role:"ai",toolCalls:a}}):"click run to see output"}function RS(n){const a=n.playgroundInstanceId,l=O(A=>A.instances),t=O(A=>A.streaming),i=Na(A=>A),r=O(A=>A.instances.findIndex(z=>z.id===a)),s=l.find(A=>A.id===a),d=O(A=>A.updateInstance),[c,g]=m.useState(null),f=O(A=>A.markPlaygroundInstanceComplete),u=T.useRelayEnvironment(),p=ul();if(!s)throw new Error(`No instance found for id ${a}`);if(s.template.__type!=="chat")throw new Error("We only support chat templates for now");const[y,h]=m.useState(!1),[k]=T.useMutation(fu),S=(s==null?void 0:s.activeRunId)!=null,C=be(),P=m.useCallback(({title:A,message:z,...N})=>{g({title:A,message:z}),C({title:A,message:z,...N})},[C]),[L,_]=m.useState(s.output),[w,V]=m.useState([]),Q=m.useCallback(({chatCompletion:A})=>{if(h(!1),A.__typename==="TextChunk"){const z=A.content;_(N=>N!=null?N+z:z);return}else if(A.__typename==="ToolCallChunk"){V(z=>{let N=!1;const j=z.map(Z=>Z.id===A.id?(N=!0,{...Z,function:{...Z.function,arguments:Z.function.arguments+A.function.arguments}}):Z);return N||j.push({id:A.id,function:{name:A.function.name,arguments:A.function.arguments}}),j});return}if(A.__typename==="ChatCompletionSubscriptionResult"&&A.span!=null){d({instanceId:a,patch:{spanId:A.span.id},dirty:null});return}A.__typename==="ChatCompletionSubscriptionError"&&(f(n.playgroundInstanceId),A.message!=null&&P({title:"Chat completion failed",message:A.message}))},[a,f,P,n.playgroundInstanceId,d]),x=m.useCallback((A,z)=>{if(h(!1),f(n.playgroundInstanceId),d({instanceId:a,patch:{spanId:A.chatCompletion.span.id},dirty:null}),z){P({title:"Chat completion failed",message:z[0].message});return}if(A.chatCompletion.errorMessage!=null){P({title:"Chat completion failed",message:A.chatCompletion.errorMessage});return}_(A.chatCompletion.content??void 0),V(A.chatCompletion.toolCalls)},[a,f,P,n.playgroundInstanceId,d]),R=m.useCallback(()=>{_(void 0),V([]),g(null),d({instanceId:a,patch:{spanId:null},dirty:null})},[a,d]);return m.useEffect(()=>{if(!S){h(!1);return}h(!0),R();const A=C0({playgroundStore:p,instanceId:a,credentials:i});if(t){const N={subscription:hu,variables:{input:A},onNext:Z=>{Z&&Q(Z)},onCompleted:()=>{h(!1),f(n.playgroundInstanceId)},onError:Z=>{h(!1),f(n.playgroundInstanceId);const se=Ho(Z);se!=null&&se.length>0?P({title:"Failed to get output",message:se.join(`
`)}):P({title:"Failed to get output",message:Z.message})}};return _l.requestSubscription(u,N).dispose}return k({variables:{input:A},onCompleted:x,onError(N){h(!1),f(n.playgroundInstanceId);const j=De(N);j!=null&&j.length>0?P({title:"Failed to get output",message:j.join(`
`)}):P({title:"Failed to get output",message:N.message})}}).dispose},[R,i,u,k,S,a,f,P,x,Q,p,n.playgroundInstanceId,t,d]),e(q,{title:e(_S,{index:r,title:"Output"}),extra:L!=null||(w==null?void 0:w.length)>0?e(DS,{outputContent:L,toolCalls:w,instance:s,cleanupOutput:R}):null,titleSeparator:!0,collapsible:!0,variant:"compact",bodyStyle:{padding:0},children:y?e(v,{padding:"size-200",children:e(ge,{message:"Running..."})}):c?e(v,{padding:"size-200",children:e(er,{children:c.message})}):o(J,{children:[e(v,{padding:"size-200",children:e(Kn,{children:e(wS,{content:L,partialToolCalls:w})})}),e(m.Suspense,{children:s.spanId?e(LS,{spanId:s.spanId}):null})]})})}function ES(){return m.useMemo(()=>window.navigator.userAgent.toLowerCase().includes("mac")?"Cmd":"Ctrl",[])}function MS(){const n=ES(),a=O(r=>r.runPlaygroundInstances),l=O(r=>r.cancelPlaygroundInstances),t=O(r=>r.instances.some(s=>s.activeRunId!=null)),i=m.useCallback(()=>{t?l():a()},[t,l,a]);return Sa("mod+enter",r=>{r.preventDefault(),r.stopPropagation(),i()},{enableOnFormTags:!0,enableOnContentEditable:!0,preventDefault:!0}),e(M,{variant:"primary",leadingVisual:e(I,{svg:t?e(sn,{}):e(Da,{})}),size:"S",onPress:()=>{i()},trailingVisual:o(Qo,{children:[e(si,{children:n}),e("span",{"aria-hidden":"true",children:n==="Cmd"?"⌘":"Ctrl"}),e(si,{children:"enter"}),e("span",{"aria-hidden":"true",children:"⏎"})]}),children:t?"Cancel":"Run"})}function VS(){const n=O(i=>i.streaming),a=O(i=>i.setStreaming),l=un(i=>i.setPlaygroundStreamingEnabled),t=O(i=>i.instances.some(r=>r.activeRunId!=null));return e(xa,{labelPlacement:"start",isSelected:n,onChange:()=>{a(!n),l(!n)},isDisabled:t,children:"Stream"})}const bu=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"Prompt",kind:"LinkedField",name:"createChatPromptVersion",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"UpsertPromptFromTemplateDialogUpdateMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"UpsertPromptFromTemplateDialogUpdateMutation",selections:a},params:{cacheID:"5560d38314208ef482b716e9817358fe",id:null,metadata:{},name:"UpsertPromptFromTemplateDialogUpdateMutation",operationKind:"mutation",text:`mutation UpsertPromptFromTemplateDialogUpdateMutation(
  $input: CreateChatPromptVersionInput!
) {
  createChatPromptVersion(input: $input) {
    id
    name
  }
}
`}}}();bu.hash="96205130072396cb213f4fa790a7a6b1";const Su=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"Prompt",kind:"LinkedField",name:"createChatPrompt",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"UpsertPromptFromTemplateDialogCreateMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"UpsertPromptFromTemplateDialogCreateMutation",selections:a},params:{cacheID:"73d9d27e0df3bc27e4af4dd3d77f41fb",id:null,metadata:{},name:"UpsertPromptFromTemplateDialogCreateMutation",operationKind:"mutation",text:`mutation UpsertPromptFromTemplateDialogCreateMutation(
  $input: CreateChatPromptInput!
) {
  createChatPrompt(input: $input) {
    id
    name
  }
}
`}}}();Su.hash="fa52cba6c2bfaa6298a5360253dc9bc5";const vu=function(){var n=[{alias:null,args:[{kind:"Literal",name:"first",value:200}],concreteType:"PromptConnection",kind:"LinkedField",name:"prompts",plural:!1,selections:[{alias:null,args:null,concreteType:"PromptEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"prompt",args:null,concreteType:"Prompt",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:"prompts(first:200)"}];return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"SavePromptFormQuery",selections:n,type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"SavePromptFormQuery",selections:n},params:{cacheID:"f58ec0bbc09a5d215619bb7bd5c9b2e2",id:null,metadata:{},name:"SavePromptFormQuery",operationKind:"query",text:`query SavePromptFormQuery {
  prompts(first: 200) {
    edges {
      prompt: node {
        id
        name
      }
    }
  }
}
`}}}();vu.hash="f06c29d4c5318f96e838ba5f392cccf3";const Fu=function(){var n=[{alias:null,args:[{kind:"Literal",name:"first",value:200}],concreteType:"PromptConnection",kind:"LinkedField",name:"prompts",plural:!1,selections:[{alias:null,args:null,concreteType:"PromptEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"prompt",args:null,concreteType:"Prompt",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:"prompts(first:200)"}];return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"PromptComboBoxQuery",selections:n,type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"PromptComboBoxQuery",selections:n},params:{cacheID:"8dddcd4c6c884248b53dbaf0a625c335",id:null,metadata:{},name:"PromptComboBoxQuery",operationKind:"query",text:`query PromptComboBoxQuery {
  prompts(first: 200) {
    edges {
      prompt: node {
        __typename
        id
        name
      }
    }
  }
}
`}}}();Fu.hash="42af63a75d1f1b2184518e94395121cd";function Cu({onChange:n,container:a,promptId:l,...t}){const r=T.useLazyLoadQuery(Fu,{},{fetchPolicy:"store-and-network",fetchKey:l??void 0}).prompts.edges,s=m.useMemo(()=>r.map(d=>d.prompt),[r]);return e(_i,{size:"M","data-testid":"prompt-picker",selectedKey:l??null,"aria-label":"prompt picker",width:"100%",menuTrigger:"focus",stopPropagation:!0,container:a,defaultItems:s,placeholder:"Select a prompt...",renderEmptyState:()=>e("div",{children:"No prompts found"}),onSelectionChange:d=>{if(!(typeof d!="string"&&d!=null)){if(d===l){n(null);return}n(d)}},...t,children:d=>e(Li,{textValue:d.name,id:d.id,children:d.name},d.id)})}const zS=/^[a-z0-9]([_a-z0-9-]*[a-z0-9])?$/,Ku={value:zS,message:"Invalid identifier. Must be alphanumeric and with dashes or underscores"};function NS({onCreate:n,onUpdate:a,isSubmitting:l=!1,defaultSelectedPromptId:t}){var L,_,w,V;const i=m.useRef(null),r=T.useLazyLoadQuery(vu,{},{fetchPolicy:"network-only"}),[s,d]=m.useState(t??null),c=(_=(L=r==null?void 0:r.prompts)==null?void 0:L.edges)==null?void 0:_.find(Q=>{var x;return((x=Q==null?void 0:Q.prompt)==null?void 0:x.id)===s}),[g,f]=m.useState(((w=c==null?void 0:c.prompt)==null?void 0:w.name)??""),u=c?"update":"create",p=u==="create"?"Create Prompt":"Update Prompt",{control:y,handleSubmit:h,formState:{isDirty:k,isValid:S},trigger:C}=Ve({values:{promptId:s??void 0,name:u==="update"&&c?(V=c==null?void 0:c.prompt)==null?void 0:V.name:g},defaultValues:{description:""},reValidateMode:"onChange",resetOptions:{keepDefaultValues:!0}}),P=m.useCallback(Q=>{u==="create"?n(Q):a(Q)},[n,a,u]);return o(b,{direction:"column",gap:"size-100",ref:i,children:[e(v,{paddingX:"size-200",paddingTop:"size-200",children:e(G,{name:"name",control:y,rules:{required:{message:"Prompt is required",value:!0},pattern:Ku},render:({field:{onBlur:Q,onChange:x},fieldState:R})=>{var A;return e(Cu,{label:"Prompt",description:"The prompt to update, or prompt name to create",placeholder:"Select or enter new prompt name",isRequired:!0,onBlur:Q,defaultInputValue:g,onInputChange:z=>{f(z),x(z),C("name")},container:i.current??void 0,errorMessage:(A=R.error)==null?void 0:A.message,allowsCustomValue:!0,onChange:z=>{x(z),d(z)},promptId:s})}})}),o(gn,{onSubmit:h(P),children:[e(v,{paddingX:"size-200",paddingBottom:"size-200",children:e(G,{name:"description",control:y,render:({field:{onChange:Q,onBlur:x,value:R},fieldState:{invalid:A,error:z}})=>o(ee,{isInvalid:A,onChange:Q,onBlur:x,value:R,size:"S",children:[e(H,{children:u==="create"?"Prompt Description":"Change Description"}),e(Pa,{}),z?e(ke,{children:z.message}):e(F,{slot:"description",children:u==="create"?"A description of your prompt (optional)":"A description of your changes to the prompt (optional)"})]})})}),e(v,{paddingEnd:"size-200",paddingTop:"size-100",paddingBottom:"size-100",borderTopColor:"light",borderTopWidth:"thin",children:e(b,{direction:"row",justifyContent:"end",children:e(M,{variant:k?"primary":"default",size:"S",isDisabled:l||!S,type:"submit",children:p})})})]})]})}const Jr=(n,a)=>{const l=a.getState(),t=l.allInstanceMessages,i=l.instances.find(c=>c.id===n);if(!i)throw new Error(`Instance ${n} not found`);const r=_t(i,t),s=M1(r);if(!s)throw new Error(`Could not convert instance ${n} to prompt`);const d=l.templateFormat;return{promptInput:s,templateFormat:d}},$S=({instanceId:n,setDialog:a,selectedPromptId:l})=>{const t=ce(),i=me(),r=be(),s=ul(),[d,c]=T.useMutation(Su),[g,f]=T.useMutation(bu),u=m.useCallback((h,k)=>{const S=s.getState();S.instances.find(P=>P.id===n)&&S.updateInstance({instanceId:n,patch:{prompt:{id:h,name:k}},dirty:!1})},[s,n]),p=m.useCallback(h=>{const{promptInput:k,templateFormat:S}=Jr(n,s);d({variables:{input:{name:h.name,description:h.description,promptVersion:{...k,templateFormat:S}}},onCompleted:C=>{i({title:"Prompt successfully created",action:{text:"View Prompt",onClick:()=>{t(`/prompts/${C.createChatPrompt.id}`)}}}),u(C.createChatPrompt.id,C.createChatPrompt.name),a(null)},onError:C=>{const P=De(C);r({title:"Error creating prompt",message:P==null?void 0:P[0]}),a(null)}})},[d,n,t,r,i,u,a,s]),y=m.useCallback(h=>{if(!h.promptId)throw new Error("Prompt ID is required");const{promptInput:k,templateFormat:S}=Jr(n,s);g({variables:{input:{promptId:h.promptId,promptVersion:{...k,templateFormat:S,description:h.description}}},onCompleted:C=>{i({title:"Prompt successfully updated",action:{text:"View Prompt",onClick:()=>{t(`/prompts/${C.createChatPromptVersion.id}`)}}}),u(C.createChatPromptVersion.id,C.createChatPromptVersion.name),a(null)},onError:C=>{const P=De(C);r({title:"Error updating prompt",message:P==null?void 0:P[0]}),a(null)}})},[n,t,r,i,a,s,g,u]);return e(oe,{title:"Create Prompt from Template",children:e(m.Suspense,{fallback:e(ge,{}),children:e(NS,{onCreate:p,onUpdate:y,isSubmitting:c||f,defaultSelectedPromptId:l})})})},Tu={fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"ModelConfigButtonDialogQuery",selections:[{args:null,kind:"FragmentSpread",name:"ModelProviderSelectFragment"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"ModelConfigButtonDialogQuery",selections:[{alias:null,args:null,concreteType:"GenerativeProvider",kind:"LinkedField",name:"modelProviders",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"key",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"dependenciesInstalled",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"dependencies",storageKey:null}],storageKey:null}]},params:{cacheID:"f6e033b9adc17b674922615d30065fbc",id:null,metadata:{},name:"ModelConfigButtonDialogQuery",operationKind:"query",text:`query ModelConfigButtonDialogQuery {
  ...ModelProviderSelectFragment
}

fragment ModelProviderSelectFragment on Query {
  modelProviders {
    key
    name
    dependenciesInstalled
    dependencies
  }
}
`}};Tu.hash="83e31e404724e5fcdf80a5361325f537";const Sl=1024,jS=E.object({type:E.literal("enabled"),budget_tokens:E.number().min(Sl)}),OS=({onChange:n,value:a})=>{const[l,t]=m.useState(0),r=jS.safeParse(a).data,s=m.useRef(r==null?void 0:r.budget_tokens),d=g=>{n(g?{type:"enabled",budget_tokens:s.current||Sl}:null)},c=g=>{const f=g!=null&&!isNaN(g);s.current=f?g:Sl,n({type:"enabled",budget_tokens:s.current}),f||t(u=>u+1)};return o(J,{children:[e(xa,{onChange:d,isSelected:(r==null?void 0:r.type)==="enabled",children:"Thinking Enabled"}),(r==null?void 0:r.type)==="enabled"&&o(ha,{value:r==null?void 0:r.budget_tokens,onChange:c,isDisabled:(r==null?void 0:r.type)!=="enabled",isRequired:!0,defaultValue:Sl,minValue:Sl,children:[e(H,{children:"Budget Tokens"}),e(X,{}),e(F,{slot:"description",children:"Determines how many tokens Claude can use for its internal reasoning process. Must be ≥1024 and less than max_tokens."})]},l)]})};function QS({defaultValue:n,onChange:a,label:l,errorMessage:t}){const[i,r]=m.useState(n==null?"":jn(n).json??""),s=m.useCallback(d=>{r(d);const{json:c}=Be(d);c==null&&d!==""||a(c)},[a]);return e("div",{css:K`
        & .ac-view {
          width: 100%;
        }
      `,children:e(Ia,{label:l,errorMessage:t,validationState:t?"invalid":void 0,children:e(Ue,{children:e(rn,{value:i,onChange:s,optionalLint:!0})})})})}const BS=({field:n,value:a,onChange:l,errors:t,control:i})=>{var u;const r=n.invocationName;if(!r)throw new Error("Invocation name is required");const s=(u=t[r])==null?void 0:u.message,d=n.required?`${n.label||r} is required`:void 0,c=n.minValue!=null?`${n.label||r} must be at least ${n.minValue}`:void 0,g=n.maxValue!=null?`${n.label||r} must be at most ${n.maxValue}`:void 0;if(n.canonicalName==="ANTHROPIC_EXTENDED_THINKING")return e(OS,{onChange:l,value:a});const{__typename:f}=n;switch(f){case"InvocationParameterBase":return null;case"BoundedFloatInvocationParameter":return typeof a!="number"&&a!==void 0?null:e(ff,{label:n.label,defaultValue:a,step:.1,minValue:n.minValue,maxValue:n.maxValue,onChange:p=>l(p),children:e(yf,{})});case"FloatInvocationParameter":case"IntInvocationParameter":return e(G,{control:i,name:r,rules:{required:d,min:c,max:g},render:({field:{onBlur:p}})=>o(ha,{isRequired:n.required,value:Number(a),onBlur:p,onChange:y=>{l(y)},children:[e(H,{children:n.label}),e(X,{}),s?e(ke,{children:s}):null]})});case"StringListInvocationParameter":return!Array.isArray(a)&&a!==void 0?null:e(G,{control:i,name:r,rules:{required:d},render:({field:{onBlur:p}})=>o(ee,{isRequired:n.required,defaultValue:(a==null?void 0:a.join(", "))??"",onBlur:p,onChange:y=>{if(y===""){l(void 0);return}l(y.split(/, */g))},children:[e(H,{children:n.label}),e(X,{}),s?e(ke,{children:s}):e(F,{slot:"description",children:"A comma separated list of strings"})]})});case"StringInvocationParameter":return e(G,{control:i,name:r,rules:{required:d},render:({field:{onBlur:p}})=>o(ee,{isRequired:n.required,defaultValue:(a==null?void 0:a.toString())||"",type:"text",onBlur:p,onChange:y=>{if(y===""){l(void 0);return}l(y)},children:[e(H,{children:n.label}),e(X,{}),s?e(ke,{children:s}):null]})});case"BooleanInvocationParameter":return e(xa,{onChange:l,defaultSelected:!!a,children:n.label});case"JSONInvocationParameter":return e(G,{control:i,name:r,rules:{required:d},render:()=>e(QS,{defaultValue:a,onChange:l,label:n.label??n.invocationName??"",errorMessage:s})});default:return null}},qS=(n,a)=>{if(n.invocationInputField===void 0)throw new Error("Invocation input field is required");return a[cl(n.invocationInputField)]},US=(n,a)=>{if(n.invocationName===void 0)throw new Error("Invocation name is required");if(n.invocationInputField===void 0)throw new Error("Invocation input field is required");return{invocationName:n.invocationName,canonicalName:n.canonicalName,[cl(n.invocationInputField)]:a}},HS=({instanceId:n})=>{const a=O(y=>y.instances.find(h=>h.id===n));if(!a)throw new Error("Instance not found");const{model:l}=a,t=O(y=>y.upsertInvocationParameterInput),i=O(y=>y.deleteInvocationParameterInput),r=a.model.supportedInvocationParameters,s=a.model.invocationParameters,d=m.useCallback((y,h)=>{if(!y.invocationName)throw new Error("Invocation name is required");h===void 0?i({instanceId:n,invocationParameterInputInvocationName:y.invocationName}):t({instanceId:n,invocationParameterInput:US(y,h)})},[n,t,i]),c=m.useMemo(()=>r.filter(y=>!(y.canonicalName!=null&&Nh.includes(y.canonicalName))).reduce((y,h)=>{const k=s.find(C=>Ca(C,h)),S=k?qS(h,k):void 0;return{...y,[h.invocationName]:S??null}},{}),[s,r]),g=Ve({values:c,mode:"onBlur",delayError:0,shouldFocusError:!1,resetOptions:{keepErrors:!0}}),f=g.trigger,u=m.useMemo(()=>In.debounce(f,250),[f]);return m.useEffect(()=>{u()},[c,u]),l.provider!=="AZURE_OPENAI"&&l.modelName===null?null:Object.entries(c).map(([y,h])=>{const k=r.find(C=>C.invocationName===y);if(!k)return null;const S=`${l.provider??"model"}-${k.invocationName}`;return e(BS,{field:k,value:h,onChange:C=>d(k,C),control:g.control,errors:g.formState.errors},S)})},tr=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"providerKey"}],a=[{alias:null,args:[{fields:[{kind:"Variable",name:"providerKey",variableName:"providerKey"}],kind:"ObjectValue",name:"input"}],concreteType:"GenerativeModel",kind:"LinkedField",name:"models",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ModelComboBoxQuery",selections:a,type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ModelComboBoxQuery",selections:a},params:{cacheID:"a3417a3b2ae9ad193a5fd68335cfd660",id:null,metadata:{},name:"ModelComboBoxQuery",operationKind:"query",text:`query ModelComboBoxQuery(
  $providerKey: GenerativeProviderKey!
) {
  models(input: {providerKey: $providerKey}) {
    name
  }
}
`}}}();tr.hash="fc5563c6dca10fdeda807cd7061e275a";function GS({onChange:n,container:a,modelName:l,queryReference:t,...i}){const r=T.usePreloadedQuery(tr,t),s=m.useMemo(()=>r.models.map(u=>({name:u.name,id:u.name})),[r.models]),[d,c]=m.useState({selectedKey:l??null,inputValue:l??""}),g=u=>{if(typeof u=="string"){const p=s.find(y=>y.id===u);(p==null?void 0:p.name)!=null&&n(p.name)}},f=u=>{c(p=>({inputValue:u,selectedKey:p.selectedKey}))};return m.useEffect(()=>{c({selectedKey:l??null,inputValue:l??""})},[l]),e(_i,{size:"L",label:"Model",isRequired:!0,"data-testid":"model-picker",selectedKey:d.selectedKey,"aria-label":"model picker",onInputChange:f,inputValue:d.inputValue,onSelectionChange:g,width:"100%",allowsCustomValue:!0,onBlur:()=>{d.inputValue!==""&&n(d.inputValue)},onKeyUp:u=>{u.key==="Enter"&&n(d.inputValue)},menuTrigger:"focus",container:a,description:"Choose a model from the list, or enter a custom model name",defaultItems:s,...i,children:u=>e(Li,{textValue:u.name,id:u.id,children:u.name},u.id)})}function Pu(n){const[a,l,t]=T.useQueryLoader(tr);return m.useEffect(()=>(l({providerKey:n.provider}),()=>t()),[t,l,n.provider]),a!=null?e(GS,{queryReference:a,...n}):null}const xu={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"ModelProviderSelectFragment",selections:[{alias:null,args:null,concreteType:"GenerativeProvider",kind:"LinkedField",name:"modelProviders",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"key",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"dependenciesInstalled",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"dependencies",storageKey:null}],storageKey:null}],type:"Query",abstractKey:null};xu.hash="fa50b98980c4687ef0574fa47c3ef4be";function WS({onChange:n,query:a,...l}){const t=T.useFragment(xu,a),i=t.modelProviders.filter(d=>d.dependenciesInstalled),r=i.length!==t.modelProviders.length,s=l.provider&&!i.some(d=>d.key===l.provider);return o(b,{direction:"row",gap:"size-100",children:[e(v,{flex:1,children:Ap(pt,{...l,key:"model-provider-select","data-testid":"model-provider-picker",selectedKey:l.provider??void 0,"aria-label":"Model Provider",placeholder:"Select a provider",onSelectionChange:d=>{const c=d;qo(c)&&n(c)}},e(H,{children:"Provider"}),o(M,{children:[e(lt,{}),e(yt,{})]}),e(la,{children:e(Ml,{children:t.modelProviders.map(d=>e(Xn,{id:d.key,textValue:d.name,children:o(b,{direction:"row",gap:"size-100",alignItems:"center",children:[e(Rl,{provider:d.key,height:16}),e(F,{children:d.name})]})},d.key))})}))}),s?e(I,{color:"red-700",svg:e(ta,{})}):r?e(I,{svg:e(ta,{})}):null]})}const JS=150,XS=K`
  display: flex;
  flex-direction: column;
  gap: var(--ac-global-dimension-size-200);
  .ac-field,
  .ac-dropdown,
  .ac-dropdown-button,
  .ac-slider {
    width: 100%;
  }
  // Makes the filled slider track blue
  .ac-slider-controls > .ac-slider-track:first-child::before {
    background: var(--ac-global-color-primary);
  }
  padding: var(--ac-global-dimension-size-200);
  overflow: auto;
`;function ZS(n){return n==="OPENAI"||n==="OLLAMA"}function YS({instance:n,container:a}){const l=O(s=>s.updateModel),t=m.useCallback(({configKey:s,value:d})=>{l({instanceId:n.id,patch:{...n.model,[s]:d}})},[n.id,n.model,l]),i=m.useMemo(()=>Xl(s=>{t({configKey:"modelName",value:s})},250),[t]),r=m.useMemo(()=>Xl(s=>{t({configKey:"baseUrl",value:s})},250),[t]);return o(J,{children:[e(Pu,{modelName:n.model.modelName,provider:n.model.provider,onChange:s=>{i(s)},container:a??void 0}),o(ee,{defaultValue:n.model.baseUrl??"",onChange:s=>{r(s)},children:[e(H,{children:"Base URL"}),e(X,{placeholder:"e.x. https://my-llm.com/v1"})]},`${n.id}-baseUrl-${n.model.baseUrl}`)]})}function ev({instance:n,container:a}){const l=O(r=>r.updateModel),t=m.useCallback(({configKey:r,value:s})=>{l({instanceId:n.id,patch:{...n.model,[r]:s}})},[n.id,n.model,l]),i=m.useMemo(()=>Xl(r=>{t({configKey:"modelName",value:r})},250),[t]);return o(J,{children:[o(ee,{defaultValue:n.model.modelName??"",onChange:r=>{i(r)},children:[e(H,{children:"Deployment Name"}),e(X,{placeholder:"e.x. azure-openai-deployment-name"})]},`${n.id}-modelName-${n.model.modelName}`),o(ee,{value:n.model.endpoint??"",onChange:r=>{t({configKey:"endpoint",value:r})},children:[e(H,{children:"Endpoint"}),e(X,{placeholder:"e.x. https://my.openai.azure.com"})]}),e(_i,{container:a??void 0,size:"L",label:"API Version","data-testid":"azure-api-version-combobox",selectedKey:n.model.apiVersion??void 0,"aria-label":"api version picker",placeholder:"Select an AzureOpenAI API Version",inputValue:n.model.apiVersion??"",onInputChange:r=>{t({configKey:"apiVersion",value:r})},onSelectionChange:r=>{typeof r=="string"&&t({configKey:"apiVersion",value:r})},allowsCustomValue:!0,children:hf.map(r=>e(Li,{textValue:r,id:r,children:r},r))})]})}function nv(n){const a=O(r=>r.instances.find(s=>s.id===n.playgroundInstanceId));if(!a)throw new Error(`Playground instance ${n.playgroundInstanceId} not found`);const l=a.model.supportedInvocationParameters,t=a.model.invocationParameters,i=Rs(t,l);return o(Ne,{children:[e(M,{size:"S",leadingVisual:e(Rl,{provider:a.model.provider,height:16}),children:o(b,{direction:"row",gap:"size-100",alignItems:"center",height:"100%",children:[e(an,{maxWidth:JS,children:e(F,{children:a.model.modelName||"--"})}),i?null:o(Ya,{delay:0,children:[e("span",{children:e(I,{color:"danger",svg:e(ta,{})})}),e(el,{children:"Some required invocation parameters are not configured."})]})]})}),e(on,{children:e(Ge,{variant:"slideover",size:"S",children:e(av,{...n})})})]})}function av(n){const a=O(r=>r.instances.find(s=>s.id===n.playgroundInstanceId));if(!a)throw new Error(`Playground instance ${n.playgroundInstanceId} not found`);const l=un(r=>r.setModelConfigForProvider),t=me(),i=m.useCallback(()=>{const{supportedInvocationParameters:r,...s}=a.model;l({provider:a.model.provider,modelConfig:s}),t({title:"Model Configuration Saved",message:`${ii[a.model.provider]} model configuration saved as default for later use.`,expireMs:3e3})},[a.model,t,l]);return e(He,{children:o(ea,{children:[o(na,{children:[e(aa,{children:"Model Configuration"}),o(Oa,{children:[o(Ya,{delay:0,closeDelay:0,children:[e(M,{size:"S",variant:"default",onPress:i,leadingVisual:e(I,{svg:e(Ro,{})}),children:"Save as Default"}),e(el,{placement:"bottom",offset:5,children:o(v,{padding:"size-100",backgroundColor:"light",borderColor:"dark",borderWidth:"thin",borderRadius:"small",width:"200px",children:["Saves the current configuration as the default for"," ",ii[a.model.provider]??"this provider","."]})})]}),e(Qa,{})]})]}),e(m.Suspense,{children:e(lv,{...n})})]})})}function lv(n){const{playgroundInstanceId:a}=n,l=O(y=>y.instances.find(h=>h.id===a));if(!l)throw new Error(`Playground instance ${n.playgroundInstanceId} not found`);const t=un(y=>y.modelConfigByProvider),i=O(y=>y.updateProvider),r=O(y=>y.updateModel),s=l.model.supportedInvocationParameters,d=l.model.invocationParameters,c=Rs(d,s),g=T.useLazyLoadQuery(Tu,{}),f=m.useCallback(y=>{r({instanceId:a,patch:{modelName:y}})},[a,r]),[u,p]=m.useState();return o("form",{css:XS,children:[c?null:o(b,{direction:"row",gap:"size-100",children:[e(I,{color:"danger",svg:e(ta,{})}),e(F,{color:"danger",children:"Some required invocation parameters are not configured."})]}),e(WS,{provider:l.model.provider,query:g,onChange:y=>{i({instanceId:a,provider:y,modelConfigByProvider:t})}}),ZS(l.model.provider)?e(YS,{instance:l,container:u??null}):l.model.provider==="AZURE_OPENAI"?e(ev,{instance:l,container:u??null}):e(Pu,{modelName:l.model.modelName,provider:l.model.provider,onChange:f,container:u??void 0}),e(m.Suspense,{children:e(HS,{instanceId:a})}),e("div",{ref:p})]})}const Iu=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a={alias:null,args:null,kind:"ScalarField",name:"invocationInputField",storageKey:null},l={alias:"floatDefaultValue",args:null,kind:"ScalarField",name:"defaultValue",storageKey:null},t=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:null,kind:"LinkedField",name:"modelInvocationParameters",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"invocationName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"canonicalName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"required",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null}],type:"InvocationParameterBase",abstractKey:"__isInvocationParameterBase"},{kind:"InlineFragment",selections:[{alias:"booleanDefaultValue",args:null,kind:"ScalarField",name:"defaultValue",storageKey:null},a],type:"BooleanInvocationParameter",abstractKey:null},{kind:"InlineFragment",selections:[l,a,{alias:null,args:null,kind:"ScalarField",name:"minValue",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"maxValue",storageKey:null}],type:"BoundedFloatInvocationParameter",abstractKey:null},{kind:"InlineFragment",selections:[l,a],type:"FloatInvocationParameter",abstractKey:null},{kind:"InlineFragment",selections:[{alias:"intDefaultValue",args:null,kind:"ScalarField",name:"defaultValue",storageKey:null},a],type:"IntInvocationParameter",abstractKey:null},{kind:"InlineFragment",selections:[{alias:"jsonDefaultValue",args:null,kind:"ScalarField",name:"defaultValue",storageKey:null},a],type:"JSONInvocationParameter",abstractKey:null},{kind:"InlineFragment",selections:[{alias:"stringDefaultValue",args:null,kind:"ScalarField",name:"defaultValue",storageKey:null},a],type:"StringInvocationParameter",abstractKey:null},{kind:"InlineFragment",selections:[{alias:"stringListDefaultValue",args:null,kind:"ScalarField",name:"defaultValue",storageKey:null},a],type:"StringListInvocationParameter",abstractKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ModelSupportedParamsFetcherQuery",selections:t,type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ModelSupportedParamsFetcherQuery",selections:t},params:{cacheID:"8f18509b17f3f97c2413ef8b6557d972",id:null,metadata:{},name:"ModelSupportedParamsFetcherQuery",operationKind:"query",text:`query ModelSupportedParamsFetcherQuery(
  $input: ModelsInput!
) {
  modelInvocationParameters(input: $input) {
    __typename
    ... on InvocationParameterBase {
      __isInvocationParameterBase: __typename
      invocationName
      canonicalName
      required
      label
    }
    ... on BooleanInvocationParameter {
      booleanDefaultValue: defaultValue
      invocationInputField
    }
    ... on BoundedFloatInvocationParameter {
      floatDefaultValue: defaultValue
      invocationInputField
      minValue
      maxValue
    }
    ... on FloatInvocationParameter {
      floatDefaultValue: defaultValue
      invocationInputField
    }
    ... on IntInvocationParameter {
      intDefaultValue: defaultValue
      invocationInputField
    }
    ... on JSONInvocationParameter {
      jsonDefaultValue: defaultValue
      invocationInputField
    }
    ... on StringInvocationParameter {
      stringDefaultValue: defaultValue
      invocationInputField
    }
    ... on StringListInvocationParameter {
      stringListDefaultValue: defaultValue
      invocationInputField
    }
  }
}
`}}}();Iu.hash="8bf1a32724929bdc4a02d32809ba59d7";const tv=({instanceId:n})=>{var g;const l=O(f=>f.instances).find(f=>f.id===n);if(!l)throw new Error("Instance not found");const t=l.model.provider,i=l.model.modelName,r=un(f=>f.modelConfigByProvider),s=O(f=>f.updateModelSupportedInvocationParameters),{modelInvocationParameters:d}=T.useLazyLoadQuery(Iu,{input:{providerKey:t,modelName:i}}),c=(g=l.prompt)==null?void 0:g.id;return m.useEffect(()=>{s({instanceId:n,supportedInvocationParameters:d,modelConfigByProvider:r})},[d,n,s,r,c]),null},Du=n=>a=>a.instances.find(l=>l.id===n),ui=n=>a=>a.allInstanceMessages[n];function iv({playgroundInstanceId:n,messageId:a}){const l=m.useMemo(()=>Du(n),[n]),t=O(l);if(t==null)throw new Error(`Instance ${n} not found`);const i=t.model.provider,r=ul(),s=m.useMemo(()=>ui(a),[a]),d=O(s);if(d==null)throw new Error(`Message ${a} not found`);const c=d.toolCalls,g=O(h=>h.updateMessage),[f,u]=m.useState(()=>JSON.stringify(c,null,2));m.useEffect(()=>{const h=r.getState();if(h.instances.find(L=>L.id===n)==null)return;const S=ui(a)(h);if(S==null)return;const C=S.toolCalls,P=JSON.stringify(C,null,2);Ai({str:P,excludeNull:!0})&&u(P)},[i,r,n,a]);const p=m.useCallback(h=>{const{json:k}=Be(h);g({instanceId:n,messageId:a,patch:{toolCalls:k}})},[n,a,g]),y=m.useMemo(()=>{switch(t.model.provider){case"OPENAI":case"AZURE_OPENAI":case"DEEPSEEK":case"XAI":case"OLLAMA":return bf;case"ANTHROPIC":return kf;case"GOOGLE":return null}},[t.model.provider]);return e(rn,{value:f,jsonSchema:y,onChange:p})}function rv(n){return n==="text"||n==="toolCalls"}function ov({messageMode:n,onChange:a}){return o(xt,{selectedKeys:[n],size:"S","aria-label":"Message Mode",onSelectionChange:l=>{if(l.size===0)return;const t=l.keys().next().value;rv(t)&&a(t)},children:[o(Ee,{placement:"top",delay:0,offset:10,children:[e(Pn,{"aria-label":"text input",id:"text",children:e(I,{svg:e(Ci,{})})}),e($n,{children:"Text input"})]}),o(Ee,{placement:"top",delay:0,offset:10,children:[e(Pn,{"aria-label":"tool calling",id:"toolCalls",children:e(I,{svg:e(Ki,{})})}),e($n,{children:"Tool calling"})]})]})}const sv=K`
  .ac-field-label {
    display: none;
  }
`;function dv({role:n,includeLabel:a=!0,onChange:l}){return o(pt,{selectedKey:n,css:a?void 0:sv,"data-testid":"messages-role-picker","aria-label":"Role for the chat message",size:"S",onSelectionChange:t=>{if(!xs(t))throw new Error(`Invalid chat message role: ${t}`);l(t)},children:[a&&e(H,{children:"Role"}),o(M,{children:[e(lt,{}),e(yt,{})]}),e(la,{placement:"bottom start",offset:4,shouldFlip:!0,containerPadding:8,children:o(Ml,{children:[e(Xn,{id:"system",children:"System"}),e(Xn,{id:"user",children:"User"}),e(Xn,{id:"ai",children:"AI"}),e(Xn,{id:"tool",children:"Tool"})]})})]})}const cv=32;function uv({instanceId:n,hasResponseFormat:a}){const l=O(u=>u.instances),t=O(u=>u.updateInstance),i=O(u=>u.addMessage),r=O(u=>u.upsertInvocationParameterInput),s=l.find(u=>u.id===n);if(!s)throw new Error(`Playground instance ${n} not found`);const{template:d}=s;if(d.__type!=="chat")throw new Error(`Invalid template type ${d.__type}`);const c=s.model.supportedInvocationParameters,g=c==null?void 0:c.some(u=>Ca(u,{canonicalName:Nn,invocationName:Vn})),f=c==null?void 0:c.some(u=>Ca(u,{canonicalName:ba,invocationName:Za}));return o(b,{direction:"row",justifyContent:"end",gap:"size-100",minHeight:cv,children:[g?e(M,{size:"S","aria-label":"response format",leadingVisual:e(I,{svg:e(ka,{})}),isDisabled:a,onPress:()=>{r({instanceId:n,invocationParameterInput:{valueJson:Sf(),invocationName:Vn,canonicalName:Nn}})},children:"Response Format"}):null,f?e(M,{"aria-label":"add tool",size:"S",leadingVisual:e(I,{svg:e(ka,{})}),onPress:()=>{const u={tools:[...s.tools,k0({provider:s.model.provider,toolNumber:s.tools.length+1})]};if(s.tools.length===0){const p=Si({toolChoice:"auto",targetProvider:s.model.provider});p&&(u.toolChoice=p)}t({instanceId:n,patch:u,dirty:!0})},children:"Tool"}):null,e(M,{"aria-label":"add message",size:"S",leadingVisual:e(I,{svg:e(ka,{})}),onPress:()=>{i({playgroundInstanceId:n,messages:[{id:fa(),role:"user",content:""}]})},children:"Message"})]})}const mv=400;function gv({playgroundInstanceId:n}){const a=O(u=>u.deleteInvocationParameterInput),l=O(u=>u.instances.find(p=>p.id===n)),t=l==null?void 0:l.model.provider,i=O(u=>u.upsertInvocationParameterInput);if(!l)throw new Error(`Instance ${n} not found`);const r=l.model.invocationParameters.find(u=>u.invocationName===Vn||u.canonicalName===Nn),[s,d]=m.useState(()=>JSON.stringify((r==null?void 0:r.valueJson)??{},null,2)),c=m.useRef(s),g=ul();m.useEffect(()=>{const p=g.getState().instances.find(k=>k.id===n);if(p==null)return;const y=p.model.invocationParameters.find(k=>k.invocationName===Vn||k.canonicalName===Nn);if(y==null)return;const h=JSON.stringify(y.valueJson,null,2);Ai({str:h,excludeNull:!0})&&d(h)},[t,g,n]);const f=m.useCallback(u=>{c.current=u;const{json:p}=Be(u);i({instanceId:n,invocationParameterInput:{invocationName:Vn,valueJson:p,canonicalName:Nn}})},[n,i]);return o(fe,{id:"response-format",children:[e(pe,{arrowPosition:"start",children:"Response Format"}),e(ye,{children:e(v,{padding:"size-200",children:e(q,{variant:"compact",title:"Schema",bodyStyle:{padding:0},extra:o(b,{direction:"row",gap:"size-100",children:[e(de,{text:c}),e(M,{"aria-label":"Delete Response Format",leadingVisual:e(I,{svg:e(Je,{})}),size:"S",onPress:()=>{a({instanceId:n,invocationParameterInputInvocationName:Vn})}})]}),children:e(Zo,{preInitializationMinHeight:mv,children:e(rn,{value:s,onChange:f,jsonSchema:Yh})})})})})]})}const pv=400;function yv({playgroundInstanceId:n,toolId:a}){const l=ul(),t=O(h=>h.updateInstance),i=O(h=>h.instances.find(k=>k.id===n));if(i==null)throw new Error(`Playground instance ${n} not found`);const r=i.model.provider,s=i.tools,d=s.find(h=>h.id===a);if(d==null)throw new Error(`Tool ${a} not found`);const[c,g]=m.useState(()=>JSON.stringify(d.definition,null,2)),f=m.useRef(c);m.useEffect(()=>{const k=l.getState().instances.find(P=>P.id===n);if(k==null)return;const S=k.tools.find(P=>P.id===a);if(S==null)return;const C=JSON.stringify(S.definition,null,2);Ai({str:C,excludeNull:!0})&&g(C)},[r,l,n,a]);const u=m.useCallback(h=>{f.current=h;const{json:k}=Be(h);t({instanceId:n,patch:{tools:s.map(S=>S.id===d.id?{...S,definition:k}:S)},dirty:!0})},[s,n,d.id,t]),p=m.useMemo(()=>As(d),[d]),y=m.useMemo(()=>{switch(i.model.provider){case"OPENAI":case"AZURE_OPENAI":case"DEEPSEEK":case"XAI":case"OLLAMA":return Ff;case"ANTHROPIC":return vf;case"GOOGLE":return null}},[i.model.provider]);return e(q,{collapsible:!0,backgroundColor:"yellow-100",borderColor:"yellow-700",variant:"compact",title:o(b,{direction:"row",gap:"size-100",children:[e(Ii,{spanKind:"tool"}),e(F,{children:p??"Tool"})]}),bodyStyle:{padding:0},extra:o(b,{direction:"row",gap:"size-100",children:[e(de,{text:f}),e(M,{"aria-label":"Delete tool",leadingVisual:e(I,{svg:e(Je,{})}),size:"S",onPress:()=>{const h=s.filter(C=>C.id!==d.id),k=typeof i.toolChoice=="object"&&p!=null&&Cf(i.toolChoice)===p;let S=i.toolChoice;h.length===0?S=void 0:k&&(S="auto"),t({instanceId:n,patch:{tools:h,toolChoice:S},dirty:!0})}})]}),children:e(Zo,{preInitializationMinHeight:pv,children:e(rn,{value:c,onChange:u,jsonSchema:y})})})}function fv(n){const a=n.playgroundInstanceId,l=O(d=>d.instances.find(c=>c.id===n.playgroundInstanceId)),t=O(d=>d.updateInstance);if(l==null)throw new Error(`Playground instance ${a} not found`);const{tools:i}=l;if(i==null)throw new Error(`Playground instance ${a} does not have tools`);const r=m.useMemo(()=>i.map(d=>As(d)).filter(d=>d!=null),[i]),s=l.model.provider;return Kf(s)?o(fe,{id:"tools",children:[o(pe,{arrowPosition:"start",children:["Tools",e(Ln,{children:i.length})]}),e(ye,{children:e(v,{padding:"size-200",children:o(b,{direction:"column",gap:"size-200",children:[e(dt,{children:e(Tf,{provider:s,choice:l.toolChoice,onChange:d=>{t({instanceId:a,patch:{toolChoice:d},dirty:!0})},toolNames:r})}),e(b,{direction:"column",gap:"size-200",children:i.map(d=>e(yv,{playgroundInstanceId:a,toolId:d.id},d.id))})]})})})]}):null}const Lu=1,hv=Lu+1;function kv(n){const a=n.playgroundInstanceId,l=O(u=>u.templateFormat),t=O(u=>u.updateInstance),i=m.useMemo(()=>Du(a),[a]),r=O(i);if(!r)throw new Error(`Playground instance ${a} not found`);const s=r.tools.length>0,d=r.model.invocationParameters.find(u=>Ca(u,{canonicalName:Nn,invocationName:Vn}))!=null,{template:c}=r;if(c.__type!=="chat")throw new Error(`Invalid template type ${c.__type}`);const g=c.messageIds,f=wp(pr(Np),pr(zp,{coordinateGetter:Vp}));return o(Mp,{sensors:f,onDragEnd:({active:u,over:p})=>{if(!p||u.id===p.id)return;const y=g.findIndex(S=>S===u.id),h=g.findIndex(S=>S===p.id),k=Ep(g,y,h);t({instanceId:a,patch:{template:{__type:"chat",messageIds:k}},dirty:!0})},children:[e(Rp,{items:g,children:e("ul",{css:K`
            display: flex;
            flex-direction: column;
            gap: var(--ac-global-dimension-size-200);
            padding: var(--ac-global-dimension-size-200);
          `,children:g.map(u=>e(Sv,{playgroundInstanceId:a,templateFormat:l,messageId:u},u))})}),e(v,{paddingStart:"size-200",paddingEnd:"size-200",paddingTop:"size-100",paddingBottom:"size-100",borderColor:"dark",borderTopWidth:"thin",borderBottomWidth:s||d?"thin":void 0,children:e(uv,{instanceId:a,hasResponseFormat:d})}),s||d?o(Cn,{defaultExpandedKeys:["tools","response-format"],children:[s?e(fv,{...n}):null,d?e(gv,{...n}):null]}):null]})}function bv({message:n,updateMessage:a,templateFormat:l,playgroundInstanceId:t,messageMode:i}){const r=m.useCallback(s=>{a({content:s})},[a]);return i==="toolCalls"?e(v,{paddingTop:"size-100",paddingStart:"size-250",paddingEnd:"size-250",paddingBottom:"size-200",children:e(Ia,{label:"Tool Calls",children:e(Ue,{width:"100%",children:e(iv,{playgroundInstanceId:t,messageId:n.id})})})}):n.role==="tool"?o(dt,{onSubmit:s=>{s.preventDefault()},children:[e(v,{paddingX:"size-200",paddingY:"size-100",borderColor:"yellow-700",borderBottomWidth:"thin",children:e(ee,{value:n.toolCallId,onChange:s=>a({toolCallId:s}),"aria-label":"Tool Call ID",size:"S",children:e(X,{placeholder:"Tool Call ID"})})}),e(rn,{value:n.content??'""',"aria-label":"tool message content",height:"100%",onChange:s=>a({content:s})})]}):e(ft,{children:e(ht,{height:"100%",defaultValue:n.content||"","aria-label":"Message content",templateFormat:l,onChange:r})})}function Sv({playgroundInstanceId:n,templateFormat:a,messageId:l}){const t=O(A=>A.updateMessage),i=O(A=>A.deleteMessage),{attributes:r,listeners:s,setNodeRef:d,transform:c,transition:g,setActivatorNodeRef:f,isDragging:u}=$p({id:l}),p=m.useMemo(()=>A=>{var z;return(z=A.instances.find(N=>N.id===n))==null?void 0:z.model},[n]),y=O(p);if(!y)throw new Error(`Instance model not found for instance ${n}`);const h=m.useMemo(()=>ui(l),[l]),k=O(h),S=Nl(k.role),C={transform:jp.Translate.toString(c),transition:g,zIndex:u?hv:Lu},P=k.toolCalls!=null&&k.toolCalls.length>0,[L,_]=m.useState(P?"toolCalls":"text"),[w,V]=m.useState(k.content),[Q,x]=m.useState(k.toolCalls),R=m.useCallback(A=>{t({instanceId:n,messageId:l,patch:A})},[n,l,t]);return e("li",{ref:d,style:C,children:e(q,{collapsible:!0,variant:"compact",bodyStyle:{padding:0},...S,title:e("div",{css:K`
              // Align the role picker with the prompt picker in PlaygroundTemplate header
              margin-left: var(--ac-global-dimension-size-150);
            `,children:e(dv,{includeLabel:!1,role:k.role,onChange:A=>{let z=k.content,N=k.toolCalls;A!=="ai"&&(N=void 0,_("text")),A==="tool"&&(z='""'),t({instanceId:n,messageId:l,patch:{role:A,toolCalls:N,content:z}})}})}),extra:o(b,{direction:"row",gap:"size-100",children:[k.role==="ai"?e(ov,{messageMode:L,onChange:A=>{switch(_(A),A){case"text":x(k.toolCalls),t({instanceId:n,messageId:l,patch:{content:w,toolCalls:void 0}});break;case"toolCalls":V(k.content),t({instanceId:n,messageId:l,patch:{content:"",toolCalls:Q!=null?Jo({toolCalls:Q,provider:y.provider}):[b0(y.provider)]}});break;default:Te()}}}):null,e(de,{text:L==="toolCalls"?jn(k.toolCalls).json??"":k.content??""}),e(M,{"aria-label":"Delete message",leadingVisual:e(I,{svg:e(Je,{})}),size:"S",onPress:()=>{i({instanceId:n,messageId:l})}}),e(Pf,{ref:f,listeners:s,attributes:r})]}),children:e("div",{children:e(bv,{message:k,messageMode:L,playgroundInstanceId:n,templateFormat:a,updateMessage:R})})})})}function vv(n){const[a,l]=m.useState(null),t=n.playgroundInstanceId,i=O(k=>k.updateInstance),r=O(k=>k.addMessage),s=O(k=>k.setDirty),d=O(k=>k.instances),c=d.find(k=>k.id===t),g=d.findIndex(k=>k.id===t),f=c==null?void 0:c.prompt,u=f==null?void 0:f.id,p=O(k=>k.dirtyInstances[t]),y=m.useCallback(async k=>{if(!k){i({instanceId:t,patch:{prompt:null},dirty:!1});return}const S=await Kc(k);S&&(i({instanceId:t,patch:{...S.instance,template:{__type:"chat",messageIds:[]}},dirty:!1}),r({playgroundInstanceId:t,messages:S.instance.template.messages}),s(t,!1))},[t,i,r,s]);if(!c)throw new Error(`Playground instance ${t} not found`);const{template:h}=c;return o(J,{children:[e(q,{title:o(b,{direction:"row",gap:"size-100",alignItems:"center",marginEnd:"size-100",children:[e(Di,{index:g}),e(Cu,{promptId:u,onChange:y})]}),collapsible:!0,variant:"compact",bodyStyle:{padding:0},extra:o(b,{direction:"row",gap:"size-100",children:[e(m.Suspense,{fallback:e("div",{children:e(ge,{size:"S"})}),children:e(tv,{instanceId:t})}),e(nv,{...n}),e(Cv,{instanceId:t,setDialog:l,dirty:p}),d.length>1?e(Fv,{...n}):null]}),children:h.__type==="chat"?e(m.Suspense,{children:e(kv,{...n})}):"Completion Template"}),e(ue,{isDismissable:!0,onDismiss:()=>{l(null)},children:a})]})}function Fv(n){const a=O(l=>l.deleteInstance);return o(Ee,{children:[e(nn,{children:e(M,{size:"S","aria-label":"Delete this instance of the playground",leadingVisual:e(I,{svg:e(Je,{})}),onPress:()=>{a(n.playgroundInstanceId)}})}),e($n,{children:e($a,{children:"Delete this instance of the playground"})})]})}function Cv({instanceId:n,setDialog:a,dirty:l}){const t=O(r=>r.instances.find(s=>s.id===n));if(!t)throw new Error(`Instance ${n} not found`);return e(J,{children:o(Ee,{delay:100,offset:5,placement:"top",children:[e(nn,{children:e(M,{variant:l?"primary":void 0,size:"S",onPress:()=>{var r;a(e($S,{instanceId:n,setDialog:a,selectedPromptId:(r=t.prompt)==null?void 0:r.id}))},children:"Save"})}),e($n,{children:e($a,{children:"Save this prompt"})})]})})}function Kv({size:n}){const a=O(t=>t.templateFormat),l=O(t=>t.setTemplateFormat);return e("div",{css:K`
        & * {
          white-space: nowrap;
        }
      `,children:o(xt,{size:n,defaultSelectedKeys:[a],"aria-label":"Template Format",onSelectionChange:t=>{if(t.size===0)return;const i=t.keys().next().value;typeof i=="string"&&xf(i)&&l(i)},children:[e(Pn,{"aria-label":"None",id:bn.NONE,children:"None"}),e(Pn,{"aria-label":"Mustache",id:bn.Mustache,children:"Mustache"}),e(Pn,{"aria-label":"F-String",id:bn.FString,children:"F-String"})]})})}const Tv=K`
  display: flex;
  overflow: hidden;
  flex-direction: column;
  height: 100%;
`;function ir(n){const{modelProviders:a}=T.useLazyLoadQuery(Tc,{}),l=un(r=>r.modelConfigByProvider),t=un(r=>r.playgroundStreamingEnabled);return a.some(r=>r.dependenciesInstalled)?o(O1,{...n,streaming:t,modelConfigByProvider:l,children:[o("div",{css:Tv,children:[e(v,{borderBottomColor:"dark",borderBottomWidth:"thin",padding:"size-200",flex:"none",children:o(b,{direction:"row",justifyContent:"space-between",alignItems:"center",children:[e(ae,{level:1,children:"Playground"}),o(b,{direction:"row",gap:"size-100",alignItems:"center",children:[e(VS,{}),e(CS,{}),e(Y1,{}),e(MS,{})]})]})}),e(wv,{})]}),e(m.Suspense,{children:e(W1,{})})]}):e(Z1,{availableProviders:a})}function Pv(){const n=O(i=>i.addInstance),a=O(i=>i.instances),l=a.length,t=a.some(i=>i.activeRunId!=null);return e(M,{size:"S","aria-label":"add prompt",leadingVisual:e(I,{svg:e(Bn,{})}),isDisabled:l>=Dh||t,onPress:()=>{n()},children:"Compare"})}const xv=K`
  display: flex;
  flex-direction: column;
  height: 100%;
  overflow: hidden;
  & > .ac-disclosure-group {
    display: flex;
    flex-direction: column;
    height: 100%;
    overflow: hidden;
    flex: 1 1 auto;
    & > .ac-disclosure {
      height: 100%;
      display: flex;
      flex-direction: column;
      overflow-x: hidden;
      overflow-y: auto;
      flex: 1 1 auto;
      // prevent the accordion item header from growing to fill the accordion item
      // using two selectors as fallback just incase the component lib changes subtly
      & > [role="button"],
      & > #prompts-heading {
        flex: 0 0 auto;
      }
      .ac-disclosure-panel {
        height: 100%;
        overflow: hidden;
        flex: 1 1 auto;
      }
    }
  }
`,Iv=K`
  padding: var(--ac-global-dimension-size-200);
  scrollbar-gutter: stable;
  height: 100%;
  flex: 1 1 auto;
  overflow: auto;
  box-sizing: border-box;
`,Dv=K`
  height: 100%;
  overflow: auto;
`,Lv=632,_v=["prompts"],Av=["input","output"];function wv(){const n=O(u=>u.templateFormat),[a]=pn(),l=a.get("datasetId"),t=l!=null,r=O(u=>u.instances.length)===1,s=O(u=>u.instances.some(p=>p.activeRunId!=null)),d=O(u=>Object.values(u.dirtyInstances).some(p=>p)),c=O(u=>u.instances.map(p=>p.id),(u,p)=>u.length===p.length&&u.every((y,h)=>y===p[h])),g=m.useCallback(({currentLocation:u,nextLocation:p})=>{const y=u.pathname!==p.pathname;return(s||d)&&y},[s,d]),f=Op(g);return m.useEffect(()=>{const u=s,p=y=>{y.preventDefault(),y.returnValue=!0};if(u)return window.addEventListener("beforeunload",p),()=>{window.removeEventListener("beforeunload",p)}},[s]),o(m.Fragment,{children:[o(Fn,{direction:r&&!t?"horizontal":"vertical",autoSaveId:r?"playground-horizontal":"playground-vertical",children:[e(Ie,{children:e("div",{css:xv,children:e(Cn,{defaultExpandedKeys:_v,children:o(fe,{id:"prompts",size:"L",children:[o(pe,{arrowPosition:"start",justifyContent:"space-between",children:["Prompts",e(El,{children:o(b,{direction:"row",gap:"size-100",alignItems:"center",children:[e(Kv,{size:"S"}),e(Pv,{})]})})]}),e(ye,{children:e("div",{css:Iv,children:e(b,{direction:"row",gap:"size-200",maxWidth:"100%",children:c.map(u=>e(v,{flex:"1 1 0px",minWidth:Lv,children:e(vv,{playgroundInstanceId:u})},`${u}-prompt`))})})})]})})})}),e(Dn,{css:Pt}),e(Ie,{children:t?e(m.Suspense,{fallback:e(ge,{}),children:e(vS,{datasetId:l})}):e("div",{css:Dv,children:o(Cn,{defaultExpandedKeys:Av,children:[n!==bn.NONE?o(fe,{id:"input",size:"L",children:[e(pe,{arrowPosition:"start",children:"Inputs"}),e(ye,{children:e(v,{padding:"size-200",height:"100%",children:e(IS,{})})})]}):null,o(fe,{id:"output",size:"L",children:[e(pe,{arrowPosition:"start",children:"Output"}),e(ye,{children:e(v,{padding:"size-200",height:"100%",children:e(b,{direction:"row",gap:"size-200",children:c.map(u=>e(v,{flex:"1 1 0px",children:e(RS,{playgroundInstanceId:u})},`${u}-output`))})})})]})]})})})]}),f!=null&&e(If,{blocker:f,message:s?"Playground run is still in progress, leaving the page may result in incomplete runs. Are you sure you want to leave?":"You have unsaved changes. Are you sure you want to leave?"})]},"playground-content")}function zT(){const{instanceWithPrompt:n,templateFormat:a}=Me(),{instance:l}=m.useMemo(()=>{const{instance:t}=ko();return{instance:{...t,...n,template:n.template}}},[n]);return e(ir,{instances:[l],templateFormat:a})}const _u=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"},{defaultValue:null,kind:"LocalArgument",name:"promptId"}],a=[{kind:"Variable",name:"input",variableName:"input"}],l=[{kind:"Variable",name:"id",variableName:"promptId"}],t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"TagPromptVersionButtonSetTagMutation",selections:[{alias:null,args:a,concreteType:"PromptVersionTagMutationPayload",kind:"LinkedField",name:"setPromptVersionTag",plural:!1,selections:[{alias:null,args:null,concreteType:"Query",kind:"LinkedField",name:"query",plural:!1,selections:[{alias:"prompt",args:l,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{kind:"InlineFragment",selections:[{args:null,kind:"FragmentSpread",name:"PromptVersionsList__main"}],type:"Prompt",abstractKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"TagPromptVersionButtonSetTagMutation",selections:[{alias:null,args:a,concreteType:"PromptVersionTagMutationPayload",kind:"LinkedField",name:"setPromptVersionTag",plural:!1,selections:[{alias:null,args:null,concreteType:"Query",kind:"LinkedField",name:"query",plural:!1,selections:[{alias:"prompt",args:l,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"PromptVersionConnection",kind:"LinkedField",name:"promptVersions",plural:!1,selections:[{alias:null,args:null,concreteType:"PromptVersionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"version",args:null,concreteType:"PromptVersion",kind:"LinkedField",name:"node",plural:!1,selections:[t,{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"sequenceNumber",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"user",plural:!1,selections:[t,{alias:null,args:null,kind:"ScalarField",name:"username",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"profilePictureUrl",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PromptVersionTag",kind:"LinkedField",name:"tags",plural:!0,selections:[t,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],type:"Prompt",abstractKey:null},t],storageKey:null}],storageKey:null}],storageKey:null}]},params:{cacheID:"991a6a38de992c1261cceafe9b2c6850",id:null,metadata:{},name:"TagPromptVersionButtonSetTagMutation",operationKind:"mutation",text:`mutation TagPromptVersionButtonSetTagMutation(
  $input: SetPromptVersionTagInput!
  $promptId: ID!
) {
  setPromptVersionTag(input: $input) {
    query {
      prompt: node(id: $promptId) {
        __typename
        ... on Prompt {
          ...PromptVersionsList__main
        }
        id
      }
    }
  }
}

fragment PromptVersionSummaryFragment on PromptVersion {
  id
  description
  sequenceNumber
  createdAt
  user {
    id
    username
    profilePictureUrl
  }
  ...PromptVersionTagsList_data
}

fragment PromptVersionTagsList_data on PromptVersion {
  tags {
    id
    name
  }
}

fragment PromptVersionsList__main on Prompt {
  promptVersions {
    edges {
      version: node {
        id
        ...PromptVersionSummaryFragment
      }
    }
  }
}
`}}}();_u.hash="e6cca3095cc459928e5d7ff1e7137a43";const Au=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"promptId"},{defaultValue:null,kind:"LocalArgument",name:"versionId"}],a=[{kind:"Variable",name:"id",variableName:"promptId"}],l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},t=[l,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],i={kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"PromptVersionTag",kind:"LinkedField",name:"versionTags",plural:!0,selections:t,storageKey:null}],type:"Prompt",abstractKey:null},r=[{kind:"Variable",name:"id",variableName:"versionId"}],s={kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"PromptVersionTag",kind:"LinkedField",name:"tags",plural:!0,selections:t,storageKey:null}],type:"PromptVersion",abstractKey:null},d={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"TagPromptVersionButtonTagsQuery",selections:[{alias:"prompt",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[i],storageKey:null},{alias:"promptVersion",args:r,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[s],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"TagPromptVersionButtonTagsQuery",selections:[{alias:"prompt",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[d,i,l],storageKey:null},{alias:"promptVersion",args:r,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[d,s,l],storageKey:null}]},params:{cacheID:"07290a8880ce785c72cb316417da40f0",id:null,metadata:{},name:"TagPromptVersionButtonTagsQuery",operationKind:"query",text:`query TagPromptVersionButtonTagsQuery(
  $promptId: ID!
  $versionId: ID!
) {
  prompt: node(id: $promptId) {
    __typename
    ... on Prompt {
      versionTags {
        id
        name
      }
    }
    id
  }
  promptVersion: node(id: $versionId) {
    __typename
    ... on PromptVersion {
      tags {
        id
        name
      }
    }
    id
  }
}
`}}}();Au.hash="6f96cbb8864a597a74d85547a9b49ed0";const wu=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"},{defaultValue:null,kind:"LocalArgument",name:"promptVersionId"}],a=[{kind:"Variable",name:"input",variableName:"input"}],l=[{kind:"Variable",name:"id",variableName:"promptVersionId"}],t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"NewPromptVersionTagDialogMutation",selections:[{alias:null,args:a,concreteType:"PromptVersionTagMutationPayload",kind:"LinkedField",name:"setPromptVersionTag",plural:!1,selections:[{alias:null,args:null,concreteType:"Query",kind:"LinkedField",name:"query",plural:!1,selections:[{alias:null,args:l,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"PromptVersionTagsList_data"}],storageKey:null}],storageKey:null}],storageKey:null}],type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"NewPromptVersionTagDialogMutation",selections:[{alias:null,args:a,concreteType:"PromptVersionTagMutationPayload",kind:"LinkedField",name:"setPromptVersionTag",plural:!1,selections:[{alias:null,args:null,concreteType:"Query",kind:"LinkedField",name:"query",plural:!1,selections:[{alias:null,args:l,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"PromptVersionTag",kind:"LinkedField",name:"tags",plural:!0,selections:[t,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],storageKey:null}],type:"PromptVersion",abstractKey:null},t],storageKey:null}],storageKey:null}],storageKey:null}]},params:{cacheID:"bfc7b301944fc8273b56810aa777401c",id:null,metadata:{},name:"NewPromptVersionTagDialogMutation",operationKind:"mutation",text:`mutation NewPromptVersionTagDialogMutation(
  $input: SetPromptVersionTagInput!
  $promptVersionId: ID!
) {
  setPromptVersionTag(input: $input) {
    query {
      node(id: $promptVersionId) {
        __typename
        ...PromptVersionTagsList_data
        id
      }
    }
  }
}

fragment PromptVersionTagsList_data on PromptVersion {
  tags {
    id
    name
  }
}
`}}}();wu.hash="a6e4352854be2ab5fd0c10368a3469ad";function Rv({onNewTagCreated:n,promptVersionId:a,onDismiss:l}){const{control:t,handleSubmit:i,formState:{isDirty:r}}=Ve({defaultValues:{name:"",description:""}}),[s,d]=m.useState(null),[c,g]=T.useMutation(wu);return e(ue,{onDismiss:l,isDismissable:!0,type:"modal",children:o(oe,{title:"New Prompt Tag",children:[s?e(Fe,{variant:"danger",banner:!0,children:s}):null,o(gn,{onSubmit:i(u=>{d(null),c({variables:{input:{name:u.name,description:u.description,promptVersionId:a},promptVersionId:a},onCompleted:()=>{n(u),l()},onError:p=>{d(p.message)}})}),children:[o(v,{padding:"size-200",children:[e(G,{name:"name",control:t,rules:{required:"Name is required",pattern:Ku},render:({field:{name:u,onChange:p,onBlur:y,value:h},fieldState:{invalid:k,error:S}})=>o(ee,{isInvalid:k,onChange:p,onBlur:y,name:u,value:h.toString(),children:[e(H,{children:"Tag Name"}),e(X,{placeholder:"e.x. prod"}),S!=null&&S.message?e(ke,{children:S.message}):e(F,{slot:"description",children:"The identifier of the tag"})]})}),e(G,{name:"description",control:t,render:({field:{name:u,onChange:p,onBlur:y,value:h},fieldState:{invalid:k,error:S}})=>o(ee,{isInvalid:k,onChange:p,name:u,onBlur:y,value:h.toString(),children:[e(H,{children:"Description"}),e(Pa,{placeholder:"A description of the tag"}),S!=null&&S.message?e(ke,{children:S.message}):e(F,{slot:"description",children:"A description of the tag (optional)"})]})})]}),e(v,{paddingX:"size-200",paddingY:"size-100",borderTopColor:"dark",borderTopWidth:"thin",children:e(b,{gap:"size-100",justifyContent:"end",children:e(M,{variant:r?"primary":"default",size:"S",type:"submit",isDisabled:g,children:"Create Tag"})})})]})]})})}function Ev(){const[n,a]=m.useState(!1),[l,t]=m.useState(0),i=me(),{promptId:r,versionId:s}=Qe();if(!r)throw new Error("Expected promptId to be defined");if(!s)throw new Error("Expected versionId to be defined");return o("div",{children:[o(Ne,{children:[e(M,{size:"S",leadingVisual:e(I,{svg:e(Df,{})}),children:"Tag Version"}),o(la,{placement:"bottom end",children:[e(Yo,{}),o(He,{children:[e(m.Suspense,{fallback:e(v,{padding:"size-100",children:e(ge,{size:"S"})}),children:e(Mv,{promptId:r,versionId:s,fetchKey:l,onTagSet:d=>{t(c=>c+1),i({title:"Tag Set",message:`The tag ${d} has been set on the version`})}})}),e(v,{padding:"size-100",width:"250px",children:e(M,{leadingVisual:e(I,{svg:e(ka,{})}),size:"S",css:K`
                  width: 100%;
                `,onPress:()=>a(!0),children:"New Tag"})})]})]})]}),n&&e(Rv,{promptVersionId:s,onDismiss:()=>a(!1),onNewTagCreated:d=>{t(c=>c+1),i({title:"Tag Created",message:`The tag ${d.name} has been created and been set on the version`})}})]})}function Mv({promptId:n,versionId:a,fetchKey:l,onTagSet:t}){var f,u;const i=T.useLazyLoadQuery(Au,{promptId:n,versionId:a},{fetchKey:l,fetchPolicy:"store-and-network"}),r=m.useMemo(()=>{var p,y;return((y=(p=i==null?void 0:i.prompt)==null?void 0:p.versionTags)==null?void 0:y.map(h=>h.name))||[]},[(f=i==null?void 0:i.prompt)==null?void 0:f.versionTags]),s=m.useMemo(()=>{var p,y;return((y=(p=i==null?void 0:i.promptVersion)==null?void 0:p.tags)==null?void 0:y.map(h=>h.name))||[]},[(u=i==null?void 0:i.promptVersion)==null?void 0:u.tags]),d=m.useMemo(()=>Array.from(new Set([...vr.map(p=>p.name),...r])),[r]),[c,g]=T.useMutation(_u);return e("ul",{children:d.map(p=>{const y=s.includes(p);return e("li",{children:e(v,{paddingY:"size-100",paddingX:"size-200",borderBottomColor:"light",borderBottomWidth:"thin",children:o(b,{direction:"row",gap:"size-100",alignItems:"center",children:[e("input",{type:"checkbox",name:p,checked:y,disabled:y||g,onChange:h=>{if(h.target.checked){const k=!s.includes(p);let S="";if(k){const C=vr.find(P=>P.name===p);S=(C==null?void 0:C.description)||""}c({variables:{input:{name:p,promptVersionId:a,description:S},promptId:n},onCompleted:()=>{t(p)}})}}}),e("span",{children:p})]})})},p)})})}function NT(){const n=Me();return Oe(n),e(Vv,{promptVersion:n.promptVersion})}function Vv({promptVersion:n}){return e(v,{width:"100%",overflow:"auto",elementType:"section",children:e(v,{padding:"size-200",width:"100%",overflow:"auto",children:o(b,{direction:"column",gap:"size-200",maxWidth:900,marginStart:"auto",marginEnd:"auto",children:[o(b,{direction:"row",justifyContent:"space-between",children:[o(b,{direction:"row",gap:"size-100",children:[e(ae,{level:2,children:`Version: ${n.id}`}),e(kc,{promptVersion:n})]}),o(b,{direction:"row",gap:"size-100",children:[e(de,{text:n.id,children:"Version ID"}),e(Ev,{})]})]}),e(dc,{promptVersion:n}),e(ac,{promptVersion:n}),e(pc,{promptVersion:n})]})})})}const Ru=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}],l={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"invocationParameters",storageKey:null},s={alias:null,args:null,kind:"ScalarField",name:"modelName",storageKey:null},d=[{alias:null,args:null,kind:"ScalarField",name:"definition",storageKey:null}],c={alias:null,args:null,concreteType:"ToolDefinition",kind:"LinkedField",name:"tools",plural:!0,selections:d,storageKey:null},g={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},f={alias:null,args:null,kind:"ScalarField",name:"toolCallId",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"promptVersionLoaderQuery",selections:[{alias:"promptVersion",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[l,t,{kind:"InlineFragment",selections:[{args:null,kind:"FragmentSpread",name:"PromptInvocationParameters__main"},{args:null,kind:"FragmentSpread",name:"PromptChatMessagesCard__main"},{args:null,kind:"FragmentSpread",name:"PromptCodeExportCard__main"},{args:null,kind:"FragmentSpread",name:"PromptModelConfigurationCard__main"},{args:null,kind:"FragmentSpread",name:"PromptVersionTagsList_data"},i,r,s,c,{alias:null,args:null,concreteType:"PromptVersionTag",kind:"LinkedField",name:"tags",plural:!0,selections:[g],storageKey:null}],type:"PromptVersion",abstractKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"promptVersionLoaderQuery",selections:[{alias:"promptVersion",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[l,t,{kind:"InlineFragment",selections:[r,{alias:"provider",args:null,kind:"ScalarField",name:"modelProvider",storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"template",plural:!1,selections:[l,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"PromptMessage",kind:"LinkedField",name:"messages",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"role",storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"content",plural:!0,selections:[l,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"TextContentValue",kind:"LinkedField",name:"text",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"text",storageKey:null}],storageKey:null}],type:"TextContentPart",abstractKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"ToolCallContentValue",kind:"LinkedField",name:"toolCall",plural:!1,selections:[f,{alias:null,args:null,concreteType:"ToolCallFunction",kind:"LinkedField",name:"toolCall",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"arguments",storageKey:null},g],storageKey:null}],storageKey:null}],type:"ToolCallContentPart",abstractKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"ToolResultContentValue",kind:"LinkedField",name:"toolResult",plural:!1,selections:[f,{alias:null,args:null,kind:"ScalarField",name:"result",storageKey:null}],storageKey:null}],type:"ToolResultContentPart",abstractKey:null}],storageKey:null}],storageKey:null}],type:"PromptChatTemplate",abstractKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"template",storageKey:null}],type:"PromptStringTemplate",abstractKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"templateType",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"templateFormat",storageKey:null},s,{alias:null,args:null,kind:"ScalarField",name:"modelProvider",storageKey:null},{alias:null,args:null,concreteType:"ResponseFormat",kind:"LinkedField",name:"responseFormat",plural:!1,selections:d,storageKey:null},c,{alias:"model",args:null,kind:"ScalarField",name:"modelName",storageKey:null},{alias:null,args:null,concreteType:"PromptVersionTag",kind:"LinkedField",name:"tags",plural:!0,selections:[t,g],storageKey:null},i],type:"PromptVersion",abstractKey:null}],storageKey:null}]},params:{cacheID:"4f37a4d04a5a5999d2f9f42875519473",id:null,metadata:{},name:"promptVersionLoaderQuery",operationKind:"query",text:`query promptVersionLoaderQuery(
  $id: ID!
) {
  promptVersion: node(id: $id) {
    __typename
    id
    ... on PromptVersion {
      ...PromptInvocationParameters__main
      ...PromptChatMessagesCard__main
      ...PromptCodeExportCard__main
      ...PromptModelConfigurationCard__main
      ...PromptVersionTagsList_data
      description
      invocationParameters
      modelName
      tools {
        definition
      }
      tags {
        name
        id
      }
    }
  }
}

fragment PromptChatMessagesCard__main on PromptVersion {
  provider: modelProvider
  template {
    __typename
    ... on PromptChatTemplate {
      messages {
        role
        content {
          __typename
          ... on TextContentPart {
            text {
              text
            }
          }
          ... on ToolCallContentPart {
            toolCall {
              toolCallId
              toolCall {
                arguments
                name
              }
            }
          }
          ... on ToolResultContentPart {
            toolResult {
              toolCallId
              result
            }
          }
        }
      }
    }
    ... on PromptStringTemplate {
      template
    }
  }
  templateType
  templateFormat
}

fragment PromptCodeExportCard__main on PromptVersion {
  id
  invocationParameters
  modelName
  modelProvider
  responseFormat {
    definition
  }
  tools {
    definition
  }
  template {
    __typename
    ... on PromptChatTemplate {
      messages {
        role
        content {
          __typename
          ... on TextContentPart {
            __typename
            text {
              text
            }
          }
          ... on ToolCallContentPart {
            __typename
            toolCall {
              toolCallId
              toolCall {
                name
                arguments
              }
            }
          }
          ... on ToolResultContentPart {
            __typename
            toolResult {
              toolCallId
              result
            }
          }
        }
      }
    }
    ... on PromptStringTemplate {
      template
    }
  }
  templateFormat
  templateType
}

fragment PromptInvocationParameters__main on PromptVersion {
  invocationParameters
}

fragment PromptLLM__main on PromptVersion {
  model: modelName
  provider: modelProvider
}

fragment PromptModelConfigurationCard__main on PromptVersion {
  model: modelName
  provider: modelProvider
  ...PromptLLM__main
  ...PromptInvocationParameters__main
  ...PromptTools__main
  ...PromptResponseFormatFragment
}

fragment PromptResponseFormatFragment on PromptVersion {
  responseFormat {
    definition
  }
}

fragment PromptTools__main on PromptVersion {
  tools {
    definition
  }
}

fragment PromptVersionTagsList_data on PromptVersion {
  tags {
    id
    name
  }
}
`}}}();Ru.hash="df4fcaf877c81b47d2b61098c91e6771";async function $T(n){const{versionId:a}=n.params;return await T.fetchQuery(he,Ru,{id:a}).toPromise().catch(()=>{throw new Error("Prompt version not found")})}const Eu=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}],l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},t={kind:"InlineFragment",selections:[{alias:null,args:[{kind:"Literal",name:"first",value:1}],concreteType:"PromptVersionConnection",kind:"LinkedField",name:"promptVersions",plural:!1,selections:[{alias:null,args:null,concreteType:"PromptVersionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"promptVersion",args:null,concreteType:"PromptVersion",kind:"LinkedField",name:"node",plural:!1,selections:[l],storageKey:null}],storageKey:null}],storageKey:"promptVersions(first:1)"}],type:"Prompt",abstractKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"promptVersionsLoaderQuery",selections:[{alias:"prompt",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[t],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"promptVersionsLoaderQuery",selections:[{alias:"prompt",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},t,l],storageKey:null}]},params:{cacheID:"72451f81ebdef0195b7338c67ae5f327",id:null,metadata:{},name:"promptVersionsLoaderQuery",operationKind:"query",text:`query promptVersionsLoaderQuery(
  $id: ID!
) {
  prompt: node(id: $id) {
    __typename
    ... on Prompt {
      promptVersions(first: 1) {
        edges {
          promptVersion: node {
            id
          }
        }
      }
    }
    id
  }
}
`}}}();Eu.hash="82115f75fbd5968bbe774fb7e006718f";async function jT({params:n}){var r,s,d;if(n.versionId)return null;const l=n.promptId,t=await _l.fetchQuery(he,Eu,{id:l}).toPromise();if(!((d=(s=(r=t==null?void 0:t.prompt)==null?void 0:r.promptVersions)==null?void 0:s.edges)!=null&&d.length))throw new Error("Prompt does not have any versions");const i=t.prompt.promptVersions.edges[0].promptVersion;return Kl(`/prompts/${l}/versions/${i.id}`)}const Mu={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"PromptVersionsPageContent__main",selections:[{args:null,kind:"FragmentSpread",name:"PromptVersionsList__main"}],type:"Prompt",abstractKey:null};Mu.hash="994c1d93ccbab49fef121d5d73cd2b62";const Vu={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"PromptVersionsList__main",selections:[{alias:null,args:null,concreteType:"PromptVersionConnection",kind:"LinkedField",name:"promptVersions",plural:!1,selections:[{alias:null,args:null,concreteType:"PromptVersionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"version",args:null,concreteType:"PromptVersion",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{args:null,kind:"FragmentSpread",name:"PromptVersionSummaryFragment"}],storageKey:null}],storageKey:null}],storageKey:null}],type:"Prompt",abstractKey:null};Vu.hash="30cac642c3466fa8405eb71f29d27be3";const zv=K`
  border-bottom: 1px solid var(--ac-global-color-grey-300);
  transition: background-color 0.1s ease-in;

  &[data-active="true"],
  &:hover {
    background-color: var(--ac-global-color-grey-200);
  }

  & > a {
    text-decoration: none;
    color: inherit;
  }
`,Nv=({version:n,active:a})=>e("div",{css:zv,"data-active":a,children:e(Qp,{to:`${n.id}`,children:e(v,{width:"100%",paddingY:"size-100",paddingX:"size-200",children:e(bc,{promptVersion:n})})})}),Xr=400,$v=({prompt:n,itemActive:a})=>{const{promptVersions:l}=T.useFragment(Vu,n);return e(v,{height:"100%",overflow:"auto",width:Xr,minWidth:Xr,borderRightWidth:"thin",borderColor:"grey-300",children:e(b,{direction:"column",children:l.edges.map(({version:t})=>e(Nv,{version:t,active:a==null?void 0:a(t)},t.id))})})};function OT(){const{prompt:n}=Xi(),{versionId:a}=Qe();return e(jv,{prompt:n,promptVersionId:a})}function jv({prompt:n,promptVersionId:a}){const l=T.useFragment(Mu,n),t=m.useCallback(i=>i.id===a,[a]);return e(v,{height:"100%",children:o(b,{direction:"row",height:"100%",children:[e($v,{prompt:l,itemActive:t}),e(ve,{})]})})}const zu=function(){var n={kind:"ClientExtension",selections:[{alias:null,args:null,kind:"ScalarField",name:"__id",storageKey:null}]},a=[{kind:"Literal",name:"first",value:1e3}],l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"maxCount",storageKey:null},s={alias:null,args:null,kind:"ScalarField",name:"maxDays",storageKey:null};return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"settingsDataPageLoaderQuery",selections:[{args:null,kind:"FragmentSpread",name:"RetentionPoliciesTable_policies"},n],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"settingsDataPageLoaderQuery",selections:[{alias:null,args:a,concreteType:"ProjectTraceRetentionPolicyConnection",kind:"LinkedField",name:"projectTraceRetentionPolicies",plural:!1,selections:[{alias:null,args:null,concreteType:"ProjectTraceRetentionPolicyEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"ProjectTraceRetentionPolicy",kind:"LinkedField",name:"node",plural:!1,selections:[l,t,{alias:null,args:null,kind:"ScalarField",name:"cronExpression",storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"rule",plural:!1,selections:[i,{kind:"InlineFragment",selections:[r],type:"TraceRetentionRuleMaxCount",abstractKey:null},{kind:"InlineFragment",selections:[s],type:"TraceRetentionRuleMaxDays",abstractKey:null},{kind:"InlineFragment",selections:[s,r],type:"TraceRetentionRuleMaxDaysOrCount",abstractKey:null}],storageKey:null},{alias:null,args:null,concreteType:"ProjectConnection",kind:"LinkedField",name:"projects",plural:!1,selections:[{alias:null,args:null,concreteType:"ProjectEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"node",plural:!1,selections:[t,l],storageKey:null}],storageKey:null}],storageKey:null},i],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null},n],storageKey:"projectTraceRetentionPolicies(first:1000)"},{alias:null,args:a,filters:null,handle:"connection",key:"RetentionPoliciesTable_projectTraceRetentionPolicies",kind:"LinkedHandle",name:"projectTraceRetentionPolicies"},n]},params:{cacheID:"f9f28f0c1f07a912207e1a17f4a46292",id:null,metadata:{},name:"settingsDataPageLoaderQuery",operationKind:"query",text:`query settingsDataPageLoaderQuery {
  ...RetentionPoliciesTable_policies
}

fragment RetentionPoliciesTable_policies on Query {
  projectTraceRetentionPolicies(first: 1000) {
    edges {
      node {
        ...RetentionPoliciesTable_retentionPolicy
        id
        __typename
      }
      cursor
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
}

fragment RetentionPoliciesTable_retentionPolicy on ProjectTraceRetentionPolicy {
  id
  name
  cronExpression
  rule {
    __typename
    ... on TraceRetentionRuleMaxCount {
      maxCount
    }
    ... on TraceRetentionRuleMaxDays {
      maxDays
    }
    ... on TraceRetentionRuleMaxDaysOrCount {
      maxDays
      maxCount
    }
  }
  projects {
    edges {
      node {
        name
        id
      }
    }
  }
}
`}}}();zu.hash="17d72dfe84adde031abd0890b21bdea6";async function QT(){return await T.fetchQuery(he,zu,{}).toPromise()}const Nu=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}],l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},t={kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"sessionId",storageKey:null}],type:"ProjectSession",abstractKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"sessionLoaderQuery",selections:[{alias:"session",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[l,t],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"sessionLoaderQuery",selections:[{alias:"session",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},l,t],storageKey:null}]},params:{cacheID:"e24902c01f282294437ffeec0084a2af",id:null,metadata:{},name:"sessionLoaderQuery",operationKind:"query",text:`query sessionLoaderQuery(
  $id: ID!
) {
  session: node(id: $id) {
    __typename
    id
    ... on ProjectSession {
      sessionId
    }
  }
}
`}}}();Nu.hash="ddb30651beeea59f8543ce916b705810";async function BT(n){const{sessionId:a}=n.params;return await T.fetchQuery(he,Nu,{id:a}).toPromise()}const $u=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}],l={alias:null,args:null,kind:"ScalarField",name:"numTraces",storageKey:null},t={alias:null,args:null,concreteType:"TokenUsage",kind:"LinkedField",name:"tokenUsage",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"total",storageKey:null}],storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"sessionId",storageKey:null},r={alias:"latencyP50",args:[{kind:"Literal",name:"probability",value:.5}],kind:"ScalarField",name:"traceLatencyMsQuantile",storageKey:"traceLatencyMsQuantile(probability:0.5)"},s={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},d={alias:null,args:null,kind:"ScalarField",name:"traceId",storageKey:null},c={alias:null,args:null,kind:"ScalarField",name:"attributes",storageKey:null},g=[s],f=[{alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"mimeType",storageKey:null}],u={alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"input",plural:!1,selections:f,storageKey:null},p={alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"output",plural:!1,selections:f,storageKey:null},y={alias:null,args:null,kind:"ScalarField",name:"cumulativeTokenCountTotal",storageKey:null},h={alias:null,args:null,kind:"ScalarField",name:"latencyMs",storageKey:null},k={alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},S={alias:null,args:null,kind:"ScalarField",name:"spanId",storageKey:null},C={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},P={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},L={alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},_={alias:null,args:null,kind:"ScalarField",name:"score",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"SessionDetailsQuery",selections:[{alias:"session",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{kind:"InlineFragment",selections:[l,t,i,r,{alias:null,args:null,concreteType:"TraceConnection",kind:"LinkedField",name:"traces",plural:!1,selections:[{alias:null,args:null,concreteType:"TraceEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"trace",args:null,concreteType:"Trace",kind:"LinkedField",name:"node",plural:!1,selections:[s,d,{alias:null,args:null,concreteType:"Span",kind:"LinkedField",name:"rootSpan",plural:!1,selections:[s,c,{alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"project",plural:!1,selections:g,storageKey:null},u,p,y,h,k,S,{args:null,kind:"FragmentSpread",name:"AnnotationSummaryGroup"}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],type:"ProjectSession",abstractKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"SessionDetailsQuery",selections:[{alias:"session",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[C,{kind:"InlineFragment",selections:[l,t,i,r,{alias:null,args:null,concreteType:"TraceConnection",kind:"LinkedField",name:"traces",plural:!1,selections:[{alias:null,args:null,concreteType:"TraceEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"trace",args:null,concreteType:"Trace",kind:"LinkedField",name:"node",plural:!1,selections:[s,d,{alias:null,args:null,concreteType:"Span",kind:"LinkedField",name:"rootSpan",plural:!1,selections:[s,c,{alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"project",plural:!1,selections:[s,{alias:null,args:null,concreteType:"AnnotationConfigConnection",kind:"LinkedField",name:"annotationConfigs",plural:!1,selections:[{alias:null,args:null,concreteType:"AnnotationConfigEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[C,{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"annotationType",storageKey:null}],type:"AnnotationConfigBase",abstractKey:"__isAnnotationConfigBase"},{kind:"InlineFragment",selections:[s,P,{alias:null,args:null,kind:"ScalarField",name:"optimizationDirection",storageKey:null},{alias:null,args:null,concreteType:"CategoricalAnnotationValue",kind:"LinkedField",name:"values",plural:!0,selections:[L,_],storageKey:null}],type:"CategoricalAnnotationConfig",abstractKey:null},{kind:"InlineFragment",selections:g,type:"Node",abstractKey:"__isNode"}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null},u,p,y,h,k,S,{alias:null,args:null,concreteType:"SpanAnnotation",kind:"LinkedField",name:"spanAnnotations",plural:!0,selections:[s,P,L,_,{alias:null,args:null,kind:"ScalarField",name:"annotatorKind",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"user",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"username",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"profilePictureUrl",storageKey:null},s],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"AnnotationSummary",kind:"LinkedField",name:"spanAnnotationSummaries",plural:!0,selections:[{alias:null,args:null,concreteType:"LabelFraction",kind:"LinkedField",name:"labelFractions",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"fraction",storageKey:null},L],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"meanScore",storageKey:null},P],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],type:"ProjectSession",abstractKey:null},s],storageKey:null}]},params:{cacheID:"a528f218e204fe3e0f4a6b55b967ada7",id:null,metadata:{},name:"SessionDetailsQuery",operationKind:"query",text:`query SessionDetailsQuery(
  $id: ID!
) {
  session: node(id: $id) {
    __typename
    ... on ProjectSession {
      numTraces
      tokenUsage {
        total
      }
      sessionId
      latencyP50: traceLatencyMsQuantile(probability: 0.5)
      traces {
        edges {
          trace: node {
            id
            traceId
            rootSpan {
              id
              attributes
              project {
                id
              }
              input {
                value
                mimeType
              }
              output {
                value
                mimeType
              }
              cumulativeTokenCountTotal
              latencyMs
              startTime
              spanId
              ...AnnotationSummaryGroup
            }
          }
        }
      }
    }
    id
  }
}

fragment AnnotationSummaryGroup on Span {
  project {
    id
    annotationConfigs {
      edges {
        node {
          __typename
          ... on AnnotationConfigBase {
            __isAnnotationConfigBase: __typename
            annotationType
          }
          ... on CategoricalAnnotationConfig {
            id
            name
            optimizationDirection
            values {
              label
              score
            }
          }
          ... on Node {
            __isNode: __typename
            id
          }
        }
      }
    }
  }
  spanAnnotations {
    id
    name
    label
    score
    annotatorKind
    createdAt
    user {
      username
      profilePictureUrl
      id
    }
  }
  spanAnnotationSummaries {
    labelFractions {
      fraction
      label
    }
    meanScore
    name
  }
}
`}}}();$u.hash="23916e656b7e054a82b1e1ac29e916d3";function Ov({spanNodeId:n,projectId:a,size:l="M",buttonText:t="Annotate"}){const[i,r]=m.useState(null);return o(J,{children:[e(M,{size:l,"aria-label":"Edit Span Annotations",leadingVisual:e(I,{svg:e(ja,{})}),onPress:()=>r(e(Xo,{spanNodeId:n,projectId:a})),children:t}),e(ue,{type:"slideOver",isDismissable:!0,onDismiss:()=>r(null),children:i})]})}const Qv=n=>{const{json:a}=Be(n);if(a==null||!va(a))return null;const l=a[Se.user];if(l==null||!va(l))return null;const t=l[Bp.id];return In.isString(t)||In.isNumber(t)?t:null};function Zr({role:n,value:a,mimeType:l}){const t=m.useMemo(()=>{if(l!=="json")return String(a);const r=Be(a);return r.json==null?"--":JSON.stringify(r.json,null,2)},[a,l]),i=Nl(n==="HUMAN"?"user":"assistant");return e(v,{alignSelf:n==="HUMAN"?"start":"end",borderRadius:"medium",borderColor:"dark",borderWidth:"thin",padding:"size-200",maxWidth:"70%",...i,children:o(b,{direction:"column",gap:"size-50",children:[e(F,{color:"text-700",children:n}),l==="json"?e(Sn,{value:t}):e(F,{children:t})]})})}function Bv({traceId:n,rootSpan:a,index:l}){const t=m.useMemo(()=>new Date(a.startTime),[a.startTime]),i=m.useMemo(()=>Qv(a.attributes),[a.attributes]);return e(v,{height:"100%",children:o(b,{direction:"column",justifyContent:"space-between",height:"100%",children:[o(b,{direction:"column",gap:"size-200",children:[o(b,{direction:"row",justifyContent:"space-between",children:[o(F,{children:["Trace #",l+1]}),e(we,{to:`/projects/${a.project.id}/traces/${n}?${mn}=${a.id}`,children:o(b,{alignItems:"center",children:["View Trace",e(I,{svg:e(Lf,{})})]})})]}),o(b,{direction:"row",justifyContent:"space-between",children:[i!=null?o(F,{color:"text-700",children:["user: ",i]}):null,e(F,{color:"text-700",flex:"end",marginStart:"auto",children:da(t)})]}),o(b,{direction:"row",gap:"size-100",children:[e(La,{tokenCountTotal:a.cumulativeTokenCountTotal??0,nodeId:a.id}),a.latencyMs!=null?e(je,{latencyMs:a.latencyMs}):"--"]})]}),o(b,{direction:"row",justifyContent:"space-between",alignItems:"end",children:[o(b,{direction:"column",gap:"size-100",maxWidth:"50%",children:[e(F,{children:"Feedback"}),e(b,{gap:"size-50",direction:"column",children:e(Kt,{span:a,renderEmptyState:()=>"--"})})]}),e("span",{children:e(Ov,{size:"S",spanNodeId:a.id,projectId:a.project.id,buttonText:"Annotate"})})]})]})})}function qv({rootSpan:n}){var a,l,t,i;return o(b,{direction:"column",gap:"size-100",children:[e(Zr,{role:"HUMAN",value:(a=n.input)==null?void 0:a.value,mimeType:(l=n.input)==null?void 0:l.mimeType}),e(Zr,{role:"AI",value:(t=n.output)==null?void 0:t.value,mimeType:(i=n.output)==null?void 0:i.mimeType})]})}function Uv({traces:n}){const a=m.useMemo(()=>((n==null?void 0:n.edges)||[]).map(({trace:t})=>t).filter(t=>t.rootSpan!==null),[n]);return e(v,{height:"100%",flex:"1 1 auto",overflow:"auto",children:a.map(({traceId:l,rootSpan:t},i)=>e(v,{borderBottomColor:"dark",borderBottomWidth:"thin",children:o(b,{direction:"row",children:[e(v,{borderRightWidth:"thin",borderEndColor:"dark",padding:"size-200",flex:"1 1 auto",children:e(qv,{rootSpan:t})}),e(v,{width:350,padding:"size-200",flex:"none",children:e(Bv,{traceId:l,rootSpan:t,index:i})})]})},t.spanId))})}function Hv({traceCount:n,tokenUsage:a,latencyP50:l,sessionId:t}){return e(v,{padding:"size-200",borderBottomWidth:"thin",borderBottomColor:"dark",children:o(b,{direction:"row",gap:"size-400",children:[o(b,{direction:"column",children:[e(F,{elementType:"h3",color:"text-700",children:"Traces Count"}),e(F,{size:"L",children:n})]}),a!=null?o(b,{direction:"column",children:[e(F,{elementType:"h3",color:"text-700",children:"Total Tokens"}),e(La,{tokenCountTotal:a.total,nodeId:t,size:"L"})]}):null,l!=null?o(b,{direction:"column",children:[e(F,{elementType:"h3",color:"text-700",children:"Latency P50"}),e(je,{latencyMs:l,size:"L"})]}):null]})})}function Gv(n){const{sessionId:a}=n,l=T.useLazyLoadQuery($u,{id:a},{fetchPolicy:"store-and-network"});if(l.session==null)throw new Error("Session not found");return o("main",{css:K`
        flex: 1 1 auto;
        display: flex;
        flex-direction: column;
        height: 100%;
        overflow: hidden;
      `,children:[e(Hv,{traceCount:l.session.numTraces??0,tokenUsage:l.session.tokenUsage,latencyP50:l.session.latencyP50,sessionId:a}),e(Uv,{traces:l.session.traces})]})}function qT(){var i;const n=Me();Oe(n);const{sessionId:a}=Qe(),l=ce(),{rootPath:t}=zt();return e(ue,{type:"slideOver",isDismissable:!0,onDismiss:()=>l(`${t}/sessions`),children:e(oe,{size:"fullscreen",title:`Session ID: ${((i=n.session)==null?void 0:i.sessionId)??"--"}`,children:e(Tt,{children:e(Gv,{sessionId:a})})})})}const ju=function(){var n=[{alias:null,args:null,concreteType:"Functionality",kind:"LinkedField",name:"functionality",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"modelInferences",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"homeLoaderQuery",selections:n,type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"homeLoaderQuery",selections:n},params:{cacheID:"8bfba02258509f0b645b86f3322838d8",id:null,metadata:{},name:"homeLoaderQuery",operationKind:"query",text:`query homeLoaderQuery {
  functionality {
    modelInferences
  }
}
`}}}();ju.hash="a248736e236c8d5348e0ecfbe9440ca2";async function UT(n){const a=await T.fetchQuery(he,ju,{}).toPromise();return a!=null&&a.functionality.modelInferences?Kl("/model"):Kl("/projects")}const Ou=function(){var n={defaultValue:null,kind:"LocalArgument",name:"endTime"},a={defaultValue:null,kind:"LocalArgument",name:"startTime"},l=[{kind:"Variable",name:"endTime",variableName:"endTime"},{kind:"Variable",name:"startTime",variableName:"startTime"}],t=[{kind:"Literal",name:"first",value:50}],i={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},s={fields:[{kind:"Variable",name:"end",variableName:"endTime"},{kind:"Variable",name:"start",variableName:"startTime"}],kind:"ObjectValue",name:"timeRange"},d={alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},c=[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},i],g={alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null};return{fragment:{argumentDefinitions:[n,a],kind:"Fragment",metadata:null,name:"ModelPageQuery",selections:[{args:l,kind:"FragmentSpread",name:"ModelSchemaTable_dimensions"},{args:l,kind:"FragmentSpread",name:"ModelEmbeddingsTable_embeddingDimensions"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[a,n],kind:"Operation",name:"ModelPageQuery",selections:[{alias:null,args:null,concreteType:"Model",kind:"LinkedField",name:"model",plural:!1,selections:[{alias:null,args:t,concreteType:"DimensionConnection",kind:"LinkedField",name:"dimensions",plural:!1,selections:[{alias:null,args:null,concreteType:"DimensionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"dimension",args:null,concreteType:"Dimension",kind:"LinkedField",name:"node",plural:!1,selections:[i,r,{alias:null,args:null,kind:"ScalarField",name:"type",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"dataType",storageKey:null},{alias:"cardinality",args:[{kind:"Literal",name:"metric",value:"cardinality"},s],kind:"ScalarField",name:"dataQualityMetric",storageKey:null},{alias:"percentEmpty",args:[{kind:"Literal",name:"metric",value:"percentEmpty"},s],kind:"ScalarField",name:"dataQualityMetric",storageKey:null},{alias:"min",args:[{kind:"Literal",name:"metric",value:"min"},s],kind:"ScalarField",name:"dataQualityMetric",storageKey:null},{alias:"mean",args:[{kind:"Literal",name:"metric",value:"mean"},s],kind:"ScalarField",name:"dataQualityMetric",storageKey:null},{alias:"max",args:[{kind:"Literal",name:"metric",value:"max"},s],kind:"ScalarField",name:"dataQualityMetric",storageKey:null},{alias:"psi",args:[{kind:"Literal",name:"metric",value:"psi"},s],kind:"ScalarField",name:"driftMetric",storageKey:null}],storageKey:null},d,{alias:null,args:null,concreteType:"Dimension",kind:"LinkedField",name:"node",plural:!1,selections:c,storageKey:null}],storageKey:null},g],storageKey:"dimensions(first:50)"},{alias:null,args:t,filters:null,handle:"connection",key:"ModelSchemaTable_dimensions",kind:"LinkedHandle",name:"dimensions"},{alias:null,args:t,concreteType:"EmbeddingDimensionConnection",kind:"LinkedField",name:"embeddingDimensions",plural:!1,selections:[{alias:null,args:null,concreteType:"EmbeddingDimensionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"embedding",args:null,concreteType:"EmbeddingDimension",kind:"LinkedField",name:"node",plural:!1,selections:[i,r,{alias:"euclideanDistance",args:[{kind:"Literal",name:"metric",value:"euclideanDistance"},s],kind:"ScalarField",name:"driftMetric",storageKey:null}],storageKey:null},d,{alias:null,args:null,concreteType:"EmbeddingDimension",kind:"LinkedField",name:"node",plural:!1,selections:c,storageKey:null}],storageKey:null},g],storageKey:"embeddingDimensions(first:50)"},{alias:null,args:t,filters:null,handle:"connection",key:"ModelEmbeddingsTable_embeddingDimensions",kind:"LinkedHandle",name:"embeddingDimensions"}],storageKey:null}]},params:{cacheID:"c4ca588a9d6e4666b2fe13fb5df8520c",id:null,metadata:{},name:"ModelPageQuery",operationKind:"query",text:`query ModelPageQuery(
  $startTime: DateTime!
  $endTime: DateTime!
) {
  ...ModelSchemaTable_dimensions_3uKjWt
  ...ModelEmbeddingsTable_embeddingDimensions_3uKjWt
}

fragment ModelEmbeddingsTable_embeddingDimensions_3uKjWt on Query {
  model {
    embeddingDimensions(first: 50) {
      edges {
        embedding: node {
          id
          name
          euclideanDistance: driftMetric(metric: euclideanDistance, timeRange: {start: $startTime, end: $endTime})
        }
        cursor
        node {
          __typename
          id
        }
      }
      pageInfo {
        endCursor
        hasNextPage
      }
    }
  }
}

fragment ModelSchemaTable_dimensions_3uKjWt on Query {
  model {
    dimensions(first: 50) {
      edges {
        dimension: node {
          id
          name
          type
          dataType
          cardinality: dataQualityMetric(metric: cardinality, timeRange: {start: $startTime, end: $endTime})
          percentEmpty: dataQualityMetric(metric: percentEmpty, timeRange: {start: $startTime, end: $endTime})
          min: dataQualityMetric(metric: min, timeRange: {start: $startTime, end: $endTime})
          mean: dataQualityMetric(metric: mean, timeRange: {start: $startTime, end: $endTime})
          max: dataQualityMetric(metric: max, timeRange: {start: $startTime, end: $endTime})
          psi: driftMetric(metric: psi, timeRange: {start: $startTime, end: $endTime})
        }
        cursor
        node {
          __typename
          id
        }
      }
      pageInfo {
        endCursor
        hasNextPage
      }
    }
  }
}
`}}}();Ou.hash="b612239336c7638df42037315b00f635";function HT(n){const{referenceInferences:a}=Hn(),{timeRange:l}=ua(),t=T.useLazyLoadQuery(Ou,{startTime:l.start.toISOString(),endTime:l.end.toISOString()});return o("main",{children:[o(wi,{children:[e(es,{}),a?e(ns,{inferencesRole:"reference",timeRange:{start:new Date(a.startTime),end:new Date(a.endTime)}}):null]}),e("section",{css:K`
          margin: var(--ac-global-dimension-static-size-200);
        `,children:e(yi,{title:"Model Schema",variant:"compact",bodyStyle:{padding:0},children:o(cn,{children:[o(dn,{children:[e(le,{id:"all",children:"All"}),e(le,{id:"embeddings",children:"Embeddings"}),e(le,{id:"dimensions",children:"Dimensions"})]}),e(re,{id:"all",children:o(Cn,{defaultExpandedKeys:["embeddings","dimensions"],children:[o(fe,{id:"embeddings",children:[e(pe,{children:"Embeddings"}),e(ye,{children:e(Fr,{model:t})})]}),o(fe,{id:"dimensions",children:[e(pe,{children:"Dimensions"}),e(ye,{children:e(Cr,{model:t})})]})]})}),e(re,{id:"embeddings",children:e(Fr,{model:t})}),e(re,{id:"dimensions",children:e(Cr,{model:t})})]})})}),e(ve,{})]})}const Qu={fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"EmbeddingPageModelQuery",selections:[{alias:null,args:null,concreteType:"Model",kind:"LinkedField",name:"model",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"MetricSelector_dimensions"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"EmbeddingPageModelQuery",selections:[{alias:null,args:null,concreteType:"Model",kind:"LinkedField",name:"model",plural:!1,selections:[{alias:"numericDimensions",args:[{kind:"Literal",name:"include",value:{dataTypes:["numeric"]}}],concreteType:"DimensionConnection",kind:"LinkedField",name:"dimensions",plural:!1,selections:[{alias:null,args:null,concreteType:"DimensionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"Dimension",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"type",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:'dimensions(include:{"dataTypes":["numeric"]})'}],storageKey:null}]},params:{cacheID:"4ccf476dd862525b059197daccd0d4d9",id:null,metadata:{},name:"EmbeddingPageModelQuery",operationKind:"query",text:`query EmbeddingPageModelQuery {
  model {
    ...MetricSelector_dimensions
  }
}

fragment MetricSelector_dimensions on Model {
  numericDimensions: dimensions(include: {dataTypes: [numeric]}) {
    edges {
      node {
        id
        name
        type
      }
    }
  }
}
`}};Qu.hash="374499f7f8ce6919e4a0a4ecbe380c52";const Bu=function(){var n={defaultValue:null,kind:"LocalArgument",name:"clusterMinSamples"},a={defaultValue:null,kind:"LocalArgument",name:"clusterSelectionEpsilon"},l={defaultValue:null,kind:"LocalArgument",name:"dataQualityMetricColumnName"},t={defaultValue:null,kind:"LocalArgument",name:"fetchDataQualityMetric"},i={defaultValue:null,kind:"LocalArgument",name:"fetchPerformanceMetric"},r={defaultValue:null,kind:"LocalArgument",name:"id"},s={defaultValue:null,kind:"LocalArgument",name:"minClusterSize"},d={defaultValue:null,kind:"LocalArgument",name:"minDist"},c={defaultValue:null,kind:"LocalArgument",name:"nNeighbors"},g={defaultValue:null,kind:"LocalArgument",name:"nSamples"},f={defaultValue:null,kind:"LocalArgument",name:"performanceMetric"},u={defaultValue:null,kind:"LocalArgument",name:"timeRange"},p=[{kind:"Variable",name:"id",variableName:"id"}],y={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},h={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},k={alias:null,args:null,kind:"ScalarField",name:"x",storageKey:null},S={alias:null,args:null,kind:"ScalarField",name:"y",storageKey:null},C=[y,{alias:null,args:null,kind:"ScalarField",name:"eventId",storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"coordinates",plural:!1,selections:[h,{kind:"InlineFragment",selections:[k,S,{alias:null,args:null,kind:"ScalarField",name:"z",storageKey:null}],type:"Point3D",abstractKey:null},{kind:"InlineFragment",selections:[k,S],type:"Point2D",abstractKey:null}],storageKey:null},{alias:null,args:null,concreteType:"EmbeddingMetadata",kind:"LinkedField",name:"embeddingMetadata",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"linkToData",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"rawData",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"EventMetadata",kind:"LinkedField",name:"eventMetadata",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"predictionId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"predictionLabel",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"actualLabel",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"predictionScore",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"actualScore",storageKey:null}],storageKey:null}],P=[{alias:null,args:null,kind:"ScalarField",name:"primaryValue",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"referenceValue",storageKey:null}],L={kind:"InlineFragment",selections:[{alias:null,args:[{kind:"Variable",name:"clusterMinSamples",variableName:"clusterMinSamples"},{kind:"Variable",name:"clusterSelectionEpsilon",variableName:"clusterSelectionEpsilon"},{kind:"Variable",name:"minClusterSize",variableName:"minClusterSize"},{kind:"Variable",name:"minDist",variableName:"minDist"},{kind:"Variable",name:"nNeighbors",variableName:"nNeighbors"},{kind:"Variable",name:"nSamples",variableName:"nSamples"},{kind:"Variable",name:"timeRange",variableName:"timeRange"}],concreteType:"UMAPPoints",kind:"LinkedField",name:"UMAPPoints",plural:!1,selections:[{alias:null,args:null,concreteType:"UMAPPoint",kind:"LinkedField",name:"data",plural:!0,selections:C,storageKey:null},{alias:null,args:null,concreteType:"UMAPPoint",kind:"LinkedField",name:"referenceData",plural:!0,selections:C,storageKey:null},{alias:null,args:null,concreteType:"UMAPPoint",kind:"LinkedField",name:"corpusData",plural:!0,selections:C,storageKey:null},{alias:null,args:null,concreteType:"Cluster",kind:"LinkedField",name:"clusters",plural:!0,selections:[y,{alias:null,args:null,kind:"ScalarField",name:"eventIds",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"driftRatio",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"primaryToCorpusRatio",storageKey:null},{condition:"fetchDataQualityMetric",kind:"Condition",passingValue:!0,selections:[{alias:null,args:[{fields:[{kind:"Variable",name:"columnName",variableName:"dataQualityMetricColumnName"},{kind:"Literal",name:"metric",value:"mean"}],kind:"ObjectValue",name:"metric"}],concreteType:"DatasetValues",kind:"LinkedField",name:"dataQualityMetric",plural:!1,selections:P,storageKey:null}]},{condition:"fetchPerformanceMetric",kind:"Condition",passingValue:!0,selections:[{alias:null,args:[{fields:[{kind:"Variable",name:"metric",variableName:"performanceMetric"}],kind:"ObjectValue",name:"metric"}],concreteType:"DatasetValues",kind:"LinkedField",name:"performanceMetric",plural:!1,selections:P,storageKey:null}]}],storageKey:null},{alias:null,args:null,concreteType:"Retrieval",kind:"LinkedField",name:"contextRetrievals",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"queryId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"documentId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"relevance",storageKey:null}],storageKey:null}],storageKey:null}],type:"EmbeddingDimension",abstractKey:null};return{fragment:{argumentDefinitions:[n,a,l,t,i,r,s,d,c,g,f,u],kind:"Fragment",metadata:null,name:"EmbeddingPageUMAPQuery",selections:[{alias:"embedding",args:p,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[L],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[r,u,d,c,g,s,n,a,t,l,i,f],kind:"Operation",name:"EmbeddingPageUMAPQuery",selections:[{alias:"embedding",args:p,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[h,L,y],storageKey:null}]},params:{cacheID:"d9999f636a5bf081cc90ab4c726f82ab",id:null,metadata:{},name:"EmbeddingPageUMAPQuery",operationKind:"query",text:`query EmbeddingPageUMAPQuery(
  $id: ID!
  $timeRange: TimeRange!
  $minDist: Float!
  $nNeighbors: Int!
  $nSamples: Int!
  $minClusterSize: Int!
  $clusterMinSamples: Int!
  $clusterSelectionEpsilon: Float!
  $fetchDataQualityMetric: Boolean!
  $dataQualityMetricColumnName: String
  $fetchPerformanceMetric: Boolean!
  $performanceMetric: PerformanceMetric!
) {
  embedding: node(id: $id) {
    __typename
    ... on EmbeddingDimension {
      UMAPPoints(timeRange: $timeRange, minDist: $minDist, nNeighbors: $nNeighbors, nSamples: $nSamples, minClusterSize: $minClusterSize, clusterMinSamples: $clusterMinSamples, clusterSelectionEpsilon: $clusterSelectionEpsilon) {
        data {
          id
          eventId
          coordinates {
            __typename
            ... on Point3D {
              x
              y
              z
            }
            ... on Point2D {
              x
              y
            }
          }
          embeddingMetadata {
            linkToData
            rawData
          }
          eventMetadata {
            predictionId
            predictionLabel
            actualLabel
            predictionScore
            actualScore
          }
        }
        referenceData {
          id
          eventId
          coordinates {
            __typename
            ... on Point3D {
              x
              y
              z
            }
            ... on Point2D {
              x
              y
            }
          }
          embeddingMetadata {
            linkToData
            rawData
          }
          eventMetadata {
            predictionId
            predictionLabel
            actualLabel
            predictionScore
            actualScore
          }
        }
        corpusData {
          id
          eventId
          coordinates {
            __typename
            ... on Point3D {
              x
              y
              z
            }
            ... on Point2D {
              x
              y
            }
          }
          embeddingMetadata {
            linkToData
            rawData
          }
          eventMetadata {
            predictionId
            predictionLabel
            actualLabel
            predictionScore
            actualScore
          }
        }
        clusters {
          id
          eventIds
          driftRatio
          primaryToCorpusRatio
          dataQualityMetric(metric: {columnName: $dataQualityMetricColumnName, metric: mean}) @include(if: $fetchDataQualityMetric) {
            primaryValue
            referenceValue
          }
          performanceMetric(metric: {metric: $performanceMetric}) @include(if: $fetchPerformanceMetric) {
            primaryValue
            referenceValue
          }
        }
        contextRetrievals {
          queryId
          documentId
          relevance
        }
      }
    }
    id
  }
}
`}}}();Bu.hash="ef95e709ca26aebdf07386ab97205b1e";function Wv(){const{theme:n}=ca();return m.useMemo(()=>n==="light"?_f:Af,[n])}function Jv(){const{embeddingDimensionId:n}=Qe();if(!n)throw new Error("Missing embeddingDimensionId in URL params");return n}const qu={euclideanDistance:{name:"Euclidean Distance",shortName:"Euc. Distance",definition:"Euclidean distance over time captures how much your primary inferences's embeddings are drifting from the reference data. Euclidean distance of the embeddings is calculated by taking the centroid of the embedding vectors for each inferences and calculating the distance between the two centroids."},queryDistance:{name:"Query Distance",shortName:"Query Distance",definition:"The query distance is the euclidean distance of the centroid of queries from the centroid of the corpus."},accuracyScore:{name:"Accuracy Score",shortName:"Accuracy",definition:"Accuracy classification score. In multi-label classification, this function computes subset accuracy: the set of labels predicted for a sample must exactly match the corresponding set of labels in the ground truth."}};function Ma(n){const a=qu[n];return a!=null?a.shortName:n}function Zt(n){const a=qu[n];return a&&a.definition!=null&&a.definition||null}function Ua(n){return`${n.column}:${n.dir}`}function Xv(){const{referenceInferences:n}=Hn(),a=!!n,l=Y(c=>c.clusterSort),t=Y(c=>c.setClusterSort),[i,r]=m.useState(!1),s=m.useMemo(()=>{const c=[];return a&&c.push({label:"Most drift",value:Ua({column:"driftRatio",dir:"desc"})}),[...c,{label:"Largest clusters",value:Ua({column:"size",dir:"desc"})},{label:"Smallest clusters",value:Ua({column:"size",dir:"asc"})},{label:"Highest metric value",value:Ua({column:"primaryMetricValue",dir:"desc"})},{label:"Lowest metric value",value:Ua({column:"primaryMetricValue",dir:"asc"})}]},[a]),d=Ua(l);return e("div",{css:K`
        .ac-action-button {
          background: none;
          border: none;
          color: ${"var(--ac-global-text-color-700)"};
          font-size: var(--ac-global-font-size-xs);
          line-height: var(--ac-global-line-height-xs);
          cursor: pointer;
          outline: none;
          &:hover {
            color: var(--ac-global-text-color-900);
          }
        }
      `,children:o(ot,{placement:"bottom right","aria-label":"Sort clusters by",isOpen:i,onOpenChange:c=>r(c),children:[o(ey,{children:["Sort",e("span",{"aria-hidden":!0,"data-testid":"dropdown-caret",css:K`
              margin-left: var(--ac-global-dimension-static-size-50);
              border-bottom-color: #0000;
              border-left-color: #0000;
              border-right-color: #0000;
              border-style: solid;
              border-width: 3px 3px 0;
              content: "";
              display: inline-block;
              height: 0;
              vertical-align: middle;
              width: 0;
            `})]}),e(ho,{children:e(ct,{style:{width:200},selectedKeys:[d],selectionMode:"single",items:s,onSelectionChange:c=>{if(c instanceof Set&&c.size>0){const[g]=c.values(),[f,u]=g.split(":");t({column:f,dir:u})}r(!1)},children:c=>e(xe,{children:c.label},c.value)})})]})})}const Uu={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"MetricSelector_dimensions",selections:[{alias:"numericDimensions",args:[{kind:"Literal",name:"include",value:{dataTypes:["numeric"]}}],concreteType:"DimensionConnection",kind:"LinkedField",name:"dimensions",plural:!1,selections:[{alias:null,args:null,concreteType:"DimensionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"Dimension",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"type",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:'dimensions(include:{"dataTypes":["numeric"]})'}],type:"Model",abstractKey:null};Uu.hash="55d03de16503d7af254c17cef7d18ee0";const Ga=":";function Zv(n){return["drift","performance","dataQuality","retrieval"].includes(n)}function pl(n){const{type:a,metric:l}=n;switch(a){case"drift":return`${a}${Ga}${l}`;case"retrieval":return`${a}${Ga}${l}`;case"performance":return`${a}${Ga}${l}`;case"dataQuality":{const{name:t}=n.dimension;return`${a}${Ga}${l}${Ga}${t}`}default:Te()}}function Yv({metricKey:n,dimensions:a}){const[l,t,i]=n.split(Ga);if(!Zv(l))throw new Error(`Invalid metric type: ${l}`);switch(l){case"drift":return{type:l,metric:t};case"retrieval":return{type:l,metric:t};case"performance":return{type:l,metric:t};case"dataQuality":{const r=a.find(s=>s.name===i);if(!r)throw new Error(`Invalid dimension name: ${i}`);return{type:l,metric:t,dimension:r}}default:Te()}}const eF=K`
  /* Align with other toolbar components */
  .react-aria-Button {
    height: 30px;
    min-height: 30px;
  }

  .react-aria-Label {
    padding: 5px 0;
    display: inline-block;
    font-size: var(--ac-global-dimension-static-font-size-75);
    font-weight: var(--px-font-weight-heavy);
  }
`;function nF({model:n}){const[,a]=m.useTransition(),l=T.useFragment(Uu,n),{referenceInferences:t,corpusInferences:i}=Hn(),r=!!t,s=!!i,d=Y(h=>h.metric),c=Y(h=>h.loading),g=Y(h=>h.setMetric),f=l.numericDimensions.edges.map(h=>h.node),u=f.length>0,p=m.useCallback(h=>{if(!h)return;const k=Yv({metricKey:h,dimensions:f});a(()=>{g(k)})},[g,f,a]),y=[];return r&&y.push({key:pl({type:"drift",metric:"euclideanDistance"}),label:"Euclidean Distance"}),s&&y.push({key:pl({type:"retrieval",metric:"queryDistance"}),label:"Query Distance"}),y.push({key:pl({type:"performance",metric:"accuracyScore"}),label:"Accuracy Score"}),u&&f.forEach(h=>{y.push({key:pl({type:"dataQuality",metric:"average",dimension:h}),label:`${h.name} avg`})}),o(Ee,{delay:0,children:[e(nn,{children:o(pt,{selectedKey:d?pl(d):void 0,onSelectionChange:p,placeholder:"Select a metric...",isDisabled:c,"aria-label":"Analysis metric",css:eF,children:[e(H,{children:"Metric"}),o(M,{children:[e(lt,{}),e(yt,{})]}),e(la,{children:e(Ml,{children:y.map(h=>e(Xn,{id:h.key,children:h.label},h.key))})})]})}),e($n,{children:o("section",{css:K`
            h4 {
              margin-bottom: 0.5rem;
            }
          `,children:[e(ae,{level:4,children:"Analysis Metric"}),e(F,{children:"Select a metric to drive the analysis of your embeddings."}),e(F,{children:"To analyze the the drift between your two inferences, select a drift metric and the UI will highlight areas of high drift."}),e(F,{children:"To analyze the quality of your embeddings, select a dimension data quality metric by which to analyze the point cloud. The UI will highlight areas where the data quality is degrading."})]})})]})}const Hu=function(){var n={defaultValue:null,kind:"LocalArgument",name:"countGranularity"},a={defaultValue:null,kind:"LocalArgument",name:"dimensionId"},l={defaultValue:null,kind:"LocalArgument",name:"embeddingDimensionId"},t={defaultValue:null,kind:"LocalArgument",name:"fetchDataQuality"},i={defaultValue:null,kind:"LocalArgument",name:"fetchDrift"},r={defaultValue:null,kind:"LocalArgument",name:"fetchPerformance"},s={defaultValue:null,kind:"LocalArgument",name:"fetchQueryDistance"},d={defaultValue:null,kind:"LocalArgument",name:"metricGranularity"},c={defaultValue:null,kind:"LocalArgument",name:"performanceMetric"},g={defaultValue:null,kind:"LocalArgument",name:"timeRange"},f=[{kind:"Variable",name:"id",variableName:"embeddingDimensionId"}],u={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},p={kind:"Variable",name:"granularity",variableName:"metricGranularity"},y={kind:"Variable",name:"timeRange",variableName:"timeRange"},h=[p,{kind:"Literal",name:"metric",value:"euclideanDistance"},y],k=[{alias:null,args:null,concreteType:"TimeSeriesDataPoint",kind:"LinkedField",name:"data",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"timestamp",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null}],storageKey:null}],S={kind:"InlineFragment",selections:[{condition:"fetchDrift",kind:"Condition",passingValue:!0,selections:[{alias:"euclideanDistanceTimeSeries",args:h,concreteType:"DriftTimeSeries",kind:"LinkedField",name:"driftTimeSeries",plural:!1,selections:k,storageKey:null}]},{condition:"fetchQueryDistance",kind:"Condition",passingValue:!0,selections:[{alias:null,args:h,concreteType:"DriftTimeSeries",kind:"LinkedField",name:"retrievalMetricTimeSeries",plural:!1,selections:k,storageKey:null}]},{alias:"trafficTimeSeries",args:[{kind:"Variable",name:"granularity",variableName:"countGranularity"},{kind:"Literal",name:"metric",value:"count"},y],concreteType:"DataQualityTimeSeries",kind:"LinkedField",name:"dataQualityTimeSeries",plural:!1,selections:k,storageKey:null}],type:"EmbeddingDimension",abstractKey:null},C=[{kind:"Variable",name:"id",variableName:"dimensionId"}],P={kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:[p,{kind:"Literal",name:"metric",value:"mean"},y],concreteType:"DataQualityTimeSeries",kind:"LinkedField",name:"dataQualityTimeSeries",plural:!1,selections:k,storageKey:null}],type:"Dimension",abstractKey:null},L={alias:null,args:null,concreteType:"Model",kind:"LinkedField",name:"model",plural:!1,selections:[{condition:"fetchPerformance",kind:"Condition",passingValue:!0,selections:[{alias:null,args:[p,{fields:[{kind:"Variable",name:"metric",variableName:"performanceMetric"}],kind:"ObjectValue",name:"metric"},y],concreteType:"PerformanceTimeSeries",kind:"LinkedField",name:"performanceTimeSeries",plural:!1,selections:k,storageKey:null}]}],storageKey:null},_={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null};return{fragment:{argumentDefinitions:[n,a,l,t,i,r,s,d,c,g],kind:"Fragment",metadata:null,name:"MetricTimeSeriesQuery",selections:[{alias:"embedding",args:f,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[u,S],storageKey:null},{condition:"fetchDataQuality",kind:"Condition",passingValue:!0,selections:[{alias:"dimension",args:C,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[P],storageKey:null}]},L],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[l,g,d,n,i,s,t,a,r,c],kind:"Operation",name:"MetricTimeSeriesQuery",selections:[{alias:"embedding",args:f,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[_,u,S],storageKey:null},{condition:"fetchDataQuality",kind:"Condition",passingValue:!0,selections:[{alias:"dimension",args:C,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[_,P,u],storageKey:null}]},L]},params:{cacheID:"752d4bce509b4932d2511c656378a7bf",id:null,metadata:{},name:"MetricTimeSeriesQuery",operationKind:"query",text:`query MetricTimeSeriesQuery(
  $embeddingDimensionId: ID!
  $timeRange: TimeRange!
  $metricGranularity: Granularity!
  $countGranularity: Granularity!
  $fetchDrift: Boolean!
  $fetchQueryDistance: Boolean!
  $fetchDataQuality: Boolean!
  $dimensionId: ID!
  $fetchPerformance: Boolean!
  $performanceMetric: PerformanceMetric!
) {
  embedding: node(id: $embeddingDimensionId) {
    __typename
    id
    ... on EmbeddingDimension {
      euclideanDistanceTimeSeries: driftTimeSeries(metric: euclideanDistance, timeRange: $timeRange, granularity: $metricGranularity) @include(if: $fetchDrift) {
        data {
          timestamp
          value
        }
      }
      retrievalMetricTimeSeries(metric: euclideanDistance, timeRange: $timeRange, granularity: $metricGranularity) @include(if: $fetchQueryDistance) {
        data {
          timestamp
          value
        }
      }
      trafficTimeSeries: dataQualityTimeSeries(metric: count, timeRange: $timeRange, granularity: $countGranularity) {
        data {
          timestamp
          value
        }
      }
    }
  }
  dimension: node(id: $dimensionId) @include(if: $fetchDataQuality) {
    __typename
    ... on Dimension {
      name
      dataQualityTimeSeries(metric: mean, timeRange: $timeRange, granularity: $metricGranularity) {
        data {
          timestamp
          value
        }
      }
    }
    id
  }
  model {
    performanceTimeSeries(metric: {metric: $performanceMetric}, timeRange: $timeRange, granularity: $metricGranularity) @include(if: $fetchPerformance) {
      data {
        timestamp
        value
      }
    }
  }
}
`}}}();Hu.hash="c0f9fd33875d639882a5b673d484bf3d";const Yr=new Intl.NumberFormat([],{maximumFractionDigits:2}),Gu=()=>{const n=An(),a=n.blue400,l=n.gray500;return{color:a,barColor:l}};function aF({active:n,payload:a,label:l}){var r,s,d;const{color:t,barColor:i}=Gu();if(n&&a&&a.length){const c=((r=a[1])==null?void 0:r.value)??null,g=((s=a[0])==null?void 0:s.value)??null,f=typeof c=="number"?Yr.format(c):"--",u=typeof g=="number"?Yr.format(g):"--";return o(qn,{children:[e(F,{weight:"heavy",size:"S",children:`${da(new Date(l))}`}),e(ze,{color:t,name:((d=a[1])==null?void 0:d.payload.metricName)??"Metric",value:f}),e(ze,{color:i,shape:"square",name:"Count",value:u}),e(Ft,{}),o("div",{css:K`
            display: flex;
            flex-direction: row;
            align-items: center;
            color: var(--ac-global-color-primary);
            gap: var(--ac-global-dimension-static-size-50);

            margin-top: var(--ac-global-dimension-static-size-50);
          `,children:[e(I,{svg:e(ta,{})}),e("span",{children:"Click to view the point cloud at this time"})]})]})}return null}function lF(n){switch(n.type){case"drift":return"Embedding Drift";case"performance":return"Model Performance";case"dataQuality":return"Data Quality";case"retrieval":return"Query Distance";default:Te()}}function tF(n){if(n)switch(n.type){case"drift":return Ma(n.metric);case"performance":return Ma(n.metric);case"dataQuality":return`${n.dimension.name} avg`;case"retrieval":return Ma(n.metric);default:Te()}else return"Count"}function iF(n){switch(n.type){case"drift":return Zt(n.metric);case"performance":return Zt(n.metric);case"dataQuality":return null;case"retrieval":return Zt(n.metric);default:Te()}}function rF({embeddingDimensionId:n}){const a=Y(w=>w.metric),l=a.type==="drift",t=a.type==="retrieval",i=a.type==="dataQuality",r=a.type==="performance",{timeRange:s}=ua(),{selectedTimestamp:d,setSelectedTimestamp:c}=It(),g=rl(s),f=T.useLazyLoadQuery(Hu,{embeddingDimensionId:n,timeRange:{start:s.start.toISOString(),end:s.end.toISOString()},metricGranularity:as(s),countGranularity:g,fetchDrift:l,fetchQueryDistance:t,fetchDataQuality:i,fetchPerformance:r,dimensionId:a.type==="dataQuality"?a.dimension.id:n,performanceMetric:a.type==="performance"?a.metric:"accuracyScore"}),u=ol({samplingIntervalMinutes:g.samplingIntervalMinutes}),p=m.useCallback(w=>{const{activePayload:V}=w;if(V!=null&&V.length>0){const Q=V[0].payload;c(new Date(Q.timestamp))}},[c]),y=oF({data:f,metric:a}),k=sF(f).reduce((w,V)=>(w[V.timestamp]=V.value,w),{})??{},S=y.map(w=>{const V=k[w.timestamp];return{...w,traffic:V,timestamp:new Date(w.timestamp).getTime()}}),C=tF(a),P=iF(a),{color:L,barColor:_}=Gu();return o("section",{css:K`
        width: 100%;
        height: 100%;
        display: flex;
        flex-direction: column;
        overflow: hidden;
        h3 {
          padding: var(--ac-global-dimension-static-size-100)
            var(--ac-global-dimension-static-size-200) 0
            var(--ac-global-dimension-static-size-200);
          flex: none;
          display: flex;
          flex-direction: row;
          align-items: center;
          gap: var(--ac-global-dimension-static-size-50);
        }
        & > div {
          flex: 1 1 auto;
          width: 100%;
          overflow: hidden;
        }
      `,children:[o(ae,{level:3,children:[lF(a),P!=null?o(Al,{children:[e(ae,{level:4,children:C}),e($a,{children:P})]}):null]}),e("div",{children:e(wn,{width:"100%",height:"100%",children:o(dl,{data:S,margin:{top:25,right:18,left:18,bottom:10},onClick:p,children:[o("defs",{children:[o("linearGradient",{id:"colorUv",x1:"0",y1:"0",x2:"0",y2:"1",children:[e("stop",{offset:"5%",stopColor:L,stopOpacity:.8}),e("stop",{offset:"95%",stopColor:L,stopOpacity:0})]}),o("linearGradient",{id:"barColor",x1:"0",y1:"0",x2:"0",y2:"1",children:[e("stop",{offset:"5%",stopColor:_,stopOpacity:.3}),e("stop",{offset:"95%",stopColor:_,stopOpacity:0})]})]}),e(Wn,{...sl,tickFormatter:w=>u(new Date(w)),style:{fill:"var(--ac-global-text-color-700)"}}),e(hn,{stroke:"var(--ac-global-color-grey-500)",label:{value:C,angle:-90,position:"insideLeft",style:{textAnchor:"middle",fill:"var(--ac-global-text-color-900)"}},style:{fill:"var(--ac-global-text-color-700)"}}),e(hn,{yAxisId:"right",orientation:"right",label:{value:"Count",angle:90,position:"insideRight",style:{textAnchor:"middle",fill:"var(--ac-global-text-color-900)"}},style:{fill:"var(--ac-global-text-color-700)"}}),e(Jn,{strokeDasharray:"4 4",stroke:"var(--ac-global-color-grey-500)",strokeOpacity:.5}),e(Gn,{content:e(aF,{})}),e(Fa,{yAxisId:"right",dataKey:"traffic",fill:"url(#barColor)",spacing:5}),e(Dl,{type:"monotone",dataKey:"value",stroke:L,fillOpacity:1,fill:"url(#colorUv)"}),d!=null?e(vs,{...ls,x:d.getTime()}):null]})})})]})}function oF({data:n,metric:a}){var l,t,i,r,s,d;if(((l=n.embedding.euclideanDistanceTimeSeries)==null?void 0:l.data)!=null&&n.embedding.euclideanDistanceTimeSeries.data.length>0)return n.embedding.euclideanDistanceTimeSeries.data.map(c=>({metricName:Ma(a.metric),...c}));if(((t=n.embedding.retrievalMetricTimeSeries)==null?void 0:t.data)!=null&&n.embedding.retrievalMetricTimeSeries.data.length>0)return n.embedding.retrievalMetricTimeSeries.data.map(c=>({metricName:Ma(a.metric),...c}));if(n.dimension&&((r=(i=n.dimension)==null?void 0:i.dataQualityTimeSeries)==null?void 0:r.data)!=null&&n.dimension.dataQualityTimeSeries.data.length>0){const c=n.dimension.name||"unknown";return n.dimension.dataQualityTimeSeries.data.map(g=>({metricName:`${c} avg`,...g}))}else{if(n.model&&((s=n.model.performanceTimeSeries)==null?void 0:s.data)!=null&&n.model.performanceTimeSeries.data.length>0)return n.model.performanceTimeSeries.data.map(c=>({metricName:Ma(a.metric),...c}));if(((d=n.embedding.trafficTimeSeries)==null?void 0:d.data)!=null)return n.embedding.trafficTimeSeries.data.map(c=>({metricName:"Count",...c}))}return[]}function sF(n){var a;return((a=n.embedding.trafficTimeSeries)==null?void 0:a.data)!=null?[...n.embedding.trafficTimeSeries.data]:[]}const Wu=function(){var n={defaultValue:null,kind:"LocalArgument",name:"corpusEventIds"},a={defaultValue:null,kind:"LocalArgument",name:"primaryEventIds"},l={defaultValue:null,kind:"LocalArgument",name:"referenceEventIds"},t=[{kind:"Variable",name:"eventIds",variableName:"primaryEventIds"}],i={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},s={alias:null,args:null,kind:"ScalarField",name:"type",storageKey:null},d={alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null},c={alias:null,args:null,concreteType:"EventMetadata",kind:"LinkedField",name:"eventMetadata",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"predictionId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"predictionLabel",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"predictionScore",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"actualLabel",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"actualScore",storageKey:null}],storageKey:null},g={alias:null,args:null,concreteType:"PromptResponse",kind:"LinkedField",name:"promptAndResponse",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"prompt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"response",storageKey:null}],storageKey:null},f={alias:null,args:null,kind:"ScalarField",name:"documentText",storageKey:null},u=[i,{alias:null,args:null,concreteType:"DimensionWithValue",kind:"LinkedField",name:"dimensions",plural:!0,selections:[{alias:null,args:null,concreteType:"Dimension",kind:"LinkedField",name:"dimension",plural:!1,selections:[r,s],storageKey:null},d],storageKey:null},c,g,f],p=[{kind:"Variable",name:"eventIds",variableName:"referenceEventIds"}],y=[{kind:"Variable",name:"eventIds",variableName:"corpusEventIds"}],h=[i,{alias:null,args:null,concreteType:"DimensionWithValue",kind:"LinkedField",name:"dimensions",plural:!0,selections:[{alias:null,args:null,concreteType:"Dimension",kind:"LinkedField",name:"dimension",plural:!1,selections:[r,s,i],storageKey:null},d],storageKey:null},c,g,f];return{fragment:{argumentDefinitions:[n,a,l],kind:"Fragment",metadata:null,name:"PointSelectionPanelContentQuery",selections:[{alias:null,args:null,concreteType:"Model",kind:"LinkedField",name:"model",plural:!1,selections:[{alias:null,args:null,concreteType:"Inferences",kind:"LinkedField",name:"primaryInferences",plural:!1,selections:[{alias:null,args:t,concreteType:"Event",kind:"LinkedField",name:"events",plural:!0,selections:u,storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"Inferences",kind:"LinkedField",name:"referenceInferences",plural:!1,selections:[{alias:null,args:p,concreteType:"Event",kind:"LinkedField",name:"events",plural:!0,selections:u,storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"Inferences",kind:"LinkedField",name:"corpusInferences",plural:!1,selections:[{alias:null,args:y,concreteType:"Event",kind:"LinkedField",name:"events",plural:!0,selections:u,storageKey:null}],storageKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[a,l,n],kind:"Operation",name:"PointSelectionPanelContentQuery",selections:[{alias:null,args:null,concreteType:"Model",kind:"LinkedField",name:"model",plural:!1,selections:[{alias:null,args:null,concreteType:"Inferences",kind:"LinkedField",name:"primaryInferences",plural:!1,selections:[{alias:null,args:t,concreteType:"Event",kind:"LinkedField",name:"events",plural:!0,selections:h,storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"Inferences",kind:"LinkedField",name:"referenceInferences",plural:!1,selections:[{alias:null,args:p,concreteType:"Event",kind:"LinkedField",name:"events",plural:!0,selections:h,storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"Inferences",kind:"LinkedField",name:"corpusInferences",plural:!1,selections:[{alias:null,args:y,concreteType:"Event",kind:"LinkedField",name:"events",plural:!0,selections:h,storageKey:null}],storageKey:null}],storageKey:null}]},params:{cacheID:"12c88e562048659c9ca654fccf693fb2",id:null,metadata:{},name:"PointSelectionPanelContentQuery",operationKind:"query",text:`query PointSelectionPanelContentQuery(
  $primaryEventIds: [ID!]!
  $referenceEventIds: [ID!]!
  $corpusEventIds: [ID!]!
) {
  model {
    primaryInferences {
      events(eventIds: $primaryEventIds) {
        id
        dimensions {
          dimension {
            name
            type
            id
          }
          value
        }
        eventMetadata {
          predictionId
          predictionLabel
          predictionScore
          actualLabel
          actualScore
        }
        promptAndResponse {
          prompt
          response
        }
        documentText
      }
    }
    referenceInferences {
      events(eventIds: $referenceEventIds) {
        id
        dimensions {
          dimension {
            name
            type
            id
          }
          value
        }
        eventMetadata {
          predictionId
          predictionLabel
          predictionScore
          actualLabel
          actualScore
        }
        promptAndResponse {
          prompt
          response
        }
        documentText
      }
    }
    corpusInferences {
      events(eventIds: $corpusEventIds) {
        id
        dimensions {
          dimension {
            name
            type
            id
          }
          value
        }
        eventMetadata {
          predictionId
          predictionLabel
          predictionScore
          actualLabel
          actualScore
        }
        promptAndResponse {
          prompt
          response
        }
        documentText
      }
    }
  }
}
`}}}();Wu.hash="4bd627481610322f2acbcf73dfbfaadc";const eo=K`
  margin: var(--ac-global-dimension-static-size-200);
  display: flex;
  flex-direction: column;
  gap: var(--ac-global-dimension-static-size-100);
  & > div {
    display: flex;
    flex-direction: row;
    dt {
      font-weight: bold;
      flex: none;
      width: 130px;
    }
    dd {
      flex: 1 1 auto;
      margin-inline-start: 0;
    }
  }
`;function yl(n){return e("div",{css:K`
        max-height: 200px;
        overflow-y: auto;
      `,children:e("pre",{css:K`
          padding: var(--ac-global-dimension-static-size-200);
          color: var(--ac-global-text-color-900);
          white-space: normal;
          margin: 0;
        `,children:n.children})})}function dF({event:n}){const a=n.retrievedDocuments&&n.retrievedDocuments.length>0,l=!n.id.includes("CORPUS");return o("section",{css:K`
        height: 100%;
        overflow-y: auto;
      `,children:[e(gF,{event:n}),o(Cn,{defaultExpandedKeys:["prediction","document","dimensions","retrievals"],children:[l?o(fe,{id:"prediction",children:[e(pe,{children:"Prediction Details"}),e(ye,{children:o("dl",{css:eo,children:[n.predictionId!=null&&o("div",{children:[e("dt",{children:"Prediction ID"}),e("dd",{css:K`
                        display: flex;
                        align-items: center;
                      `,children:n.predictionId})]}),n.predictionLabel!=null&&o("div",{children:[e("dt",{children:"Prediction Label"}),e("dd",{children:n.predictionLabel})]}),n.predictionScore!=null&&o("div",{children:[e("dt",{children:"Prediction Score"}),e("dd",{children:n.predictionScore})]}),n.actualLabel!=null&&o("div",{children:[e("dt",{children:"Actual Label"}),e("dd",{children:n.actualLabel})]}),n.actualScore!=null&&o("div",{children:[e("dt",{children:"Actual Score"}),e("dd",{children:n.actualScore})]})]})})]}):o(fe,{id:"document",children:[e(pe,{children:"Document Details"}),e(ye,{children:e("dl",{css:eo,children:n.predictionId!=null&&o("div",{children:[e("dt",{children:"Document ID"}),e("dd",{css:K`
                        display: flex;
                        align-items: center;
                      `,children:n.predictionId})]})})})]}),o(fe,{id:"dimensions",children:[e(pe,{children:"Dimensions"}),e(ye,{children:e(uF,{dimensions:n.dimensions})})]}),a&&o(fe,{id:"retrievals",children:[o(pe,{children:["Retrieved Documents",e(Ln,{children:n.retrievedDocuments.length})]}),e(ye,{children:e("ul",{css:K`
                  padding: var(--ac-global-dimension-static-size-100);
                  li + li {
                    margin-top: var(--ac-global-dimension-static-size-100);
                  }
                `,children:n.retrievedDocuments.map(t=>e("li",{children:e(cF,{document:t})},t.id))})})]})]})]})}function cF({document:n}){return e(v,{borderRadius:"medium",backgroundColor:"light",children:o(b,{direction:"column",children:[e(v,{width:"100%",borderBottomWidth:"thin",borderBottomColor:"dark",children:o(b,{direction:"row",justifyContent:"space-between",margin:"size-100",alignItems:"center",children:[o(b,{direction:"row",gap:"size-50",alignItems:"center",children:[e(I,{svg:e(Bo,{})}),o(ae,{level:4,children:["document ",n.id]})]}),typeof n.relevance=="number"&&e(Tn,{color:"var(--ac-global-color-blue-1000)",children:`relevance ${xi(n.relevance)}`})]})}),e("pre",{css:K`
            padding: var(--ac-global-dimension-static-size-200);
            white-space: normal;
            margin: 0;
          `,children:n.text})]})})}function uF({dimensions:n}){const a=m.useMemo(()=>n.map(i=>({name:i.dimension.name,type:i.dimension.type,value:i.value??"--"})),[n]),l=m.useMemo(()=>[{header:()=>"Name",accessorKey:"name"},{header:()=>"Type",accessorKey:"type"},{header:()=>"Value",accessorKey:"value"}],[]),t=Ce({columns:l,data:a,getCoreRowModel:Ke()});return o("table",{css:We,children:[e("thead",{children:t.getHeaderGroups().map(i=>e("tr",{children:i.headers.map(r=>e("th",{colSpan:r.colSpan,children:r.isPlaceholder?null:e("div",{children:W(r.column.columnDef.header,r.getContext())})},r.id))},i.id))}),t.getCoreRowModel().rows.length?e("tbody",{children:t.getRowModel().rows.map(i=>e("tr",{children:i.getVisibleCells().map(r=>e("td",{children:W(r.column.columnDef.cell,r.getContext())},r.id))},i.id))}):e(pF,{})]})}function mF({dataUrl:n}){const a=wf(n),l=Rf(n);return a?e("video",{src:n,controls:!0,css:K`
          width: 100%;
          height: 500px;
          background-color: black;
        `}):l?e("audio",{src:n,controls:!0,autoPlay:!0}):e("img",{src:n,alt:"event image",width:"100%",height:"200px",css:K`
        object-fit: contain;
        background-color: black;
      `})}function gF({event:n}){const a=n.linkToData||void 0,l=n.rawData,t=n.prompt||n.response?{prompt:n.prompt,response:n.response}:null,i=n.documentText;let r=null;return a?r=o(b,{direction:"column",children:[e(mF,{dataUrl:a}),l&&o(fe,{id:"raw",children:[e(pe,{children:"Raw Data"}),e(ye,{children:e(yl,{children:l})})]})]}):i?r=o(fe,{id:"document",children:[e(pe,{children:"Document"}),e(ye,{children:e(yl,{children:i})})]}):t?r=o(Cn,{defaultExpandedKeys:["prompt","response"],children:[o(fe,{id:"prompt",children:[e(pe,{children:"Prompt"}),e(ye,{children:e(yl,{children:t.prompt})})]}),o(fe,{id:"response",children:[e(pe,{children:"Response"}),e(ye,{children:e(yl,{children:t.response})})]})]}):n.rawData&&n.rawData&&n.rawData,r}function pF(){return e("tbody",{className:"is-empty",children:e("tr",{children:e("td",{colSpan:100,css:K`
            text-align: center;
            padding: var(--ac-global-dimension-size-300)
              var(--ac-global-dimension-size-300) !important;
          `,children:e(Mo,{graphicKey:"documents",message:"This embedding has no associated dimensions"})})})})}const Ju=function(){var n=[{alias:null,args:null,concreteType:"Model",kind:"LinkedField",name:"model",plural:!1,selections:[{alias:null,args:null,concreteType:"ExportedFile",kind:"LinkedField",name:"exportedFiles",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"fileName",storageKey:null}],storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"ExportSelectionButtonExportsQuery",selections:n,type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"ExportSelectionButtonExportsQuery",selections:n},params:{cacheID:"2f7e3554305121746dc799b6a8d120da",id:null,metadata:{},name:"ExportSelectionButtonExportsQuery",operationKind:"query",text:`query ExportSelectionButtonExportsQuery {
  model {
    exportedFiles {
      fileName
    }
  }
}
`}}}();Ju.hash="7e6db431afe21f137e54505645c787f4";const Xu=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"eventIds"}],a=[{alias:null,args:[{kind:"Variable",name:"eventIds",variableName:"eventIds"}],concreteType:"ExportedFile",kind:"LinkedField",name:"exportEvents",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"fileName",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ExportSelectionButtonMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ExportSelectionButtonMutation",selections:a},params:{cacheID:"d370df04ca30a5059288c7aa298239a8",id:null,metadata:{},name:"ExportSelectionButtonMutation",operationKind:"mutation",text:`mutation ExportSelectionButtonMutation(
  $eventIds: [ID!]!
) {
  exportEvents(eventIds: $eventIds) {
    fileName
  }
}
`}}}();Xu.hash="8b0d6962e2034d4c148d1b9919111d2f";const yF=`import phoenix as px

exports = px.active_session().exports
dataframe = exports[-1]
dataframe`,fF=K`
  .cm-content {
    padding: var(--ac-global-dimension-static-size-100);
  }
`;function hF({value:n}){const{theme:a}=ca(),l=a==="light"?_a:Aa;return e(wa,{value:n,basicSetup:!1,extensions:[zl()],editable:!1,theme:l,css:fF})}function kF(){const n=Y(s=>s.selectedEventIds),[a,l]=T.useMutation(Xu),[t,i]=m.useState(null),r=m.useCallback(()=>{a({variables:{eventIds:[...n]},onCompleted:s=>{i(s.exportEvents)}})},[a,n]);return o(J,{children:[e(M,{size:"S",leadingVisual:e(I,{svg:l?e(sn,{}):e(Ri,{})}),"aria-label":"Export selection / cluster",isDisabled:l,onPress:r,children:l?"Exporting":"Export"}),e(ue,{type:"slideOver",isDismissable:!0,onDismiss:()=>i(null),children:t!=null&&o(oe,{title:"Cluster Exports",size:"M",children:[e(Fe,{variant:"success",banner:!0,title:"Export succeeded",extra:e(M,{variant:"success",size:"S",onPress:()=>{window.open(`/exports?filename=${t.fileName}`,"_self")},children:"Download"})}),o("div",{css:K`
                display: flex;
                flex-direction: column;
                justify-content: space-between;
                align-items: flex-start;
                padding: 16px;
                gap: 16px;
              `,children:[e("p",{css:K`
                  margin: 0;
                  flex: 1 1 auto;
                `,children:"You can retrieve your export in your notebook via"}),e(v,{borderColor:"light",borderWidth:"thin",borderRadius:"medium",children:e(hF,{value:yF})})]}),e(Cn,{defaultExpandedKeys:["all-exports"],children:o(fe,{id:"all-exports",children:[e(pe,{children:"Latest Exports"}),e(ye,{children:e(m.Suspense,{fallback:e(ge,{}),children:e(bF,{})})})]})})]})})]})}function bF(){const n=T.useLazyLoadQuery(Ju,{},{fetchPolicy:"network-only"});return e(rt,{children:n.model.exportedFiles.map((a,l)=>e(it,{children:o("div",{css:K`
              display: flex;
              flex-direction: row;
              justify-content: space-between;
              align-items: center;
            `,children:[a.fileName,e(M,{size:"S","aria-label":"Download",variant:"default",leadingVisual:e(I,{svg:e(ny,{})}),onPress:()=>{window.open(`/exports?filename=${a.fileName}`,"_self")}})]})},l))})}function SF(n){const{getInferencesNameByRole:a}=Hn(),{events:l,onItemSelected:t}=n,i=Y(g=>g.eventIdToDataMap),r=Y(g=>g.eventIdToGroup),s=Y(g=>g.pointGroupColors),d=Y(g=>g.selectionGridSize),c=Y(g=>g.setHoveredEventId);return e("div",{css:K`
        flex: 1 1 auto;
        overflow-y: auto;
      `,"data-testid":"grid-view-scroll-container",children:e("ul",{"data-grid-size":d,css:K`
          &[data-grid-size="small"] {
            --grid-item-min-width: 100px;
            --grid-item-height: 100px;
          }
          &[data-grid-size="medium"] {
            --grid-item-min-width: 200px;
            --grid-item-height: 200px;
          }
          &[data-grid-size="large"] {
            --grid-item-min-width: 300px;
            --grid-item-height: 200px;
          }
          padding: var(--ac-global-dimension-static-size-200);
          transition: all 0.2s ease-in-out;
          display: grid;
          grid-template-columns: repeat(
            auto-fill,
            minmax(var(--grid-item-min-width), 1fr)
          );
          flex-wrap: wrap;
          gap: var(--ac-global-dimension-static-size-200);
          & > li {
            min-width: var(--grid-item-min-width);
            height: var(--grid-item-height);
          }
        `,children:l.map((g,f)=>{const u=i.get(g.id),{rawData:p=null,linkToData:y=null}=(u==null?void 0:u.embeddingMetadata)??{},{predictionLabel:h=null,actualLabel:k=null}=(u==null?void 0:u.eventMetadata)??{},S=Ef(g.id),C=a(S),P=r[g.id],L=s[P];return e("li",{children:e(Mf,{rawData:p,linkToData:y,inferencesName:C,group:P,onClick:()=>{t(g.id)},onMouseOver:()=>{c(g.id)},onMouseOut:()=>{c(null)},color:L,size:d,predictionLabel:h,actualLabel:k,promptAndResponse:g.promptAndResponse,documentText:g.documentText,autoPlay:!1})},f)})})})}function vF({data:n,onPointSelected:a}){const{primaryInferences:l,referenceInferences:t}=Hn(),i=Y(f=>f.metric),[r,s]=m.useState([]),{columns:d,tableData:c}=m.useMemo(()=>{const f=n.filter(L=>L.id.includes("CORPUS")===!1);let u=!1,p=!1,y=!1,h=!1,k=!1;n.forEach(L=>{L.linkToData&&(u=!0),L.rawData&&(p=!0),(L.prompt||L.response)&&(y=!0),L.predictionLabel&&(h=!0),L.actualLabel&&(k=!0)});const S=[];t&&S.push({header:"Inference Set",accessorKey:"id",size:50,cell:({getValue:L})=>e(FF,{id:L(),primaryInferencesName:l.name,referenceInferencesName:(t==null?void 0:t.name)??"reference"})}),u&&S.push({header:"Link",accessorKey:"linkToData",cell:({getValue:L})=>{const _=L();if(typeof _=="string"){const w=_.split("/").pop();return e(_n,{href:_,children:w})}return null}}),y?(S.push({header:"Prompt",accessorKey:"prompt",cell:Re,size:200}),S.push({header:"Response",accessorKey:"response",cell:Re,size:200})):p&&S.push({header:"Raw Data",accessorKey:"rawData"}),h&&S.push({header:"Prediction Label",accessorKey:"predictionLabel",size:50}),k&&S.push({header:"Actual Label",accessorKey:"actualLabel",size:50});const C=[];if(i&&i.type==="dataQuality"){const L=i.dimension.name;C.push({header:i.dimension.name,accessorKey:"metric",cell:Vf,sortingFn:"basic"}),f.forEach(_=>{var V;const w=(V=_.dimensions.find(Q=>Q.dimension.name===L))==null?void 0:V.value;_.metric=w!=null?Number(w):null})}return{columns:[...S,...C,{header:"",id:"view-details",size:50,cell:({row:L})=>e(M,{"aria-label":"view point details",size:"S",onPress:()=>{a(L.original.id)},children:"view details"})}],tableData:f}},[n,a,l,t,i]),g=Ce({columns:d,data:c,state:{sorting:r},getCoreRowModel:Ke(),onSortingChange:s,getSortedRowModel:ln()});return o("table",{css:We,children:[e("thead",{children:g.getHeaderGroups().map(f=>e("tr",{children:f.headers.map(u=>o("th",{children:[u.isPlaceholder?null:o("div",{className:u.column.getCanSort()?"sort":"",onClick:u.column.getToggleSortingHandler(),children:[W(u.column.columnDef.header,u.getContext()),u.column.getIsSorted()?e(I,{className:"sort-icon",svg:u.column.getIsSorted()==="asc"?e(Ze,{}):e(Xe,{})}):null]}),e("div",{onMouseDown:u.getResizeHandler(),onTouchStart:u.getResizeHandler(),className:`resizer ${u.column.getIsResizing()?"isResizing":""}`,style:{transform:u.column.getIsResizing()?`translateX(${g.getState().columnSizingInfo.deltaOffset}px)`:""}})]},u.id))},f.id))}),e("tbody",{children:g.getRowModel().rows.map(f=>e("tr",{children:f.getVisibleCells().map(u=>e("td",{style:{width:u.column.getSize()},children:W(u.column.columnDef.cell,u.getContext())},u.id))},f.id))})]})}function FF({id:n,primaryInferencesName:a,referenceInferencesName:l}){const t=n.includes("PRIMARY"),i=Wv();return o(b,{direction:"row",gap:"size-100",alignItems:"center",children:[e(Nf,{shape:zf.circle,color:i[t?0:1]}),t?a:l]})}const CF=K`
  width: 100%;
  height: 100%;
  position: relative;
  display: flex;
  flex-direction: column;
  /* Give spacing for the close icon */
  & > .ac-tabs {
    padding-top: 17px;
    width: 100%;
    height: 100%;
    display: flex;
    flex-direction: column;
    overflow: hidden;
    [role="tablist"] {
      flex: none;
    }
    .ac-tabs__pane-container {
      display: flex;
      flex-direction: column;
      flex: 1 1 auto;
      overflow: hidden;
      [role="tabpanel"] {
        display: flex;
        flex-direction: column;
        flex: 1 1 auto;
        overflow: hidden;
      }
    }
  }
`;function KF({event:n,relevance:a}){return{id:n.eventMetadata.predictionId||"unknown id",text:n.documentText??"empty document",relevance:a}}function TF(){const n=Y(w=>w.selectedEventIds),a=Y(w=>w.setSelectedEventIds),l=Y(w=>w.setSelectedClusterId),t=Y(w=>w.selectionDisplay),[i,r]=m.useState(null),{primaryEventIds:s,referenceEventIds:d,corpusEventIds:c}=m.useMemo(()=>{const w=[],V=[],Q=[];return n.forEach(x=>{x.includes("PRIMARY")?w.push(x):x.includes("CORPUS")?Q.push(x):V.push(x)}),{primaryEventIds:w,referenceEventIds:V,corpusEventIds:Q}},[n]),g=T.useLazyLoadQuery(Wu,{primaryEventIds:[...s],referenceEventIds:[...d],corpusEventIds:[...c]}),f=m.useMemo(()=>{var x,R,A,z,N,j;const w=((R=(x=g.model)==null?void 0:x.primaryInferences)==null?void 0:R.events)??[],V=((z=(A=g.model)==null?void 0:A.referenceInferences)==null?void 0:z.events)??[],Q=((j=(N=g.model)==null?void 0:N.corpusInferences)==null?void 0:j.events)??[];return[...w,...V,...Q]},[g]),u=()=>{a(new Set),l(null)},p=Y(w=>w.eventIdToDataMap),y=Y(w=>w.pointData),h=Y(w=>w.selectionSearchText),k=m.useMemo(()=>f.map(w=>{var x,R,A,z,N,j,Z;const V=p.get(w.id),Q=[];return y!=null&&(V==null?void 0:V.retrievals)!=null&&V.retrievals.forEach(({documentId:se,relevance:Ye})=>{const kn=y[se];kn!=null&&Q.push(KF({event:kn,relevance:Ye}))}),{id:w.id,predictionId:((x=w.eventMetadata)==null?void 0:x.predictionId)??null,actualLabel:((R=w.eventMetadata)==null?void 0:R.actualLabel)??null,actualScore:((A=w.eventMetadata)==null?void 0:A.actualScore)??null,predictionLabel:((z=w.eventMetadata)==null?void 0:z.predictionLabel)??null,predictionScore:((N=w.eventMetadata)==null?void 0:N.predictionScore)??null,rawData:(V==null?void 0:V.embeddingMetadata.rawData)??null,linkToData:(V==null?void 0:V.embeddingMetadata.linkToData)??null,dimensions:w.dimensions,prompt:((j=w.promptAndResponse)==null?void 0:j.prompt)??null,response:((Z=w.promptAndResponse)==null?void 0:Z.response)??null,retrievedDocuments:Q,documentText:w.documentText??null}}),[f,p,y]),S=m.useMemo(()=>{if(h){const w=h.toLowerCase();return k.filter(V=>{var Q,x,R,A;return V.id.includes(w)||((Q=V.documentText)==null?void 0:Q.toLowerCase().includes(w))||((x=V.predictionId)==null?void 0:x.includes(w))||((R=V.prompt)==null?void 0:R.toLowerCase().includes(w))||((A=V.response)==null?void 0:A.toLowerCase().includes(w))})}return k},[k,h]),C=m.useMemo(()=>{if(h){const w=h.toLowerCase();return f.filter(V=>{var Q,x,R,A,z,N,j;return V.id.includes(w)||((Q=V.documentText)==null?void 0:Q.toLowerCase().includes(w))||((R=(x=V.eventMetadata)==null?void 0:x.predictionId)==null?void 0:R.includes(w))||((z=(A=V.promptAndResponse)==null?void 0:A.prompt)==null?void 0:z.toLowerCase().includes(w))||((j=(N=V.promptAndResponse)==null?void 0:N.response)==null?void 0:j.toLowerCase().includes(w))})}return f},[f,h]),P=m.useMemo(()=>i?k.find(V=>V.id===i)??null:null,[k,i]),L=f.length,_=C.length;return o("section",{css:CF,children:[o("div",{role:"toolbar",css:K`
          position: absolute;
          top: var(--ac-global-dimension-static-size-100);
          right: var(--ac-global-dimension-static-size-200);
          display: flex;
          flex-direction: row-reverse;
          gap: var(--ac-global-dimension-static-size-100);
        `,children:[e(M,{size:"S",leadingVisual:e(I,{svg:e(ay,{})}),"aria-label":"Clear selection",onPress:u}),e(kF,{})]}),o(cn,{children:[e(dn,{children:e(le,{id:"selection",children:"Selection"})}),o(Il,{id:"selection",children:[e(PF,{numSelectedEvents:L,numMatchingEvents:_,searchText:h}),t===ts.list?e("div",{css:K`
                flex: 1 1 auto;
                overflow-y: auto;
              `,children:e(vF,{data:S,onPointSelected:r})}):e(SF,{events:C,onItemSelected:r})]})]}),e(ue,{type:"slideOver",isDismissable:!0,onDismiss:()=>r(null),children:P&&e(oe,{title:"Embedding Details",size:"L",children:e(dF,{event:P})})})]})}function PF({numSelectedEvents:n,numMatchingEvents:a,searchText:l}){const t=Y(g=>g.selectionDisplay),i=Y(g=>g.setSelectionDisplay),r=Y(g=>g.selectionGridSize),s=Y(g=>g.setSelectionGridSize),d=Y(g=>g.setSelectionSearchText),c=m.useMemo(()=>l?`${a}/${n} match "${l}"`:`${n} selected`,[n,a,l]);return e(wi,{extra:o("div",{css:K`
            display: flex;
            flex-direction: row;
            gap: var(--ac-global-dimension-static-size-100);
          `,children:[e(is,{size:"S",onChange:g=>{d(g)},children:e(X,{placeholder:"Search by text or ID"})}),t===ts.gallery&&e($f,{size:r,onChange:s}),e(jf,{mode:t,onChange:g=>{i(g)}})]}),children:e(F,{children:c})})}const Zu=Bu;function GT(){const{referenceInferences:n,corpusInferences:a}=Hn(),{timeRange:l}=ua(),t=m.useMemo(()=>{let i={};return a!=null?i=Bf():n!=null?i=qf():i=Uf(),i={...i,umapParameters:{...window.Config.UMAP}},i},[a,n]);return e(rs,{initialTimestamp:l.end,children:e(Hf,{...t,children:e(xF,{})})})}function xF(){const n=Jv(),{primaryInferences:a,referenceInferences:l}=Hn(),t=Y(C=>C.umapParameters),i=Y(C=>C.getHDSCANParameters),r=Y(C=>C.getMetric),s=Y(C=>C.reset),d=Y(C=>C.setLoading),[c,g]=m.useState(!0),[f,u,p]=T.useQueryLoader(Zu),{selectedTimestamp:y}=It(),h=m.useMemo(()=>y??new Date(a.endTime),[y,a.endTime]),k=m.useMemo(()=>({start:po(h,2).toISOString(),end:h.toISOString()}),[h]),S=T.useLazyLoadQuery(Qu,{});return m.useEffect(()=>{s(),d(!0);const C=r();return u({id:n,timeRange:k,...t,...i(),fetchDataQualityMetric:C.type==="dataQuality",fetchPerformanceMetric:C.type==="performance",dataQualityMetricColumnName:C.type==="dataQuality"?C.dimension.name:null,performanceMetric:C.type==="performance"?C.metric:"accuracyScore"},{fetchPolicy:"network-only"}),()=>{p()}},[d,s,n,u,p,t,i,r,k]),o("main",{css:K`
        flex: 1 1 auto;
        display: flex;
        flex-direction: column;
        overflow: hidden;
      `,children:[e(RF,{}),o(wi,{extra:e(xa,{onChange:C=>{g(C)},isSelected:c,labelPlacement:"start",children:"Show Timeseries"}),children:[e(es,{}),l?e(ns,{inferencesRole:"reference",timeRange:{start:new Date(l.startTime),end:new Date(l.endTime)}}):null,e(nF,{model:S.model})]}),o(Fn,{direction:"vertical",children:[c?o(J,{children:[e(Ie,{defaultSize:20,collapsible:!0,order:1,children:e(m.Suspense,{fallback:e(ge,{}),children:e(rF,{embeddingDimensionId:n})})}),e(Dn,{css:Ba})]}):null,e(Ie,{order:2,children:e("div",{css:K`
              width: 100%;
              height: 100%;
              position: relative;
            `,children:e(m.Suspense,{fallback:e(Gf,{}),children:f?e(DF,{queryReference:f}):null})})})]})]})}function IF(n){if(n.__typename!=="Point3D")throw new Error(`Expected Point3D but got ${n.__typename} for coordinates`);return[n.x,n.y,n.z]}function DF({queryReference:n}){const a=T.usePreloadedQuery(Zu,n),l=m.useMemo(()=>{var g,f;return((f=(g=a.embedding)==null?void 0:g.UMAPPoints)==null?void 0:f.data)??[]},[a]),t=m.useMemo(()=>{var g,f;return((f=(g=a.embedding)==null?void 0:g.UMAPPoints)==null?void 0:f.referenceData)??[]},[a]),i=m.useMemo(()=>{var g,f;return((f=(g=a.embedding)==null?void 0:g.UMAPPoints)==null?void 0:f.corpusData)??[]},[a]),r=m.useMemo(()=>{var g,f;return((f=(g=a.embedding)==null?void 0:g.UMAPPoints)==null?void 0:f.contextRetrievals)??[]},[a]),s=m.useMemo(()=>[...l,...t,...i].map(f=>({...f,position:IF(f.coordinates),metaData:{id:f.eventId}})),[t,l,i]),d=Y(g=>g.setInitialData),c=Y(g=>g.setClusters);return qp(()=>{var f,u;const g=((u=(f=a.embedding)==null?void 0:f.UMAPPoints)==null?void 0:u.clusters)||[];d({points:s,clusters:g,retrievals:r})},[s,n,r,d,c]),e("div",{css:K`
        flex: 1 1 auto;
        display: flex;
        flex-direction: row;
        align-items: stretch;
        width: 100%;
        height: 100%;
      `,"data-testid":"point-cloud-display",children:o(Fn,{direction:"horizontal",children:[e(Ie,{id:"embedding-left",defaultSize:15,maxSize:30,minSize:10,collapsible:!0,children:o(Fn,{autoSaveId:"embedding-controls-vertical",direction:"vertical",children:[e(Ie,{css:K`
                display: flex;
                flex-direction: column;
                .ac-tabs {
                  height: 100%;
                  overflow: hidden;
                  display: flex;
                  flex-direction: column;
                  [role="tablist"] {
                    flex: none;
                  }
                  .ac-tabs__pane-container {
                    flex: 1 1 auto;
                    overflow: hidden;
                    display: flex;
                    flex-direction: column;
                    & > div {
                      height: 100%;
                    }
                  }
                }
              `,children:e(AF,{})}),e(Dn,{css:Ba}),e(Ie,{css:K`
                .ac-tabs {
                  height: 100%;
                  overflow: hidden;
                  .ac-tabs__pane-container {
                    height: 100%;
                    overflow-y: auto;
                  }
                }
              `,children:o(cn,{children:[o(dn,{children:[e(le,{id:"display",children:"Display"}),e(le,{id:"hyperparameters",children:"Hyperparameters"})]}),e(Il,{id:"display",children:e(Jf,{})}),e(Il,{id:"hyperparameters",children:e(Xf,{})})]})})]})}),e(Dn,{css:Pt}),e(Ie,{children:o("div",{css:K`
              position: relative;
              width: 100%;
              height: 100%;
            `,children:[e(LF,{}),e(Zf,{})]})})]})})}function LF(){return Y(a=>a.selectedEventIds).size===0?null:e("div",{css:K`
        position: absolute;
        top: 0;
        left: 0;
        bottom: 0;
        right: 0;
      `,"data-testid":"selection-panel",children:o(Fn,{direction:"vertical",children:[e(Ie,{}),e(Dn,{css:Ba,style:{zIndex:1}}),e(Ie,{id:"embedding-point-selection",defaultSize:40,minSize:20,order:2,style:{zIndex:1},children:e(_F,{children:e(m.Suspense,{fallback:e(ge,{}),children:e(TF,{})})})})]})})}function _F(n){return e("div",{css:K`
        background-color: var(--ac-global-color-grey-75);
        width: 100%;
        height: 100%;
      `,children:n.children})}const AF=m.memo(function(){const{referenceInferences:a}=Hn(),l=Y(u=>u.clusters),t=Y(u=>u.selectedClusterId),i=Y(u=>u.metric),r=Y(u=>u.setSelectedClusterId),s=Y(u=>u.setSelectedEventIds),d=Y(u=>u.setHighlightedClusterId),c=Y(u=>u.setClusterColorMode),g=a==null||i.type==="drift",f=m.useCallback(u=>{c(u==="configuration"?Kr.highlight:Kr.default)},[c]);return o(cn,{onSelectionChange:u=>f(u),children:[o(dn,{children:[o(le,{id:"clusters",children:["Clusters ",e(Ln,{children:l.length})]}),e(le,{id:"configuration",children:"Configuration"})]}),e(Il,{id:"clusters",children:o(b,{direction:"column",height:"100%",children:[e(v,{borderBottomColor:"dark",borderBottomWidth:"thin",backgroundColor:"dark",flex:"none",padding:"size-50",children:e(b,{direction:"row",justifyContent:"end",children:e(Xv,{})})}),e(v,{flex:"1 1 auto",overflow:"auto",children:e("ul",{css:K`
                flex: 1 1 auto;
                display: flex;
                flex-direction: column;
                gap: var(--ac-global-dimension-size-100);
                margin: var(--ac-global-dimension-size-100);
              `,children:l.map(u=>e("li",{children:e(Of,{clusterId:u.id,numPoints:u.eventIds.length,isSelected:t===u.id,driftRatio:u.driftRatio,primaryToCorpusRatio:u.primaryToCorpusRatio,primaryMetricValue:u.primaryMetricValue,referenceMetricValue:u.referenceMetricValue,metricName:wF(i),hideReference:g,onClick:()=>{t!==u.id?(r(u.id),s(new Set(u.eventIds))):(r(null),s(new Set))},onMouseEnter:()=>{d(u.id)},onMouseLeave:()=>{d(null)}})},u.id))})})]})}),e(Il,{id:"configuration",children:e(v,{overflow:"auto",height:"100%",children:e(Qf,{})})})]})});function wF(n){const{type:a,metric:l}=n;switch(a){case"dataQuality":return`${n.dimension.name} avg`;case"drift":{switch(l){case"euclideanDistance":return"Cluster Drift";default:Te()}break}case"performance":return Ma(l);case"retrieval":{switch(l){case"queryDistance":return"% Query";default:Te()}break}default:Te()}}function RF(){const{notifyError:n}=Wf(),a=Y(t=>t.errorMessage),l=Y(t=>t.setErrorMessage);return m.useEffect(()=>{a!==null&&n({title:"An error occurred",message:a,action:{text:"Dismiss",onClick:()=>{l(null)}}})},[a,n,l]),null}const Yu=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}],l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"embeddingLoaderQuery",selections:[{alias:"embedding",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{kind:"InlineFragment",selections:[l,t],type:"EmbeddingDimension",abstractKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"embeddingLoaderQuery",selections:[{alias:"embedding",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},l,{kind:"InlineFragment",selections:[t],type:"EmbeddingDimension",abstractKey:null}],storageKey:null}]},params:{cacheID:"6f34962d234c6eb9fc0812628dd9a905",id:null,metadata:{},name:"embeddingLoaderQuery",operationKind:"query",text:`query embeddingLoaderQuery(
  $id: ID!
) {
  embedding: node(id: $id) {
    __typename
    ... on EmbeddingDimension {
      id
      name
    }
    id
  }
}
`}}}();Yu.hash="96d029150ec0c7e5419c2efa0ee67fc5";async function WT(n){const{embeddingDimensionId:a}=n.params;return T.fetchQuery(he,Yu,{id:a}).toPromise()}const em=function(){var n={defaultValue:null,kind:"LocalArgument",name:"dimensionId"},a={defaultValue:null,kind:"LocalArgument",name:"hasReference"},l={defaultValue:null,kind:"LocalArgument",name:"timeRange"},t=[{kind:"Variable",name:"id",variableName:"dimensionId"}],i={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},r={kind:"Variable",name:"timeRange",variableName:"timeRange"},s=[r],d=[{kind:"Variable",name:"hasReference",variableName:"hasReference"},r],c={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},g=[{alias:null,args:null,kind:"ScalarField",name:"primaryValue",storageKey:null}],f={kind:"Literal",name:"metric",value:"cardinality"},u={kind:"Literal",name:"metric",value:"percentEmpty"},p={kind:"Literal",name:"inferencesRole",value:"reference"};return{fragment:{argumentDefinitions:[n,a,l],kind:"Fragment",metadata:null,name:"DimensionPageQuery",selections:[{alias:"dimension",args:t,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{kind:"InlineFragment",selections:[i,{args:s,kind:"FragmentSpread",name:"DimensionSegmentsBarChart_dimension"},{args:s,kind:"FragmentSpread",name:"DimensionCountStats_dimension"},{args:s,kind:"FragmentSpread",name:"DimensionDriftStats_dimension"},{args:d,kind:"FragmentSpread",name:"DimensionCardinalityStats_dimension"},{args:d,kind:"FragmentSpread",name:"DimensionPercentEmptyStats_dimension"},{args:s,kind:"FragmentSpread",name:"DimensionQuantilesStats_dimension"}],type:"Dimension",abstractKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[n,l,a],kind:"Operation",name:"DimensionPageQuery",selections:[{alias:"dimension",args:t,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[c,i,{kind:"InlineFragment",selections:[{alias:null,args:[{kind:"Variable",name:"primaryTimeRange",variableName:"timeRange"}],concreteType:"Segments",kind:"LinkedField",name:"segmentsComparison",plural:!1,selections:[{alias:null,args:null,concreteType:"Segment",kind:"LinkedField",name:"segments",plural:!0,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"bin",plural:!1,selections:[c,{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],type:"NominalBin",abstractKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"NumericRange",kind:"LinkedField",name:"range",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"start",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"end",storageKey:null}],storageKey:null}],type:"IntervalBin",abstractKey:null}],storageKey:null},{alias:null,args:null,concreteType:"DatasetValues",kind:"LinkedField",name:"counts",plural:!1,selections:g,storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"DatasetValues",kind:"LinkedField",name:"totalCounts",plural:!1,selections:g,storageKey:null}],storageKey:null},{alias:"count",args:[{kind:"Literal",name:"metric",value:"count"},r],kind:"ScalarField",name:"dataQualityMetric",storageKey:null},{alias:"psi",args:[{kind:"Literal",name:"metric",value:"psi"},r],kind:"ScalarField",name:"driftMetric",storageKey:null},{alias:"cardinality",args:[f,r],kind:"ScalarField",name:"dataQualityMetric",storageKey:null},{alias:"percentEmpty",args:[u,r],kind:"ScalarField",name:"dataQualityMetric",storageKey:null},{alias:"p99",args:[{kind:"Literal",name:"metric",value:"p99"},r],kind:"ScalarField",name:"dataQualityMetric",storageKey:null},{alias:"p75",args:[{kind:"Literal",name:"metric",value:"p75"},r],kind:"ScalarField",name:"dataQualityMetric",storageKey:null},{alias:"p50",args:[{kind:"Literal",name:"metric",value:"p50"},r],kind:"ScalarField",name:"dataQualityMetric",storageKey:null},{alias:"p25",args:[{kind:"Literal",name:"metric",value:"p25"},r],kind:"ScalarField",name:"dataQualityMetric",storageKey:null},{alias:"p1",args:[{kind:"Literal",name:"metric",value:"p01"},r],kind:"ScalarField",name:"dataQualityMetric",storageKey:null},{condition:"hasReference",kind:"Condition",passingValue:!0,selections:[{alias:"referenceCardinality",args:[p,f],kind:"ScalarField",name:"dataQualityMetric",storageKey:'dataQualityMetric(inferencesRole:"reference",metric:"cardinality")'},{alias:"referencePercentEmpty",args:[p,u],kind:"ScalarField",name:"dataQualityMetric",storageKey:'dataQualityMetric(inferencesRole:"reference",metric:"percentEmpty")'}]}],type:"Dimension",abstractKey:null}],storageKey:null}]},params:{cacheID:"39ebdc3f16bc7a35f11f82fbe817bae7",id:null,metadata:{},name:"DimensionPageQuery",operationKind:"query",text:`query DimensionPageQuery(
  $dimensionId: ID!
  $timeRange: TimeRange!
  $hasReference: Boolean!
) {
  dimension: node(id: $dimensionId) {
    __typename
    ... on Dimension {
      id
      ...DimensionSegmentsBarChart_dimension_3E0ZE6
      ...DimensionCountStats_dimension_3E0ZE6
      ...DimensionDriftStats_dimension_3E0ZE6
      ...DimensionCardinalityStats_dimension_1JBzL3
      ...DimensionPercentEmptyStats_dimension_1JBzL3
      ...DimensionQuantilesStats_dimension_3E0ZE6
    }
    id
  }
}

fragment DimensionCardinalityStats_dimension_1JBzL3 on Dimension {
  id
  cardinality: dataQualityMetric(metric: cardinality, timeRange: $timeRange)
  referenceCardinality: dataQualityMetric(metric: cardinality, inferencesRole: reference) @include(if: $hasReference)
}

fragment DimensionCountStats_dimension_3E0ZE6 on Dimension {
  id
  count: dataQualityMetric(metric: count, timeRange: $timeRange)
}

fragment DimensionDriftStats_dimension_3E0ZE6 on Dimension {
  id
  psi: driftMetric(metric: psi, timeRange: $timeRange)
}

fragment DimensionPercentEmptyStats_dimension_1JBzL3 on Dimension {
  id
  percentEmpty: dataQualityMetric(metric: percentEmpty, timeRange: $timeRange)
  referencePercentEmpty: dataQualityMetric(metric: percentEmpty, inferencesRole: reference) @include(if: $hasReference)
}

fragment DimensionQuantilesStats_dimension_3E0ZE6 on Dimension {
  p99: dataQualityMetric(metric: p99, timeRange: $timeRange)
  p75: dataQualityMetric(metric: p75, timeRange: $timeRange)
  p50: dataQualityMetric(metric: p50, timeRange: $timeRange)
  p25: dataQualityMetric(metric: p25, timeRange: $timeRange)
  p1: dataQualityMetric(metric: p01, timeRange: $timeRange)
}

fragment DimensionSegmentsBarChart_dimension_3E0ZE6 on Dimension {
  id
  segmentsComparison(primaryTimeRange: $timeRange) {
    segments {
      bin {
        __typename
        ... on NominalBin {
          __typename
          name
        }
        ... on IntervalBin {
          __typename
          range {
            start
            end
          }
        }
        ... on MissingValueBin {
          __typename
        }
      }
      counts {
        primaryValue
      }
    }
    totalCounts {
      primaryValue
    }
  }
}
`}}}();em.hash="667ef1a20e42077fcd704bf788c9357c";const nm=function(){var n={kind:"Literal",name:"metric",value:"cardinality"};return{argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"hasReference"},{defaultValue:null,kind:"LocalArgument",name:"timeRange"}],kind:"Fragment",metadata:null,name:"DimensionCardinalityStats_dimension",selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:"cardinality",args:[n,{kind:"Variable",name:"timeRange",variableName:"timeRange"}],kind:"ScalarField",name:"dataQualityMetric",storageKey:null},{condition:"hasReference",kind:"Condition",passingValue:!0,selections:[{alias:"referenceCardinality",args:[{kind:"Literal",name:"inferencesRole",value:"reference"},n],kind:"ScalarField",name:"dataQualityMetric",storageKey:'dataQualityMetric(inferencesRole:"reference",metric:"cardinality")'}]}],type:"Dimension",abstractKey:null}}();nm.hash="8b4edef350e4df49e799afa70ca34918";function EF(n){const a=T.useFragment(nm,n.dimension);return o(J,{children:[e(F,{elementType:"h3",size:"XS",color:"text-700",children:"Cardinality"}),e(F,{children:za(a.cardinality)}),a.referenceCardinality!=null&&e(F,{size:"S",color:"purple-800",children:za(a.referenceCardinality)})]})}const am=function(){var n={defaultValue:null,kind:"LocalArgument",name:"dimensionId"},a={defaultValue:null,kind:"LocalArgument",name:"granularity"},l={defaultValue:null,kind:"LocalArgument",name:"timeRange"},t=[{kind:"Variable",name:"id",variableName:"dimensionId"}],i={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},r={kind:"InlineFragment",selections:[{alias:"cardinalityTimeSeries",args:[{kind:"Variable",name:"granularity",variableName:"granularity"},{kind:"Literal",name:"metric",value:"cardinality"},{kind:"Variable",name:"timeRange",variableName:"timeRange"}],concreteType:"DataQualityTimeSeries",kind:"LinkedField",name:"dataQualityTimeSeries",plural:!1,selections:[{alias:null,args:null,concreteType:"TimeSeriesDataPoint",kind:"LinkedField",name:"data",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"timestamp",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null}],storageKey:null}],storageKey:null}],type:"Dimension",abstractKey:null};return{fragment:{argumentDefinitions:[n,a,l],kind:"Fragment",metadata:null,name:"DimensionCardinalityTimeSeriesQuery",selections:[{alias:"dimension",args:t,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[i,r],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[n,l,a],kind:"Operation",name:"DimensionCardinalityTimeSeriesQuery",selections:[{alias:"dimension",args:t,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},i,r],storageKey:null}]},params:{cacheID:"3c329f10094fdfe6dfbc0c7742bcffc4",id:null,metadata:{},name:"DimensionCardinalityTimeSeriesQuery",operationKind:"query",text:`query DimensionCardinalityTimeSeriesQuery(
  $dimensionId: ID!
  $timeRange: TimeRange!
  $granularity: Granularity!
) {
  dimension: node(id: $dimensionId) {
    __typename
    id
    ... on Dimension {
      cardinalityTimeSeries: dataQualityTimeSeries(metric: cardinality, timeRange: $timeRange, granularity: $granularity) {
        data {
          timestamp
          value
        }
      }
    }
  }
}
`}}}();am.hash="54017cf4e3febc3e99e1d95c98800ef7";const $l={top:25,right:18,left:18,bottom:5},MF=new Intl.NumberFormat([],{maximumFractionDigits:2}),lm=()=>{const{gray300:n}=An();return{color:n}};function VF({active:n,payload:a,label:l}){var i;const{color:t}=lm();if(n&&a&&a.length){const r=((i=a[0])==null?void 0:i.value)??null,s=typeof r=="number"?MF.format(r):"--";return o(qn,{children:[e(F,{weight:"heavy",size:"S",children:`${da(new Date(l))}`}),e(ze,{color:t,name:"Cardinality",value:s}),e(Ft,{})]})}return null}function zF({dimensionId:n}){var d;const{timeRange:a}=ua(),l=rl(a),t=T.useLazyLoadQuery(am,{dimensionId:n,timeRange:{start:a.start.toISOString(),end:a.end.toISOString()},granularity:l}),{color:i}=lm(),r=((d=t.dimension.cardinalityTimeSeries)==null?void 0:d.data.map(c=>({timestamp:new Date(c.timestamp).valueOf(),value:c.value})))||[],s=ol({samplingIntervalMinutes:l.samplingIntervalMinutes});return e(wn,{width:"100%",height:"100%",children:o(dl,{data:r,margin:$l,syncId:"dimensionDetails",children:[e("defs",{children:o("linearGradient",{id:"cardinalityColorUv",x1:"0",y1:"0",x2:"0",y2:"1",children:[e("stop",{offset:"5%",stopColor:i,stopOpacity:.8}),e("stop",{offset:"95%",stopColor:i,stopOpacity:0})]})}),e(Wn,{...sl,tickFormatter:c=>s(new Date(c))}),e(hn,{stroke:"var(--ac-global-color-grey-500)",label:{value:"Cardinality",angle:-90,position:"insideLeft",style:{textAnchor:"middle",fill:"var(--ac-global-text-color-900)"}},style:{fill:"var(--ac-global-text-color-700)"}}),e(Jn,{strokeDasharray:"4 4",stroke:"var(--ac-global-color-grey-500)",strokeOpacity:.5}),e(Gn,{content:e(VF,{})}),e(Dl,{type:"monotone",dataKey:"value",stroke:i,fillOpacity:1,fill:"url(#cardinalityColorUv)"})]})})}const tm={argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"timeRange"}],kind:"Fragment",metadata:null,name:"DimensionCountStats_dimension",selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:"count",args:[{kind:"Literal",name:"metric",value:"count"},{kind:"Variable",name:"timeRange",variableName:"timeRange"}],kind:"ScalarField",name:"dataQualityMetric",storageKey:null}],type:"Dimension",abstractKey:null};tm.hash="6dccac51f3fb0853276677c692af5a43";function NF(n){const l=T.useFragment(tm,n.dimension).count??0;return o(J,{children:[e(F,{elementType:"h3",size:"XS",color:"text-700",children:"Total Count"}),e(F,{size:"L",children:za(l)})]})}const im=function(){var n={defaultValue:null,kind:"LocalArgument",name:"countGranularity"},a={defaultValue:null,kind:"LocalArgument",name:"dimensionId"},l={defaultValue:null,kind:"LocalArgument",name:"timeRange"},t=[{kind:"Variable",name:"id",variableName:"dimensionId"}],i={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},r={kind:"InlineFragment",selections:[{alias:"trafficTimeSeries",args:[{kind:"Variable",name:"granularity",variableName:"countGranularity"},{kind:"Literal",name:"metric",value:"count"},{kind:"Variable",name:"timeRange",variableName:"timeRange"}],concreteType:"DataQualityTimeSeries",kind:"LinkedField",name:"dataQualityTimeSeries",plural:!1,selections:[{alias:null,args:null,concreteType:"TimeSeriesDataPoint",kind:"LinkedField",name:"data",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"timestamp",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null}],storageKey:null}],storageKey:null}],type:"Dimension",abstractKey:null};return{fragment:{argumentDefinitions:[n,a,l],kind:"Fragment",metadata:null,name:"DimensionCountTimeSeriesQuery",selections:[{alias:"embedding",args:t,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[i,r],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[a,l,n],kind:"Operation",name:"DimensionCountTimeSeriesQuery",selections:[{alias:"embedding",args:t,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},i,r],storageKey:null}]},params:{cacheID:"695a044545346c5b69438bef3d905a3e",id:null,metadata:{},name:"DimensionCountTimeSeriesQuery",operationKind:"query",text:`query DimensionCountTimeSeriesQuery(
  $dimensionId: ID!
  $timeRange: TimeRange!
  $countGranularity: Granularity!
) {
  embedding: node(id: $dimensionId) {
    __typename
    id
    ... on Dimension {
      trafficTimeSeries: dataQualityTimeSeries(metric: count, timeRange: $timeRange, granularity: $countGranularity) {
        data {
          timestamp
          value
        }
      }
    }
  }
}
`}}}();im.hash="0e3c417502e042a162e263efd78e1877";const $F=new Intl.NumberFormat([],{maximumFractionDigits:2}),rm=()=>{const{gray300:n}=An();return{barColor:n}};function jF({active:n,payload:a,label:l}){var i;const{barColor:t}=rm();if(n&&a&&a.length){const r=((i=a[0])==null?void 0:i.value)??null,s=typeof r=="number"?$F.format(r):"--";return o(qn,{children:[e(F,{weight:"heavy",size:"S",children:`${da(new Date(l))}`}),e(ze,{color:t,shape:"square",name:"Count",value:s})]})}return null}function OF({dimensionId:n}){var c;const{timeRange:a}=ua(),l=rl(a),r=(((c=T.useLazyLoadQuery(im,{dimensionId:n,timeRange:{start:a.start.toISOString(),end:a.end.toISOString()},countGranularity:l}).embedding.trafficTimeSeries)==null?void 0:c.data)||[]).map(g=>({...g,timestamp:new Date(g.timestamp).valueOf()})),s=ol({samplingIntervalMinutes:l.samplingIntervalMinutes}),{barColor:d}=rm();return e(wn,{width:"100%",height:"100%",children:o(Lt,{data:r,margin:$l,syncId:"dimensionDetails",children:[e("defs",{children:o("linearGradient",{id:"countBarColor",x1:"0",y1:"0",x2:"0",y2:"1",children:[e("stop",{offset:"5%",stopColor:d,stopOpacity:1}),e("stop",{offset:"95%",stopColor:d,stopOpacity:.5})]})}),e(Wn,{...sl,tickFormatter:g=>s(new Date(g))}),e(hn,{stroke:"var(--ac-global-color-grey-500)",label:{value:"Count",angle:-90,position:"insideLeft",style:{textAnchor:"middle",fill:"var(--ac-global-text-color-900)"}},style:{fill:"var(--ac-global-text-color-700)"}}),e(Jn,{strokeDasharray:"4 4",stroke:"var(--ac-global-color-grey-500)",strokeOpacity:.5}),e(Gn,{...Ei,content:e(jF,{})}),e(Fa,{dataKey:"value",fill:"url(#countBarColor)",spacing:5})]})})}const om=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"dimensionId"},{defaultValue:null,kind:"LocalArgument",name:"timeRange"}],a=[{kind:"Variable",name:"id",variableName:"dimensionId"}],l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},t=[{kind:"Variable",name:"primaryTimeRange",variableName:"timeRange"}],i={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},s={alias:null,args:null,concreteType:"NumericRange",kind:"LinkedField",name:"range",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"start",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"end",storageKey:null}],storageKey:null},d=[{alias:null,args:null,kind:"ScalarField",name:"primaryValue",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"referenceValue",storageKey:null}],c={alias:null,args:null,concreteType:"DatasetValues",kind:"LinkedField",name:"counts",plural:!1,selections:d,storageKey:null},g={alias:null,args:null,concreteType:"DatasetValues",kind:"LinkedField",name:"totalCounts",plural:!1,selections:d,storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"DimensionDriftBreakdownSegmentBarChartQuery",selections:[{alias:"dimension",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[l,{kind:"InlineFragment",selections:[{kind:"RequiredField",field:{alias:null,args:t,concreteType:"Segments",kind:"LinkedField",name:"segmentsComparison",plural:!1,selections:[{alias:null,args:null,concreteType:"Segment",kind:"LinkedField",name:"segments",plural:!0,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"bin",plural:!1,selections:[{kind:"InlineFragment",selections:[i,r],type:"NominalBin",abstractKey:null},{kind:"InlineFragment",selections:[i,s],type:"IntervalBin",abstractKey:null},{kind:"InlineFragment",selections:[i],type:"MissingValueBin",abstractKey:null}],storageKey:null},c],storageKey:null},g],storageKey:null},action:"THROW"}],type:"Dimension",abstractKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"DimensionDriftBreakdownSegmentBarChartQuery",selections:[{alias:"dimension",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[i,l,{kind:"InlineFragment",selections:[{alias:null,args:t,concreteType:"Segments",kind:"LinkedField",name:"segmentsComparison",plural:!1,selections:[{alias:null,args:null,concreteType:"Segment",kind:"LinkedField",name:"segments",plural:!0,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"bin",plural:!1,selections:[i,{kind:"InlineFragment",selections:[r],type:"NominalBin",abstractKey:null},{kind:"InlineFragment",selections:[s],type:"IntervalBin",abstractKey:null}],storageKey:null},c],storageKey:null},g],storageKey:null}],type:"Dimension",abstractKey:null}],storageKey:null}]},params:{cacheID:"2e05d1ca13480861b72938edd162c36f",id:null,metadata:{},name:"DimensionDriftBreakdownSegmentBarChartQuery",operationKind:"query",text:`query DimensionDriftBreakdownSegmentBarChartQuery(
  $dimensionId: ID!
  $timeRange: TimeRange!
) {
  dimension: node(id: $dimensionId) {
    __typename
    id
    ... on Dimension {
      segmentsComparison(primaryTimeRange: $timeRange) {
        segments {
          bin {
            __typename
            ... on NominalBin {
              __typename
              name
            }
            ... on IntervalBin {
              __typename
              range {
                start
                end
              }
            }
            ... on MissingValueBin {
              __typename
            }
          }
          counts {
            primaryValue
            referenceValue
          }
        }
        totalCounts {
          primaryValue
          referenceValue
        }
      }
    }
  }
}
`}}}();om.hash="f42c6bfff21c628edc1e297e0a0462d4";const no=tt(".2f"),sm=()=>{const{primary:n,reference:a}=An();return{primaryBarColor:n,referenceBarColor:a}};function QF({active:n,payload:a,label:l}){var r,s,d,c,g,f;const{primaryBarColor:t,referenceBarColor:i}=sm();if(n&&a&&a.length){const u=(s=(r=a[0])==null?void 0:r.payload)==null?void 0:s.primaryName,p=(d=a[0])==null?void 0:d.value,y=(g=(c=a[0])==null?void 0:c.payload)==null?void 0:g.referenceName,h=(f=a[1])==null?void 0:f.value;return o(qn,{children:[e(F,{elementType:"h3",size:"S",weight:"heavy",children:l}),e(ze,{color:t,shape:"square",name:u,value:p!=null?`${no(p)}%`:"--"}),e(ze,{color:i,shape:"square",name:y,value:h!=null?`${no(h)}%`:"--"})]})}return null}function BF(n){var p,y,h,k,S;const{primaryInferences:a,referenceInferences:l}=Hn(),t=a.name,i=(l==null?void 0:l.name)||"reference",{selectedTimestamp:r}=It(),s=m.useMemo(()=>r??new Date(a.endTime),[r,a.endTime]),d=m.useMemo(()=>({start:po(s,2).toISOString(),end:s.toISOString()}),[s]),c=T.useLazyLoadQuery(om,{dimensionId:n.dimensionId,timeRange:d}),g=m.useMemo(()=>{var _,w,V,Q,x;const C=((_=c.dimension.segmentsComparison)==null?void 0:_.segments)??[],P=((V=(w=c.dimension.segmentsComparison)==null?void 0:w.totalCounts)==null?void 0:V.primaryValue)??0,L=((x=(Q=c.dimension.segmentsComparison)==null?void 0:Q.totalCounts)==null?void 0:x.referenceValue)??0;return C.map(R=>{var se,Ye;const A=((se=R.counts)==null?void 0:se.primaryValue)??0,z=((Ye=R.counts)==null?void 0:Ye.referenceValue)??0,N=os(R.bin),j=A/P*100,Z=z/L*100;return{name:N,primaryName:t,referenceName:i,primaryPercent:j,referencePercent:Z}})},[(p=c.dimension.segmentsComparison)==null?void 0:p.segments,(h=(y=c.dimension.segmentsComparison)==null?void 0:y.totalCounts)==null?void 0:h.primaryValue,(S=(k=c.dimension.segmentsComparison)==null?void 0:k.totalCounts)==null?void 0:S.referenceValue,t,i]),{primaryBarColor:f,referenceBarColor:u}=sm();return o(b,{direction:"column",height:"100%",children:[e(v,{flex:"none",paddingTop:"size-100",paddingStart:"size-200",children:e(F,{elementType:"h3",size:"S",color:"text-700",children:`Distribution comparison at ${da(new Date(d.end))}`})}),e(v,{flex:!0,children:e(wn,{children:o(Lt,{data:g,margin:{top:15,right:18,left:18,bottom:5},children:[o("defs",{children:[o("linearGradient",{id:"dimensionPrimarySegmentsBarColor",x1:"0",y1:"0",x2:"0",y2:"1",children:[e("stop",{offset:"5%",stopColor:f,stopOpacity:1}),e("stop",{offset:"95%",stopColor:f,stopOpacity:.5})]}),o("linearGradient",{id:"dimensionReferenceSegmentsBarColor",x1:"0",y1:"0",x2:"0",y2:"1",children:[e("stop",{offset:"5%",stopColor:u,stopOpacity:1}),e("stop",{offset:"95%",stopColor:u,stopOpacity:.5})]})]}),e(Wn,{dataKey:"name",style:{fill:"var(--ac-global-text-color-700)"}}),e(hn,{stroke:"var(--ac-global-color-grey-500)",label:{value:"Percent",angle:-90,position:"insideLeft",style:{textAnchor:"middle",fill:"var(--ac-global-text-color-900)"}},style:{fill:"var(--ac-global-text-color-700)"}}),e(Jn,{strokeDasharray:"4 4",stroke:"var(--ac-global-color-grey-500)"}),e(Gn,{...Ei,content:e(QF,{})}),e(Fa,{dataKey:"primaryPercent",fill:"url(#dimensionPrimarySegmentsBarColor)"}),e(Fa,{dataKey:"referencePercent",fill:"url(#dimensionReferenceSegmentsBarColor)"})]})})})]})}const dm={argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"timeRange"}],kind:"Fragment",metadata:null,name:"DimensionDriftStats_dimension",selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:"psi",args:[{kind:"Literal",name:"metric",value:"psi"},{kind:"Variable",name:"timeRange",variableName:"timeRange"}],kind:"ScalarField",name:"driftMetric",storageKey:null}],type:"Dimension",abstractKey:null};dm.hash="f8a9fb08a14f63906e38bc247d50b189";const qF=o(Al,{variant:"info",placement:"top end",children:[e(ae,{weight:"heavy",level:4,children:"Population Stability Index"}),e($a,{children:e(F,{children:"PSI is a symmetric metric that measures the relative entropy, or difference in information represented by two distributions. It can be thought of as measuring the distance between two data distributions showing how different the two distributions are from each other."})}),e("footer",{children:e(_n,{href:"https://arize.com/blog-course/population-stability-index-psi/#:~:text=Population%20Stability%20Index%20(PSI)%20Overview,distributions%20are%20from%20each%20other.",children:"Learn more"})})]});function UF(n){const a=T.useFragment(dm,n.dimension);return o(J,{children:[o(b,{direction:"row",alignItems:"center",gap:"size-25",children:[e(F,{elementType:"h3",size:"XS",color:"text-700",children:"PSI"}),qF]}),e(F,{size:"L",children:Ja(a.psi)})]})}const cm=function(){var n={defaultValue:null,kind:"LocalArgument",name:"countGranularity"},a={defaultValue:null,kind:"LocalArgument",name:"dimensionId"},l={defaultValue:null,kind:"LocalArgument",name:"driftGranularity"},t={defaultValue:null,kind:"LocalArgument",name:"timeRange"},i=[{kind:"Variable",name:"id",variableName:"dimensionId"}],r={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},s={kind:"Variable",name:"timeRange",variableName:"timeRange"},d=[{alias:null,args:null,concreteType:"TimeSeriesDataPoint",kind:"LinkedField",name:"data",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"timestamp",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null}],storageKey:null}],c={kind:"InlineFragment",selections:[{alias:null,args:[{kind:"Variable",name:"granularity",variableName:"driftGranularity"},{kind:"Literal",name:"metric",value:"psi"},s],concreteType:"DriftTimeSeries",kind:"LinkedField",name:"driftTimeSeries",plural:!1,selections:d,storageKey:null},{alias:"trafficTimeSeries",args:[{kind:"Variable",name:"granularity",variableName:"countGranularity"},{kind:"Literal",name:"metric",value:"count"},s],concreteType:"DataQualityTimeSeries",kind:"LinkedField",name:"dataQualityTimeSeries",plural:!1,selections:d,storageKey:null}],type:"Dimension",abstractKey:null};return{fragment:{argumentDefinitions:[n,a,l,t],kind:"Fragment",metadata:null,name:"DimensionDriftTimeSeriesQuery",selections:[{alias:"embedding",args:i,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[r,c],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[a,t,l,n],kind:"Operation",name:"DimensionDriftTimeSeriesQuery",selections:[{alias:"embedding",args:i,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},r,c],storageKey:null}]},params:{cacheID:"76a27456cd1f545ddb16fc0d9ef09fc1",id:null,metadata:{},name:"DimensionDriftTimeSeriesQuery",operationKind:"query",text:`query DimensionDriftTimeSeriesQuery(
  $dimensionId: ID!
  $timeRange: TimeRange!
  $driftGranularity: Granularity!
  $countGranularity: Granularity!
) {
  embedding: node(id: $dimensionId) {
    __typename
    id
    ... on Dimension {
      driftTimeSeries(metric: psi, timeRange: $timeRange, granularity: $driftGranularity) {
        data {
          timestamp
          value
        }
      }
      trafficTimeSeries: dataQualityTimeSeries(metric: count, timeRange: $timeRange, granularity: $countGranularity) {
        data {
          timestamp
          value
        }
      }
    }
  }
}
`}}}();cm.hash="e458e42625d1c4dcdd2359a8d33d32a8";const um=()=>{const{orange300:n,gray300:a}=An();return{color:n,barColor:a}};function HF({active:n,payload:a,label:l}){var i;const{color:t}=um();if(n&&a&&a.length){const r=((i=a[1])==null?void 0:i.value)??null;return o(qn,{children:[e(F,{weight:"heavy",size:"S",children:`${da(new Date(l))}`}),e(ze,{color:t,name:"PSI",value:Ja(r)}),e(Ft,{}),o("div",{css:K`
            display: flex;
            flex-direction: row;
            align-items: center;
            color: var(--ac-global-color-primary);
            gap: var(--ac-global-dimension-static-size-50);

            margin-top: var(--ac-global-dimension-static-size-50);
          `,children:[e(I,{svg:e(ta,{})}),e("span",{children:"Click to view details"})]})]})}return null}function GF({dimensionId:n}){var y,h;const{timeRange:a}=ua(),{selectedTimestamp:l,setSelectedTimestamp:t}=It(),i=rl(a),r=T.useLazyLoadQuery(cm,{dimensionId:n,timeRange:{start:a.start.toISOString(),end:a.end.toISOString()},driftGranularity:as(a),countGranularity:i}),s=((y=r.embedding.driftTimeSeries)==null?void 0:y.data)||[],d=((h=r.embedding.trafficTimeSeries)==null?void 0:h.data.reduce((k,S)=>(k[S.timestamp]=S.value,k),{}))??{},c=s.map(k=>{const S=d[k.timestamp];return{...k,traffic:S,timestamp:new Date(k.timestamp).valueOf()}}),g=ol({samplingIntervalMinutes:i.samplingIntervalMinutes}),f=m.useCallback(k=>{const{activePayload:S}=k;if(S!=null&&S.length>0){const C=S[0].payload;t(new Date(C.timestamp))}},[t]),{color:u,barColor:p}=um();return e(wn,{width:"100%",height:"100%",children:o(dl,{data:c,margin:$l,onClick:f,syncId:"dimensionDetails",children:[o("defs",{children:[o("linearGradient",{id:"dimensionDriftColorUv",x1:"0",y1:"0",x2:"0",y2:"1",children:[e("stop",{offset:"5%",stopColor:u,stopOpacity:.8}),e("stop",{offset:"95%",stopColor:u,stopOpacity:0})]}),o("linearGradient",{id:"barColor",x1:"0",y1:"0",x2:"0",y2:"1",children:[e("stop",{offset:"5%",stopColor:p,stopOpacity:.8}),e("stop",{offset:"95%",stopColor:p,stopOpacity:0})]})]}),e(Wn,{...sl,tickFormatter:k=>g(new Date(k))}),e(hn,{stroke:"var(--ac-global-color-grey-500)",label:{value:"PSI",angle:-90,position:"insideLeft",style:{textAnchor:"middle",fill:"var(--ac-global-text-color-900)"}},style:{fill:"var(--ac-global-color-grey-500)"}}),e(hn,{yAxisId:"right",orientation:"right",tick:!1,tickLine:!1,width:0}),e(Jn,{strokeDasharray:"4 4",stroke:"var(--ac-global-color-grey-500)",strokeOpacity:.5}),e(Gn,{content:e(HF,{})}),e(Fa,{yAxisId:"right",dataKey:"traffic",fill:"url(#barColor)",spacing:5}),e(Dl,{type:"monotone",dataKey:"value",stroke:u,fillOpacity:1,fill:"url(#dimensionDriftColorUv)"}),l!=null?e(vs,{...ls,x:l.getTime()}):null]})})}const mm=function(){var n={kind:"Literal",name:"metric",value:"percentEmpty"};return{argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"hasReference"},{defaultValue:null,kind:"LocalArgument",name:"timeRange"}],kind:"Fragment",metadata:null,name:"DimensionPercentEmptyStats_dimension",selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:"percentEmpty",args:[n,{kind:"Variable",name:"timeRange",variableName:"timeRange"}],kind:"ScalarField",name:"dataQualityMetric",storageKey:null},{condition:"hasReference",kind:"Condition",passingValue:!0,selections:[{alias:"referencePercentEmpty",args:[{kind:"Literal",name:"inferencesRole",value:"reference"},n],kind:"ScalarField",name:"dataQualityMetric",storageKey:'dataQualityMetric(inferencesRole:"reference",metric:"percentEmpty")'}]}],type:"Dimension",abstractKey:null}}();mm.hash="1e10d0449d6607d9292f355548c41c78";function WF(n){const a=T.useFragment(mm,n.dimension);return o(J,{children:[e(F,{elementType:"h3",size:"XS",color:"text-700",children:"% Empty"}),e(F,{size:"L",children:Zl(a.percentEmpty)}),a.referencePercentEmpty!=null&&e(F,{size:"M",color:"purple-800",children:Zl(a.referencePercentEmpty)})]})}const gm=function(){var n={defaultValue:null,kind:"LocalArgument",name:"dimensionId"},a={defaultValue:null,kind:"LocalArgument",name:"granularity"},l={defaultValue:null,kind:"LocalArgument",name:"timeRange"},t=[{kind:"Variable",name:"id",variableName:"dimensionId"}],i={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},r={kind:"InlineFragment",selections:[{alias:"percentEmptyTimeSeries",args:[{kind:"Variable",name:"granularity",variableName:"granularity"},{kind:"Literal",name:"metric",value:"percentEmpty"},{kind:"Variable",name:"timeRange",variableName:"timeRange"}],concreteType:"DataQualityTimeSeries",kind:"LinkedField",name:"dataQualityTimeSeries",plural:!1,selections:[{alias:null,args:null,concreteType:"TimeSeriesDataPoint",kind:"LinkedField",name:"data",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"timestamp",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null}],storageKey:null}],storageKey:null}],type:"Dimension",abstractKey:null};return{fragment:{argumentDefinitions:[n,a,l],kind:"Fragment",metadata:null,name:"DimensionPercentEmptyTimeSeriesQuery",selections:[{alias:"embedding",args:t,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[i,r],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[n,l,a],kind:"Operation",name:"DimensionPercentEmptyTimeSeriesQuery",selections:[{alias:"embedding",args:t,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},i,r],storageKey:null}]},params:{cacheID:"85842391b76ccca79e3b6f506fb1d78d",id:null,metadata:{},name:"DimensionPercentEmptyTimeSeriesQuery",operationKind:"query",text:`query DimensionPercentEmptyTimeSeriesQuery(
  $dimensionId: ID!
  $timeRange: TimeRange!
  $granularity: Granularity!
) {
  embedding: node(id: $dimensionId) {
    __typename
    id
    ... on Dimension {
      percentEmptyTimeSeries: dataQualityTimeSeries(metric: percentEmpty, timeRange: $timeRange, granularity: $granularity) {
        data {
          timestamp
          value
        }
      }
    }
  }
}
`}}}();gm.hash="c04e7d788249ceb6f9f7a9ff50a28efd";const JF=new Intl.NumberFormat([],{maximumFractionDigits:2}),pm=()=>{const{gray100:n}=An();return{color:n}};function XF({active:n,payload:a,label:l}){var i;const{color:t}=pm();if(n&&a&&a.length){const r=((i=a[0])==null?void 0:i.value)??null,s=typeof r=="number"?JF.format(r):"--";return o(qn,{children:[e(F,{weight:"heavy",size:"S",children:`${da(new Date(l))}`}),e(ze,{color:t,name:"% Empty",value:s})]})}return null}function ZF({dimensionId:n}){var d;const{timeRange:a}=ua(),l=rl(a),i=((d=T.useLazyLoadQuery(gm,{dimensionId:n,timeRange:{start:a.start.toISOString(),end:a.end.toISOString()},granularity:l}).embedding.percentEmptyTimeSeries)==null?void 0:d.data.map(c=>({timestamp:new Date(c.timestamp).valueOf(),value:c.value})))||[],r=ol({samplingIntervalMinutes:l.samplingIntervalMinutes}),{color:s}=pm();return e(wn,{width:"100%",height:"100%",children:o(dl,{data:i,margin:$l,syncId:"dimensionDetails",children:[e("defs",{children:o("linearGradient",{id:"percentEmptyColorUv",x1:"0",y1:"0",x2:"0",y2:"1",children:[e("stop",{offset:"5%",stopColor:s,stopOpacity:.8}),e("stop",{offset:"95%",stopColor:s,stopOpacity:0})]})}),e(Wn,{...sl,tickFormatter:c=>r(new Date(c))}),e(hn,{stroke:"var(--ac-global-color-grey-500)",label:{value:"% Empty",angle:-90,position:"insideLeft",style:{textAnchor:"middle",fill:"var(--ac-global-text-color-900)"}},style:{fill:"var(--ac-global-text-color-700)"}}),e(Jn,{strokeDasharray:"4 4",stroke:"var(--ac-global-color-grey-500)",strokeOpacity:.5}),e(Gn,{content:e(XF,{})}),e(ji,{type:"monotone",dataKey:"value",stroke:s,fillOpacity:1,fill:"url(#percentEmptyColorUv)"})]})})}const ym=function(){var n={kind:"Variable",name:"timeRange",variableName:"timeRange"};return{argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"timeRange"}],kind:"Fragment",metadata:null,name:"DimensionQuantilesStats_dimension",selections:[{alias:"p99",args:[{kind:"Literal",name:"metric",value:"p99"},n],kind:"ScalarField",name:"dataQualityMetric",storageKey:null},{alias:"p75",args:[{kind:"Literal",name:"metric",value:"p75"},n],kind:"ScalarField",name:"dataQualityMetric",storageKey:null},{alias:"p50",args:[{kind:"Literal",name:"metric",value:"p50"},n],kind:"ScalarField",name:"dataQualityMetric",storageKey:null},{alias:"p25",args:[{kind:"Literal",name:"metric",value:"p25"},n],kind:"ScalarField",name:"dataQualityMetric",storageKey:null},{alias:"p1",args:[{kind:"Literal",name:"metric",value:"p01"},n],kind:"ScalarField",name:"dataQualityMetric",storageKey:null}],type:"Dimension",abstractKey:null}}();ym.hash="c306c8eafb1d34be464d3a658d5f94a7";function YF(n){const a=T.useFragment(ym,n.dimension);return e("ul",{css:K`
        display: flex;
        flex-direction: column;
        gap: var(--ac-global-dimension-static-size-50);
      `,children:Object.keys(a).map(l=>{const t=a[l];return o("li",{css:K`
              display: flex;
              flex-direction: column;
              align-items: flex-end;
            `,children:[e(F,{elementType:"h3",size:"XS",color:"text-700",children:l}),e(F,{size:"S","data-raw":t,children:xi(t)})]},l)})})}const fm=function(){var n={defaultValue:null,kind:"LocalArgument",name:"dimensionId"},a={defaultValue:null,kind:"LocalArgument",name:"granularity"},l={defaultValue:null,kind:"LocalArgument",name:"timeRange"},t=[{kind:"Variable",name:"id",variableName:"dimensionId"}],i={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},r={kind:"Variable",name:"granularity",variableName:"granularity"},s={kind:"Variable",name:"timeRange",variableName:"timeRange"},d=[{alias:null,args:null,concreteType:"TimeSeriesDataPoint",kind:"LinkedField",name:"data",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"timestamp",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null}],storageKey:null}],c={kind:"InlineFragment",selections:[{alias:"p99TimeSeries",args:[r,{kind:"Literal",name:"metric",value:"p99"},s],concreteType:"DataQualityTimeSeries",kind:"LinkedField",name:"dataQualityTimeSeries",plural:!1,selections:d,storageKey:null},{alias:"p75TimeSeries",args:[r,{kind:"Literal",name:"metric",value:"p75"},s],concreteType:"DataQualityTimeSeries",kind:"LinkedField",name:"dataQualityTimeSeries",plural:!1,selections:d,storageKey:null},{alias:"p50TimeSeries",args:[r,{kind:"Literal",name:"metric",value:"p50"},s],concreteType:"DataQualityTimeSeries",kind:"LinkedField",name:"dataQualityTimeSeries",plural:!1,selections:d,storageKey:null},{alias:"p25TimeSeries",args:[r,{kind:"Literal",name:"metric",value:"p25"},s],concreteType:"DataQualityTimeSeries",kind:"LinkedField",name:"dataQualityTimeSeries",plural:!1,selections:d,storageKey:null},{alias:"p01TimeSeries",args:[r,{kind:"Literal",name:"metric",value:"p01"},s],concreteType:"DataQualityTimeSeries",kind:"LinkedField",name:"dataQualityTimeSeries",plural:!1,selections:d,storageKey:null}],type:"Dimension",abstractKey:null};return{fragment:{argumentDefinitions:[n,a,l],kind:"Fragment",metadata:null,name:"DimensionQuantilesTimeSeriesQuery",selections:[{alias:"dimension",args:t,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[i,c],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[n,l,a],kind:"Operation",name:"DimensionQuantilesTimeSeriesQuery",selections:[{alias:"dimension",args:t,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},i,c],storageKey:null}]},params:{cacheID:"04ae2e4b101a75b965867de769810e0c",id:null,metadata:{},name:"DimensionQuantilesTimeSeriesQuery",operationKind:"query",text:`query DimensionQuantilesTimeSeriesQuery(
  $dimensionId: ID!
  $timeRange: TimeRange!
  $granularity: Granularity!
) {
  dimension: node(id: $dimensionId) {
    __typename
    id
    ... on Dimension {
      p99TimeSeries: dataQualityTimeSeries(metric: p99, timeRange: $timeRange, granularity: $granularity) {
        data {
          timestamp
          value
        }
      }
      p75TimeSeries: dataQualityTimeSeries(metric: p75, timeRange: $timeRange, granularity: $granularity) {
        data {
          timestamp
          value
        }
      }
      p50TimeSeries: dataQualityTimeSeries(metric: p50, timeRange: $timeRange, granularity: $granularity) {
        data {
          timestamp
          value
        }
      }
      p25TimeSeries: dataQualityTimeSeries(metric: p25, timeRange: $timeRange, granularity: $granularity) {
        data {
          timestamp
          value
        }
      }
      p01TimeSeries: dataQualityTimeSeries(metric: p01, timeRange: $timeRange, granularity: $granularity) {
        data {
          timestamp
          value
        }
      }
    }
  }
}
`}}}();fm.hash="83342058bb8f50dad5bec299b4bc034d";const eC=tt("~s");var hm=(n=>(n.p99_p01="p99_p01",n.p75_p25="p75_p25",n.p50="p50",n))(hm||{});const nC=new Intl.NumberFormat([],{maximumFractionDigits:2});function fl(n){return typeof n=="number"?nC.format(n):"--"}const km=()=>{const n=An();return{outerColor:n.gray500,innerColor:n.gray300,lineColor:n.default}};function aC({active:n,payload:a,label:l}){const{outerColor:t,innerColor:i,lineColor:r}=km();if(n&&a&&a.length){const s=a[0].payload;return o(qn,{children:[e(F,{weight:"heavy",size:"S",children:`${da(new Date(l))}`}),e(ze,{color:t,name:"p99",value:fl(s.p99_p01[0])}),e(ze,{color:i,name:"p75",value:fl(s.p75_p25[0])}),e(ze,{color:r,name:"p50",value:fl(s.p50)}),e(ze,{color:i,name:"p25",value:fl(s.p75_p25[1])}),e(ze,{color:t,name:"p01",value:fl(s.p99_p01[1])})]})}return null}function lC({dimensionId:n}){var L,_,w,V,Q;const{timeRange:a}=ua(),l=rl(a),t=T.useLazyLoadQuery(fm,{dimensionId:n,timeRange:{start:a.start.toISOString(),end:a.end.toISOString()},granularity:l}),i=((L=t.dimension.p99TimeSeries)==null?void 0:L.data.map(x=>x))||[],r=((_=t.dimension.p01TimeSeries)==null?void 0:_.data.map(x=>x))||[],s=((w=t.dimension.p75TimeSeries)==null?void 0:w.data.map(x=>x))||[],d=((V=t.dimension.p25TimeSeries)==null?void 0:V.data.map(x=>x))||[],c=((Q=t.dimension.p50TimeSeries)==null?void 0:Q.data.map(x=>x))||[],g=i.map((x,R)=>({timestamp:new Date(x.timestamp).valueOf(),p99_p01:[x.value,r[R].value],p75_p25:[s[R].value,d[R].value],p50:c[R].value})),f=ol({samplingIntervalMinutes:l.samplingIntervalMinutes}),[u,p]=m.useState(Object.keys(hm).reduce((x,R)=>(x[R]=!1,x),{})),y=x=>{u[x.dataKey]||p({...u})},h=()=>{p({...u})},k=x=>{p({...u,[String(x.dataKey)]:!u[x.dataKey]})},{outerColor:S,innerColor:C,lineColor:P}=km();return e(wn,{width:"100%",height:"100%",children:o(dl,{data:g,margin:$l,syncId:"dimensionDetails",children:[o("defs",{children:[o("linearGradient",{id:"p99_p01ColorUV",x1:"0",y1:"0",x2:"0",y2:"1",children:[e("stop",{offset:"10%",stopColor:S,stopOpacity:.7}),e("stop",{offset:"50%",stopColor:S,stopOpacity:.3}),e("stop",{offset:"90%",stopColor:S,stopOpacity:.7})]}),o("linearGradient",{id:"p75_p25ColorUV",x1:"0",y1:"0",x2:"0",y2:"1",children:[e("stop",{offset:"10%",stopColor:C,stopOpacity:.7}),e("stop",{offset:"50%",stopColor:C,stopOpacity:.3}),e("stop",{offset:"90%",stopColor:C,stopOpacity:.7})]})]}),e(Wn,{...sl,tickFormatter:x=>f(new Date(x))}),e(hn,{stroke:"var(--ac-global-color-grey-500)",label:{value:"Value",angle:-90,position:"insideLeft",style:{textAnchor:"middle",fill:"var(--ac-global-text-color-900)"}},tickFormatter:x=>eC(x),style:{fill:"var(--ac-global-text-color-700)"}}),e(Jn,{strokeDasharray:"4 4",stroke:"var(--ac-global-color-grey-500)",strokeOpacity:.5}),e(Gn,{content:e(aC,{})}),e(Ih,{onClick:k,onMouseOver:y,onMouseOut:h}),e(Dl,{type:"monotone",dataKey:"p99_p01",name:"p99 - p01",fillOpacity:1,fill:"url(#p99_p01ColorUV)",stroke:S,hide:u.p99_p01===!0}),e(Dl,{type:"monotone",dataKey:"p75_p25",name:"p75 - p25",fillOpacity:1,stroke:C,fill:"url(#p75_p25ColorUV)",hide:u.p75_p25===!0}),e(ji,{type:"monotone",dataKey:"p50",stroke:P,hide:u.p50===!0})]})})}const bm=function(){var n={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},a=[{alias:null,args:null,kind:"ScalarField",name:"primaryValue",storageKey:null}];return{argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"timeRange"}],kind:"Fragment",metadata:null,name:"DimensionSegmentsBarChart_dimension",selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:[{kind:"Variable",name:"primaryTimeRange",variableName:"timeRange"}],concreteType:"Segments",kind:"LinkedField",name:"segmentsComparison",plural:!1,selections:[{alias:null,args:null,concreteType:"Segment",kind:"LinkedField",name:"segments",plural:!0,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"bin",plural:!1,selections:[{kind:"InlineFragment",selections:[n,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],type:"NominalBin",abstractKey:null},{kind:"InlineFragment",selections:[n,{alias:null,args:null,concreteType:"NumericRange",kind:"LinkedField",name:"range",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"start",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"end",storageKey:null}],storageKey:null}],type:"IntervalBin",abstractKey:null},{kind:"InlineFragment",selections:[n],type:"MissingValueBin",abstractKey:null}],storageKey:null},{alias:null,args:null,concreteType:"DatasetValues",kind:"LinkedField",name:"counts",plural:!1,selections:a,storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"DatasetValues",kind:"LinkedField",name:"totalCounts",plural:!1,selections:a,storageKey:null}],storageKey:null}],type:"Dimension",abstractKey:null}}();bm.hash="8cef9841e9a5bd7d0d50acb5db9028b0";const tC=tt(".2f"),Sm=()=>{const{primary:n}=An();return{color:n}};function iC({active:n,payload:a,label:l}){var i;const{color:t}=Sm();if(n&&a&&a.length){const r=(i=a[0])==null?void 0:i.value;return e(qn,{children:e(ze,{color:t,shape:"square",name:l,value:r!=null?`${tC(r)}%`:"--"})})}return null}function rC(n){const a=T.useFragment(bm,n.dimension),l=m.useMemo(()=>{var s,d,c;const i=((s=a.segmentsComparison)==null?void 0:s.segments)??[],r=((c=(d=a.segmentsComparison)==null?void 0:d.totalCounts)==null?void 0:c.primaryValue)??0;return i.map(g=>{var y;const f=((y=g.counts)==null?void 0:y.primaryValue)??0,u=os(g.bin),p=f/r*100;return{name:u,percent:p}})},[a]),{color:t}=Sm();return e(wn,{children:o(Lt,{data:l,margin:{top:25,right:18,left:18,bottom:5},children:[e("defs",{children:o("linearGradient",{id:"dimensionSegmentsBarColor",x1:"0",y1:"0",x2:"0",y2:"1",children:[e("stop",{offset:"5%",stopColor:t,stopOpacity:1}),e("stop",{offset:"95%",stopColor:t,stopOpacity:.5})]})}),e(Wn,{dataKey:"name",style:{fill:"var(--ac-global-text-color-700)"}}),e(hn,{stroke:"var(--ac-global-color-grey-500)",label:{value:"% Volume",angle:-90,position:"insideLeft",style:{textAnchor:"middle",fill:"var(--ac-global-text-color-900)"}},style:{fill:"var(--ac-global-text-color-700)"}}),e(Jn,{strokeDasharray:"4 4",stroke:"var(--ac-global-color-grey-500)",strokeOpacity:.5}),e(Gn,{...Ei,content:e(iC,{})}),e(Fa,{dataKey:"percent",fill:"url(#dimensionSegmentsBarColor)",spacing:15})]})})}function JT(){const{dimensionId:n}=Qe(),{timeRange:a}=ua(),l=Me();Oe(l);const{referenceInferences:t}=Hn(),i=t!==null,r=i,s=l.dimension.shape!=="continuous",d=l.dimension.dataType==="numeric",c=ce(),g=T.useLazyLoadQuery(em,{dimensionId:n,timeRange:{start:a.start.toISOString(),end:a.end.toISOString()},hasReference:i});if(!n)throw new Error("Dimension ID is required to display a dimension");return e(rs,{initialTimestamp:new Date(a.end),children:e(ue,{type:"slideOver",isDismissable:!0,onDismiss:()=>c(-1),children:e(oe,{size:"L",title:l.dimension.name,children:e("main",{css:K`
              padding: var(--ac-global-dimension-static-size-100);
              display: flex;
              flex-direction: column;
              min-height: 400px;
              overflow-y: auto;
              height: 100%;
            `,children:e(m.Suspense,{fallback:e(ge,{}),children:o(b,{direction:"column",gap:"size-100",children:[e(v,{borderColor:"dark",borderRadius:"medium",borderWidth:"thin",height:"size-1600",children:e(rC,{dimension:g.dimension})}),e(v,{borderColor:"dark",borderRadius:"medium",borderWidth:"thin",height:"size-1600","data-testid":"dimension-count-time-series-view",children:o(b,{direction:"row",alignItems:"stretch",height:"100%",children:[e(OF,{dimensionId:n}),e(Ea,{children:e(NF,{dimension:g.dimension})})]})}),r?e(v,{borderColor:"dark",borderRadius:"medium",borderWidth:"thin",children:o(b,{direction:"column",alignItems:"stretch",children:[e(v,{width:"100%",height:"size-1600",children:o(b,{direction:"row",alignItems:"stretch",height:"100%",children:[e(v,{flex:!0,children:e(GF,{dimensionId:n})}),e(Ea,{children:e(UF,{dimension:g.dimension})})]})}),e(v,{height:"size-1600",width:"100%",borderTopColor:"dark",borderTopWidth:"thin",children:e(m.Suspense,{fallback:e(ge,{}),children:e(BF,{dimensionId:n})})})]})}):null,d?e(v,{borderColor:"dark",borderRadius:"medium",borderWidth:"thin",height:"size-3000",children:o(b,{direction:"row",alignItems:"stretch",height:"100%",children:[e(v,{flex:!0,children:e(lC,{dimensionId:n})}),e(Ea,{children:e(YF,{dimension:g.dimension})})]})}):null,s?e(v,{borderColor:"dark",borderRadius:"medium",borderWidth:"thin",height:"size-1600",children:o(b,{direction:"row",alignItems:"stretch",height:"100%",children:[e(v,{flex:!0,children:e(zF,{dimensionId:n})}),e(Ea,{children:e(EF,{dimension:g.dimension})})]})}):null,e(v,{borderColor:"dark",borderRadius:"medium",borderWidth:"thin",height:"size-1600",children:o(b,{direction:"row",alignItems:"stretch",height:"100%",children:[e(ZF,{dimensionId:n}),e(Ea,{children:e(WF,{dimension:g.dimension})})]})})]})})})})})})}const vm=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}],l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"dataType",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"shape",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"dimensionLoaderQuery",selections:[{alias:"dimension",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{kind:"InlineFragment",selections:[l,t,i,r],type:"Dimension",abstractKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"dimensionLoaderQuery",selections:[{alias:"dimension",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},l,{kind:"InlineFragment",selections:[t,i,r],type:"Dimension",abstractKey:null}],storageKey:null}]},params:{cacheID:"f16f279b01e4bc5c5261bbdb629a0b73",id:null,metadata:{},name:"dimensionLoaderQuery",operationKind:"query",text:`query dimensionLoaderQuery(
  $id: ID!
) {
  dimension: node(id: $id) {
    __typename
    ... on Dimension {
      id
      name
      dataType
      shape
    }
    id
  }
}
`}}}();vm.hash="00f0d45ac038a51b4b30d9c5251f701e";async function XT(n){const{dimensionId:a}=n.params;return T.fetchQuery(he,vm,{id:a}).toPromise()}const ZT=()=>{const n=Tl(a=>a.defaultTab);return e(yo,{to:n,replace:!0})},Fm=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"id"},{defaultValue:null,kind:"LocalArgument",name:"timeRange"}],a=[{kind:"Variable",name:"id",variableName:"id"}],l={kind:"Variable",name:"timeRange",variableName:"timeRange"},t=[l];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ProjectPageQuery",selections:[{alias:"project",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"ProjectPageHeader_stats"},{args:null,kind:"FragmentSpread",name:"StreamToggle_data"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ProjectPageQuery",selections:[{alias:"project",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{kind:"InlineFragment",selections:[{alias:null,args:t,kind:"ScalarField",name:"traceCount",storageKey:null},{alias:null,args:t,kind:"ScalarField",name:"tokenCountTotal",storageKey:null},{alias:null,args:t,kind:"ScalarField",name:"tokenCountPrompt",storageKey:null},{alias:null,args:t,kind:"ScalarField",name:"tokenCountCompletion",storageKey:null},{alias:"latencyMsP50",args:[{kind:"Literal",name:"probability",value:.5},l],kind:"ScalarField",name:"latencyMsQuantile",storageKey:null},{alias:"latencyMsP99",args:[{kind:"Literal",name:"probability",value:.99},l],kind:"ScalarField",name:"latencyMsQuantile",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"spanAnnotationNames",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"documentEvaluationNames",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"streamingLastUpdatedAt",storageKey:null}],type:"Project",abstractKey:null}],storageKey:null}]},params:{cacheID:"6f2e474e767cd6efbff3c16e5bda0e88",id:null,metadata:{},name:"ProjectPageQuery",operationKind:"query",text:`query ProjectPageQuery(
  $id: ID!
  $timeRange: TimeRange!
) {
  project: node(id: $id) {
    __typename
    ...ProjectPageHeader_stats
    ...StreamToggle_data
    id
  }
}

fragment ProjectPageHeader_stats on Project {
  traceCount(timeRange: $timeRange)
  tokenCountTotal(timeRange: $timeRange)
  tokenCountPrompt(timeRange: $timeRange)
  tokenCountCompletion(timeRange: $timeRange)
  latencyMsP50: latencyMsQuantile(probability: 0.5, timeRange: $timeRange)
  latencyMsP99: latencyMsQuantile(probability: 0.99, timeRange: $timeRange)
  spanAnnotationNames
  documentEvaluationNames
  id
}

fragment StreamToggle_data on Project {
  streamingLastUpdatedAt
  id
}
`}}}();Fm.hash="f940b0d4a1ccd3cfc8bb67f22cd7ccc2";const Cm=function(){var n={defaultValue:null,kind:"LocalArgument",name:"id"},a={defaultValue:null,kind:"LocalArgument",name:"timeRange"},l=[{kind:"Variable",name:"id",variableName:"id"}],t={kind:"Variable",name:"timeRange",variableName:"timeRange"},i=[t];return{fragment:{argumentDefinitions:[n,a],kind:"Fragment",metadata:null,name:"ProjectPageHeaderQuery",selections:[{alias:null,args:l,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"ProjectPageHeader_stats"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[a,n],kind:"Operation",name:"ProjectPageHeaderQuery",selections:[{alias:null,args:l,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{kind:"InlineFragment",selections:[{alias:null,args:i,kind:"ScalarField",name:"traceCount",storageKey:null},{alias:null,args:i,kind:"ScalarField",name:"tokenCountTotal",storageKey:null},{alias:null,args:i,kind:"ScalarField",name:"tokenCountPrompt",storageKey:null},{alias:null,args:i,kind:"ScalarField",name:"tokenCountCompletion",storageKey:null},{alias:"latencyMsP50",args:[{kind:"Literal",name:"probability",value:.5},t],kind:"ScalarField",name:"latencyMsQuantile",storageKey:null},{alias:"latencyMsP99",args:[{kind:"Literal",name:"probability",value:.99},t],kind:"ScalarField",name:"latencyMsQuantile",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"spanAnnotationNames",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"documentEvaluationNames",storageKey:null}],type:"Project",abstractKey:null}],storageKey:null}]},params:{cacheID:"07dd4c3e5140047af720772d246e2f4c",id:null,metadata:{},name:"ProjectPageHeaderQuery",operationKind:"query",text:`query ProjectPageHeaderQuery(
  $timeRange: TimeRange
  $id: ID!
) {
  node(id: $id) {
    __typename
    ...ProjectPageHeader_stats
    id
  }
}

fragment ProjectPageHeader_stats on Project {
  traceCount(timeRange: $timeRange)
  tokenCountTotal(timeRange: $timeRange)
  tokenCountPrompt(timeRange: $timeRange)
  tokenCountCompletion(timeRange: $timeRange)
  latencyMsP50: latencyMsQuantile(probability: 0.5, timeRange: $timeRange)
  latencyMsP99: latencyMsQuantile(probability: 0.99, timeRange: $timeRange)
  spanAnnotationNames
  documentEvaluationNames
  id
}
`}}}();Cm.hash="e110b84031cc6bfa6bb37751b9c69765";const Km=function(){var n={kind:"Variable",name:"timeRange",variableName:"timeRange"},a=[n];return{argumentDefinitions:[{kind:"RootArgument",name:"timeRange"}],kind:"Fragment",metadata:{refetch:{connection:null,fragmentPathInResult:["node"],operation:Cm,identifierInfo:{identifierField:"id",identifierQueryVariableName:"id"}}},name:"ProjectPageHeader_stats",selections:[{alias:null,args:a,kind:"ScalarField",name:"traceCount",storageKey:null},{alias:null,args:a,kind:"ScalarField",name:"tokenCountTotal",storageKey:null},{alias:null,args:a,kind:"ScalarField",name:"tokenCountPrompt",storageKey:null},{alias:null,args:a,kind:"ScalarField",name:"tokenCountCompletion",storageKey:null},{alias:"latencyMsP50",args:[{kind:"Literal",name:"probability",value:.5},n],kind:"ScalarField",name:"latencyMsQuantile",storageKey:null},{alias:"latencyMsP99",args:[{kind:"Literal",name:"probability",value:.99},n],kind:"ScalarField",name:"latencyMsQuantile",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"spanAnnotationNames",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"documentEvaluationNames",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],type:"Project",abstractKey:null}}();Km.hash="e110b84031cc6bfa6bb37751b9c69765";const Tm=function(){var n={defaultValue:null,kind:"LocalArgument",name:"evaluationName"},a={defaultValue:null,kind:"LocalArgument",name:"id"},l={defaultValue:null,kind:"LocalArgument",name:"timeRange"},t=[{kind:"Variable",name:"id",variableName:"id"}],i=[{kind:"Variable",name:"evaluationName",variableName:"evaluationName"},{kind:"Variable",name:"timeRange",variableName:"timeRange"}];return{fragment:{argumentDefinitions:[n,a,l],kind:"Fragment",metadata:null,name:"DocumentEvaluationSummaryValueQuery",selections:[{alias:null,args:t,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:i,kind:"FragmentSpread",name:"DocumentEvaluationSummaryValueFragment"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[n,l,a],kind:"Operation",name:"DocumentEvaluationSummaryValueQuery",selections:[{alias:null,args:t,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{kind:"InlineFragment",selections:[{alias:null,args:i,concreteType:"DocumentEvaluationSummary",kind:"LinkedField",name:"documentEvaluationSummary",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"averageNdcg",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"averagePrecision",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"meanReciprocalRank",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hitRate",storageKey:null}],storageKey:null}],type:"Project",abstractKey:null}],storageKey:null}]},params:{cacheID:"129953ba27b24f48a92cca26e4b7c447",id:null,metadata:{},name:"DocumentEvaluationSummaryValueQuery",operationKind:"query",text:`query DocumentEvaluationSummaryValueQuery(
  $evaluationName: String!
  $timeRange: TimeRange!
  $id: ID!
) {
  node(id: $id) {
    __typename
    ...DocumentEvaluationSummaryValueFragment_1dJL9N
    id
  }
}

fragment DocumentEvaluationSummaryValueFragment_1dJL9N on Project {
  documentEvaluationSummary(evaluationName: $evaluationName, timeRange: $timeRange) {
    averageNdcg
    averagePrecision
    meanReciprocalRank
    hitRate
  }
  id
}
`}}}();Tm.hash="15d0652aa260c80f62acec943f615d93";const Pm={argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"evaluationName"},{defaultValue:null,kind:"LocalArgument",name:"timeRange"}],kind:"Fragment",metadata:{refetch:{connection:null,fragmentPathInResult:["node"],operation:Tm,identifierInfo:{identifierField:"id",identifierQueryVariableName:"id"}}},name:"DocumentEvaluationSummaryValueFragment",selections:[{alias:null,args:[{kind:"Variable",name:"evaluationName",variableName:"evaluationName"},{kind:"Variable",name:"timeRange",variableName:"timeRange"}],concreteType:"DocumentEvaluationSummary",kind:"LinkedField",name:"documentEvaluationSummary",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"averageNdcg",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"averagePrecision",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"meanReciprocalRank",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hitRate",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],type:"Project",abstractKey:null};Pm.hash="15d0652aa260c80f62acec943f615d93";const xm=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"evaluationName"},{defaultValue:null,kind:"LocalArgument",name:"id"},{defaultValue:null,kind:"LocalArgument",name:"timeRange"}],a=[{kind:"Variable",name:"id",variableName:"id"}],l=[{kind:"Variable",name:"evaluationName",variableName:"evaluationName"},{kind:"Variable",name:"timeRange",variableName:"timeRange"}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"DocumentEvaluationSummaryQuery",selections:[{alias:"project",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:l,kind:"FragmentSpread",name:"DocumentEvaluationSummaryValueFragment"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"DocumentEvaluationSummaryQuery",selections:[{alias:"project",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{kind:"InlineFragment",selections:[{alias:null,args:l,concreteType:"DocumentEvaluationSummary",kind:"LinkedField",name:"documentEvaluationSummary",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"averageNdcg",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"averagePrecision",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"meanReciprocalRank",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hitRate",storageKey:null}],storageKey:null}],type:"Project",abstractKey:null}],storageKey:null}]},params:{cacheID:"6f74fa682304c8e322329ebe91d73bf2",id:null,metadata:{},name:"DocumentEvaluationSummaryQuery",operationKind:"query",text:`query DocumentEvaluationSummaryQuery(
  $evaluationName: String!
  $id: ID!
  $timeRange: TimeRange!
) {
  project: node(id: $id) {
    __typename
    ...DocumentEvaluationSummaryValueFragment_1dJL9N
    id
  }
}

fragment DocumentEvaluationSummaryValueFragment_1dJL9N on Project {
  documentEvaluationSummary(evaluationName: $evaluationName, timeRange: $timeRange) {
    averageNdcg
    averagePrecision
    meanReciprocalRank
    hitRate
  }
  id
}
`}}}();xm.hash="6ec982057cc21ad195aa215a2118c5bc";function oC({evaluationName:n}){var i,r;const{projectId:a}=Qe(),{timeRange:l}=Ct(),t=T.useLazyLoadQuery(xm,{id:a,evaluationName:n,timeRange:{start:(i=l==null?void 0:l.start)==null?void 0:i.toISOString(),end:(r=l==null?void 0:l.end)==null?void 0:r.toISOString()}});return o(b,{direction:"column",flex:"none",children:[e(F,{elementType:"h3",size:"S",color:"text-700",children:n}),e(m.Suspense,{fallback:e(F,{size:"L",children:"--"}),children:e(sC,{evaluationName:n,project:t==null?void 0:t.project})})]})}function sC(n){var g,f,u,p;const{project:a}=n,{fetchKey:l}=qa(),[t,i]=T.useRefetchableFragment(Pm,a);m.useEffect(()=>{m.startTransition(()=>{i({},{fetchPolicy:"store-and-network"})})},[l,i]);const r=(g=t==null?void 0:t.documentEvaluationSummary)==null?void 0:g.averageNdcg,s=(f=t==null?void 0:t.documentEvaluationSummary)==null?void 0:f.averagePrecision,d=(u=t==null?void 0:t.documentEvaluationSummary)==null?void 0:u.hitRate,c=(p=t==null?void 0:t.documentEvaluationSummary)==null?void 0:p.meanReciprocalRank;return o(Ee,{delay:0,placement:"bottom",children:[e(nn,{children:e(b,{direction:"row",alignItems:"center",gap:"size-50",height:"28px",children:o(J,{children:[e(vn,{metric:"ndcg",score:r},"ndcg"),e(vn,{metric:"precision",score:s},"precision"),e(vn,{metric:"hit rate",score:d},"hit")]})})}),e(oa,{children:e(v,{width:"size-2400",children:o(b,{direction:"column",children:[o(b,{justifyContent:"space-between",children:[e(F,{children:"average ndcg"}),e(F,{children:typeof r=="number"?Wa(r):"--"})]}),o(b,{justifyContent:"space-between",children:[e(F,{children:"average precision"}),e(F,{children:typeof s=="number"?Wa(s):"--"})]}),o(b,{justifyContent:"space-between",children:[e(F,{children:"mean reciprocal rank"}),e(F,{children:typeof c=="number"?Wa(c):"--"})]}),o(b,{justifyContent:"space-between",children:[e(F,{children:"hit rate"}),e(F,{children:typeof d=="number"?Wa(d):"--"})]})]})})})]})}function dC(n){var p;const{extra:a}=n,{fetchKey:l}=qa(),[t,i]=T.useRefetchableFragment(Km,n.project);m.useEffect(()=>{m.startTransition(()=>{i({},{fetchPolicy:"store-and-network"})})},[l,i]);const r=t==null?void 0:t.latencyMsP50,s=t==null?void 0:t.latencyMsP99,d=t==null?void 0:t.tokenCountTotal,c=t==null?void 0:t.tokenCountPrompt,g=t==null?void 0:t.tokenCountCompletion,f=(p=t==null?void 0:t.spanAnnotationNames)==null?void 0:p.filter(y=>y!=="note"),u=t==null?void 0:t.documentEvaluationNames;return e(v,{paddingStart:"size-200",paddingEnd:"size-200",paddingTop:"size-200",paddingBottom:"size-50",flex:"none",children:o(b,{direction:"row",justifyContent:"space-between",alignItems:"center",children:[e("div",{css:K`
            overflow-x: auto;
            overflow-y: hidden;
            flex: 1 1 auto;
            background-image: linear-gradient(
                to right,
                var(--ac-global-color-grey-75),
                var(--ac-global-color-grey-75)
              ),
              linear-gradient(
                to right,
                var(--ac-global-color-grey-75),
                var(--ac-global-color-grey-75)
              ),
              linear-gradient(
                to right,
                rgba(var(--ac-global-color-grey-300-rgb), 0.9),
                rgba(var(--ac-global-color-grey-300-rgb), 0)
              ),
              linear-gradient(
                to left,
                rgba(var(--ac-global-color-grey-300-rgb), 0.9),
                rgba(var(--ac-global-color-grey-300-rgb), 0)
              );
            background-repeat: no-repeat;
            background-size:
              32px 100%,
              32px 100%,
              32px 100%,
              32px 100%;
            background-position:
              left center,
              right center,
              left center,
              right center;
            background-attachment: local, local, scroll, scroll;
          `,children:o(b,{direction:"row",gap:"size-400",alignItems:"center",children:[o(b,{direction:"column",flex:"none",children:[e(F,{elementType:"h3",size:"S",color:"text-700",children:"Total Traces"}),e(F,{size:"L",children:za(t==null?void 0:t.traceCount)})]}),o(b,{direction:"column",flex:"none",children:[e(F,{elementType:"h3",size:"S",color:"text-700",children:"Total Tokens"}),o(Ee,{delay:0,placement:"bottom",children:[e(nn,{children:e(F,{size:"L",children:za(d)})}),e(oa,{children:e(v,{width:"size-2400",children:o(b,{direction:"column",children:[o(b,{justifyContent:"space-between",children:[e(F,{children:"Prompt Tokens"}),e(F,{children:typeof c=="number"?Qt(c):"--"})]}),o(b,{justifyContent:"space-between",children:[e(F,{children:"Completion Tokens"}),e(F,{children:typeof g=="number"?Qt(g):"--"})]}),o(b,{justifyContent:"space-between",children:[e(F,{children:"Total Tokens"}),e(F,{children:typeof d=="number"?Qt(d):"--"})]})]})})})]})]}),o(b,{direction:"column",flex:"none",children:[e(F,{elementType:"h3",size:"S",color:"text-700",children:"Latency P50"}),r!=null?e(je,{latencyMs:r,size:"L"}):e(F,{size:"L",children:"--"})]}),o(b,{direction:"column",flex:"none",children:[e(F,{elementType:"h3",size:"S",color:"text-700",children:"Latency P99"}),s!=null?e(je,{latencyMs:s,size:"L"}):e(F,{size:"L",children:"--"})]}),f.map(y=>e(Tt,{fallback:Yf,children:e(gb,{annotationName:y},y)},y)),u.map(y=>e(oC,{evaluationName:y},`document-${y}`))]})}),e(v,{flex:"none",paddingStart:"size-100",children:a})]})})}const Im=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"StreamToggleRefetchQuery",selections:[{alias:null,args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"StreamToggle_data"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"StreamToggleRefetchQuery",selections:[{alias:null,args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"streamingLastUpdatedAt",storageKey:null}],type:"Project",abstractKey:null}],storageKey:null}]},params:{cacheID:"70bebe4abe808b13c94decf17c7cd90d",id:null,metadata:{},name:"StreamToggleRefetchQuery",operationKind:"query",text:`query StreamToggleRefetchQuery(
  $id: ID!
) {
  node(id: $id) {
    __typename
    ...StreamToggle_data
    id
  }
}

fragment StreamToggle_data on Project {
  streamingLastUpdatedAt
  id
}
`}}}();Im.hash="30a8f0bcf1aa6021b2c9a47866f5dc49";const Dm={argumentDefinitions:[],kind:"Fragment",metadata:{refetch:{connection:null,fragmentPathInResult:["node"],operation:Im,identifierInfo:{identifierField:"id",identifierQueryVariableName:"id"}}},name:"StreamToggle_data",selections:[{alias:null,args:null,kind:"ScalarField",name:"streamingLastUpdatedAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],type:"Project",abstractKey:null};Dm.hash="30a8f0bcf1aa6021b2c9a47866f5dc49";const cC=2e3,uC=["spans","traces","sessions"];function mC(n){const{isStreaming:a,setIsStreaming:l,setFetchKey:t}=qa(),r=al().pathname.split("/").pop()||"",s=uC.includes(r)&&a,[d,c]=T.useRefetchableFragment(Dm,n.project),g=m.useRef(d.streamingLastUpdatedAt),f=m.useCallback(()=>{s&&m.startTransition(()=>{c({},{fetchPolicy:"store-and-network"})})},[s,c]),u=d.streamingLastUpdatedAt;return m.useEffect(()=>{u!=null&&(g.current==null||g.current<u)&&(g.current=u,t(`fetch-traces-${u}`))},[t,u]),rb(f,cC),e(xa,{labelPlacement:"start",isSelected:a,onChange:()=>{l(!a)},children:"Stream"})}const gC=K`
  flex: 1 1 auto;
  display: flex;
  flex-direction: column;
  overflow: hidden;
  .ac-tabs {
    flex: 1 1 auto;
    overflow: hidden;
    display: flex;
    flex-direction: column;
    div[role="tablist"] {
      flex: none;
    }
    .ac-tabs__pane-container {
      flex: 1 1 auto;
      display: flex;
      flex-direction: column;
      overflow: hidden;
      div[role="tabpanel"]:not([hidden]) {
        flex: 1 1 auto;
        display: flex;
        flex-direction: column;
        overflow: hidden;
      }
    }
  }
`;function YT(){const{projectId:n}=Qe(),{timeRange:a}=Ct();return e(m.Suspense,{fallback:e(ge,{}),children:e(yC,{projectId:n,timeRange:a})})}const pC=["spans","traces","sessions","config"],ao=n=>pC.includes(n),lo={spans:0,traces:1,sessions:2,config:3};function yC({projectId:n,timeRange:a}){const l=Tl(V=>V.treatOrphansAsRoots),t=m.useMemo(()=>{var V,Q;return{start:(V=a==null?void 0:a.start)==null?void 0:V.toISOString(),end:(Q=a==null?void 0:a.end)==null?void 0:Q.toISOString()}},[a]),i=ce(),{rootPath:r,tab:s}=zt(),d=T.useLazyLoadQuery(Fm,{id:n,timeRange:t},{fetchPolicy:"store-and-network",fetchKey:`${n}-${t.start}-${t.end}`}),[c,g,f]=T.useQueryLoader($d),[u,p,y]=T.useQueryLoader(jd),[h,k,S]=T.useQueryLoader(Od),[C,P,L]=T.useQueryLoader(Qd),_=ao(s)?lo[s]:0;m.useEffect(()=>(_===0?p({id:n,timeRange:t,orphanSpanAsRootSpan:l}):_===1?g({id:n,timeRange:t}):_===2?k({id:n,timeRange:t}):_===3&&P({id:n}),()=>{y(),S(),f(),L()}),[g,n,t,_,y,S,f,p,k,P,L,l]);const w=m.useCallback(V=>{m.startTransition(()=>{i(V===1?`${r}/traces`:V===2?`${r}/sessions`:V===3?`${r}/config`:`${r}/spans`)})},[i,r]);return e(mb,{children:o("main",{css:gC,children:[e(dC,{project:d.project,extra:o(b,{direction:"row",alignItems:"center",gap:"size-100",children:[e(mC,{project:d.project}),e(mt,{})]})}),e(Bd.Provider,{value:{spansQueryReference:u??null,sessionsQueryReference:h??null,tracesQueryReference:c??null,projectConfigQueryReference:C??null},children:o(cn,{onSelectionChange:V=>{typeof V=="string"&&ao(V)&&w(lo[V])},selectedKey:s,children:[o(dn,{children:[e(le,{id:"spans",children:"Spans"}),e(le,{id:"traces",children:"Traces"}),e(le,{id:"sessions",children:"Sessions"}),e(le,{id:"config",children:"Config"})]}),e(re,{padded:!1,id:"spans",children:e(ve,{})}),e(re,{padded:!1,id:"traces",children:e(ve,{})}),e(re,{padded:!1,id:"sessions",children:e(ve,{})}),e(re,{padded:!1,id:"config",children:e(ve,{})})]})})]})})}const Lm=m.createContext(null);function _m(){const n=m.useContext(Lm);if(n===null)throw new Error("useSessionSubstring must be used within a SessionSubstringProvider");return n}function fC(n){const[a,l]=m.useState(""),t=m.useCallback(i=>{m.startTransition(()=>{l(i)})},[]);return e(Lm.Provider,{value:{filterIoSubstring:a,setFilterIoSubstring:t},children:n.children})}const Am=function(){var n={defaultValue:null,kind:"LocalArgument",name:"after"},a={defaultValue:null,kind:"LocalArgument",name:"filterIoSubstring"},l={defaultValue:30,kind:"LocalArgument",name:"first"},t={defaultValue:null,kind:"LocalArgument",name:"id"},i={defaultValue:{col:"startTime",dir:"desc"},kind:"LocalArgument",name:"sort"},r={defaultValue:null,kind:"LocalArgument",name:"timeRange"},s=[{kind:"Variable",name:"id",variableName:"id"}],d={kind:"Variable",name:"after",variableName:"after"},c={kind:"Variable",name:"filterIoSubstring",variableName:"filterIoSubstring"},g={kind:"Variable",name:"first",variableName:"first"},f={kind:"Variable",name:"sort",variableName:"sort"},u={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},p={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},y=[d,c,g,f,{kind:"Variable",name:"timeRange",variableName:"timeRange"}],h=[{alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null}];return{fragment:{argumentDefinitions:[n,a,l,t,i,r],kind:"Fragment",metadata:null,name:"SessionsTableQuery",selections:[{alias:null,args:s,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:[d,c,g,f],kind:"FragmentSpread",name:"SessionsTable_sessions"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[n,a,l,i,r,t],kind:"Operation",name:"SessionsTableQuery",selections:[{alias:null,args:s,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[u,p,{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:y,concreteType:"ProjectSessionConnection",kind:"LinkedField",name:"sessions",plural:!1,selections:[{alias:null,args:null,concreteType:"ProjectSessionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"session",args:null,concreteType:"ProjectSession",kind:"LinkedField",name:"node",plural:!1,selections:[p,{alias:null,args:null,kind:"ScalarField",name:"sessionId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"numTraces",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"endTime",storageKey:null},{alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"firstInput",plural:!1,selections:h,storageKey:null},{alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"lastOutput",plural:!1,selections:h,storageKey:null},{alias:null,args:null,concreteType:"TokenUsage",kind:"LinkedField",name:"tokenUsage",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"total",storageKey:null}],storageKey:null},{alias:"traceLatencyMsP50",args:[{kind:"Literal",name:"probability",value:.5}],kind:"ScalarField",name:"traceLatencyMsQuantile",storageKey:"traceLatencyMsQuantile(probability:0.5)"},{alias:"traceLatencyMsP99",args:[{kind:"Literal",name:"probability",value:.99}],kind:"ScalarField",name:"traceLatencyMsQuantile",storageKey:"traceLatencyMsQuantile(probability:0.99)"}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"ProjectSession",kind:"LinkedField",name:"node",plural:!1,selections:[u,p],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:y,filters:["sort","filterIoSubstring","timeRange"],handle:"connection",key:"SessionsTable_sessions",kind:"LinkedHandle",name:"sessions"}],type:"Project",abstractKey:null}],storageKey:null}]},params:{cacheID:"44404d501ccfaf7aba76d62aaa10371d",id:null,metadata:{},name:"SessionsTableQuery",operationKind:"query",text:`query SessionsTableQuery(
  $after: String = null
  $filterIoSubstring: String = null
  $first: Int = 30
  $sort: ProjectSessionSort = {col: startTime, dir: desc}
  $timeRange: TimeRange
  $id: ID!
) {
  node(id: $id) {
    __typename
    ...SessionsTable_sessions_2MhLSo
    id
  }
}

fragment SessionsTable_sessions_2MhLSo on Project {
  name
  sessions(first: $first, after: $after, sort: $sort, filterIoSubstring: $filterIoSubstring, timeRange: $timeRange) {
    edges {
      session: node {
        id
        sessionId
        numTraces
        startTime
        endTime
        firstInput {
          value
        }
        lastOutput {
          value
        }
        tokenUsage {
          total
        }
        traceLatencyMsP50: traceLatencyMsQuantile(probability: 0.5)
        traceLatencyMsP99: traceLatencyMsQuantile(probability: 0.99)
      }
      cursor
      node {
        __typename
        id
      }
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
  id
}
`}}}();Am.hash="827cd1cd4207ee9d2803d2768d0a52ab";const wm=function(){var n=["sessions"],a={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},l=[{alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null}];return{argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"after"},{defaultValue:null,kind:"LocalArgument",name:"filterIoSubstring"},{defaultValue:30,kind:"LocalArgument",name:"first"},{defaultValue:{col:"startTime",dir:"desc"},kind:"LocalArgument",name:"sort"},{kind:"RootArgument",name:"timeRange"}],kind:"Fragment",metadata:{connection:[{count:"first",cursor:"after",direction:"forward",path:n}],refetch:{connection:{forward:{count:"first",cursor:"after"},backward:null,path:n},fragmentPathInResult:["node"],operation:Am,identifierInfo:{identifierField:"id",identifierQueryVariableName:"id"}}},name:"SessionsTable_sessions",selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:"sessions",args:[{kind:"Variable",name:"filterIoSubstring",variableName:"filterIoSubstring"},{kind:"Variable",name:"sort",variableName:"sort"},{kind:"Variable",name:"timeRange",variableName:"timeRange"}],concreteType:"ProjectSessionConnection",kind:"LinkedField",name:"__SessionsTable_sessions_connection",plural:!1,selections:[{alias:null,args:null,concreteType:"ProjectSessionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"session",args:null,concreteType:"ProjectSession",kind:"LinkedField",name:"node",plural:!1,selections:[a,{alias:null,args:null,kind:"ScalarField",name:"sessionId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"numTraces",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"endTime",storageKey:null},{alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"firstInput",plural:!1,selections:l,storageKey:null},{alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"lastOutput",plural:!1,selections:l,storageKey:null},{alias:null,args:null,concreteType:"TokenUsage",kind:"LinkedField",name:"tokenUsage",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"total",storageKey:null}],storageKey:null},{alias:"traceLatencyMsP50",args:[{kind:"Literal",name:"probability",value:.5}],kind:"ScalarField",name:"traceLatencyMsQuantile",storageKey:"traceLatencyMsQuantile(probability:0.5)"},{alias:"traceLatencyMsP99",args:[{kind:"Literal",name:"probability",value:.99}],kind:"ScalarField",name:"traceLatencyMsQuantile",storageKey:"traceLatencyMsQuantile(probability:0.99)"}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"ProjectSession",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},a],type:"Project",abstractKey:null}}();wm.hash="827cd1cd4207ee9d2803d2768d0a52ab";const Rm=m.createContext(null);function hC({children:n,...a}){const[l]=m.useState(()=>eh(a));return e(Rm.Provider,{value:l,children:n})}function en(n,a){const l=m.useContext(Rm);if(!l)throw new Error("Missing TracingContext.Provider in the tree");return Ll(l,n,a)}const kC=K`
  flex: 1 1 auto;
  .cm-content {
    padding: var(--ac-global-dimension-static-size-100) 0;
  }
  .cm-editor {
    background-color: transparent !important;
  }
  .cm-focused {
    outline: none;
  }
  .cm-selectionLayer .cm-selectionBackground {
    background: var(--ac-global-color-cyan-400) !important;
  }
`,bC=K`
  border-width: var(--ac-global-border-size-thin);
  border-style: solid;
  border-color: var(--ac-global-input-field-border-color);
  border-radius: var(--ac-global-rounding-small);
  background-color: var(--ac-global-input-field-background-color);
  transition: all 0.2s ease-in-out;
  overflow-x: hidden;
  &:hover,
  &[data-is-focused="true"] {
    border-color: var(--ac-global-input-field-border-color-active);
    background-color: var(--ac-global-input-field-background-color-active);
  }
  &[data-is-invalid="true"] {
    border-color: var(--ac-global-color-danger);
  }
  box-sizing: border-box;
`;function SC(n){const{placeholder:a="Search messages"}=n,[l,t]=m.useState(!1),{filterIoSubstring:i,setFilterIoSubstring:r}=_m(),{theme:s}=ca();return e("div",{"data-is-focused":l,className:"sessions-substring-field",css:bC,children:o(b,{direction:"row",children:[e(fi,{children:e(I,{svg:e(Mi,{})})}),e(wa,{css:kC,indentWithTab:!1,basicSetup:{lineNumbers:!1,foldGutter:!1,bracketMatching:!1,syntaxHighlighting:!1,highlightActiveLine:!1,highlightActiveLineGutter:!1,defaultKeymap:!1},onFocus:()=>t(!0),onBlur:()=>t(!1),value:i,onChange:r,height:"36px",width:"100%",theme:s==="light"?_a:Aa,placeholder:a}),e("button",{css:K`
            margin-right: var(--ac-global-dimension-static-size-100);
            color: var(--ac-global-text-color-700);
            visibility: ${i!==""?"visible":"hidden"};
          `,onClick:()=>r(""),className:"button--reset",children:e(I,{svg:e(Dt,{})})})]})})}const vC="pip install openinference-instrumentation",FC=`import uuid

import openai
from openinference.instrumentation import using_session
from openinference.semconv.trace import SpanAttributes
from opentelemetry import trace

client = openai.Client()
session_id = str(uuid.uuid4())

tracer = trace.get_tracer(__name__)

@tracer.start_as_current_span(name="agent", attributes={SpanAttributes.OPENINFERENCE_SPAN_KIND: "agent"})
def assistant(
  messages: list[dict],
  session_id: str = str,
):
  current_span = trace.get_current_span()
  current_span.set_attribute(SpanAttributes.SESSION_ID, session_id)
  current_span.set_attribute(SpanAttributes.INPUT_VALUE, messages[-1].get('content'))

  # Propagate the session_id down to spans crated by the OpenAI instrumentation
  # This is not strictly necessary, but it helps to correlate the spans to the same session
  with using_session(session_id):
   response = client.chat.completions.create(
       model="gpt-3.5-turbo",
       messages=[{"role": "system", "content": "You are a helpful assistant."}] + messages,
   ).choices[0].message

  current_span.set_attribute(SpanAttributes.OUTPUT_VALUE, response.content)
  return response

messages = [
  {"role": "user", "content": "hi! im bob"}
]
response = assistant(
  messages,
  session_id=session_id,
)
messages = messages + [
  response,
  {"role": "user", "content": "what's my name?"}
]
response = assistant(
  messages,
  session_id=session_id,
)`;function CC(){return o("div",{children:[e(v,{paddingTop:"size-200",paddingBottom:"size-100",children:e(ae,{level:2,weight:"heavy",children:"Install Dependencies"})}),e(v,{paddingBottom:"size-100",children:o(F,{children:["Sessions are tracked via the OpenTelemetry attribute ",e("b",{children:"session.id"}),". The easiest way to get started with sessions is to use the OpenInference instrumentation package."]})}),e(Ue,{children:e(Mn,{value:vC})}),e(v,{paddingTop:"size-200",paddingBottom:"size-100",children:e(ae,{level:2,weight:"heavy",children:"Add Session ID to your Traces"})}),e(v,{paddingBottom:"size-100",children:e(F,{children:"Below is an example of how to add session IDs to a simple OpenAI application."})}),e(Ue,{children:e(Mn,{value:FC})}),e(v,{paddingBottom:"size-100",paddingTop:"size-100",children:o(F,{children:["For more information on how to use sessions, consult the"," ",e(_n,{href:"https://arize.com/docs/phoenix/tracing/how-to-tracing/setup-sessions",children:"documentation"})]})})]})}const KC="npm install @arizeai/openinference-core --save",TC=`import { trace } from "@opentelemetry/api";
import { SemanticConventions } from "@arizeai/openinference-semantic-conventions";
import { context } from "@opentelemetry/api";
import { setSession } from "@arizeai/openinference-core";

const tracer = trace.getTracer("agent");

const client = new OpenAI({
  apiKey: process.env["OPENAI_API_KEY"], // This is the default and can be omitted
});

async function assistant(params: {
  messages: { role: string; content: string }[];
  sessionId: string;
}) {
  return tracer.startActiveSpan("agent", async (span: Span) => {
    span.setAttribute(SemanticConventions.OPENINFERENCE_SPAN_KIND, "agent");
    span.setAttribute(SemanticConventions.SESSION_ID, params.sessionId);
    span.setAttribute(
      SemanticConventions.INPUT_VALUE,
      messages[messages.length - 1].content,
    );
    try {
      // This is not strictly necessary but it helps propagate the session ID
      // to all child spans
      return context.with(
        setSession(context.active(), { sessionId: params.sessionId }),
        async () => {
          // Calls within this block will generate spans with the session ID set
          const chatCompletion = await client.chat.completions.create({
            messages: params.messages,
            model: "gpt-3.5-turbo",
          });
          const response = chatCompletion.choices[0].message;
          span.setAttribute(SemanticConventions.OUTPUT_VALUE, response.content);
          span.end();
          return response;
        },
      );
    } catch (e) {
      span.error(e);
    }
  });
}

const sessionId = crypto.randomUUID();

let messages = [{ role: "user", content: "hi! im Tim" }];

const res = await assistant({
  messages,
  sessionId: sessionId,
});

messages = [res, { role: "assistant", content: "What is my name?" }];

await assistant({
  messages,
  sessionId: sessionId,
});
`;function PC(){return o("div",{children:[e(v,{paddingTop:"size-200",paddingBottom:"size-100",children:e(ae,{level:2,weight:"heavy",children:"Install Dependencies"})}),e(v,{paddingBottom:"size-100",children:o(F,{children:["Sessions are tracked via the OpenTelemetry attribute ",e("b",{children:"session.id"}),". The easiest way to get started with sessions is to use the OpenInference instrumentation package."]})}),e(Ue,{children:e(Mn,{value:KC})}),e(v,{paddingTop:"size-200",paddingBottom:"size-100",children:e(ae,{level:2,weight:"heavy",children:"Add Session ID to your Traces"})}),e(v,{paddingBottom:"size-100",children:e(F,{children:"Below is an example of how to add session IDs to a simple OpenAI application."})}),e(Ue,{children:e(Yl,{value:TC})}),e(v,{paddingBottom:"size-100",children:o(F,{children:["For more information on how to use sessions, consult the"," ",e(_n,{href:"https://arize.com/docs/phoenix/tracing/how-to-tracing/setup-sessions",children:"documentation"})]})})]})}function xC(){const[n,a]=m.useState("Python");return e(oe,{title:"Setup Sessions for this Project",size:"L",children:o(v,{padding:"size-400",overflow:"auto",children:[e(v,{paddingBottom:"size-100",children:e(tl,{language:n,onChange:a})}),n==="Python"?e(CC,{}):e(PC,{})]})})}function IC(){const[n,a]=m.useState(null),l=()=>{a(e(xC,{}))};return o("tbody",{className:"is-empty",children:[e("tr",{children:e("td",{colSpan:100,css:K`
            text-align: center;
            padding: var(--ac-global-dimension-size-300)
              var(--ac-global-dimension-size-300) !important;
          `,children:o(b,{direction:"column",gap:"size-200",alignItems:"center",children:["No sessions found for this project",e(M,{leadingVisual:e(I,{svg:e(Da,{})}),onPress:l,children:"Setup Sessions"})]})})}),e(ue,{onDismiss:()=>a(null),isDismissable:!0,type:"slideOver",children:n})]})}const rr=K`
  display: flex;
  flex-direction: column;
  flex: 1 1 auto;
  overflow: hidden;
  .span-filter-condition-field {
    flex: 1 1 auto;
  }

  // Style the column selector
  .ac-dropdown-button {
    min-width: var(--ac-global-dimension-static-size-300);
  }
`,to=Bi,Em=({table:n})=>{const a=ce();return e("tbody",{children:n.getRowModel().rows.map(l=>e("tr",{onClick:()=>a(`${encodeURIComponent(l.id)}`),children:l.getVisibleCells().map(t=>e("td",{style:{width:`calc(var(--col-${t.column.id}-size) * 1px)`,maxWidth:`calc(var(--col-${t.column.id}-size) * 1px)`,textWrap:"nowrap",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:W(t.column.columnDef.cell,t.getContext())},t.id))},l.id))})},DC=fn.memo(Em,(n,a)=>n.table.options.data===a.table.options.data);function LC(n){const a=m.useRef(null),[l,t]=m.useState([]),{filterIoSubstring:i}=_m(),{fetchKey:r}=qa(),{data:s,loadNext:d,hasNext:c,isLoadingNext:g,refetch:f}=T.usePaginationFragment(wm,n.project),u=m.useMemo(()=>s.sessions.edges.map(({session:z})=>({...z,tokenCountTotal:z.tokenUsage.total})),[s.sessions]),p=[{header:"session id",accessorKey:"sessionId",enableSorting:!1,cell:Re},{header:"first input",accessorKey:"firstInput.value",enableSorting:!1,cell:Re},{header:"last output",accessorKey:"lastOutput.value",enableSorting:!1,cell:Re},{header:"start time",accessorKey:"startTime",enableSorting:!0,cell:_e},{header:"end time",accessorKey:"endTime",enableSorting:!0,cell:_e},{header:"p50 latency",accessorKey:"traceLatencyMsP50",enableSorting:!1,cell:({getValue:z})=>{const N=z();return N===null||typeof N!="number"?null:e(je,{latencyMs:N})}},{header:"p99 latency",accessorKey:"traceLatencyMsP99",enableSorting:!1,cell:({getValue:z})=>{const N=z();return N===null||typeof N!="number"?null:e(je,{latencyMs:N})}},{header:"total tokens",accessorKey:"tokenCountTotal",enableSorting:!0,minSize:80,cell:({row:z,getValue:N})=>{const j=N();return j==null||typeof j!="number"?"--":e(La,{tokenCountTotal:j,nodeId:z.original.id})}},{header:"total traces",accessorKey:"numTraces",enableSorting:!0,cell:ss}];m.useEffect(()=>{const z=l[0];m.startTransition(()=>{f({sort:z?{col:z.id,dir:z.desc?"desc":"asc"}:{col:"startTime",dir:"desc"},after:null,first:to,filterIoSubstring:i},{fetchPolicy:"store-and-network"})})},[l,f,i,r]);const y=fn.useCallback(z=>{if(z){const{scrollHeight:N,scrollTop:j,clientHeight:Z}=z;N-j-Z<300&&!g&&c&&d(to)}},[c,g,d]),[h,k]=m.useState({}),S=en(z=>z.columnVisibility),C=en(z=>z.columnSizing),P=en(z=>z.setColumnSizing),L=Ce({columns:p,data:u,onExpandedChange:k,manualSorting:!0,state:{sorting:l,expanded:h,columnVisibility:S,columnSizing:C},columnResizeMode:"onChange",onColumnSizingChange:P,enableSubRowSelection:!1,onSortingChange:t,getCoreRowModel:Ke(),getSortedRowModel:ln(),getExpandedRowModel:fo(),getRowId:z=>z.id}),w=L.getRowModel().rows.length===0,{columnSizingInfo:V,columnSizing:Q}=L.getState(),x=L.getFlatHeaders,R=p.length,A=fn.useMemo(()=>{const z=x(),N={};for(let j=0;j<z.length;j++){const Z=z[j];N[`--header-${Z.id}-size`]=Z.getSize(),N[`--col-${Z.column.id}-size`]=Z.column.getSize()}return N},[x,V,Q,R]);return o("div",{css:rr,children:[e(v,{paddingTop:"size-100",paddingBottom:"size-100",paddingStart:"size-200",paddingEnd:"size-200",borderBottomColor:"grey-300",borderBottomWidth:"thin",flex:"none",children:e(SC,{})}),e("div",{css:K`
          flex: 1 1 auto;
          overflow: auto;
        `,onScroll:z=>y(z.target),ref:a,children:o("table",{css:Un,style:{...A,width:L.getTotalSize(),minWidth:"100%"},children:[e("thead",{children:L.getHeaderGroups().map(z=>e("tr",{children:z.headers.map(N=>e("th",{style:{width:`calc(var(--header-${N.id}-size) * 1px)`},children:N.isPlaceholder?null:o(J,{children:[o("div",{"data-sortable":N.column.getCanSort(),className:N.column.getCanSort()?"sort":"",onClick:N.column.getToggleSortingHandler(),style:{left:N.getStart(),width:N.getSize()},children:[W(N.column.columnDef.header,N.getContext()),N.column.getIsSorted()?e(I,{className:"sort-icon",svg:N.column.getIsSorted()==="asc"?e(Xe,{}):e(Ze,{})}):null]}),e("div",{onMouseDown:N.getResizeHandler(),onTouchStart:N.getResizeHandler(),className:`resizer ${N.column.getIsResizing()?"isResizing":""}`})]})},N.id))},z.id))}),w?e(IC,{}):V.isResizingColumn?e(DC,{table:L}):e(Em,{table:L})]})})]})}function or({children:n}){const{projectId:a}=Qe();if(!a)throw new Error("projectId is required");const{tab:l}=zt();if(!Ld(l))throw new Error(`Invalid tab: ${l}`);return e(hC,{projectId:a,tableId:l||"table",children:n})}function _C({queryReference:n}){const a=T.usePreloadedQuery(Od,n);return e(fC,{children:e(LC,{project:a.project})})}const eP=()=>{const{sessionsQueryReference:n}=At();return n?o(or,{children:[e(nr,{children:e(m.Suspense,{fallback:e(ge,{}),children:e(_C,{queryReference:n})})}),e(m.Suspense,{children:e(ve,{})})]}):null},Mm=function(){var n={defaultValue:null,kind:"LocalArgument",name:"after"},a={defaultValue:null,kind:"LocalArgument",name:"filterCondition"},l={defaultValue:30,kind:"LocalArgument",name:"first"},t={defaultValue:null,kind:"LocalArgument",name:"id"},i={defaultValue:null,kind:"LocalArgument",name:"orphanSpanAsRootSpan"},r={defaultValue:!0,kind:"LocalArgument",name:"rootSpansOnly"},s={defaultValue:{col:"startTime",dir:"desc"},kind:"LocalArgument",name:"sort"},d={defaultValue:null,kind:"LocalArgument",name:"timeRange"},c=[{kind:"Variable",name:"id",variableName:"id"}],g={kind:"Variable",name:"after",variableName:"after"},f={kind:"Variable",name:"filterCondition",variableName:"filterCondition"},u={kind:"Variable",name:"first",variableName:"first"},p={kind:"Variable",name:"rootSpansOnly",variableName:"rootSpansOnly"},y={kind:"Variable",name:"sort",variableName:"sort"},h={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},k={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},S={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},C=[g,f,u,{kind:"Variable",name:"orphanSpanAsRootSpan",variableName:"orphanSpanAsRootSpan"},p,y,{kind:"Variable",name:"timeRange",variableName:"timeRange"}],P=[{alias:"value",args:null,kind:"ScalarField",name:"truncatedValue",storageKey:null}],L={alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},_={alias:null,args:null,kind:"ScalarField",name:"score",storageKey:null};return{fragment:{argumentDefinitions:[n,a,l,t,i,r,s,d],kind:"Fragment",metadata:null,name:"SpansTableSpansQuery",selections:[{alias:null,args:c,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:[g,f,u,p,y],kind:"FragmentSpread",name:"SpansTable_spans"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[n,a,l,i,r,s,d,t],kind:"Operation",name:"SpansTableSpansQuery",selections:[{alias:null,args:c,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[h,k,{kind:"InlineFragment",selections:[S,{alias:null,args:null,kind:"ScalarField",name:"spanAnnotationNames",storageKey:null},{alias:null,args:C,concreteType:"SpanConnection",kind:"LinkedField",name:"spans",plural:!1,selections:[{alias:null,args:null,concreteType:"SpanEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"span",args:null,concreteType:"Span",kind:"LinkedField",name:"node",plural:!1,selections:[k,{alias:null,args:null,kind:"ScalarField",name:"spanKind",storageKey:null},S,{alias:null,args:null,kind:"ScalarField",name:"metadata",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"statusCode",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"latencyMs",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"tokenCountTotal",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cumulativeTokenCountTotal",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"spanId",storageKey:null},{alias:null,args:null,concreteType:"Trace",kind:"LinkedField",name:"trace",plural:!1,selections:[k,{alias:null,args:null,kind:"ScalarField",name:"traceId",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"input",plural:!1,selections:P,storageKey:null},{alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"output",plural:!1,selections:P,storageKey:null},{alias:null,args:null,concreteType:"SpanAnnotation",kind:"LinkedField",name:"spanAnnotations",plural:!0,selections:[k,S,L,_,{alias:null,args:null,kind:"ScalarField",name:"annotatorKind",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"user",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"username",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"profilePictureUrl",storageKey:null},k],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"AnnotationSummary",kind:"LinkedField",name:"spanAnnotationSummaries",plural:!0,selections:[{alias:null,args:null,concreteType:"LabelFraction",kind:"LinkedField",name:"labelFractions",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"fraction",storageKey:null},L],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"meanScore",storageKey:null},S],storageKey:null},{alias:null,args:null,concreteType:"DocumentRetrievalMetrics",kind:"LinkedField",name:"documentRetrievalMetrics",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"evaluationName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"ndcg",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"precision",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hit",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"project",plural:!1,selections:[k,{alias:null,args:null,concreteType:"AnnotationConfigConnection",kind:"LinkedField",name:"annotationConfigs",plural:!1,selections:[{alias:null,args:null,concreteType:"AnnotationConfigEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[h,{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"annotationType",storageKey:null}],type:"AnnotationConfigBase",abstractKey:"__isAnnotationConfigBase"},{kind:"InlineFragment",selections:[k,S,{alias:null,args:null,kind:"ScalarField",name:"optimizationDirection",storageKey:null},{alias:null,args:null,concreteType:"CategoricalAnnotationValue",kind:"LinkedField",name:"values",plural:!0,selections:[L,_],storageKey:null}],type:"CategoricalAnnotationConfig",abstractKey:null},{kind:"InlineFragment",selections:[k],type:"Node",abstractKey:"__isNode"}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"Span",kind:"LinkedField",name:"node",plural:!1,selections:[h,k],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:C,filters:["sort","rootSpansOnly","filterCondition","orphanSpanAsRootSpan","timeRange"],handle:"connection",key:"SpansTable_spans",kind:"LinkedHandle",name:"spans"}],type:"Project",abstractKey:null}],storageKey:null}]},params:{cacheID:"fc79d02f18fbddd3427e6290828530b7",id:null,metadata:{},name:"SpansTableSpansQuery",operationKind:"query",text:`query SpansTableSpansQuery(
  $after: String = null
  $filterCondition: String = null
  $first: Int = 30
  $orphanSpanAsRootSpan: Boolean
  $rootSpansOnly: Boolean = true
  $sort: SpanSort = {col: startTime, dir: desc}
  $timeRange: TimeRange
  $id: ID!
) {
  node(id: $id) {
    __typename
    ...SpansTable_spans_xYL0c
    id
  }
}

fragment AnnotationSummaryGroup on Span {
  project {
    id
    annotationConfigs {
      edges {
        node {
          __typename
          ... on AnnotationConfigBase {
            __isAnnotationConfigBase: __typename
            annotationType
          }
          ... on CategoricalAnnotationConfig {
            id
            name
            optimizationDirection
            values {
              label
              score
            }
          }
          ... on Node {
            __isNode: __typename
            id
          }
        }
      }
    }
  }
  spanAnnotations {
    id
    name
    label
    score
    annotatorKind
    createdAt
    user {
      username
      profilePictureUrl
      id
    }
  }
  spanAnnotationSummaries {
    labelFractions {
      fraction
      label
    }
    meanScore
    name
  }
}

fragment SpanColumnSelector_annotations on Project {
  spanAnnotationNames
}

fragment SpansTable_spans_xYL0c on Project {
  name
  ...SpanColumnSelector_annotations
  spans(first: $first, after: $after, sort: $sort, rootSpansOnly: $rootSpansOnly, filterCondition: $filterCondition, orphanSpanAsRootSpan: $orphanSpanAsRootSpan, timeRange: $timeRange) {
    edges {
      span: node {
        id
        spanKind
        name
        metadata
        statusCode
        startTime
        latencyMs
        tokenCountTotal
        cumulativeTokenCountTotal
        spanId
        trace {
          id
          traceId
        }
        input {
          value: truncatedValue
        }
        output {
          value: truncatedValue
        }
        spanAnnotations {
          id
          name
          label
          score
          annotatorKind
          createdAt
        }
        spanAnnotationSummaries {
          labelFractions {
            fraction
            label
          }
          meanScore
          name
        }
        documentRetrievalMetrics {
          evaluationName
          ndcg
          precision
          hit
        }
        ...AnnotationSummaryGroup
      }
      cursor
      node {
        __typename
        id
      }
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
  id
}
`}}}();Mm.hash="50778371684f1bd53a53c5bbeb7a6715";const Vm=function(){var n=["spans"],a={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},t=[{alias:"value",args:null,kind:"ScalarField",name:"truncatedValue",storageKey:null}],i={alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null};return{argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"after"},{defaultValue:null,kind:"LocalArgument",name:"filterCondition"},{defaultValue:30,kind:"LocalArgument",name:"first"},{kind:"RootArgument",name:"orphanSpanAsRootSpan"},{defaultValue:!0,kind:"LocalArgument",name:"rootSpansOnly"},{defaultValue:{col:"startTime",dir:"desc"},kind:"LocalArgument",name:"sort"},{kind:"RootArgument",name:"timeRange"}],kind:"Fragment",metadata:{connection:[{count:"first",cursor:"after",direction:"forward",path:n}],refetch:{connection:{forward:{count:"first",cursor:"after"},backward:null,path:n},fragmentPathInResult:["node"],operation:Mm,identifierInfo:{identifierField:"id",identifierQueryVariableName:"id"}}},name:"SpansTable_spans",selections:[a,{args:null,kind:"FragmentSpread",name:"SpanColumnSelector_annotations"},{alias:"spans",args:[{kind:"Variable",name:"filterCondition",variableName:"filterCondition"},{kind:"Variable",name:"orphanSpanAsRootSpan",variableName:"orphanSpanAsRootSpan"},{kind:"Variable",name:"rootSpansOnly",variableName:"rootSpansOnly"},{kind:"Variable",name:"sort",variableName:"sort"},{kind:"Variable",name:"timeRange",variableName:"timeRange"}],concreteType:"SpanConnection",kind:"LinkedField",name:"__SpansTable_spans_connection",plural:!1,selections:[{alias:null,args:null,concreteType:"SpanEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"span",args:null,concreteType:"Span",kind:"LinkedField",name:"node",plural:!1,selections:[l,{alias:null,args:null,kind:"ScalarField",name:"spanKind",storageKey:null},a,{alias:null,args:null,kind:"ScalarField",name:"metadata",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"statusCode",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"latencyMs",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"tokenCountTotal",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cumulativeTokenCountTotal",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"spanId",storageKey:null},{alias:null,args:null,concreteType:"Trace",kind:"LinkedField",name:"trace",plural:!1,selections:[l,{alias:null,args:null,kind:"ScalarField",name:"traceId",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"input",plural:!1,selections:t,storageKey:null},{alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"output",plural:!1,selections:t,storageKey:null},{alias:null,args:null,concreteType:"SpanAnnotation",kind:"LinkedField",name:"spanAnnotations",plural:!0,selections:[l,a,i,{alias:null,args:null,kind:"ScalarField",name:"score",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"annotatorKind",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"AnnotationSummary",kind:"LinkedField",name:"spanAnnotationSummaries",plural:!0,selections:[{alias:null,args:null,concreteType:"LabelFraction",kind:"LinkedField",name:"labelFractions",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"fraction",storageKey:null},i],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"meanScore",storageKey:null},a],storageKey:null},{alias:null,args:null,concreteType:"DocumentRetrievalMetrics",kind:"LinkedField",name:"documentRetrievalMetrics",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"evaluationName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"ndcg",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"precision",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hit",storageKey:null}],storageKey:null},{args:null,kind:"FragmentSpread",name:"AnnotationSummaryGroup"}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"Span",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},l],type:"Project",abstractKey:null}}();Vm.hash="50778371684f1bd53a53c5bbeb7a6715";const AC=K`
  border-radius: var(--ac-global-dimension-size-50);
  border: 1px solid var(--ac-global-color-grey-200);
  padding: var(--ac-global-dimension-size-50)
    var(--ac-global-dimension-size-100);
  transition: background-color 0.2s;

  &[role="button"] {
    cursor: pointer;
    &:hover {
      background-color: var(--ac-global-color-grey-200);
      border-color: var(--ac-global-color-grey-400);
    }
  }
  max-width: 100%;
  height: var(--ac-global-dimension-size-200);
`;function wC({metadata:n,onClick:a}){const l=m.useMemo(()=>{let t=n;return t.startsWith("{")&&(t=t.slice(1)),t.endsWith("}")&&(t=t.slice(0,-1)),t},[n]);return e("div",{css:K(AC),role:a?"button":"label","aria-label":"metadata",onClick:t=>{t.stopPropagation(),t.preventDefault(),a==null||a()},children:e(b,{direction:"row",justifyContent:"space-between",alignItems:"center",height:"100%",children:e(an,{maxWidth:"100%",children:e(F,{children:l})})})})}function RC(n){return n.replaceAll(`
`,"\\n").replaceAll('"','\\"')}function EC(n){return typeof n=="boolean"?n?"True":"False":typeof n=="number"?n.toString():typeof n=="string"?`"${RC(n)}"`:""}const zm=(n,a)=>`metadata${n.split(".").map(i=>/^\d+$/.test(i)?`[${i}]`:`['${i}']`).join("")} == ${EC(a)}`;function MC({children:n,metadata:a,width:l}){const{appendFilterCondition:t}=Vt(),i=Object.entries(a).map(([r,s])=>({key:r,value:String(s),filterCondition:zm(r,s)}));return o(Ee,{delay:500,offset:3,children:[e(nn,{children:n}),e(oa,{UNSAFE_style:{minWidth:l},children:o(b,{direction:"row",wrap:"nowrap",gap:"size-100",children:[e(b,{flexBasis:"40%",children:o(b,{direction:"column",gap:"size-100",width:"100%",children:[e(F,{weight:"heavy",children:"Metadata"}),e("ul",{css:K`
                  display: flex;
                  flex-direction: column;
                  gap: var(--ac-global-dimension-size-100);
                  overflow-y: auto;
                  max-height: 200px;
                  scrollbar-gutter: stable;
                  padding-right: var(--ac-global-dimension-size-50);
                `,children:i.map(({key:r,value:s})=>e("li",{children:o(b,{direction:"row",gap:"size-100",children:[e(b,{flexBasis:"30%",width:0,children:e(an,{maxWidth:"100%",children:e(F,{weight:"heavy",color:"inherit",size:"XS",children:r})})}),e(b,{flexBasis:"70%",flexShrink:1,justifyContent:"end",width:0,children:e(an,{maxWidth:"100%",children:e(F,{color:"inherit",size:"XS",maxWidth:"100%",children:s})})})]})},r))})]})}),e(v,{borderColor:"dark",paddingStart:"size-200",paddingEnd:"size-100",marginStart:"size-200",flexBasis:"60%",borderStartWidth:"thin",children:o(b,{direction:"column",gap:"size-100",width:"100%",children:[e(F,{weight:"heavy",children:"Filters"}),e("ul",{css:K`
                  display: flex;
                  flex-direction: row;
                  gap: var(--ac-global-dimension-size-100);
                  padding: var(--ac-global-dimension-size-50) 0;
                  flex-wrap: wrap;
                `,children:i.map(({key:r,filterCondition:s})=>e("li",{children:o("button",{onClick:d=>{d.preventDefault(),d.stopPropagation(),t(s)},css:K`
                        all: unset;
                        color: var(--ac-global-text-color-900);
                        border: 1px solid var(--ac-global-color-grey-300);
                        border-radius: 4px;
                        padding: var(--ac-global-dimension-size-50)
                          var(--ac-global-dimension-size-100);
                        cursor: pointer;
                        transition: background-color 0.2s;
                        &:hover {
                          background-color: var(--ac-global-color-gray-300);
                        }
                      `,children:["Match ",r]})},r))})]})})]})})]})}const Nm=({metadata:n})=>{const{appendFilterCondition:a}=Vt(),[l,t]=m.useMemo(()=>{try{if(typeof n!="string")throw new Error("Metadata is not a string");const i=nh(n),r=JSON.stringify(i);if(Object.keys(i).length===0)throw new Error("Metadata is empty");return[i,r]}catch{return[null,null]}},[n]);return!l||!t?"--":e("div",{style:{maxWidth:"100%"},children:e(MC,{width:"800px",metadata:l,children:e(wC,{metadata:t,onClick:()=>{const[i,r]=Object.entries(l)[0],s=zm(i,r);a(s)}})})})};function VC(){const n=Tl(l=>l.treatOrphansAsRoots),a=Tl(l=>l.setTreatOrphansAsRoots);return o(Ne,{children:[e(M,{size:"M","aria-label":"Filter Configuration",leadingVisual:e(I,{svg:e(ah,{})})}),o(la,{children:[e(Yo,{}),e(He,{children:e(v,{padding:"size-100",children:e(b,{direction:"column",gap:"size-100",children:e(xa,{isSelected:n,onChange:l=>{a(l)},children:"Treat Orphan Spans as Roots"})})})})]})]})}function zC({projectName:n}){const[a,l]=m.useState("Python");return e(oe,{title:"Send Traces to this Project",size:"L",children:o(v,{padding:"size-400",overflow:"auto",children:[e(v,{paddingBottom:"size-100",children:e(tl,{language:a,onChange:l})}),a==="Python"?e(ds,{projectName:n}):e(cs,{projectName:n})]})})}function $m({projectName:n}){const[a,l]=m.useState(null),t=()=>{l(e(zC,{projectName:n}))};return o("tbody",{className:"is-empty",children:[e("tr",{children:e("td",{colSpan:100,css:K`
            text-align: center;
            padding: var(--ac-global-dimension-size-300)
              var(--ac-global-dimension-size-300) !important;
          `,children:o(b,{direction:"column",gap:"size-200",alignItems:"center",children:["No traces found that match the selected filters",e(M,{variant:"default",leadingVisual:e(I,{svg:e(Da,{})}),onPress:t,children:"Get Started"})]})})}),e(ue,{onDismiss:()=>l(null),isDismissable:!0,type:"slideOver",children:a})]})}const jm={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"SpanColumnSelector_annotations",selections:[{alias:null,args:null,kind:"ScalarField",name:"spanAnnotationNames",storageKey:null}],type:"Project",abstractKey:null};jm.hash="ad01e6897ad1ea779eb346d85783b8b4";const NC=["spanKind","name"];function Om(n){return e(hi,{menu:e($C,{...n}),triggerProps:{placement:"bottom end"},children:o(b,{direction:"row",alignItems:"center",gap:"size-100",children:[e(I,{svg:e(lh,{})}),"Columns"]})})}const et=K`
  padding: var(--ac-global-dimension-static-size-50)
    var(--ac-global-dimension-static-size-100);
  label {
    display: flex;
    align-items: center;
    gap: var(--ac-global-dimension-static-size-100);
  }
`;function $C(n){const{columns:a}=n,l=en(c=>c.columnVisibility),t=en(c=>c.setColumnVisibility),i=m.useMemo(()=>a.filter(c=>!NC.includes(c.id)),[a]),r=m.useMemo(()=>i.every(c=>{const g=l[c.id];return g??!0}),[i,l]),s=m.useCallback(c=>{const{name:g,checked:f}=c.target;t({...l,[g]:f})},[l,t]),d=m.useCallback(c=>{const{checked:g}=c.target,f=i.reduce((u,p)=>({...u,[p.id]:g}),{});t(f)},[i,t]);return e("div",{css:K`
        overflow-y: auto;
        max-height: calc(100vh - 200px);
      `,children:o(v,{paddingTop:"size-50",paddingBottom:"size-50",children:[e(v,{borderBottomColor:"dark",borderBottomWidth:"thin",paddingBottom:"size-50",children:e("div",{css:et,children:o("label",{children:[e("input",{type:"checkbox",name:"toggle-all",checked:r,onChange:d}),"span columns"]})})}),e("ul",{children:i.map(c=>{const g=l[c.id],f=g??!0,u=typeof c.columnDef.header=="string"?c.columnDef.header:c.id;return e("li",{css:et,children:o("label",{children:[e("input",{type:"checkbox",name:c.id,checked:f,onChange:s}),u]})},c.id)})}),e(jC,{...n})]})})}function jC({query:n}){const a=T.useFragment(jm,n),l=en(s=>s.annotationColumnVisibility),t=en(s=>s.setAnnotationColumnVisibility),i=m.useMemo(()=>a.spanAnnotationNames.every(s=>l[s]||!1),[a.spanAnnotationNames,l]),r=m.useCallback(()=>{const s=a.spanAnnotationNames.reduce((d,c)=>({...d,[c]:!i}),{});t(s)},[a.spanAnnotationNames,t,i]);return o("section",{children:[e(v,{paddingTop:"size-50",paddingBottom:"size-50",borderColor:"dark",borderTopWidth:"thin",borderBottomWidth:"thin",children:e("div",{css:et,children:o("label",{children:[e("input",{type:"checkbox",name:"toggle-annotations-all",checked:i,onChange:r}),"annotations"]})})}),e("ul",{children:a.spanAnnotationNames.map(s=>{const d=l[s]??!1;return e("li",{css:et,children:o("label",{children:[e("input",{type:"checkbox",name:s,checked:d,onChange:()=>{t({...l,[s]:!d})}}),s]})},s)})})]})}const Qm=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"condition"},{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}],l={kind:"InlineFragment",selections:[{alias:null,args:[{kind:"Variable",name:"condition",variableName:"condition"}],concreteType:"ValidationResult",kind:"LinkedField",name:"validateSpanFilterCondition",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"isValid",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"errorMessage",storageKey:null}],storageKey:null}],type:"Project",abstractKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"SpanFilterConditionFieldValidationQuery",selections:[{alias:"project",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[l],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"SpanFilterConditionFieldValidationQuery",selections:[{alias:"project",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},l,{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null}]},params:{cacheID:"38e5e2288d5746b32b21632854cc7c82",id:null,metadata:{},name:"SpanFilterConditionFieldValidationQuery",operationKind:"query",text:`query SpanFilterConditionFieldValidationQuery(
  $condition: String!
  $id: ID!
) {
  project: node(id: $id) {
    __typename
    ... on Project {
      validateSpanFilterCondition(condition: $condition) {
        isValid
        errorMessage
      }
    }
    id
  }
}
`}}}();Qm.hash="4020987ee29c63747be68dc3cada3de0";const Bm=K`
  flex: 1 1 auto;
  .cm-content {
    padding: var(--ac-global-dimension-static-size-100) 0;
  }
  .cm-editor {
    background-color: transparent !important;
  }
  .cm-focused {
    outline: none;
  }
  .cm-selectionLayer .cm-selectionBackground {
    background: var(--ac-global-color-cyan-400) !important;
  }
`,qm=K`
  border-width: var(--ac-global-border-size-thin);
  border-style: solid;
  border-color: var(--ac-global-input-field-border-color);
  border-radius: var(--ac-global-rounding-small);
  background-color: var(--ac-global-input-field-background-color);
  transition: all 0.2s ease-in-out;
  overflow-x: hidden;
  &:hover,
  &[data-is-focused="true"] {
    border-color: var(--ac-global-input-field-border-color-active);
    background-color: var(--ac-global-input-field-background-color-active);
  }
  &[data-is-invalid="true"] {
    border-color: var(--ac-global-color-danger);
  }
  box-sizing: border-box;
`;function OC(n){const a=n.matchBefore(/\w*/);return!a||a.from==a.to&&!n.explicit?null:{from:a.from,options:[{label:"span_kind",type:"variable",info:"The span variant: CHAIN, LLM, RETRIEVER, TOOL, etc."},{label:"status_code",type:"variable",info:"The span status: OK, UNSET, or ERROR"},{label:"input.value",type:"variable",info:"The input value of a span, typically a query"},{label:"output.value",type:"variable",info:"The output value of a span, typically a response"},{label:"name",type:"variable",info:"The name given to a span - e.x. OpenAI"},{label:"latency_ms",type:"variable",info:"Latency (i.e. duration) in milliseconds"},{label:"cumulative_token_count.prompt",type:"variable",info:"Sum of token count for prompt from self and all child spans"},{label:"cumulative_token_count.completion",type:"variable",info:"Sum of token count for completion from self and all child spans"},{label:"cumulative_token_count.total",type:"variable",info:"Sum of token count total (prompt + completion) from self and all child spans"},{label:"llm spans",type:"text",apply:"span_kind == 'LLM'",detail:"macro"},{label:"retriever spans",type:"text",apply:"span_kind == 'RETRIEVER'",detail:"macro"},{label:"search input",type:"text",apply:"'' in input.value",detail:"macro"},{label:"search output",type:"text",apply:"'' in output.value",detail:"macro"},{label:"status_code error",type:"text",apply:"status_code == 'ERROR'",detail:"macro"},{label:"Latency >= 10s",type:"text",apply:"latency_ms >= 10_000",detail:"macro"},{label:"Tokens >= 1,000",type:"text",apply:"llm.token_count.total >= 1_000",detail:"macro"},{label:"Hallucinations",type:"text",apply:"annotations['Hallucination'].label == 'hallucinated'",detail:"macro"},{label:"Annotations",type:"text",apply:"annotations['Hallucination'].label == 'hallucinated'",detail:"macro"},{label:"Metadata",type:"text",apply:"metadata['topic'] == 'agent'",detail:"macro"},{label:"Substring",type:"text",apply:"'agent' in input.value",detail:"macro"}]}}async function QC(n,a){if(!n)return{isValid:!0,errorMessage:null};const l=await _l.fetchQuery(he,Qm,{condition:n,id:a}).toPromise();if(!l)throw new Error("Filter condition validation is null");return l.project.validateSpanFilterCondition}const BC=[$i.of([{key:"Enter",run:n=>!0}]),zl(),hs({override:[OC]})];function Um(n){const{onValidCondition:a,placeholder:l="filter condition (e.x. span_kind == 'LLM')"}=n,[t,i]=m.useState(!1),[r,s]=m.useState(""),{filterCondition:d,setFilterCondition:c,appendFilterCondition:g}=Vt(),f=m.useDeferredValue(d),{theme:u}=ca(),p=u==="light"?_a:Aa,{projectId:y}=Qe();m.useEffect(()=>{QC(f,y).then(S=>{S!=null&&S.isValid?(s(""),m.startTransition(()=>{a(f)})):s((S==null?void 0:S.errorMessage)??"Invalid filter condition")})},[a,f,y]);const h=r!=="";return o("div",{"data-is-focused":t,"data-is-invalid":h,className:"span-filter-condition-field",css:qm,children:[o(b,{direction:"row",children:[e(fi,{children:e(I,{svg:e(Mi,{})})}),e(wa,{css:Bm,indentWithTab:!1,basicSetup:{lineNumbers:!1,foldGutter:!1,bracketMatching:!0,syntaxHighlighting:!0,highlightActiveLine:!1,highlightActiveLineGutter:!1,defaultKeymap:!1},onFocus:()=>i(!0),onBlur:()=>i(!1),value:d,onChange:c,height:"36px",width:"100%",theme:p,placeholder:l,extensions:BC}),e("button",{css:K`
            margin-right: var(--ac-global-dimension-static-size-100);
            color: var(--ac-global-text-color-700);
            visibility: ${d!==""?"visible":"hidden"};
          `,onClick:()=>c(""),className:"button--reset",children:e(I,{svg:e(Dt,{})})}),o(ot,{placement:"bottom right",children:[e(nn,{children:e("button",{css:K`
                color: var(--ac-global-text-color-700);
                background-color: var(--ac-global-color-grey-300);
                padding-left: var(--ac-global-dimension-static-size-100);
                padding-right: var(--ac-global-dimension-static-size-100);
                height: 100%;
              `,className:"button--reset",children:e(I,{svg:e(Bn,{})})})}),e(qC,{onAddFilterConditionSnippet:g})]})]}),o(Ee,{isOpen:h&&t,placement:"bottom",children:[e(nn,{children:e("div",{})}),e(oa,{children:r!=""?e(F,{color:"danger",children:r}):e(F,{color:"success",children:"Valid Expression"})})]})]})}function qC(n){const{onAddFilterConditionSnippet:a}=n;return e(v,{width:"500px",padding:"size-200",borderRadius:"medium",borderWidth:"thin",borderColor:"light",backgroundColor:"light",children:o(b,{direction:"column",gap:"size-100",children:[e(Ra,{label:"filter by kind",initialSnippet:"span_kind == 'LLM'",onAddFilterConditionSnippet:a},"kind"),e(Ra,{label:"filter by token count",initialSnippet:"cumulative_token_count.total > 1000",onAddFilterConditionSnippet:a},"token_count"),e(Ra,{label:"filter by annotation label",initialSnippet:"annotations['Hallucination'].label == 'hallucinated'",onAddFilterConditionSnippet:a},"annotation_label"),e(Ra,{label:"filter by evaluation label",initialSnippet:"evals['Hallucination'].label == 'hallucinated'",onAddFilterConditionSnippet:a},"eval_label"),e(Ra,{label:"filter by evaluation score",initialSnippet:"evals['Hallucination'].score < 1",onAddFilterConditionSnippet:a},"eval_score"),e(Ra,{label:"filter by metadata",initialSnippet:"metadata['topic'] == 'agent'",onAddFilterConditionSnippet:a},"metadata"),e(Ra,{label:"filter by substring",initialSnippet:"'agent' in input.value",onAddFilterConditionSnippet:a},"substring")]})})}function Ra(n){const{initialSnippet:a,onAddFilterConditionSnippet:l}=n,[t,i]=m.useState(a),{theme:r}=ca(),s=r==="light"?_a:Aa;return e(Ia,{label:n.label,children:o(b,{direction:"row",width:"100%",gap:"size-100",children:[e("div",{css:K(qm,K`
              flex: 1 1 auto;
            `),children:e(wa,{value:t,basicSetup:{lineNumbers:!1,foldGutter:!1,bracketMatching:!0,syntaxHighlighting:!0,highlightActiveLine:!1,highlightActiveLineGutter:!1},extensions:[zl()],editable:!0,onChange:i,theme:s,css:Bm})}),e(M,{"aria-label":"Add to filter condition",variant:"default",onPress:()=>l(t),leadingVisual:e(I,{svg:e(Bn,{})})})]})})}const Hm=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"traceIds"}],a=[{alias:null,args:[{kind:"Variable",name:"traceIds",variableName:"traceIds"}],concreteType:"Query",kind:"LinkedField",name:"deleteTraces",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"SpanSelectionToolbarDeleteTracesMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"SpanSelectionToolbarDeleteTracesMutation",selections:a},params:{cacheID:"3e39d87554a43d8dc3006d3e977317e5",id:null,metadata:{},name:"SpanSelectionToolbarDeleteTracesMutation",operationKind:"mutation",text:`mutation SpanSelectionToolbarDeleteTracesMutation(
  $traceIds: [ID!]!
) {
  deleteTraces(traceIds: $traceIds) {
    __typename
  }
}
`}}}();Hm.hash="61f5b577eead8d4094340843ed9d8d28";const Gm=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"DatasetMutationPayload",kind:"LinkedField",name:"addSpansToDataset",plural:!1,selections:[{alias:null,args:null,concreteType:"Dataset",kind:"LinkedField",name:"dataset",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"SpanSelectionToolbarAddSpansToDatasetMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"SpanSelectionToolbarAddSpansToDatasetMutation",selections:a},params:{cacheID:"1c694540190478b8fba8ef3c0cacf30c",id:null,metadata:{},name:"SpanSelectionToolbarAddSpansToDatasetMutation",operationKind:"mutation",text:`mutation SpanSelectionToolbarAddSpansToDatasetMutation(
  $input: AddSpansToDatasetInput!
) {
  addSpansToDataset(input: $input) {
    dataset {
      id
    }
  }
}
`}}}();Gm.hash="5e3aef907285081a06c0e0360045e865";const Wm={fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"DatasetSelectorPopoverContentDatasetsQuery",selections:[{args:null,kind:"FragmentSpread",name:"DatasetSelectorPopoverContent_datasets"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"DatasetSelectorPopoverContentDatasetsQuery",selections:[{alias:null,args:null,concreteType:"DatasetConnection",kind:"LinkedField",name:"datasets",plural:!1,selections:[{alias:null,args:null,concreteType:"DatasetEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"dataset",args:null,concreteType:"Dataset",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}]},params:{cacheID:"6d459b61a36b99979f025742892941f9",id:null,metadata:{},name:"DatasetSelectorPopoverContentDatasetsQuery",operationKind:"query",text:`query DatasetSelectorPopoverContentDatasetsQuery {
  ...DatasetSelectorPopoverContent_datasets
}

fragment DatasetSelectorPopoverContent_datasets on Query {
  datasets {
    edges {
      dataset: node {
        id
        name
      }
    }
  }
}
`}};Wm.hash="40d5267ad0ec2335a73ff2a4d05bbed1";const Jm={argumentDefinitions:[],kind:"Fragment",metadata:{refetch:{connection:null,fragmentPathInResult:[],operation:Wm}},name:"DatasetSelectorPopoverContent_datasets",selections:[{alias:null,args:null,concreteType:"DatasetConnection",kind:"LinkedField",name:"datasets",plural:!1,selections:[{alias:null,args:null,concreteType:"DatasetEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"dataset",args:null,concreteType:"Dataset",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],type:"Query",abstractKey:null};Jm.hash="40d5267ad0ec2335a73ff2a4d05bbed1";const Xm={fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"DatasetSelectorPopoverContentQuery",selections:[{args:null,kind:"FragmentSpread",name:"DatasetSelectorPopoverContent_datasets"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"DatasetSelectorPopoverContentQuery",selections:[{alias:null,args:null,concreteType:"DatasetConnection",kind:"LinkedField",name:"datasets",plural:!1,selections:[{alias:null,args:null,concreteType:"DatasetEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"dataset",args:null,concreteType:"Dataset",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}]},params:{cacheID:"5fb28a402f330dd235295da21efea58b",id:null,metadata:{},name:"DatasetSelectorPopoverContentQuery",operationKind:"query",text:`query DatasetSelectorPopoverContentQuery {
  ...DatasetSelectorPopoverContent_datasets
}

fragment DatasetSelectorPopoverContent_datasets on Query {
  datasets {
    edges {
      dataset: node {
        id
        name
      }
    }
  }
}
`}};Xm.hash="7cd8a13144d97d2b5294f2a09c9e1351";function UC(n){const{onCreateNewDataset:a,onDatasetSelected:l}=n,[t,i]=m.useState(""),r=T.useLazyLoadQuery(Xm,{},{fetchPolicy:"network-only"});return o(q,{title:"Add to Dataset",variant:"compact",backgroundColor:"light",borderColor:"light",bodyStyle:{padding:0},extra:e(M,{variant:"default",size:"S",onPress:a,children:"New Dataset"}),children:[e(v,{padding:"size-100",children:e(is,{onChange:s=>{i(s)},children:e(X,{placeholder:"Search datasets"})})}),e(v,{borderTopWidth:"thin",borderColor:"light",children:e("div",{css:K`
            height: 400px;
            overflow-y: auto;
            min-width: 300px;
          `,children:e(HC,{query:r,search:t,onDatasetSelected:l})})})]})}function HC(n){const{search:a,onDatasetSelected:l}=n,[t]=T.useRefetchableFragment(Jm,n.query),i=m.useMemo(()=>{let s=t.datasets.edges.map(d=>d.dataset);return a&&(s=s.filter(d=>d.name.toLowerCase().includes(a.toLowerCase()))),s},[a,t]);return i.length===0?e(v,{padding:"size-200",children:e(b,{direction:"column",justifyContent:"center",alignItems:"center",flex:"1 1 auto",children:e(F,{children:"No datasets found"})})}):e(ct,{selectionMode:"single",onSelectionChange:s=>{if(typeof s=="object"){const d=Array.from(s);l(d[0])}},children:i.map(s=>e(xe,{children:s.name},s.id))})}function Zm(n){const a=ce(),l=me(),t=be(),[i,r]=m.useState(!1),[s,d]=m.useState(!1),[c,g]=m.useState(!1),{selectedSpans:f,onClearSelection:u}=n,[p,y]=T.useMutation(Gm),[h,k]=T.useMutation(Hm),S=f.length!==1,C=m.useCallback(_=>{p({variables:{input:{datasetId:_,spanIds:f.map(w=>w.id)}},onCompleted:()=>{l({title:"Examples added to dataset",message:`${f.length} example${S?"s have":" has"} been added to the dataset.`,action:{text:"View dataset",onClick:()=>{a(`/datasets/${_}/examples`)}}}),u()},onError:w=>{const V=De(w);t({title:"An error occurred",message:`Failed to add spans to dataset: ${(V==null?void 0:V[0])??w.message}`})}})},[p,f,l,S,u,a,t]),P=m.useCallback(()=>{const _=[...new Set(f.map(w=>w.traceId))];h({variables:{traceIds:_},onCompleted:()=>{l({title:"Traces deleted",message:`${_.length} trace${_.length!==1?"s have":" has"} been deleted.`}),u()},onError:w=>{const V=De(w);t({title:"An error occurred",message:`Failed to delete traces: ${(V==null?void 0:V[0])??w.message}`})}})},[h,f,l,u,t]),L=()=>{g(!0)};return e("div",{css:K`
        position: absolute;
        bottom: var(--ac-global-dimension-size-600);
        left: 50%;
        transform: translateX(-50%);
        z-index: 10;
        box-shadow: 8px 8px 20px 0 rgba(0, 0, 0, 0.4);
        border-radius: var(--ac-global-rounding-medium);
      `,children:e(v,{backgroundColor:"light",padding:"size-200",borderColor:"light",borderWidth:"thin",borderRadius:"medium",minWidth:"size-6000",children:o(b,{direction:"row",justifyContent:"space-between",alignItems:"center",children:[e(F,{children:`${f.length} span${S?"s":""} selected`}),o(b,{direction:"row",gap:"size-100",children:[e(M,{variant:"default",size:"S",onPress:u,children:"Cancel"}),o(Ne,{isOpen:s,onOpenChange:_=>{d(_)},children:[e(M,{variant:"default",size:"S",leadingVisual:y?e(sn,{}):e(gt,{}),onPress:()=>{d(!0)},isDisabled:y,children:y?"Adding...":"Add to Dataset"}),e(m.Suspense,{children:e(la,{placement:"top end",crossOffset:300,children:e(UC,{onDatasetSelected:_=>{C(_),d(!1)},onCreateNewDataset:()=>{d(!1),r(!0)}})})})]}),e(Ne,{isOpen:i,onOpenChange:r,children:e(la,{children:e(on,{children:e(Ge,{children:e(He,{children:o(ea,{children:[o(na,{children:[e(aa,{children:"New Dataset"}),e(Oa,{children:e(M,{variant:"default",size:"S",onPress:()=>{r(!1)},leadingVisual:e(I,{svg:e(Wo,{})})})})]}),e(us,{onDatasetCreateError:_=>{const w=De(_);t({title:"Dataset creation failed",message:`Failed to create dataset: ${(w==null?void 0:w[0])??_.message}`})},onDatasetCreated:_=>{r(!1),l({title:"Dataset created",message:`${_.name} has been successfully created.`}),d(!0)}})]})})})})})}),e(M,{variant:"danger",size:"S",leadingVisual:e(I,{svg:k?e(sn,{}):e(Je,{})}),isDisabled:k,onPress:L,children:k?"Deleting...":"Delete"}),e(Ne,{isOpen:c,onOpenChange:g,children:e(on,{children:e(Ge,{children:e(He,{children:o(ea,{children:[e(na,{children:e(aa,{children:"Delete Traces"})}),e(v,{padding:"size-200",children:e(F,{color:"danger",children:"Are you sure you want to delete the selected spans and their traces?"})}),e(v,{paddingEnd:"size-200",paddingTop:"size-100",paddingBottom:"size-100",borderTopColor:"light",borderTopWidth:"thin",children:o(b,{direction:"row",justifyContent:"end",gap:"size-100",children:[e(M,{variant:"default",onPress:()=>{g(!1)},children:"Cancel"}),e(M,{variant:"danger",onPress:()=>{P(),g(!1)},children:"Delete Traces"})]})})]})})})})})]})]})})})}const Ym="annotations",mi="-",eg={col:"startTime",dir:"desc"};function ng(n){let a=null,l=null;if(n.id&&n.id.startsWith(Ym)){const[,t,i]=n.id.split(mi);l={attr:t,name:i}}else a=n.id;return{col:a,evalResultKey:l,dir:n.desc?"desc":"asc"}}function nt(n,a){return`${Ym}${mi}${a}${mi}${n}`.replace(/[^a-zA-Z0-9]/g,"-")}const ql=Bi,GC={minSize:100};function WC(n){return n==="root"||n==="all"}const ag=({table:n,hasNext:a,onLoadNext:l,isLoadingNext:t})=>{const i=ce(),[r]=pn(),{traceId:s}=Qe(),d=r.get(mn);return o("tbody",{children:[n.getRowModel().rows.map(c=>{const g=d===c.original.id||!d&&c.original.trace.traceId===s;return e("tr",{"data-selected":g,onClick:()=>i(`${c.original.trace.traceId}?${mn}=${c.original.id}`),children:c.getVisibleCells().map(f=>{const u=`--col-${f.column.id}-size`;return e("td",{style:{width:`calc(var(${u}) * 1px)`,maxWidth:`calc(var(${u}) * 1px)`,textWrap:"nowrap",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:W(f.column.columnDef.cell,f.getContext())},f.id)})},c.id)}),a?e(Vi,{onLoadMore:l,isLoadingNext:t},"load-more"):null]})},JC=fn.memo(ag,(n,a)=>n.table.options.data===a.table.options.data);function XC(n){const{fetchKey:a}=qa(),l=m.useRef(null),t=m.useRef(!0),[i,r]=m.useState({}),[s,d]=m.useState([]),[c,g]=m.useState(""),[f,u]=m.useState(!0),p=en(D=>D.columnVisibility),{data:y,loadNext:h,hasNext:k,isLoadingNext:S,refetch:C}=T.usePaginationFragment(Vm,n.project),P=lr(),L=P==null?void 0:P.setTraceSequence;m.useEffect(()=>{if(L)return L(y.spans.edges.map(({span:D})=>({traceId:D.trace.traceId,spanId:D.id}))),()=>{L([])}},[y.spans.edges,L]);const _=en(D=>D.annotationColumnVisibility),w=m.useMemo(()=>Object.keys(_).filter(D=>_[D]),[_]),V=m.useMemo(()=>y.spans.edges.map(({span:$})=>$),[y]),Q=w.map(D=>({header:D,columns:[{header:"labels",accessorKey:nt(D,"label"),cell:({row:$})=>{const U=$.original.spanAnnotationSummaries.find(ne=>ne.name===D);return U?e(Xc,{name:D,labelFractions:U.labelFractions}):null}},{header:"mean score",accessorKey:nt(D,"score"),cell:({row:$})=>{const U=$.original.spanAnnotationSummaries.find(ne=>ne.name===D);return U?e(vt,{value:U.meanScore,fallback:null}):null}}]})),x=[{header:()=>o(b,{direction:"row",gap:"size-50",children:[e("span",{children:"annotations"}),o(Al,{children:[e(ae,{level:3,weight:"heavy",children:"Annotations"}),e($a,{children:"Evaluations and human annotations logged via the API or set via the UI."})]})]}),id:"annotations",accessorKey:"spanAnnotations",enableSorting:!1,cell:({row:D})=>o(b,{direction:"row",gap:"size-50",wrap:"wrap",children:[e(Kt,{span:D.original,showFilterActions:!0}),D.original.documentRetrievalMetrics.map($=>o(J,{children:[e(vn,{name:$.evaluationName,metric:"ndcg",score:$.ndcg},"ndcg"),e(vn,{name:$.evaluationName,metric:"precision",score:$.precision},"precision"),e(vn,{name:$.evaluationName,metric:"hit",score:$.hit},"hit")]}))]})},...Q],R=[{id:"select",maxSize:10,header:({table:D})=>e(On,{checked:D.getIsAllRowsSelected(),indeterminate:D.getIsSomeRowsSelected(),onChange:D.getToggleAllRowsSelectedHandler()}),cell:({row:D})=>e(On,{checked:D.getIsSelected(),disabled:!D.getCanSelect(),indeterminate:D.getIsSomeSelected(),onChange:D.getToggleSelectedHandler()})},{header:"status",accessorKey:"statusCode",maxSize:30,enableSorting:!1,cell:({getValue:D})=>{const $=D();return e(b,{direction:"row",gap:"size-50",alignItems:"center",children:e(St,{statusCode:$})})}},{header:"kind",accessorKey:"spanKind",maxSize:100,enableSorting:!1,cell:({getValue:D})=>e(Pi,{spanKind:D()})},{header:"name",accessorKey:"name",enableSorting:!1,cell:({getValue:D,row:$})=>{const U=$.original,{traceId:ne}=U.trace;return e(we,{to:`${ne}?${mn}=${U.id}`,children:D()})}},{header:"input",accessorKey:"input.value",cell:Re,enableSorting:!1},{header:"output",accessorKey:"output.value",cell:Re,enableSorting:!1},{header:"metadata",accessorKey:"metadata",cell:({row:D})=>e(Nm,{metadata:D.original.metadata}),enableSorting:!1},...x,{header:"start time",accessorKey:"startTime",cell:_e},{header:"latency",accessorKey:"latencyMs",cell:({getValue:D})=>{const $=D();return $===null||typeof $!="number"?null:e(je,{latencyMs:$})}},{header:f?"cumulative tokens":"total tokens",accessorKey:f?"cumulativeTokenCountTotal":"tokenCountTotal",cell:({row:D,getValue:$})=>{if($()===null)return"--";const ne=D.original,tn=f?ne.cumulativeTokenCountTotal:ne.tokenCountTotal;return e(La,{tokenCountTotal:tn||0,nodeId:ne.id})}}];m.useEffect(()=>{if(t.current===!0){t.current=!1;return}m.startTransition(()=>{const D=s[0];C({sort:D?ng(D):eg,after:null,first:ql,filterCondition:c,rootSpansOnly:f},{fetchPolicy:"store-and-network"})})},[s,C,c,a,f]);const A=m.useCallback(D=>{if(D){const{scrollHeight:$,scrollTop:U,clientHeight:ne}=D;$-U-ne<300&&!S&&k&&h(ql)}},[k,S,h]),z=en(D=>D.setColumnSizing),N=en(D=>D.columnSizing),j=Ce({columns:R,data:V,state:{sorting:s,columnVisibility:p,rowSelection:i,columnSizing:N},defaultColumn:GC,columnResizeMode:"onChange",manualSorting:!0,enableRowSelection:!0,onRowSelectionChange:r,onSortingChange:d,onColumnSizingChange:z,getCoreRowModel:Ke(),getSortedRowModel:ln()}),Z=j.getRowModel().rows,se=j.getSelectedRowModel().rows,Ye=se.map(D=>({id:D.original.id,traceId:D.original.trace.id})),kn=m.useCallback(()=>{r({})},[r]),ma=Z.length===0,Rn=j.getAllColumns().filter(D=>D.columns.length===0),{columnSizingInfo:B,columnSizing:ie}=j.getState(),te=j.getFlatHeaders,Ae=Rn.length,[Pe]=m.useMemo(()=>{const D=te(),$={};for(let U=0;U<D.length;U++){const ne=D[U];$[`--header-${ne.id}-size`]=ne.getSize(),$[`--col-${ne.column.id}-size`]=ne.column.getSize()}return[$]},[te,B,ie,Ae]);return o("div",{css:rr,children:[e(v,{paddingTop:"size-100",paddingBottom:"size-100",paddingStart:"size-200",paddingEnd:"size-200",borderBottomColor:"grey-300",borderBottomWidth:"thin",flex:"none",children:o(b,{direction:"row",gap:"size-100",width:"100%",alignItems:"center",children:[e(Um,{onValidCondition:g}),o(xt,{"aria-label":"Toggle between root and all spans",selectionMode:"single",selectedKeys:[f?"root":"all"],onSelectionChange:D=>{if(D.size===0)return;const $=D.keys().next().value;if(WC($))u($==="root");else throw new Error(`Unknown root span filter selection: ${$}`)},children:[e(Pn,{"aria-label":"root spans",id:"root",children:"Root Spans"}),e(Pn,{"aria-label":"all spans",id:"all",children:"All"})]}),e(Om,{columns:Rn,query:y}),e(VC,{})]})}),e("div",{css:K`
          flex: 1 1 auto;
          overflow: auto;
        `,onScroll:D=>A(D.target),ref:l,children:o("table",{css:Un,style:{...Pe,width:j.getTotalSize(),minWidth:"100%"},children:[e("thead",{children:j.getHeaderGroups().map(D=>e("tr",{children:D.headers.map($=>e("th",{colSpan:$.colSpan,style:{width:`calc(var(--header-${$.id}-size) * 1px)`},children:$.isPlaceholder?null:o(J,{children:[o("div",{className:$.column.getCanSort()?"sort":"",onClick:$.column.getToggleSortingHandler(),style:{left:$.getStart(),width:$.getSize()},children:[e(an,{maxWidth:"100%",children:W($.column.columnDef.header,$.getContext())}),$.column.getIsSorted()?e(I,{className:"sort-icon",svg:$.column.getIsSorted()==="asc"?e(Xe,{}):e(Ze,{})}):null]}),e("div",{onMouseDown:$.getResizeHandler(),onTouchStart:$.getResizeHandler(),className:`resizer ${$.column.getIsResizing()?"isResizing":""}`})]})},$.id))},D.id))}),ma?e($m,{projectName:y.name}):B.isResizingColumn?e(JC,{table:j,hasNext:k,onLoadNext:()=>h(ql),isLoadingNext:S}):e(ag,{table:j,hasNext:k,onLoadNext:()=>h(ql),isLoadingNext:S})]})}),se.length?e(Zm,{selectedSpans:Ye,onClearSelection:kn}):null]})}function ZC({queryReference:n}){const a=T.usePreloadedQuery(jd,n);return e(XC,{project:a.project})}const nP=()=>{const{spansQueryReference:n}=At();return n?e(or,{children:o(cu,{children:[e(nr,{children:e(m.Suspense,{fallback:e(ge,{}),children:e(ZC,{queryReference:n})})}),e(m.Suspense,{children:e(ve,{})})]})}):null},lg=function(){var n={defaultValue:null,kind:"LocalArgument",name:"after"},a={defaultValue:null,kind:"LocalArgument",name:"filterCondition"},l={defaultValue:30,kind:"LocalArgument",name:"first"},t={defaultValue:null,kind:"LocalArgument",name:"id"},i={defaultValue:{col:"startTime",dir:"desc"},kind:"LocalArgument",name:"sort"},r={defaultValue:null,kind:"LocalArgument",name:"timeRange"},s=[{kind:"Variable",name:"id",variableName:"id"}],d={kind:"Variable",name:"after",variableName:"after"},c={kind:"Variable",name:"filterCondition",variableName:"filterCondition"},g={kind:"Variable",name:"first",variableName:"first"},f={kind:"Variable",name:"sort",variableName:"sort"},u={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},p={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},y={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},h=[d,c,g,{kind:"Literal",name:"rootSpansOnly",value:!0},f,{kind:"Variable",name:"timeRange",variableName:"timeRange"}],k={alias:null,args:null,kind:"ScalarField",name:"spanKind",storageKey:null},S={alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},C={alias:null,args:null,kind:"ScalarField",name:"latencyMs",storageKey:null},P={alias:null,args:null,kind:"ScalarField",name:"parentId",storageKey:null},L=[{alias:"value",args:null,kind:"ScalarField",name:"truncatedValue",storageKey:null}],_={alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"input",plural:!1,selections:L,storageKey:null},w={alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"output",plural:!1,selections:L,storageKey:null},V={alias:null,args:null,kind:"ScalarField",name:"spanId",storageKey:null},Q={alias:null,args:null,kind:"ScalarField",name:"traceId",storageKey:null},x={alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},R={alias:null,args:null,kind:"ScalarField",name:"score",storageKey:null},A={alias:null,args:null,concreteType:"SpanAnnotation",kind:"LinkedField",name:"spanAnnotations",plural:!0,selections:[p,y,x,R,{alias:null,args:null,kind:"ScalarField",name:"annotatorKind",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"user",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"username",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"profilePictureUrl",storageKey:null},p],storageKey:null}],storageKey:null},z={alias:null,args:null,concreteType:"AnnotationSummary",kind:"LinkedField",name:"spanAnnotationSummaries",plural:!0,selections:[{alias:null,args:null,concreteType:"LabelFraction",kind:"LinkedField",name:"labelFractions",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"fraction",storageKey:null},x],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"meanScore",storageKey:null},y],storageKey:null},N={alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"project",plural:!1,selections:[p,{alias:null,args:null,concreteType:"AnnotationConfigConnection",kind:"LinkedField",name:"annotationConfigs",plural:!1,selections:[{alias:null,args:null,concreteType:"AnnotationConfigEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[u,{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"annotationType",storageKey:null}],type:"AnnotationConfigBase",abstractKey:"__isAnnotationConfigBase"},{kind:"InlineFragment",selections:[p,y,{alias:null,args:null,kind:"ScalarField",name:"optimizationDirection",storageKey:null},{alias:null,args:null,concreteType:"CategoricalAnnotationValue",kind:"LinkedField",name:"values",plural:!0,selections:[x,R],storageKey:null}],type:"CategoricalAnnotationConfig",abstractKey:null},{kind:"InlineFragment",selections:[p],type:"Node",abstractKey:"__isNode"}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null},j={alias:null,args:null,concreteType:"DocumentRetrievalMetrics",kind:"LinkedField",name:"documentRetrievalMetrics",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"evaluationName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"ndcg",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"precision",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hit",storageKey:null}],storageKey:null};return{fragment:{argumentDefinitions:[n,a,l,t,i,r],kind:"Fragment",metadata:null,name:"TracesTableQuery",selections:[{alias:null,args:s,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:[d,c,g,f],kind:"FragmentSpread",name:"TracesTable_spans"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[n,a,l,i,r,t],kind:"Operation",name:"TracesTableQuery",selections:[{alias:null,args:s,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[u,p,{kind:"InlineFragment",selections:[y,{alias:null,args:null,kind:"ScalarField",name:"spanAnnotationNames",storageKey:null},{alias:"rootSpans",args:h,concreteType:"SpanConnection",kind:"LinkedField",name:"spans",plural:!1,selections:[{alias:null,args:null,concreteType:"SpanEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"rootSpan",args:null,concreteType:"Span",kind:"LinkedField",name:"node",plural:!1,selections:[p,k,y,{alias:null,args:null,kind:"ScalarField",name:"metadata",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"statusCode",storageKey:null},S,C,{alias:null,args:null,kind:"ScalarField",name:"cumulativeTokenCountTotal",storageKey:null},P,_,w,V,{alias:null,args:null,concreteType:"Trace",kind:"LinkedField",name:"trace",plural:!1,selections:[p,Q,{alias:null,args:null,kind:"ScalarField",name:"numSpans",storageKey:null}],storageKey:null},A,z,N,j,{alias:null,args:[{kind:"Literal",name:"first",value:50}],concreteType:"SpanConnection",kind:"LinkedField",name:"descendants",plural:!1,selections:[{alias:null,args:null,concreteType:"SpanEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"Span",kind:"LinkedField",name:"node",plural:!1,selections:[p,k,y,{alias:"statusCode",args:null,kind:"ScalarField",name:"propagatedStatusCode",storageKey:null},S,C,P,{alias:"cumulativeTokenCountTotal",args:null,kind:"ScalarField",name:"tokenCountTotal",storageKey:null},_,w,V,{alias:null,args:null,concreteType:"Trace",kind:"LinkedField",name:"trace",plural:!1,selections:[p,Q],storageKey:null},A,N,z,j],storageKey:null}],storageKey:null}],storageKey:"descendants(first:50)"}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"Span",kind:"LinkedField",name:"node",plural:!1,selections:[u,p],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},{alias:"rootSpans",args:h,filters:["sort","rootSpansOnly","filterCondition","timeRange"],handle:"connection",key:"TracesTable_rootSpans",kind:"LinkedHandle",name:"spans"}],type:"Project",abstractKey:null}],storageKey:null}]},params:{cacheID:"dcad31a9f81b32615240143982c91514",id:null,metadata:{},name:"TracesTableQuery",operationKind:"query",text:`query TracesTableQuery(
  $after: String = null
  $filterCondition: String = null
  $first: Int = 30
  $sort: SpanSort = {col: startTime, dir: desc}
  $timeRange: TimeRange
  $id: ID!
) {
  node(id: $id) {
    __typename
    ...TracesTable_spans_1XEuU
    id
  }
}

fragment AnnotationSummaryGroup on Span {
  project {
    id
    annotationConfigs {
      edges {
        node {
          __typename
          ... on AnnotationConfigBase {
            __isAnnotationConfigBase: __typename
            annotationType
          }
          ... on CategoricalAnnotationConfig {
            id
            name
            optimizationDirection
            values {
              label
              score
            }
          }
          ... on Node {
            __isNode: __typename
            id
          }
        }
      }
    }
  }
  spanAnnotations {
    id
    name
    label
    score
    annotatorKind
    createdAt
    user {
      username
      profilePictureUrl
      id
    }
  }
  spanAnnotationSummaries {
    labelFractions {
      fraction
      label
    }
    meanScore
    name
  }
}

fragment SpanColumnSelector_annotations on Project {
  spanAnnotationNames
}

fragment TraceHeaderRootSpanAnnotationsFragment on Span {
  ...AnnotationSummaryGroup
}

fragment TracesTable_spans_1XEuU on Project {
  name
  ...SpanColumnSelector_annotations
  rootSpans: spans(first: $first, after: $after, sort: $sort, rootSpansOnly: true, filterCondition: $filterCondition, timeRange: $timeRange) {
    edges {
      rootSpan: node {
        id
        spanKind
        name
        metadata
        statusCode
        startTime
        latencyMs
        cumulativeTokenCountTotal
        parentId
        input {
          value: truncatedValue
        }
        output {
          value: truncatedValue
        }
        spanId
        trace {
          id
          traceId
          numSpans
        }
        spanAnnotations {
          id
          name
          label
          score
          annotatorKind
          createdAt
        }
        spanAnnotationSummaries {
          labelFractions {
            fraction
            label
          }
          meanScore
          name
        }
        ...AnnotationSummaryGroup
        documentRetrievalMetrics {
          evaluationName
          ndcg
          precision
          hit
        }
        descendants(first: 50) {
          edges {
            node {
              id
              spanKind
              name
              statusCode: propagatedStatusCode
              startTime
              latencyMs
              parentId
              cumulativeTokenCountTotal: tokenCountTotal
              input {
                value: truncatedValue
              }
              output {
                value: truncatedValue
              }
              spanId
              trace {
                id
                traceId
              }
              spanAnnotations {
                id
                name
                label
                score
                annotatorKind
                createdAt
              }
              ...AnnotationSummaryGroup
              documentRetrievalMetrics {
                evaluationName
                ndcg
                precision
                hit
              }
              ...TraceHeaderRootSpanAnnotationsFragment
            }
          }
        }
      }
      cursor
      node {
        __typename
        id
      }
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
  id
}
`}}}();lg.hash="193763dc6db3300bf3b3b1395effdfe5";const tg=function(){var n=["rootSpans"],a={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"spanKind",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"latencyMs",storageKey:null},s={alias:null,args:null,kind:"ScalarField",name:"parentId",storageKey:null},d=[{alias:"value",args:null,kind:"ScalarField",name:"truncatedValue",storageKey:null}],c={alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"input",plural:!1,selections:d,storageKey:null},g={alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"output",plural:!1,selections:d,storageKey:null},f={alias:null,args:null,kind:"ScalarField",name:"spanId",storageKey:null},u={alias:null,args:null,kind:"ScalarField",name:"traceId",storageKey:null},p={alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},y={alias:null,args:null,concreteType:"SpanAnnotation",kind:"LinkedField",name:"spanAnnotations",plural:!0,selections:[l,a,p,{alias:null,args:null,kind:"ScalarField",name:"score",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"annotatorKind",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null}],storageKey:null},h={args:null,kind:"FragmentSpread",name:"AnnotationSummaryGroup"},k={alias:null,args:null,concreteType:"DocumentRetrievalMetrics",kind:"LinkedField",name:"documentRetrievalMetrics",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"evaluationName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"ndcg",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"precision",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hit",storageKey:null}],storageKey:null};return{argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"after"},{defaultValue:null,kind:"LocalArgument",name:"filterCondition"},{defaultValue:30,kind:"LocalArgument",name:"first"},{defaultValue:{col:"startTime",dir:"desc"},kind:"LocalArgument",name:"sort"},{kind:"RootArgument",name:"timeRange"}],kind:"Fragment",metadata:{connection:[{count:"first",cursor:"after",direction:"forward",path:n}],refetch:{connection:{forward:{count:"first",cursor:"after"},backward:null,path:n},fragmentPathInResult:["node"],operation:lg,identifierInfo:{identifierField:"id",identifierQueryVariableName:"id"}}},name:"TracesTable_spans",selections:[a,{args:null,kind:"FragmentSpread",name:"SpanColumnSelector_annotations"},{alias:"rootSpans",args:[{kind:"Variable",name:"filterCondition",variableName:"filterCondition"},{kind:"Literal",name:"rootSpansOnly",value:!0},{kind:"Variable",name:"sort",variableName:"sort"},{kind:"Variable",name:"timeRange",variableName:"timeRange"}],concreteType:"SpanConnection",kind:"LinkedField",name:"__TracesTable_rootSpans_connection",plural:!1,selections:[{alias:null,args:null,concreteType:"SpanEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"rootSpan",args:null,concreteType:"Span",kind:"LinkedField",name:"node",plural:!1,selections:[l,t,a,{alias:null,args:null,kind:"ScalarField",name:"metadata",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"statusCode",storageKey:null},i,r,{alias:null,args:null,kind:"ScalarField",name:"cumulativeTokenCountTotal",storageKey:null},s,c,g,f,{alias:null,args:null,concreteType:"Trace",kind:"LinkedField",name:"trace",plural:!1,selections:[l,u,{alias:null,args:null,kind:"ScalarField",name:"numSpans",storageKey:null}],storageKey:null},y,{alias:null,args:null,concreteType:"AnnotationSummary",kind:"LinkedField",name:"spanAnnotationSummaries",plural:!0,selections:[{alias:null,args:null,concreteType:"LabelFraction",kind:"LinkedField",name:"labelFractions",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"fraction",storageKey:null},p],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"meanScore",storageKey:null},a],storageKey:null},h,k,{alias:null,args:[{kind:"Literal",name:"first",value:50}],concreteType:"SpanConnection",kind:"LinkedField",name:"descendants",plural:!1,selections:[{alias:null,args:null,concreteType:"SpanEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"Span",kind:"LinkedField",name:"node",plural:!1,selections:[l,t,a,{alias:"statusCode",args:null,kind:"ScalarField",name:"propagatedStatusCode",storageKey:null},i,r,s,{alias:"cumulativeTokenCountTotal",args:null,kind:"ScalarField",name:"tokenCountTotal",storageKey:null},c,g,f,{alias:null,args:null,concreteType:"Trace",kind:"LinkedField",name:"trace",plural:!1,selections:[l,u],storageKey:null},y,h,k,{args:null,kind:"FragmentSpread",name:"TraceHeaderRootSpanAnnotationsFragment"}],storageKey:null}],storageKey:null}],storageKey:"descendants(first:50)"}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"Span",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},l],type:"Project",abstractKey:null}}();tg.hash="193763dc6db3300bf3b3b1395effdfe5";const io=Bi,YC=50,ig=({table:n})=>{const a=ce(),{traceId:l}=Qe();return e("tbody",{children:n.getRowModel().rows.map(t=>{const i=t.original.trace.traceId===l;return e("tr",{onClick:()=>a(`${t.original.trace.traceId}`),"data-is-additional-row":t.original.__additionalRow,"data-selected":i,css:K(a2),children:t.getVisibleCells().map(r=>{const s=`--col-${r.column.id}-size`;return e("td",{style:{width:`calc(var(${s}) * 1px)`,maxWidth:`calc(var(${s}) * 1px)`,textWrap:"nowrap",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:W(r.column.columnDef.cell,r.getContext())},r.id)})},t.id)})})},e2=fn.memo(ig,(n,a)=>n.table.options.data===a.table.options.data),n2=({row:n})=>n.original.__additionalRow?null:e(Nm,{metadata:n.original.metadata}),a2=K`
  &[data-is-additional-row="true"] {
    box-shadow: inset 0 -10px 20px var(--ac-global-color-grey-100);
  }
`;function rg(n){const{children:a}=n,l=[];for(const t of a){const i={...t.span,children:rg({children:t.children})};l.push(i)}return l}function l2(n){const a=m.useRef(null),l=m.useRef(!0),[t,i]=m.useState({}),[r,s]=m.useState([]),[d,c]=m.useState(""),{fetchKey:g}=qa(),{data:f,loadNext:u,hasNext:p,isLoadingNext:y,refetch:h}=T.usePaginationFragment(tg,n.project),k=en(D=>D.annotationColumnVisibility),S=m.useMemo(()=>Object.keys(k).filter(D=>k[D]),[k]),C=m.useMemo(()=>f.rootSpans.edges.map(({rootSpan:D})=>{const $=th([D,...D.descendants.edges.map(({node:tn})=>tn)]),[U]=rg({children:$}),ne=D.trace.numSpans-YC-1;return ne>0&&(U.children=[...U.children,{...U,__additionalRow:!0,name:`+ ${ne} more span${ne>1?"s":""}`,id:`additional-${U.id}`,input:{value:""},output:{value:""},metadata:null,spanAnnotations:[],documentRetrievalMetrics:[],children:[]}]),U}),[f]),P=m.useMemo(()=>S.map(D=>({header:D,columns:[{header:"labels",accessorKey:nt(D,"label"),cell:({row:$})=>{var ne;const U=(ne=$.original.spanAnnotationSummaries)==null?void 0:ne.find(tn=>tn.name===D);return U?e(Xc,{name:D,labelFractions:U.labelFractions}):null}},{header:"mean score",accessorKey:nt(D,"score"),cell:({row:$})=>{var ne;const U=(ne=$.original.spanAnnotationSummaries)==null?void 0:ne.find(tn=>tn.name===D);return U?e(vt,{value:U.meanScore,fallback:null}):null}}]})),[S]),L=m.useMemo(()=>[{header:()=>o(b,{direction:"row",gap:"size-50",children:[e("span",{children:"Annotations"}),o(Al,{children:[e(ae,{level:3,weight:"heavy",children:"Annotations"}),e($a,{children:"Evaluations and human annotations logged via the API or set via the UI."})]})]}),id:"annotations",accessorKey:"spanAnnotations",enableSorting:!1,cell:({row:D})=>{if(D.original.__additionalRow)return null;const $=D.original.spanAnnotations.length===0&&D.original.documentRetrievalMetrics.length===0;return o(b,{direction:"row",gap:"size-50",wrap:"wrap",children:[e(Kt,{span:D.original,showFilterActions:!0}),D.original.documentRetrievalMetrics.map(U=>o(m.Fragment,{children:[e(vn,{name:U.evaluationName,metric:"ndcg",score:U.ndcg},"ndcg"),e(vn,{name:U.evaluationName,metric:"precision",score:U.precision},"precision"),e(vn,{name:U.evaluationName,metric:"hit",score:U.hit},"hit")]},"doc-evals")),$?"--":null]})}},...P],[P]),_=m.useMemo(()=>[{id:"select",maxSize:10,header:({table:D})=>e(On,{checked:D.getIsAllRowsSelected(),indeterminate:D.getIsSomeRowsSelected(),onChange:D.getToggleAllRowsSelectedHandler()}),cell:({row:D})=>D.original.__additionalRow?null:e(On,{checked:D.getIsSelected(),disabled:!D.getCanSelect(),indeterminate:D.getIsSomeSelected(),onChange:D.getToggleSelectedHandler()})},{header:"status",accessorKey:"statusCode",maxSize:30,enableSorting:!1,cell:({getValue:D,row:$})=>{if($.original.__additionalRow)return null;const U=D();return e(St,{statusCode:U})}},{header:({table:D})=>o(b,{gap:"size-50",direction:"row",alignItems:"center",children:[e(Tr,{isExpanded:D.getIsAllRowsExpanded(),onClick:D.getToggleAllRowsExpandedHandler(),"aria-label":"Expand all rows"}),"kind"]}),enableSorting:!1,accessorKey:"spanKind",maxSize:100,cell:D=>D.row.original.__additionalRow?e("div",{css:K`
                  // Since rows are flattened by default,
                  // we can use the row.depth property
                  // and paddingLeft to visually indicate the depth
                  // of the row
                  padding-left: ${D.row.depth*2}rem;
                `,children:e(I,{svg:e(Vo,{})})}):e("div",{css:K`
                // Since rows are flattened by default,
                // we can use the row.depth property
                // and paddingLeft to visually indicate the depth
                // of the row
                padding-left: ${D.row.depth*2}rem;
              `,children:o(b,{gap:"size-50",children:[D.row.getCanExpand()?e(Tr,{isExpanded:D.row.getIsExpanded(),onClick:D.row.getToggleExpandedHandler(),"aria-label":"Expand row"}):null,e(Pi,{spanKind:D.getValue()})]})})},{header:"name",accessorKey:"name",enableSorting:!1,cell:({getValue:D,row:$})=>{const{traceId:U}=$.original.trace,ne=$.original.isAdditionalSpansRow?null:$.original.id;return e(we,{to:`${U}${ne?`?${mn}=${ne}`:""}`,children:D()})}},{header:"input",accessorKey:"input.value",enableSorting:!1,cell:Re},{header:"output",accessorKey:"output.value",enableSorting:!1,cell:Re},{header:"metadata",accessorKey:"metadata",enableSorting:!1,cell:n2},...L,{header:"start time",accessorKey:"startTime",cell:D=>D.row.original.__additionalRow?null:e(_e,{...D})},{header:"latency",accessorKey:"latencyMs",cell:({getValue:D,row:$})=>{const U=D();return U===null||typeof U!="number"||$.original.__additionalRow?null:e(je,{latencyMs:U})}},{header:"total tokens",minSize:80,accessorKey:"cumulativeTokenCountTotal",cell:({row:D,getValue:$})=>{if(D.original.__additionalRow)return null;const U=$();return U===null?"--":e(La,{tokenCountTotal:U,nodeId:D.original.trace.id})}}],[L]);m.useEffect(()=>{if(l.current===!0){l.current=!1;return}const D=r[0];m.startTransition(()=>{h({sort:D?ng(D):eg,after:null,first:io,filterCondition:d},{fetchPolicy:"store-and-network"})})},[r,h,d,g]);const w=m.useCallback(D=>{if(D){const{scrollHeight:$,scrollTop:U,clientHeight:ne}=D;$-U-ne<300&&!y&&p&&u(io)}},[p,y,u]),V=lr(),Q=V==null?void 0:V.setTraceSequence;m.useEffect(()=>{if(Q)return Q(f.rootSpans.edges.map(({rootSpan:D})=>({traceId:D.trace.traceId,spanId:D.id}))),()=>{Q([])}},[f.rootSpans.edges,Q]);const[x,R]=m.useState({}),A=en(D=>D.columnVisibility),z=en(D=>D.setColumnSizing),N=en(D=>D.columnSizing),j=Ce({columns:_,data:C,onExpandedChange:R,manualSorting:!0,getSubRows:D=>D.children,state:{sorting:r,expanded:x,columnVisibility:A,rowSelection:t,columnSizing:N},columnResizeMode:"onChange",onRowSelectionChange:i,enableSubRowSelection:!1,onSortingChange:s,onColumnSizingChange:z,getCoreRowModel:Ke(),getSortedRowModel:ln(),getExpandedRowModel:fo(),getRowId:D=>D.id}),Z=j.getRowModel().rows,se=j.getSelectedRowModel().flatRows,Ye=se.map(D=>({id:D.original.id,traceId:D.original.trace.id})),kn=m.useCallback(()=>{i({})},[i]),ma=Z.length===0,Rn=j.getAllColumns().filter(D=>D.columns.length===0),{columnSizingInfo:B,columnSizing:ie}=j.getState(),te=j.getFlatHeaders,Ae=Rn.length,Pe=fn.useMemo(()=>{const D=te(),$={};for(let U=0;U<D.length;U++){const ne=D[U];$[`--header-${ne.id}-size`]=ne.getSize(),$[`--col-${ne.column.id}-size`]=ne.column.getSize()}return $},[te,B,ie,Ae]);return o("div",{css:rr,children:[e(v,{paddingTop:"size-100",paddingBottom:"size-100",paddingStart:"size-200",paddingEnd:"size-200",borderBottomColor:"grey-300",borderBottomWidth:"thin",flex:"none",children:o(b,{direction:"row",gap:"size-100",width:"100%",alignItems:"center",children:[e(Um,{onValidCondition:c}),e(Om,{columns:Rn,query:f})]})}),e("div",{css:K`
          flex: 1 1 auto;
          overflow: auto;
        `,onScroll:D=>w(D.target),ref:a,children:o("table",{css:Un,style:{...Pe,width:j.getTotalSize(),minWidth:"100%"},children:[e("thead",{children:j.getHeaderGroups().map(D=>e("tr",{children:D.headers.map($=>e("th",{style:{width:`calc(var(--header-${$.id}-size) * 1px)`},colSpan:$.colSpan,children:$.isPlaceholder?null:o(J,{children:[o("div",{"data-sortable":$.column.getCanSort(),className:$.column.getCanSort()?"sort":"",onClick:$.column.getToggleSortingHandler(),style:{left:$.getStart(),width:$.getSize()},children:[e(an,{maxWidth:"100%",children:W($.column.columnDef.header,$.getContext())}),$.column.getIsSorted()?e(I,{className:"sort-icon",svg:$.column.getIsSorted()==="asc"?e(Xe,{}):e(Ze,{})}):null]}),e("div",{onMouseDown:$.getResizeHandler(),onTouchStart:$.getResizeHandler(),className:`resizer ${$.column.getIsResizing()?"isResizing":""}`})]})},$.id))},D.id))}),ma?e($m,{projectName:f.name}):B.isResizingColumn?e(e2,{table:j}):e(ig,{table:j})]})}),se.length?e(Zm,{selectedSpans:Ye,onClearSelection:kn}):null]})}const t2=({tracesQueryReference:n})=>{const a=T.usePreloadedQuery($d,n);return e(l2,{project:a.project})},aP=()=>{const{tracesQueryReference:n}=At();return n?e(or,{children:o(cu,{children:[e(nr,{children:e(m.Suspense,{fallback:e(ge,{}),children:e(t2,{tracesQueryReference:n})})}),e(m.Suspense,{children:e(ve,{})})]})}):null},og=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}],l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},t={kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],type:"Project",abstractKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"projectLoaderQuery",selections:[{alias:"project",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[l,t],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"projectLoaderQuery",selections:[{alias:"project",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},l,t],storageKey:null}]},params:{cacheID:"146b6f58a3f2f95565821ff5d976155d",id:null,metadata:{},name:"projectLoaderQuery",operationKind:"query",text:`query projectLoaderQuery(
  $id: ID!
) {
  project: node(id: $id) {
    __typename
    id
    ... on Project {
      name
    }
  }
}
`}}}();og.hash="3e1dc1a02098a23c327567a7fcf393fd";async function lP(n){const{projectId:a}=n.params;return await T.fetchQuery(he,og,{id:a}).toPromise()}function tP(){const n=Up(),a=m.useMemo(()=>n instanceof Error&&n.message==="Failed to fetch"?e(i2,{}):e(r2,{error:n}),[n]);return e("main",{css:K`
        width: 100%;
        height: 100%;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
      `,children:e("section",{css:K`
          width: 500px;
          /* Add spacing on the bottom so it gets pushed down */
          margin-top: 200px;
          display: flex;
          flex-direction: column;
        `,children:a})})}function i2(){return o(J,{children:[o(b,{direction:"column",width:"100%",alignItems:"center",children:[e(st,{graphicKey:"not found"}),e("h1",{children:"Server disconnected"})]}),e("p",{children:"We are unable to reach the Phoenix server. Please ensure that Phoenix is running and try again."})]})}function r2({error:n}){return o(J,{children:[o(b,{direction:"column",width:"100%",alignItems:"center",children:[e(st,{graphicKey:"error"}),e("h1",{children:"Something went wrong"})]}),e("p",{children:"We strive to do our very best but 🐛 bugs happen. It would mean a lot to us if you could file a an issue. If you feel comfortable, please include the error details below in your issue. We will get back to you as soon as we can."}),e("p",{css:K`
          display: flex;
          flex-direction: row;
          justify-content: flex-end;
          gap: var(--ac-global-dimension-static-size-100);
        `,children:o("span",{css:K`
            display: inline-flex;
            flex-direction: row;
            align-items: baseline;
            gap: 0.2em;
          `,children:["💙 the",e(_n,{href:"mailto:phoenix-devs@arize.com",children:"phoenix team"})]})}),o("div",{css:K`
          display: flex;
          flex-direction: row;
          justify-content: flex-end;
          align-items: center;
          gap: var(--ac-global-dimension-static-size-100);
        `,children:[e(_n,{href:"https://github.com/Arize-ai/phoenix/issues/new?assignees=&labels=bug&template=bug_report.md&title=%5BBUG%5D",children:"file an issue with us"}),e(M,{variant:"primary",size:"S",onPress:()=>{window.location.href="/"},children:"Return Home"})]}),o("details",{open:!0,children:[e("summary",{children:"error details"}),e("pre",{css:K`
            white-space: pre-wrap;
            overflow-wrap: break-word;
            overflow: hidden;
            overflow-y: auto;
            max-height: 500px;
          `,children:n instanceof Error?n.message:null})]})]})}const sg=function(){var n=[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"endTime",storageKey:null}],a=[{alias:null,args:null,concreteType:"Model",kind:"LinkedField",name:"model",plural:!1,selections:[{alias:null,args:null,concreteType:"Inferences",kind:"LinkedField",name:"primaryInferences",plural:!1,selections:n,storageKey:null},{alias:null,args:null,concreteType:"Inferences",kind:"LinkedField",name:"referenceInferences",plural:!1,selections:n,storageKey:null},{alias:null,args:null,concreteType:"Inferences",kind:"LinkedField",name:"corpusInferences",plural:!1,selections:n,storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"ModelRootQuery",selections:a,type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"ModelRootQuery",selections:a},params:{cacheID:"c3baccc5527002697b40a06eef432a4d",id:null,metadata:{},name:"ModelRootQuery",operationKind:"query",text:`query ModelRootQuery {
  model {
    primaryInferences {
      name
      startTime
      endTime
    }
    referenceInferences {
      name
      startTime
      endTime
    }
    corpusInferences {
      name
      startTime
      endTime
    }
  }
}
`}}}();sg.hash="b73d8f3f532a0c6f88863f3c6dd5734f";const o2=sg;function iP(){const n=T.useLazyLoadQuery(o2,{}),{model:{primaryInferences:a,referenceInferences:l,corpusInferences:t}}=n;return e(rh,{primaryInferences:a,referenceInferences:l??null,corpusInferences:t??null,children:e(ih,{timeRangeBounds:{start:new Date(a.startTime),end:new Date(a.endTime)},children:e(ve,{})})})}function rP(){return e(Do,{children:e(ve,{})})}const dg=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"id"},{defaultValue:null,kind:"LocalArgument",name:"timeRange"}],a=[{kind:"Variable",name:"id",variableName:"id"}],l={kind:"Variable",name:"timeRange",variableName:"timeRange"},t=[l],i={kind:"InlineFragment",selections:[{alias:null,args:t,kind:"ScalarField",name:"traceCount",storageKey:null},{alias:"latencyMsP50",args:[{kind:"Literal",name:"probability",value:.5},l],kind:"ScalarField",name:"latencyMsQuantile",storageKey:null},{alias:null,args:t,kind:"ScalarField",name:"tokenCountTotal",storageKey:null}],type:"Project",abstractKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ProjectsPageProjectMetricsQuery",selections:[{alias:"project",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[i],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ProjectsPageProjectMetricsQuery",selections:[{alias:"project",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},i,{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null}]},params:{cacheID:"d5de8bdb83475f2bc238b517527c639d",id:null,metadata:{},name:"ProjectsPageProjectMetricsQuery",operationKind:"query",text:`query ProjectsPageProjectMetricsQuery(
  $id: ID!
  $timeRange: TimeRange!
) {
  project: node(id: $id) {
    __typename
    ... on Project {
      traceCount(timeRange: $timeRange)
      latencyMsP50: latencyMsQuantile(probability: 0.5, timeRange: $timeRange)
      tokenCountTotal(timeRange: $timeRange)
    }
    id
  }
}
`}}}();dg.hash="d61aeef7b0022043e0d4d220f435a066";const cg=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"after"},{defaultValue:null,kind:"LocalArgument",name:"filter"},{defaultValue:50,kind:"LocalArgument",name:"first"},{defaultValue:null,kind:"LocalArgument",name:"sort"}],a=[{kind:"Variable",name:"after",variableName:"after"},{kind:"Variable",name:"filter",variableName:"filter"},{kind:"Variable",name:"first",variableName:"first"},{kind:"Variable",name:"sort",variableName:"sort"}],l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ProjectsPageProjectsQuery",selections:[{args:a,kind:"FragmentSpread",name:"ProjectsPageProjectsFragment"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ProjectsPageProjectsQuery",selections:[{alias:null,args:a,concreteType:"ProjectConnection",kind:"LinkedField",name:"projects",plural:!1,selections:[{alias:null,args:null,concreteType:"ProjectEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"project",args:null,concreteType:"Project",kind:"LinkedField",name:"node",plural:!1,selections:[l,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"gradientStartColor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"gradientEndColor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"endTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},l],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:a,filters:["sort","filter"],handle:"connection",key:"ProjectsPage_projects",kind:"LinkedHandle",name:"projects"}]},params:{cacheID:"4ce729574f508383c8126b9947ee799c",id:null,metadata:{},name:"ProjectsPageProjectsQuery",operationKind:"query",text:`query ProjectsPageProjectsQuery(
  $after: String = null
  $filter: ProjectFilter = null
  $first: Int = 50
  $sort: ProjectSort = null
) {
  ...ProjectsPageProjectsFragment_3JsJJ3
}

fragment ProjectsPageProjectsFragment_3JsJJ3 on Query {
  projects(first: $first, after: $after, sort: $sort, filter: $filter) {
    edges {
      project: node {
        id
        name
        gradientStartColor
        gradientEndColor
        endTime
        startTime
      }
      cursor
      node {
        __typename
        id
      }
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
}
`}}}();cg.hash="d4c6c361639eeba67a41568089bf699a";const ug=function(){var n=["projects"];return{argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"after"},{defaultValue:null,kind:"LocalArgument",name:"filter"},{defaultValue:50,kind:"LocalArgument",name:"first"},{defaultValue:null,kind:"LocalArgument",name:"sort"}],kind:"Fragment",metadata:{connection:[{count:"first",cursor:"after",direction:"forward",path:n}],refetch:{connection:{forward:{count:"first",cursor:"after"},backward:null,path:n},fragmentPathInResult:[],operation:cg}},name:"ProjectsPageProjectsFragment",selections:[{alias:"projects",args:[{kind:"Variable",name:"filter",variableName:"filter"},{kind:"Variable",name:"sort",variableName:"sort"}],concreteType:"ProjectConnection",kind:"LinkedField",name:"__ProjectsPage_projects_connection",plural:!1,selections:[{alias:null,args:null,concreteType:"ProjectEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"project",args:null,concreteType:"Project",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"gradientStartColor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"gradientEndColor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"endTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null}],type:"Query",abstractKey:null}}();ug.hash="d4c6c361639eeba67a41568089bf699a";const mg=function(){var n={defaultValue:null,kind:"LocalArgument",name:"filter"},a={defaultValue:null,kind:"LocalArgument",name:"first"},l={defaultValue:null,kind:"LocalArgument",name:"sort"},t=[{kind:"Variable",name:"filter",variableName:"filter"},{kind:"Variable",name:"first",variableName:"first"},{kind:"Variable",name:"sort",variableName:"sort"}],i={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{fragment:{argumentDefinitions:[n,a,l],kind:"Fragment",metadata:null,name:"ProjectsPageQuery",selections:[{args:t,kind:"FragmentSpread",name:"ProjectsPageProjectsFragment"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[a,l,n],kind:"Operation",name:"ProjectsPageQuery",selections:[{alias:null,args:t,concreteType:"ProjectConnection",kind:"LinkedField",name:"projects",plural:!1,selections:[{alias:null,args:null,concreteType:"ProjectEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"project",args:null,concreteType:"Project",kind:"LinkedField",name:"node",plural:!1,selections:[i,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"gradientStartColor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"gradientEndColor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"endTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},i],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:t,filters:["sort","filter"],handle:"connection",key:"ProjectsPage_projects",kind:"LinkedHandle",name:"projects"}]},params:{cacheID:"ca0df034be070fca2025c4f8922b9932",id:null,metadata:{},name:"ProjectsPageQuery",operationKind:"query",text:`query ProjectsPageQuery(
  $first: Int
  $sort: ProjectSort
  $filter: ProjectFilter
) {
  ...ProjectsPageProjectsFragment_1bvy9D
}

fragment ProjectsPageProjectsFragment_1bvy9D on Query {
  projects(first: $first, sort: $sort, filter: $filter) {
    edges {
      project: node {
        id
        name
        gradientStartColor
        gradientEndColor
        endTime
        startTime
      }
      cursor
      node {
        __typename
        id
      }
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
}
`}}}();mg.hash="c85f2b2ff3b9697931cca71426ea0b59";const s2=()=>{const{projectViewMode:n,setProjectViewMode:a}=un(l=>({projectViewMode:l.projectViewMode,setProjectViewMode:l.setProjectViewMode}));return o(xt,{css:K`
        flex-basis: fit-content;
      `,selectedKeys:[n],selectionMode:"single",onSelectionChange:l=>{const t=l.values().next().value;typeof t=="string"&&a(t)},size:"S",children:[o(Ya,{delay:100,children:[e(Pn,{id:"grid",leadingVisual:e(I,{svg:e(oh,{})})}),e(el,{offset:10,children:e(v,{padding:"size-100",backgroundColor:"light",borderColor:"dark",borderWidth:"thin",borderRadius:"small",children:e(F,{children:"View projects in a grid"})})})]}),o(Ya,{delay:100,children:[e(Pn,{id:"table",leadingVisual:e(I,{svg:e(sh,{})})}),e(el,{offset:10,children:e(v,{padding:"size-100",backgroundColor:"light",borderColor:"dark",borderWidth:"thin",borderRadius:"small",children:e(F,{children:"View projects in a table"})})})]})]})},d2="https://arize.com/docs/phoenix/tracing/how-to-tracing/setup-tracing";function c2({variant:n}){const[a,l]=m.useState(null);return o("div",{children:[e(M,{leadingVisual:e(I,{svg:e(Lo,{})}),size:"S",variant:n,onPress:()=>{l(e(u2,{}))},children:"New Project"}),e(ue,{isDismissable:!0,type:"slideOver",onDismiss:()=>l(null),children:a})]})}function u2(){const[n,a]=m.useState("Python");return e(oe,{title:"Create a New Project",size:"L",children:o(v,{padding:"size-400",overflow:"auto",children:[e(v,{paddingBottom:"size-200",children:e(tl,{language:n,onChange:a})}),e(v,{paddingBottom:"size-100",children:o(F,{children:["Projects are created when you log your first trace via OpenTelemetry. See the"," ",e(_n,{href:d2,children:"documentation"})," ","for a complete guide."]})}),n==="Python"?e(ds,{}):e(cs,{})]})})}const gg=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"Query",kind:"LinkedField",name:"clearProject",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ProjectActionMenuClearMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ProjectActionMenuClearMutation",selections:a},params:{cacheID:"63319b4e42b499db2447817f1dc821fb",id:null,metadata:{},name:"ProjectActionMenuClearMutation",operationKind:"mutation",text:`mutation ProjectActionMenuClearMutation(
  $input: ClearProjectInput!
) {
  clearProject(input: $input) {
    __typename
  }
}
`}}}();gg.hash="c43eec4d6b882468c611dd9ebf3b095e";const pg=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"projectId"}],a=[{alias:null,args:[{kind:"Variable",name:"id",variableName:"projectId"}],concreteType:"Query",kind:"LinkedField",name:"deleteProject",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ProjectActionMenuDeleteMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ProjectActionMenuDeleteMutation",selections:a},params:{cacheID:"9a79d6d39a73196765b89d130a8e6a3f",id:null,metadata:{},name:"ProjectActionMenuDeleteMutation",operationKind:"mutation",text:`mutation ProjectActionMenuDeleteMutation(
  $projectId: ID!
) {
  deleteProject(id: $projectId) {
    __typename
  }
}
`}}}();pg.hash="e97af5c157e96020ec94d1ca72af6737";const yg=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"Query",kind:"LinkedField",name:"clearProject",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"RemoveProjectDataFormMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"RemoveProjectDataFormMutation",selections:a},params:{cacheID:"1b27a3f7535c3f3943b0f2248d1505a6",id:null,metadata:{},name:"RemoveProjectDataFormMutation",operationKind:"mutation",text:`mutation RemoveProjectDataFormMutation(
  $input: ClearProjectInput!
) {
  clearProject(input: $input) {
    __typename
  }
}
`}}}();yg.hash="212501fe2d6367ec1503bd7a00c1730f";function m2(n){const{projectId:a}=n,l=ob(),t=m.useRef(null),[i,r]=T.useMutation(yg),{control:s,handleSubmit:d,setError:c,formState:{isValid:g}}=Ve({defaultValues:{endDate:Hp(new Date(Date.now()-dh).toISOString())}}),f=m.useCallback(u=>{const p=u.endDate.toDate(pi());if(!Gp(p))return c("endDate",{message:"Date is not in a valid format"});i({variables:{input:{id:a,endTime:new Date(p).toISOString()}},onCompleted:()=>{n.onComplete()},onError:y=>{alert("Failed to clear project traces: "+y)}})},[i,a,n,c]);return o("form",{onSubmit:d(f),ref:t,children:[o(v,{padding:"size-200",children:[e(F,{color:"danger",children:" This will remove all data before the following date. This cannot be undone."}),e(G,{name:"endDate",control:s,rules:{required:"field is required"},render:({field:{name:u,onChange:p,onBlur:y,value:h},fieldState:{invalid:k,error:S}})=>o(ch,{isInvalid:k,onChange:p,name:u,onBlur:y,value:h,granularity:"second",hideTimeZone:!0,css:K`
                .react-aria-DateInput {
                  width: 100%;
                }
              `,children:[e(H,{children:"End Date"}),e(Wp,{children:C=>e(Jp,{segment:C})}),S?e(ke,{children:S.message}):e(F,{slot:"description",children:`The date up to which you want to remove data. The format is ${l}.`})]})})]}),e(v,{paddingEnd:"size-200",paddingTop:"size-100",paddingBottom:"size-100",borderTopColor:"light",borderTopWidth:"thin",children:e(b,{direction:"row",justifyContent:"end",children:e(M,{type:"submit",variant:"danger",isDisabled:!g||r,size:"S",leadingVisual:r?e(I,{svg:e(sn,{})}):void 0,onPress:()=>{var u;(u=t.current)==null||u.requestSubmit()},children:r?"Removing...":"Remove Data"})})})]})}function fg({projectId:n,projectName:a,onProjectDelete:l,onProjectClear:t,onProjectRemoveData:i,variant:r="quiet"}){const[s,d]=m.useState(null),c=a!=="default",[g]=T.useMutation(pg),[f]=T.useMutation(gg),u=m.useCallback(()=>{m.startTransition(()=>{g({variables:{projectId:n}}),l()})},[g,n,l]),p=m.useCallback(()=>{m.startTransition(()=>{f({variables:{input:{id:n}},onCompleted:()=>{t()},onError:S=>{alert("Failed to clear project: "+S)}})})},[f,n,t]),y=m.useCallback(()=>{d(o(oe,{size:"S",title:"Delete Project",children:[e(v,{padding:"size-200",children:e(F,{color:"danger",children:`Are you sure you want to delete project ${a}? This cannot be undone.`})}),e(v,{paddingEnd:"size-200",paddingTop:"size-100",paddingBottom:"size-100",borderTopColor:"light",borderTopWidth:"thin",children:e(b,{direction:"row",justifyContent:"end",children:e(M,{variant:"danger",onPress:()=>{u(),d(null)},children:"Delete Project"})})})]}))},[u,a]),h=m.useCallback(()=>{d(o(oe,{size:"S",title:"Clear Project",children:[e(v,{padding:"size-200",children:e(F,{color:"danger",children:`Are you sure you want to clear project ${a}? All traces and evaluations for this project will be deleted. This cannot be undone.`})}),e(v,{paddingEnd:"size-200",paddingTop:"size-100",paddingBottom:"size-100",borderTopColor:"light",borderTopWidth:"thin",children:e(b,{direction:"row",justifyContent:"end",children:e(M,{variant:"danger",onPress:()=>{p(),d(null)},children:"Clear"})})})]}))},[p,a]),k=m.useCallback(()=>{d(e(oe,{size:"S",title:"Remove Data",children:e(m2,{projectId:n,onComplete:()=>{i(),d(null)}})}))},[i,n]);return o("div",{onClick:S=>{S.preventDefault(),S.stopPropagation()},children:[o(ra,{buttonVariant:r,buttonSize:"compact",align:"end",onAction:S=>{switch(S){case"copyName":{navigator.clipboard.writeText(a);return}case"deleteProject":return y();case"clearProject":return h();case"removeProjectData":return k()}},disabledKeys:c?[]:["deleteProject"],children:[e(xe,{textValue:"Copy Name",children:o(b,{direction:"row",gap:"size-75",justifyContent:"start",alignItems:"center",children:[e(I,{svg:e(ri,{})}),e(F,{children:"Copy Name"})]})},"copyName"),e(xe,{textValue:"Clear All Traces",children:o(b,{direction:"row",gap:"size-75",justifyContent:"start",alignItems:"center",children:[e(I,{svg:e(Po,{})}),e(F,{children:"Clear All Data"})]})},"clearProject"),e(xe,{textValue:"Remove Data",children:o(b,{direction:"row",gap:"size-75",justifyContent:"start",alignItems:"center",children:[e(I,{svg:e(Dt,{})}),e(F,{children:"Remove Data"})]})},"removeProjectData"),c?e(xe,{children:o(b,{direction:"row",gap:"size-75",justifyContent:"start",alignItems:"center",children:[e(I,{svg:e(Je,{})}),e(F,{children:"Delete"})]})},"deleteProject"):null]}),e(ue,{type:"modal",isDismissable:!0,onDismiss:()=>d(null),children:s})]})}const g2=200;function p2({onChange:n}){const a=m.useMemo(()=>Xl(t=>{m.startTransition(()=>{n(t)})},g2),[n]),l=m.useCallback(t=>{a(t)},[a]);return e(ee,{size:"S",css:K`
        flex-basis: 100%;
      `,"aria-label":"Search projects by name",name:"filter",type:"search",onChange:l,children:e(X,{placeholder:"Search projects by name"})})}const gi=10,sr=()=>{const{projectSortOrder:n}=un(l=>({projectViewMode:l.projectViewMode,projectSortOrder:l.projectSortOrder}));return m.useMemo(()=>({sort:{col:n.column,dir:n.direction}}),[n])};function oP(){const{timeRange:n}=Ct(),a=sr(),[l]=m.useState(()=>a),t=T.useLazyLoadQuery(mg,{first:gi,filter:{value:"",col:"name"},...l});return e(m.Suspense,{fallback:e(ge,{}),children:e(y2,{timeRange:n,query:t})})}function y2({timeRange:n,query:a}){const{projectViewMode:l}=un(x=>({projectViewMode:x.projectViewMode})),t=sr(),[i,r]=m.useState(""),[s,d]=ly(),c=m.useMemo(()=>{var x,R;return{start:(x=n==null?void 0:n.start)==null?void 0:x.toISOString(),end:(R=n==null?void 0:n.end)==null?void 0:R.toISOString()}},[n]),{data:g,loadNext:f,hasNext:u,isLoadingNext:p,refetch:y}=T.usePaginationFragment(ug,a),h=m.useMemo(()=>({...t,filter:{value:i,col:"name"}}),[t,i]),k=m.useCallback(({vars:x,onComplete:R})=>{m.startTransition(()=>{y({...h,...x},{fetchPolicy:"store-and-network",onComplete:()=>{R==null||R()}})})},[y,h]),S=g==null?void 0:g.projects.edges.map(x=>x.project),C=m.useRef(null),P=m.useCallback(x=>{if(x){const{scrollHeight:R,scrollTop:A,clientHeight:z}=x;R-A-z<300&&!p&&u&&f(gi,{UNSTABLE_extraVariables:h})}},[u,p,f,h]),L=m.useCallback(x=>{k({vars:{sort:x}})},[k]),_=m.useCallback(x=>{m.startTransition(()=>{k({onComplete:()=>{s({variant:"success",title:"Project Deleted",message:`Project ${x} has been deleted.`})}})})},[s,k]),w=m.useCallback(x=>{m.startTransition(()=>{k({onComplete:()=>{s({variant:"success",title:"Project Cleared",message:`Project ${x} has been cleared of traces.`})}})})},[s,k]),V=m.useCallback(x=>{m.startTransition(()=>{k({onComplete:()=>{s({variant:"success",title:"Project Data Removed",message:`Old data from project ${x} have been removed.`})}})})},[s,k]),Q=m.useCallback(()=>{f(gi,{UNSTABLE_extraVariables:h})},[f,h]);return o("div",{css:K`
        display: flex;
        flex-direction: column;
        overflow: auto;
      `,onScroll:x=>P(x.target),ref:C,children:[e(v,{paddingStart:"size-200",paddingEnd:"size-200",paddingTop:"size-100",paddingBottom:"size-100",width:"100%",borderBottomColor:"grey-200",borderBottomWidth:"thin",flex:"none",children:o(b,{direction:"row",justifyContent:"space-between",alignItems:"center",gap:"size-100",children:[e(p2,{onChange:x=>{r(x),k({vars:{filter:{value:x,col:"name"}}})}}),o(b,{direction:"row",justifyContent:"end",alignItems:"center",gap:"size-100",css:K`
              button {
                text-wrap: nowrap;
              }
            `,children:[e(s2,{}),e(mt,{}),e(c2,{variant:"primary"})]})]})}),l==="grid"?e("div",{css:K`
            display: flex;
            flex-direction: column;
            flex: 1 1 auto;
          `,children:e(f2,{projects:S,onDelete:_,onClear:w,onRemove:V,timeRangeVariable:c,hasNext:u,loadNext:Q,isLoadingNext:p,onSort:L})}):e("div",{css:K`
            display: flex;
            flex-direction: column;
            flex: 1 1 auto;
          `,children:e(F2,{projects:S,onDelete:_,onClear:w,onRemove:V,timeRangeVariable:c,hasNext:u,loadNext:Q,isLoadingNext:p,onSort:L})}),d]})}function f2({projects:n,onDelete:a,onClear:l,onRemove:t,timeRangeVariable:i,hasNext:r,loadNext:s,isLoadingNext:d}){return o(v,{padding:"size-200",width:"100%",children:[e("ul",{css:K`
          display: grid;
          grid-template-columns: repeat(
            auto-fill,
            minmax(var(--ac-global-dimension-size-3600), 1fr)
          );
          gap: var(--ac-global-dimension-size-200);
        `,children:n==null?void 0:n.map(c=>e("li",{css:K`
              display: flex;
              flex-direction: column;
              height: 100%;
              & > div {
                height: 100%;
              }
            `,children:e(we,{title:c.name,to:`/projects/${c.id}`,css:K`
                text-decoration: none;
                display: flex;
                flex-direction: column;
                height: 100%;
              `,children:e(h2,{project:c,timeRange:i,onProjectDelete:()=>a(c.name),onProjectClear:()=>l(c.name),onProjectRemoveData:()=>t(c.name)})})},c.id))}),r&&e(b,{width:"100%",justifyContent:"center",alignItems:"center",marginTop:"size-200",children:e(ms,{onLoadMore:s,isLoadingNext:d})})]})}function hg({gradientStartColor:n,gradientEndColor:a}){return e("div",{css:K`
        border-radius: 50%;
        width: 32px;
        height: 32px;
        background: linear-gradient(
          136.27deg,
          ${n} 14.03%,
          ${a} 84.38%
        );
        flex-shrink: 0;
      `})}function h2({project:n,onProjectDelete:a,onProjectClear:l,onProjectRemoveData:t,timeRange:i}){const{gradientStartColor:r,gradientEndColor:s,endTime:d}=n,c=m.useMemo(()=>d?`Last updated  ${Xp(new Date(d),new Date,{addSuffix:!0})}`:"No traces uploaded yet.",[d]);return o("div",{css:K`
        padding: var(--ac-global-dimension-size-200);
        border: 1px solid var(--ac-global-color-grey-400);
        background-color: var(--ac-global-color-grey-100);
        box-shadow:
          0 0 1px 0px var(--ac-global-color-grey-400) inset,
          0 0 1px 0px var(--ac-global-color-grey-400);
        border-radius: var(--ac-global-rounding-medium);
        transition: border-color 0.2s;
        &:hover {
          border-color: var(--ac-global-color-primary);
        }
        display: flex;
        flex-direction: column;
        justify-content: space-between;
        gap: var(--ac-global-dimension-size-200);
        height: 100%;
      `,children:[o(b,{direction:"row",justifyContent:"space-between",alignItems:"start",children:[o(b,{direction:"row",gap:"size-100",alignItems:"center",minWidth:0,children:[e(hg,{gradientStartColor:r,gradientEndColor:s}),o(b,{direction:"column",minWidth:0,children:[e(ae,{level:2,css:K`
                overflow: hidden;
                display: -webkit-box;
                -webkit-box-orient: vertical;
                -webkit-line-clamp: 1;
                overflow: hidden;
              `,children:n.name}),e(F,{color:"text-700",size:"XS",fontStyle:"italic",children:c})]})]}),e(fg,{projectId:n.id,projectName:n.name,onProjectDelete:a,onProjectClear:l,onProjectRemoveData:t})]}),e(kg,{projectId:n.id,timeRange:i})]})}const k2=dg;function b2(){return o(b,{direction:"row",justifyContent:"space-between",minHeight:"size-600",children:[o(b,{direction:"column",flex:"none",gap:"size-100",children:[e(F,{elementType:"h3",size:"S",color:"text-700",children:"Total Traces"}),e(Bt,{width:60,height:20,animation:"wave"})]}),o(b,{direction:"column",flex:"none",gap:"size-100",children:[e(F,{elementType:"h3",size:"S",color:"text-700",children:"Total Tokens"}),e(Bt,{width:60,height:20,animation:"wave"})]}),o(b,{direction:"column",flex:"none",gap:"size-100",children:[e(F,{elementType:"h3",size:"S",color:"text-700",children:"Latency P50"}),e(Bt,{width:60,height:20,animation:"wave"})]})]})}const kg=m.memo(function({projectId:a,timeRange:l,flexProps:t}){const i=T.useRelayEnvironment(),r=m.useRef(null),[s,d]=m.useState(null),c=m.useCallback(()=>(d(null),T.fetchQuery(i,k2,{id:a,timeRange:l}).subscribe({next:u=>{d(u)},error:()=>{d(null)}})),[a,l,i]);return m.useEffect(()=>(r.current=c(),()=>{var g;(g=r.current)==null||g.unsubscribe(),r.current=null}),[c]),s==null?e(b2,{}):e(S2,{project:s,flexProps:t})});function S2({project:n,flexProps:a}){const{project:{traceCount:l,tokenCountTotal:t,latencyMsP50:i}}=n;return o(b,{direction:"row",justifyContent:"space-between",minHeight:"size-600",...a,children:[o(b,{direction:"column",flex:"none",children:[e(F,{elementType:"h3",size:"S",color:"text-700",children:"Total Traces"}),e(F,{size:"L",children:za(l)})]}),o(b,{direction:"column",flex:"none",children:[e(F,{elementType:"h3",size:"S",color:"text-700",children:"Total Tokens"}),e(F,{size:"L",children:za(t)})]}),o(b,{direction:"column",flex:"none",children:[e(F,{elementType:"h3",size:"S",color:"text-700",children:"Latency P50"}),i!=null?e(je,{latencyMs:i,size:"L"}):e(F,{size:"L",children:"--"})]})]})}const v2=["name","endTime"];function F2({projects:n,onDelete:a,onClear:l,onRemove:t,timeRangeVariable:i,hasNext:r,loadNext:s,isLoadingNext:d,onSort:c}){const g=ce(),f=m.useMemo(()=>[{header:"name",accessorKey:"name",maxSize:135,cell:({row:P})=>o(b,{direction:"row",gap:"size-200",alignItems:"center",children:[e(hg,{gradientStartColor:P.original.gradientStartColor,gradientEndColor:P.original.gradientEndColor}),e(we,{to:`/projects/${P.original.id}`,children:e(an,{maxWidth:"300px",children:P.original.name})})]})},{header:"last updated at",accessorKey:"endTime",maxSize:30,cell:_e},{header:"metrics",id:"metrics",enableSorting:!1,cell:({row:P})=>e("div",{css:K`
                  max-width: 100%;
                `,children:e(kg,{flexProps:{justifyContent:"start",gap:"size-800",wrap:"wrap",rowGap:"size-100"},projectId:P.original.id,timeRange:i})})},{header:"",id:"actions",enableSorting:!1,size:10,maxSize:10,minSize:10,cell:({row:P})=>e(fg,{variant:"default",projectId:P.original.id,projectName:P.original.name,onProjectClear:()=>l(P.original.name),onProjectRemoveData:()=>t(P.original.name),onProjectDelete:()=>a(P.original.name)})}],[i,l,a,t]),u=sr(),{setProjectSortOrder:p}=un(P=>({setProjectSortOrder:P.setProjectSortOrder})),y=m.useMemo(()=>[{id:u.sort.col,desc:u.sort.dir==="desc"}],[u.sort.col,u.sort.dir]),h=m.useCallback(P=>{if(typeof P=="function"){const L=P(y),[_]=L;if(_==null)return;const w=_.id;if(!v2.includes(w))return;c({col:w,dir:_.desc?"desc":"asc"}),p({column:w,direction:_.desc?"desc":"asc"})}},[p,y,c]),k=Ce({data:n,columns:f,getCoreRowModel:Ke(),state:{sorting:y},enableSortingRemoval:!1,onSortingChange:h}),C=k.getRowModel().rows.length===0;return e(v,{flex:"none",height:"100%",width:"100%",children:o("div",{css:K`
          flex: 1 1 auto;
          height: 100%;
          width: 100%;
        `,children:[o("table",{css:We,"data-testid":"projects-table",children:[e("thead",{children:k.getHeaderGroups().map(P=>e("tr",{children:P.headers.map(L=>e("th",{colSpan:L.colSpan,style:{width:L.getSize()},children:L.isPlaceholder?null:o("div",{className:L.column.getCanSort()?"sort":"",onClick:L.column.getToggleSortingHandler(),style:{left:L.getStart(),width:L.getSize(),textWrap:"nowrap"},children:[W(L.column.columnDef.header,L.getContext()),L.column.getIsSorted()?e(I,{className:"sort-icon",svg:L.column.getIsSorted()==="asc"?e(Xe,{}):e(Ze,{})}):null]})},L.id))},P.id))}),C?e(yn,{}):e("tbody",{children:k.getRowModel().rows.map(P=>e("tr",{onClick:()=>{g(`/projects/${P.original.id}`)},children:P.getVisibleCells().map(L=>e("td",{style:{width:L.column.getSize(),maxWidth:L.column.getSize()},children:W(L.column.columnDef.cell,L.getContext())},L.id))},P.id))})]}),r?e(v,{paddingY:"size-200",children:e(b,{direction:"row",justifyContent:"center",alignItems:"center",width:"100%",children:e(ms,{onLoadMore:s,isLoadingNext:d})})}):null]})})}const bg=function(){var n=[{kind:"Literal",name:"first",value:100},{kind:"Literal",name:"sort",value:{col:"createdAt",dir:"desc"}}];return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"DatasetsPageQuery",selections:[{args:null,kind:"FragmentSpread",name:"DatasetsTable_datasets"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"DatasetsPageQuery",selections:[{alias:null,args:n,concreteType:"DatasetConnection",kind:"LinkedField",name:"datasets",plural:!1,selections:[{alias:null,args:null,concreteType:"DatasetEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"Dataset",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"metadata",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"exampleCount",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"experimentCount",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:'datasets(first:100,sort:{"col":"createdAt","dir":"desc"})'},{alias:null,args:n,filters:["sort"],handle:"connection",key:"DatasetsTable_datasets",kind:"LinkedHandle",name:"datasets"}]},params:{cacheID:"695b221e981c4795492d79faa7d007e4",id:null,metadata:{},name:"DatasetsPageQuery",operationKind:"query",text:`query DatasetsPageQuery {
  ...DatasetsTable_datasets
}

fragment DatasetsTable_datasets on Query {
  datasets(first: 100, sort: {col: createdAt, dir: desc}) {
    edges {
      node {
        id
        name
        description
        metadata
        createdAt
        exampleCount
        experimentCount
        __typename
      }
      cursor
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
}
`}}}();bg.hash="985853a7939f44c0cefdd1a91472c67e";function C2(n){const a=n.split(`
`);return a.length>0?a[0].split(",").map(l=>l.trim()):[]}function K2(n){const{onDatasetCreated:a,onDatasetCreateError:l}=n,[t,i]=m.useState([]),{control:r,handleSubmit:s,resetField:d,formState:{isDirty:c,isValid:g}}=Ve({defaultValues:{name:"Dataset "+new Date().toISOString(),input_keys:[],output_keys:[],metadata_keys:[],description:"",metadata:{}}}),f=m.useCallback(u=>{const p=new FormData;return p.append("file",u.file[0]),p.append("name",u.name),p.append("description",u.description),p.append("metadata",JSON.stringify(u.metadata)),u.input_keys.forEach(y=>{p.append("input_keys[]",y)}),u.output_keys.forEach(y=>{p.append("output_keys[]",y)}),u.metadata_keys.forEach(y=>{p.append("metadata_keys[]",y)}),fetch(xn("/v1/datasets/upload?sync=true"),{method:"POST",body:p}).then(y=>{if(!y.ok)throw l(new Error(y.statusText||"Failed to create dataset"));return y.json()}).then(y=>{a({name:u.name,id:y.data.dataset_id})})},[l,a]);return o(gn,{onSubmit:s(f),children:[o("div",{css:K`
          padding: var(--ac-global-dimension-size-200);
          .ac-dropdown-button {
            width: 100%;
          }
        `,children:[e(G,{name:"name",control:r,rules:{required:"field is required"},render:({field:{onChange:u,onBlur:p,value:y},fieldState:{invalid:h,error:k}})=>o(ee,{isInvalid:h,onChange:u,onBlur:p,value:y.toString(),children:[e(H,{children:"Dataset Name"}),e(X,{placeholder:"e.x. Golden Dataset"}),k!=null&&k.message?e(ke,{children:k.message}):e(F,{slot:"description",children:"The name of the dataset"})]})}),e(G,{name:"description",control:r,render:({field:{onChange:u,onBlur:p,value:y},fieldState:{invalid:h,error:k}})=>o(ee,{isInvalid:h,onChange:u,onBlur:p,value:y.toString(),children:[e(H,{children:"Description"}),e(Pa,{placeholder:"e.x. A dataset for structured data extraction"}),k!=null&&k.message?e(ke,{children:k.message}):e(F,{slot:"description",children:"The description of the dataset"})]})}),e(G,{control:r,name:"file",rules:{required:"CSV file is required"},render:({field:{value:u,onChange:p,...y},fieldState:{invalid:h,error:k}})=>e(Ia,{label:"CSV file",validationState:h?"invalid":"valid",errorMessage:k==null?void 0:k.message,children:e("input",{...y,onChange:S=>{var P;p(S.target.files),d("input_keys"),d("output_keys"),d("metadata_keys");const C=(P=S.target.files)==null?void 0:P[0];if(C){const L=new FileReader;L.onload=function(_){if(!_.target)return;const w=_.target.result,V=C2(w);i(V)},L.readAsText(C)}},type:"file",id:"file",accept:".csv"})})}),e(G,{name:"input_keys",control:r,rules:{required:"field is required"},render:({field:{value:u,onChange:p},fieldState:{invalid:y,error:h}})=>e(Yt,{label:"input keys",validationState:y?"invalid":"valid",description:"the columns to use as input",columns:t,selectedColumns:u,onChange:p,errorMessage:h==null?void 0:h.message})}),e(G,{name:"output_keys",control:r,render:({field:{value:u,onChange:p},fieldState:{invalid:y,error:h}})=>e(Yt,{label:"output keys",validationState:y?"invalid":"valid",description:"the columns to use as output",columns:t,selectedColumns:u,onChange:p,errorMessage:h==null?void 0:h.message})}),e(G,{name:"metadata_keys",control:r,render:({field:{value:u,onChange:p},fieldState:{invalid:y,error:h}})=>e(Yt,{label:"metadata keys",validationState:y?"invalid":"valid",description:"the columns to use as metadata",columns:t,selectedColumns:u,onChange:p,errorMessage:h==null?void 0:h.message})})]}),e(v,{paddingEnd:"size-200",paddingTop:"size-100",paddingBottom:"size-100",borderTopColor:"light",borderTopWidth:"thin",children:e(b,{direction:"row",justifyContent:"end",children:e(M,{type:"submit",isDisabled:!g,variant:c?"primary":"default",size:"S",children:"Create Dataset"})})})]})}function Yt(n){const{columns:a,selectedColumns:l,onChange:t,label:i,validationState:r,description:s,errorMessage:d,...c}=n,g=a.length===0,f=m.useMemo(()=>g?"No columns to select":l.length>0?`${l.join(", ")}`:"No columns selected",[l,g]);return e(Ia,{label:i,isDisabled:g,validationState:r,description:s,errorMessage:d,children:e(hi,{isDisabled:g,...c,menu:e(ct,{selectionMode:"multiple",onSelectionChange:u=>{t(Array.from(u))},selectedKeys:new Set(l),children:a.map(u=>e(xe,{children:u},u))}),triggerProps:{placement:"bottom end"},children:f})})}const Sg=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"after"},{defaultValue:100,kind:"LocalArgument",name:"first"},{defaultValue:{col:"createdAt",dir:"desc"},kind:"LocalArgument",name:"sort"}],a=[{kind:"Variable",name:"after",variableName:"after"},{kind:"Variable",name:"first",variableName:"first"},{kind:"Variable",name:"sort",variableName:"sort"}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"DatasetsTableDatasetsQuery",selections:[{args:a,kind:"FragmentSpread",name:"DatasetsTable_datasets"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"DatasetsTableDatasetsQuery",selections:[{alias:null,args:a,concreteType:"DatasetConnection",kind:"LinkedField",name:"datasets",plural:!1,selections:[{alias:null,args:null,concreteType:"DatasetEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"Dataset",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"metadata",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"exampleCount",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"experimentCount",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:a,filters:["sort"],handle:"connection",key:"DatasetsTable_datasets",kind:"LinkedHandle",name:"datasets"}]},params:{cacheID:"5ac1688f54e51f9bb3247c83e23d98fb",id:null,metadata:{},name:"DatasetsTableDatasetsQuery",operationKind:"query",text:`query DatasetsTableDatasetsQuery(
  $after: String = null
  $first: Int = 100
  $sort: DatasetSort = {col: createdAt, dir: desc}
) {
  ...DatasetsTable_datasets_dWkdd
}

fragment DatasetsTable_datasets_dWkdd on Query {
  datasets(first: $first, after: $after, sort: $sort) {
    edges {
      node {
        id
        name
        description
        metadata
        createdAt
        exampleCount
        experimentCount
        __typename
      }
      cursor
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
}
`}}}();Sg.hash="fa378bc7ec26f5e877e6cf90e5ee553d";const vg=function(){var n=["datasets"];return{argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"after"},{defaultValue:100,kind:"LocalArgument",name:"first"},{defaultValue:{col:"createdAt",dir:"desc"},kind:"LocalArgument",name:"sort"}],kind:"Fragment",metadata:{connection:[{count:"first",cursor:"after",direction:"forward",path:n}],refetch:{connection:{forward:{count:"first",cursor:"after"},backward:null,path:n},fragmentPathInResult:[],operation:Sg}},name:"DatasetsTable_datasets",selections:[{alias:"datasets",args:[{kind:"Variable",name:"sort",variableName:"sort"}],concreteType:"DatasetConnection",kind:"LinkedField",name:"__DatasetsTable_datasets_connection",plural:!1,selections:[{alias:null,args:null,concreteType:"DatasetEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"Dataset",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"metadata",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"exampleCount",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"experimentCount",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null}],type:"Query",abstractKey:null}}();vg.hash="fa378bc7ec26f5e877e6cf90e5ee553d";const Fg=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"datasetId"}],a=[{alias:null,args:[{fields:[{kind:"Variable",name:"datasetId",variableName:"datasetId"}],kind:"ObjectValue",name:"input"}],concreteType:"DatasetMutationPayload",kind:"LinkedField",name:"deleteDataset",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"DeleteDatasetDialogMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"DeleteDatasetDialogMutation",selections:a},params:{cacheID:"dd7db4b6f6eac9ceaecd096c341e427c",id:null,metadata:{},name:"DeleteDatasetDialogMutation",operationKind:"mutation",text:`mutation DeleteDatasetDialogMutation(
  $datasetId: ID!
) {
  deleteDataset(input: {datasetId: $datasetId}) {
    __typename
  }
}
`}}}();Fg.hash="bd97316dd472eec18504f66e16088abc";function T2({datasetId:n,datasetName:a,onDatasetDelete:l,onDatasetDeleteError:t}){const[i,r]=T.useMutation(Fg),s=m.useCallback(()=>{m.startTransition(()=>{i({variables:{datasetId:n},onCompleted:()=>{l()},onError:d=>{t(d)}})})},[i,n,l,t]);return o(oe,{size:"S",title:"Delete Dataset",children:[e(v,{padding:"size-200",children:e(F,{color:"danger",children:`Are you sure you want to delete dataset ${a}? This will also delete all associated experiments and traces, and it cannot be undone.`})}),e(v,{paddingEnd:"size-200",paddingTop:"size-100",paddingBottom:"size-100",borderTopColor:"light",borderTopWidth:"thin",children:e(b,{direction:"row",justifyContent:"end",children:e(M,{variant:"danger",onPress:()=>{s()},isDisabled:r,leadingVisual:e(I,{svg:r?e(sn,{}):e(Je,{})}),children:"Delete Dataset"})})})]})}function P2({datasetName:n,datasetId:a,datasetDescription:l,datasetMetadata:t,onDatasetEdited:i,onDatasetEditError:r}){return e(oe,{title:"Edit Dataset",size:"M",children:e(uh,{datasetName:n,datasetId:a,datasetDescription:l,datasetMetadata:t,onDatasetEdited:i,onDatasetEditError:r})})}function x2(n){const{datasetId:a,datasetName:l,datasetDescription:t,datasetMetadata:i,onDatasetDelete:r,onDatasetDeleteError:s,onDatasetEdit:d,onDatasetEditError:c}=n,[g,f]=m.useState(null),u=m.useCallback(()=>{f(e(T2,{datasetId:a,datasetName:l,onDatasetDelete:()=>{r(),f(null)},onDatasetDeleteError:s}))},[a,l,r,s]),p=m.useCallback(()=>{f(e(P2,{datasetId:a,datasetName:l,datasetDescription:t,datasetMetadata:i,onDatasetEdited:()=>{d(),f(null)},onDatasetEditError:c}))},[t,a,i,l,d,c]);return o("div",{onClick:y=>{y.preventDefault(),y.stopPropagation()},children:[o(ra,{align:"end",buttonSize:"compact",onAction:y=>{switch(y){case"deleteDataset":u();break;case"editDataset":p();break}},children:[e(xe,{children:o(b,{direction:"row",gap:"size-75",justifyContent:"start",alignItems:"center",children:[e(I,{svg:e(Je,{})}),e(F,{children:"Delete"})]})},"deleteDataset"),e(xe,{children:o(b,{direction:"row",gap:"size-75",justifyContent:"start",alignItems:"center",children:[e(I,{svg:e(kt,{})}),e(F,{children:"Edit"})]})},"editDataset")]}),e(ue,{type:"modal",isDismissable:!0,onDismiss:()=>f(null),children:g})]})}function I2(){return e(v,{width:"100%",paddingY:"size-400",children:e(b,{direction:"column",width:"100%",alignItems:"center",justifyContent:"center",children:e(v,{width:"100%",maxWidth:"780px",children:o(b,{direction:"column",gap:"size-400",alignItems:"center",children:[e(F,{size:"XL",children:"Create datasets for testing prompts, experimentation, and fine-tuning."}),e(zi,{src:"https://storage.googleapis.com/arize-phoenix-assets/assets/videos/datasets.mp4",autoPlay:!0,muted:!0,loop:!0}),o(b,{direction:"row",gap:"size-200",children:[e(nl,{href:"https://arize.com/docs/phoenix/datasets-and-experiments/overview-datasets",target:"_blank",leadingVisual:e(I,{svg:e(Ni,{})}),children:"Documentation"}),e(nl,{href:"https://colab.research.google.com/github/arize-ai/phoenix/blob/main/tutorials/experiments/datasets_and_experiments_quickstart.ipynb",target:"_blank",leadingVisual:e(I,{svg:e(mh,{})}),children:"Quickstart"})]})]})})})})}const ro=100;function D2(n){const a=n.id;if(a!=="createdAt"&&a!=="name")throw new Error("Invalid sort column");return{col:a,dir:n.desc?"desc":"asc"}}function L2(n){const[a,l]=m.useState([]),t=m.useRef(null),i=ce(),r=me(),s=be(),{data:d,loadNext:c,hasNext:g,isLoadingNext:f,refetch:u}=T.usePaginationFragment(vg,n.query),p=m.useMemo(()=>d.datasets.edges.map(C=>C.node),[d]),y=m.useCallback(C=>{if(C){const{scrollHeight:P,scrollTop:L,clientHeight:_}=C;P-L-_<300&&!f&&g&&c(ro)}},[g,f,c]),h=Ce({columns:[{header:"name",accessorKey:"name",cell:({row:C})=>{const L=C.original.experimentCount>0?`${C.original.id}/experiments`:`${C.original.id}/examples`;return e(we,{to:L,children:C.original.name})}},{header:"description",accessorKey:"description",enableSorting:!1},{header:"created at",accessorKey:"createdAt",cell:_e},{header:"example count",accessorKey:"exampleCount",enableSorting:!1,meta:{textAlign:"right"}},{header:"experiment count",accessorKey:"experimentCount",enableSorting:!1,meta:{textAlign:"right"}},{header:"metadata",accessorKey:"metadata",enableSorting:!1,cell:Xa},{header:"",id:"actions",enableSorting:!1,size:10,cell:({row:C})=>e(x2,{datasetId:C.original.id,datasetName:C.original.name,datasetDescription:C.original.description,datasetMetadata:C.original.metadata,onDatasetEdit:()=>{r({title:"Dataset updated",message:`${C.original.name} has been successfully updated.`}),u({},{fetchPolicy:"store-and-network"})},onDatasetEditError:P=>{const L=De(P);s({title:"Dataset update failed",message:(L==null?void 0:L[0])??P.message})},onDatasetDelete:()=>{r({title:"Dataset deleted",message:`${C.original.name} has been successfully deleted.`}),u({},{fetchPolicy:"store-and-network"})},onDatasetDeleteError:P=>{const L=De(P);s({title:"Dataset deletion failed",message:(L==null?void 0:L[0])??P.message})}})}],data:p,state:{sorting:a},getCoreRowModel:Ke(),getSortedRowModel:ln(),onSortingChange:l,manualSorting:!0});m.useEffect(()=>{const C=a[0];m.startTransition(()=>{u({sort:C?D2(C):{col:"createdAt",dir:"desc"},after:null,first:ro},{fetchPolicy:"store-and-network"})})},[a,u]);const k=h.getRowModel().rows,S=k.length===0;return e("div",{css:K`
        flex: 1 1 auto;
        overflow: auto;
      `,onScroll:C=>y(C.target),ref:t,children:o("table",{css:Un,children:[e("thead",{children:h.getHeaderGroups().map(C=>e("tr",{children:C.headers.map(P=>{var L;return e("th",{colSpan:P.colSpan,children:P.isPlaceholder?null:o("div",{className:P.column.getCanSort()?"sort":"",onClick:P.column.getToggleSortingHandler(),style:{textAlign:(L=P.column.columnDef.meta)==null?void 0:L.textAlign},children:[W(P.column.columnDef.header,P.getContext()),P.column.getIsSorted()?e(I,{className:"sort-icon",svg:P.column.getIsSorted()==="asc"?e(Xe,{}):e(Ze,{})}):null]})},P.id)})},C.id))}),S?e(gh,{children:e(I2,{})}):e("tbody",{children:k.map(C=>e("tr",{onClick:()=>{const L=C.original.experimentCount>0?`${C.original.id}/experiments`:`${C.original.id}/examples`;i(L)},children:C.getVisibleCells().map(P=>{var L;return e("td",{align:(L=P.column.columnDef.meta)==null?void 0:L.textAlign,children:W(P.column.columnDef.cell,P.getContext())},P.id)})},C.id))})]})})}function sP(){return e(m.Suspense,{fallback:e(ge,{}),children:e(_2,{})})}function _2(){const[n,a]=m.useState(0),l=T.useLazyLoadQuery(bg,{},{fetchKey:n,fetchPolicy:"store-and-network"}),t=m.useCallback(()=>{a(i=>i+1)},[a]);return o(b,{direction:"column",height:"100%",children:[e(v,{padding:"size-200",borderBottomWidth:"thin",borderBottomColor:"dark",flex:"none",children:o(b,{direction:"row",justifyContent:"space-between",children:[e(ae,{level:1,children:"Datasets"}),e(A2,{onDatasetCreated:t})]})}),e(L2,{query:l})]})}function A2({onDatasetCreated:n}){const a=ce(),l=me(),t=be(),[i,r]=m.useState(null),s=()=>{r(e(oe,{size:"S",title:"New Dataset",children:e(us,{onDatasetCreated:c=>{l({title:"Dataset created",message:`${c.name} has been successfully created.`,action:{text:"Go to Dataset",onClick:()=>{a(`/datasets/${c.id}`)}}}),r(null),n()},onDatasetCreateError:c=>{const g=De(c);t({title:"Dataset creation failed",message:(g==null?void 0:g[0])??c.message})}})}))},d=()=>{r(e(oe,{size:"M",title:"New Dataset from CSV",children:e(K2,{onDatasetCreated:c=>{l({title:"Dataset created",message:`${c.name} has been successfully created.`,action:{text:"Go to Dataset",onClick:()=>{a(`/datasets/${c.id}`)}}}),r(null),n()},onDatasetCreateError:c=>{const g=De(c);t({title:"Dataset creation failed",message:(g==null?void 0:g[0])??c.message})}})}))};return o(J,{children:[o(ra,{buttonText:"Create Dataset",align:"end",icon:e(I,{svg:e(gt,{})}),onAction:c=>{switch(c){case"newDataset":s();break;case"datasetFromCSV":d();break}},children:[e(xe,{children:"New Dataset"},"newDataset"),e(xe,{children:"Dataset from CSV"},"datasetFromCSV")]}),e(ue,{type:"modal",isDismissable:!0,onDismiss:()=>r(null),children:i})]})}const Cg=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"datasetId"}],a=[{kind:"Variable",name:"id",variableName:"datasetId"}],l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},t={kind:"InlineFragment",selections:[{alias:"latestVersions",args:[{kind:"Literal",name:"first",value:1},{kind:"Literal",name:"sort",value:{col:"createdAt",dir:"desc"}}],concreteType:"DatasetVersionConnection",kind:"LinkedField",name:"versions",plural:!1,selections:[{alias:null,args:null,concreteType:"DatasetVersionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"version",args:null,concreteType:"DatasetVersion",kind:"LinkedField",name:"node",plural:!1,selections:[l,{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:'versions(first:1,sort:{"col":"createdAt","dir":"desc"})'}],type:"Dataset",abstractKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"datasetStore_latestVersionQuery",selections:[{alias:"dataset",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[l,t],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"datasetStore_latestVersionQuery",selections:[{alias:"dataset",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},l,t],storageKey:null}]},params:{cacheID:"8d1b89f8e5b4cd2774b9862c9aff1d3e",id:null,metadata:{},name:"datasetStore_latestVersionQuery",operationKind:"query",text:`query datasetStore_latestVersionQuery(
  $datasetId: ID!
) {
  dataset: node(id: $datasetId) {
    __typename
    id
    ... on Dataset {
      latestVersions: versions(first: 1, sort: {col: createdAt, dir: desc}) {
        edges {
          version: node {
            id
            description
            createdAt
          }
        }
      }
    }
  }
}
`}}}();Cg.hash="55c5e6b728d6f3e3088308750a4e43f7";const w2=n=>{const a=(l,t)=>({...n,isRefreshingLatestVersion:!1,refreshLatestVersion:async()=>{const i=t();l({isRefreshingLatestVersion:!0});const r=await R2({datasetId:i.datasetId});l({latestVersion:r,isRefreshingLatestVersion:!1})}});return mo()(Zp(a))};async function R2({datasetId:n}){var i;const a=await T.fetchQuery(he,Cg,{datasetId:n}).toPromise(),l=(i=a==null?void 0:a.dataset.latestVersions)==null?void 0:i.edges;return l&&l.length&&l[0].version||null}const Kg=m.createContext(null);function E2({children:n,...a}){const[l]=m.useState(()=>w2(a));return e(Kg.Provider,{value:l,children:n})}function Ta(n,a){const l=m.useContext(Kg);if(!l)throw new Error("Missing DatasetContext.Provider in the tree");return Ll(l,n,a)}const Tg=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"DatasetMutationPayload",kind:"LinkedField",name:"addExamplesToDataset",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"AddDatasetExampleDialogMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"AddDatasetExampleDialogMutation",selections:a},params:{cacheID:"718cf02ccb39b279132822bf503e51e6",id:null,metadata:{},name:"AddDatasetExampleDialogMutation",operationKind:"mutation",text:`mutation AddDatasetExampleDialogMutation(
  $input: AddExamplesToDatasetInput!
) {
  addExamplesToDataset(input: $input) {
    __typename
  }
}
`}}}();Tg.hash="8d99470f590cd5d28701fa6e3c0330e6";const ei={backgroundColor:"light",borderColor:"light",collapsible:!0,bodyStyle:{padding:0}};function M2(n){const{datasetId:a,onCompleted:l}=n,[t,i]=m.useState(null),[r,s]=T.useMutation(Tg),{control:d,setError:c,handleSubmit:g,formState:{isValid:f}}=Ve({defaultValues:{input:"{}",output:"{}",metadata:"{}"}}),u=m.useCallback(p=>{if(i(null),!Zn(p==null?void 0:p.input))return c("input",{message:"Input must be a valid JSON object"});if(!Zn(p==null?void 0:p.output))return c("output",{message:"Output must be a valid JSON object"});if(!Zn(p==null?void 0:p.metadata))return c("metadata",{message:"Metadata must be a valid JSON object"});r({variables:{input:{datasetId:a,examples:[{input:JSON.parse(p.input),output:JSON.parse(p.output),metadata:JSON.parse(p.metadata)}],datasetVersionDescription:p.description}},onCompleted:()=>{l()},onError:y=>{const h=De(y);i((h==null?void 0:h[0])??y.message)}})},[r,a,c,l]);return o(oe,{size:"L",title:"Add Example",children:[e("div",{css:K`
          overflow-y: auto;
          padding: var(--ac-global-dimension-size-400);
        `,children:e(b,{direction:"row",justifyContent:"center",children:e(v,{width:"900px",paddingStart:"auto",paddingEnd:"auto",children:o(b,{direction:"column",gap:"size-200",children:[t?e(Fe,{variant:"danger",children:t}):null,e(G,{control:d,name:"input",render:({field:{onChange:p,onBlur:y,value:h},fieldState:{invalid:k,error:S}})=>o(q,{title:"Input",subTitle:"The input to the LLM, retriever, program, etc.",...ei,children:[k?e(Fe,{variant:"danger",banner:!0,children:S==null?void 0:S.message}):null,e(rn,{value:h,onChange:p,onBlur:y})]})}),e(G,{control:d,name:"output",render:({field:{onChange:p,onBlur:y,value:h},fieldState:{invalid:k,error:S}})=>o(q,{title:"Output",subTitle:"The output of the LLM or program to be used as an expected output",...ei,backgroundColor:"green-100",borderColor:"green-700",children:[k?e(Fe,{variant:"danger",banner:!0,children:S==null?void 0:S.message}):null,e(rn,{value:h,onChange:p,onBlur:y})]})}),e(G,{control:d,name:"metadata",render:({field:{onChange:p,onBlur:y,value:h},fieldState:{invalid:k,error:S}})=>o(q,{title:"Metadata",subTitle:"All data from the span to use during experimentation or evaluation",...ei,children:[k?e(Fe,{variant:"danger",banner:!0,children:S==null?void 0:S.message}):null,e(rn,{value:h,onChange:p,onBlur:y})]})}),e(G,{control:d,name:"description",render:({field:{onChange:p,onBlur:y,value:h},fieldState:{invalid:k,error:S}})=>o(ee,{value:h,onChange:p,onBlur:y,isInvalid:k,children:[e(H,{children:"Version Description"}),e(Pa,{}),S?e(ke,{children:S.message}):e(F,{slot:"description",children:"A description of the changes made. Will be displayed in the version history."})]})})]})})})}),e(v,{padding:"size-200",borderTopColor:"light",borderTopWidth:"thin",children:e(b,{direction:"row",justifyContent:"end",gap:"size-100",children:e(M,{variant:"primary",size:"S",isDisabled:!f||s,leadingVisual:s?e(I,{svg:e(sn,{})}):null,onPress:()=>g(u)(),children:s?"Adding Example...":"Add Example"})})})]})}function V2(n){const{datasetId:a,onAddExampleCompleted:l}=n,[t,i]=m.useState(null),r=m.useCallback(()=>{i(e(M2,{datasetId:a,onCompleted:()=>{l(),i(null)}}))},[a,l]);return o(J,{children:[e(M,{leadingVisual:e(I,{svg:e(Bn,{})}),size:"S",onPress:r,"aria-label":"Add Dataset Example",children:"Add Example"}),e(ue,{isDismissable:!0,onDismiss:()=>{i(null)},children:t})]})}function z2(n){return`import { getDataset } from "@arizeai/phoenix-client/datasets";

const dataset = await getDataset({ dataset: { datasetId: "${n}" } });
`}function N2(){const[n,a]=m.useState("Python"),l=Ta(s=>s.datasetId),t=Ta(s=>s.latestVersion);let i=`${ti}/v1/datasets/${l}/examples`;t&&(i+=`?version-id=${t.id}`);const r=m.useMemo(()=>`import phoenix as px

client = px.Client()
# Get the current dataset version
dataset = client.get_dataset(id="${l}"${t?`, version_id="${t.id}"`:""})`,[l,t]);return o(J,{children:[e(v,{padding:"size-200",children:o(b,{direction:"column",gap:"size-100",children:[o(b,{direction:"row",gap:"size-100",alignItems:"end",width:"100%",children:[o(ee,{isReadOnly:!0,value:l,size:"S",children:[e(H,{children:"Dataset ID"}),e(X,{})]}),e(de,{text:l,size:"S"})]}),o(b,{direction:"row",gap:"size-100",alignItems:"end",children:[o(ee,{isReadOnly:!0,value:(t==null?void 0:t.id)||"No Versions",isInvalid:!t,size:"S",children:[e(H,{children:"Latest Version ID"}),e(X,{})]}),e(de,{text:(t==null?void 0:t.id)||"No Versions",isDisabled:!t,size:"S"})]}),o(b,{direction:"row",gap:"size-100",alignItems:"end",children:[o(ee,{isReadOnly:!0,value:i,size:"S",children:[e(H,{children:"REST API URL"}),e(X,{})]}),e(de,{text:i,size:"S"})]})]})}),e(v,{paddingX:"size-200",paddingY:"size-100",children:e(tl,{language:n,onChange:a,size:"S"})}),e(v,{paddingX:"size-200",paddingY:"size-100",children:e(Ue,{children:n==="Python"?e(Mn,{value:r}):e(Yl,{value:z2(l)})})})]})}function $2(){return o(Ne,{children:[e(M,{size:"S",leadingVisual:e(I,{svg:e(Ki,{})}),"aria-label":"Show Dataset Code"}),e(on,{isDismissable:!0,children:e(Ge,{variant:"slideover",size:"L",children:e(He,{children:o(ea,{children:[o(na,{children:[e(aa,{children:"Code to Access Dataset"}),e(Oa,{children:e(Qa,{slot:"close"})})]}),e(N2,{})]})})})})]})}const Pg=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"datasetId"}],a=[{kind:"Variable",name:"id",variableName:"datasetId"}],l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},i=[{kind:"Literal",name:"first",value:100}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"DatasetHistoryDialogQuery",selections:[{alias:"dataset",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{kind:"InlineFragment",selections:[l,{args:null,kind:"FragmentSpread",name:"DatasetHistoryTable_versions"}],type:"Dataset",abstractKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"DatasetHistoryDialogQuery",selections:[{alias:"dataset",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[t,l,{kind:"InlineFragment",selections:[{alias:null,args:i,concreteType:"DatasetVersionConnection",kind:"LinkedField",name:"versions",plural:!1,selections:[{alias:null,args:null,concreteType:"DatasetVersionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"DatasetVersion",kind:"LinkedField",name:"node",plural:!1,selections:[l,{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},t],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:"versions(first:100)"},{alias:null,args:i,filters:null,handle:"connection",key:"DatasetHistoryTable_versions",kind:"LinkedHandle",name:"versions"}],type:"Dataset",abstractKey:null}],storageKey:null}]},params:{cacheID:"32daf6127be134a61ec8a066b23d2f28",id:null,metadata:{},name:"DatasetHistoryDialogQuery",operationKind:"query",text:`query DatasetHistoryDialogQuery(
  $datasetId: ID!
) {
  dataset: node(id: $datasetId) {
    __typename
    ... on Dataset {
      id
      ...DatasetHistoryTable_versions
    }
    id
  }
}

fragment DatasetHistoryTable_versions on Dataset {
  versions(first: 100) {
    edges {
      node {
        id
        description
        createdAt
        __typename
      }
      cursor
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
  id
}
`}}}();Pg.hash="46e1fd587edb477782e444fba17799ef";const xg=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"after"},{defaultValue:100,kind:"LocalArgument",name:"first"},{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}],l=[{kind:"Variable",name:"after",variableName:"after"},{kind:"Variable",name:"first",variableName:"first"}],t={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"DatasetHistoryTableVersionsQuery",selections:[{alias:null,args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:l,kind:"FragmentSpread",name:"DatasetHistoryTable_versions"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"DatasetHistoryTableVersionsQuery",selections:[{alias:null,args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[t,i,{kind:"InlineFragment",selections:[{alias:null,args:l,concreteType:"DatasetVersionConnection",kind:"LinkedField",name:"versions",plural:!1,selections:[{alias:null,args:null,concreteType:"DatasetVersionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"DatasetVersion",kind:"LinkedField",name:"node",plural:!1,selections:[i,{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},t],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:l,filters:null,handle:"connection",key:"DatasetHistoryTable_versions",kind:"LinkedHandle",name:"versions"}],type:"Dataset",abstractKey:null}],storageKey:null}]},params:{cacheID:"adbbc367bb0082b7de0428488e0b2173",id:null,metadata:{},name:"DatasetHistoryTableVersionsQuery",operationKind:"query",text:`query DatasetHistoryTableVersionsQuery(
  $after: String = null
  $first: Int = 100
  $id: ID!
) {
  node(id: $id) {
    __typename
    ...DatasetHistoryTable_versions_2HEEH6
    id
  }
}

fragment DatasetHistoryTable_versions_2HEEH6 on Dataset {
  versions(first: $first, after: $after) {
    edges {
      node {
        id
        description
        createdAt
        __typename
      }
      cursor
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
  id
}
`}}}();xg.hash="37e453bc58759a1e89bc5862c460de6b";const Ig=function(){var n=["versions"],a={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"after"},{defaultValue:100,kind:"LocalArgument",name:"first"}],kind:"Fragment",metadata:{connection:[{count:"first",cursor:"after",direction:"forward",path:n}],refetch:{connection:{forward:{count:"first",cursor:"after"},backward:null,path:n},fragmentPathInResult:["node"],operation:xg,identifierInfo:{identifierField:"id",identifierQueryVariableName:"id"}}},name:"DatasetHistoryTable_versions",selections:[{alias:"versions",args:null,concreteType:"DatasetVersionConnection",kind:"LinkedField",name:"__DatasetHistoryTable_versions_connection",plural:!1,selections:[{alias:null,args:null,concreteType:"DatasetVersionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"DatasetVersion",kind:"LinkedField",name:"node",plural:!1,selections:[a,{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},a],type:"Dataset",abstractKey:null}}();Ig.hash="37e453bc58759a1e89bc5862c460de6b";const j2=100;function O2(n){const a=m.useRef(null),{data:l,loadNext:t,hasNext:i,isLoadingNext:r}=T.usePaginationFragment(Ig,n.dataset),s=m.useMemo(()=>l.versions.edges.map(u=>u.node),[l]),d=m.useCallback(u=>{if(u){const{scrollHeight:p,scrollTop:y,clientHeight:h}=u;p-y-h<300&&!r&&i&&t(j2)}},[i,r,t]),c=Ce({columns:[{header:"version ID",accessorKey:"id"},{header:"description",accessorKey:"description"},{header:"created at",accessorKey:"createdAt",cell:_e}],data:s,getCoreRowModel:Ke(),getSortedRowModel:ln()}),g=c.getRowModel().rows,f=g.length===0;return e("div",{css:K`
        flex: 1 1 auto;
        overflow: auto;
      `,onScroll:u=>d(u.target),ref:a,children:o("table",{css:We,children:[e("thead",{children:c.getHeaderGroups().map(u=>e("tr",{children:u.headers.map(p=>e("th",{colSpan:p.colSpan,children:p.isPlaceholder?null:o("div",{className:p.column.getCanSort()?"sort":"",onClick:p.column.getToggleSortingHandler(),style:{left:p.getStart(),width:p.getSize()},children:[W(p.column.columnDef.header,p.getContext()),p.column.getIsSorted()?e(I,{className:"sort-icon",svg:p.column.getIsSorted()==="asc"?e(Xe,{}):e(Ze,{})}):null]})},p.id))},u.id))}),f?e(yn,{}):e("tbody",{children:g.map(u=>e("tr",{children:u.getVisibleCells().map(p=>e("td",{children:W(p.column.columnDef.cell,p.getContext())},p.id))},u.id))})]})})}function Q2(n){const{datasetId:a}=n,l=T.useLazyLoadQuery(Pg,{datasetId:a});return e(oe,{size:"L",title:"Dataset History",children:e("div",{css:K`
          height: 500px;
        `,children:e(O2,{dataset:l.dataset})})})}function B2(n){const{datasetId:a}=n,[l,t]=m.useState(null);return o(J,{children:[o(Ee,{children:[e(M,{size:"S",leadingVisual:e(I,{svg:e(ph,{})}),"aria-label":"Version History",onPress:()=>{t(e(Q2,{datasetId:a}))}}),e($n,{children:"Dataset Version History"})]}),e(m.Suspense,{fallback:null,children:e(ue,{type:"modal",isDismissable:!0,onDismiss:()=>{t(null)},children:l})})]})}const q2=`pip install arize-phoenix>=${window.Config.platformVersion}`;function U2({isAuthEnabled:n}){let a=`import os
# Set the phoenix collector endpoint. Commonly http://localhost:6006 
os.environ["PHOENIX_COLLECTOR_ENDPOINT"] = "<your-phoenix-url>"`;return n&&(a+=`
# Configure access
os.environ["PHOENIX_API_KEY"] = "<your-api-key>"`),a}const H2=`from phoenix.experiments.types import Example
# Define your task
# Typically should be an LLM call or a call to your application
def my_task(example: Example) -> str:
    # This is just an example of how to return a JSON serializable value
    return f"Hello {example.input['person']}"`,G2=`# Define an evaluator. This just an example.
def exact_match(input, output) -> float:
    return 1.0 if output is f"Hello {input}" else 0.0

# Store the evaluators for later use
evaluators = [exact_match]`,W2=`# Run an experiment
from phoenix.experiments import run_experiment

experiment = run_experiment(dataset, my_task, evaluators=evaluators)`;function J2(n,a){return`import { createClient } from "@arizeai/phoenix-client";
import {
  asEvaluator,
  runExperiment,
} from "@arizeai/phoenix-client/experiments";
import type { Example } from "@arizeai/phoenix-client/types/datasets";
import OpenAI from "openai";

const phoenix = createClient();
const openai = new OpenAI();

/** Your AI Task  */
const task = async (example: Example) => {
  const response = await openai.chat.completions.create({
    model: "gpt-4o",
    messages: [
      { role: "system", content: "You are a helpful assistant." },
      { role: "user", content: JSON.stringify(example.input, null, 2) },
    ],
  });
  return response.choices[0]?.message?.content ?? "No response";
};

/** Exact match evaluator */
const exactMatch = asEvaluator({
  name: "Exact Match",
  kind: "custom",
  evaluate: async ({ input, output, expected }) => {
    return {
      score: output === expected ? 1.0 : 0.0,
      label: output === expected ? "match" : "no_match",
      explanation: "Expected: " + expected + ", Got: " + output,
      metadata: {},
    };
  },
});

await runExperiment({
  dataset: { datasetId: "${n}" },
  experimentName: "${a}",
  client: phoenix,
  task,
  evaluators: [exactMatch],
});`}function X2(){const n=Ta(i=>i.datasetName),a=Ta(i=>i.latestVersion),l=window.Config.authenticationEnabled,t=m.useMemo(()=>`import phoenix as px
# Initialize a phoenix client
client = px.Client()
# Get the current dataset version. You can omit the version for the latest.
dataset = client.get_dataset(name="${n}"${a?`, version_id="${a.id}"`:""})`,[n,a]);return o(v,{overflow:"auto",children:[e(v,{paddingBottom:"size-100",children:e(F,{children:"Install Phoenix"})}),e(Ue,{children:e(Mn,{value:q2})}),e(v,{paddingTop:"size-100",paddingBottom:"size-100",children:e(F,{children:"Point to a running instance of Phoenix"})}),e(Ue,{children:e(Mn,{value:U2({isAuthEnabled:l})})}),e(yh,{children:e(v,{paddingBottom:"size-100",paddingTop:"size-100",children:e(xo,{fallback:o(F,{children:["Your personal API keys can be created and managed on your"," ",e(_n,{href:"/profile",children:"Profile"})]}),children:o(F,{children:["System API keys can be created and managed in"," ",e(_n,{href:"/settings/general",children:"Settings"})]})})})}),e(v,{paddingTop:"size-100",paddingBottom:"size-100",children:e(F,{children:"Pull down this dataset"})}),e(Ue,{children:e(Mn,{value:t})}),e(v,{paddingTop:"size-100",paddingBottom:"size-100",children:e(F,{children:"Define your task"})}),e(Ue,{children:e(Mn,{value:H2})}),e(v,{paddingTop:"size-100",paddingBottom:"size-100",children:e(F,{children:"Define evaluators"})}),e(Ue,{children:e(Mn,{value:G2})}),e(v,{paddingTop:"size-100",paddingBottom:"size-100",children:e(F,{children:"Run an experiment"})}),e(Ue,{children:e(Mn,{value:W2})})]})}function Z2(){const n=Ta(a=>a.datasetName);return o(v,{overflow:"auto",children:[e(v,{paddingBottom:"size-100",children:e(F,{children:"Install Phoenix Client"})}),e(Ue,{children:e(Yl,{value:"npm install @arizeai/phoenix-client"})}),e(v,{paddingTop:"size-100",paddingBottom:"size-100",children:e(F,{children:"Run an experiment"})}),e(Ue,{children:e(Yl,{value:J2(n,"experiment_name")})})]})}function Y2(){const[n,a]=m.useState("Python");return e(oe,{title:"Run Experiment",size:"XL",children:o(v,{padding:"size-400",overflow:"auto",children:[e(v,{paddingBottom:"size-200",children:e(tl,{language:n,onChange:a})}),n==="Python"?e(X2,{}):e(Z2,{})]})})}function Dg({variant:n="default"}){const[a,l]=m.useState(null),t=m.useCallback(()=>{l(e(Y2,{}))},[]);return o(J,{children:[e(M,{size:"S",variant:n,leadingVisual:e(I,{svg:e(Go,{})}),onPress:t,children:"Run Experiment"}),e(ue,{isDismissable:!0,type:"slideOver",onDismiss:()=>{l(null)},children:a})]})}function dP(){const n=Me();Oe(n);const a=m.useMemo(()=>{const l=n.dataset.latestVersions;return l!=null&&l.edges&&l.edges.length?l.edges[0].version:null},[n]);return e(E2,{datasetId:n.dataset.id,datasetName:n.dataset.name,latestVersion:a,children:e(m.Suspense,{fallback:e(ge,{}),children:e(nK,{dataset:n.dataset})})})}const eK=K`
  flex: 1 1 auto;
  display: flex;
  flex-direction: column;
  overflow: hidden;
  .ac-tabs {
    flex: 1 1 auto;
    overflow: hidden;
    display: flex;
    flex-direction: column;
    div[role="tablist"] {
      flex: none;
    }
    .ac-tabs__pane-container {
      flex: 1 1 auto;
      display: flex;
      flex-direction: column;
      overflow: hidden;
      div[role="tabpanel"]:not([hidden]) {
        flex: 1 1 auto;
        display: flex;
        flex-direction: column;
        overflow: hidden;
      }
    }
  }
`;function nK({dataset:n}){const a=n.id,l=Ta(c=>c.refreshLatestVersion),t=me(),i=ce(),r=m.useCallback(c=>{c===0?i(`/datasets/${a}/experiments`):c===1&&i(`/datasets/${a}/examples`)},[i,a]),d=al().pathname.includes("examples")?1:0;return o("main",{css:eK,children:[e(v,{paddingStart:"size-200",paddingEnd:"size-200",paddingTop:"size-200",paddingBottom:"size-50",flex:"none",children:o(b,{direction:"row",justifyContent:"space-between",alignItems:"start",children:[e(b,{direction:"column",justifyContent:"space-between",alignItems:"start",children:e(b,{direction:"row",gap:"size-200",alignItems:"center",children:o(b,{direction:"column",children:[e(F,{elementType:"h1",size:"L",weight:"heavy",children:n.name}),e(F,{color:"text-700",children:n.description||"--"})]})})}),o(b,{direction:"row",gap:"size-100",alignItems:"center",children:[o(ra,{align:"end",buttonSize:"compact",icon:e(I,{svg:e(Ri,{})}),onAction:c=>{switch(c){case"csv":window.open(xn(`/v1/datasets/${n.id}/csv`),"_blank");break;case"openai-ft":window.open(xn(`/v1/datasets/${n.id}/jsonl/openai_ft`),"_blank");break;case"openai-evals":window.open(xn(`/v1/datasets/${n.id}/jsonl/openai_evals`),"_blank");break}},children:[e(xe,{children:"Download CSV"},"csv"),e(xe,{children:"Download OpenAI Fine-Tuning JSONL"},"openai-ft"),e(xe,{children:"Download OpenAI Evals JSONL"},"openai-evals")]}),e(B2,{datasetId:n.id}),e($2,{}),e(Dg,{}),e(V2,{datasetId:n.id,onAddExampleCompleted:()=>{t({title:"Example added",message:"The example has been added successfully and the version has been updated."}),l()}}),e(M,{size:"S",variant:"primary",leadingVisual:e(I,{svg:e(Da,{})}),onPress:()=>{i(`/playground?datasetId=${n.id}`)},children:"Playground"})]})]})}),o(cn,{defaultSelectedKey:d===0?"experiments":"examples",onSelectionChange:c=>{switch(c){case"experiments":r(0);break;case"examples":r(1);break}},children:[o(dn,{children:[o(le,{id:"experiments",children:["Experiments ",e(Ln,{children:n.experimentCount})]}),o(le,{id:"examples",children:["Examples ",e(Ln,{children:n.exampleCount})]})]}),e(re,{id:"experiments",children:e(m.Suspense,{children:e(ve,{})})}),e(re,{id:"examples",children:e(m.Suspense,{children:e(ve,{})})})]})]})}const Lg=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}],l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},i={kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},t,{alias:null,args:null,kind:"ScalarField",name:"exampleCount",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"experimentCount",storageKey:null},{alias:"latestVersions",args:[{kind:"Literal",name:"first",value:1},{kind:"Literal",name:"sort",value:{col:"createdAt",dir:"desc"}}],concreteType:"DatasetVersionConnection",kind:"LinkedField",name:"versions",plural:!1,selections:[{alias:null,args:null,concreteType:"DatasetVersionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"version",args:null,concreteType:"DatasetVersion",kind:"LinkedField",name:"node",plural:!1,selections:[l,t,{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:'versions(first:1,sort:{"col":"createdAt","dir":"desc"})'}],type:"Dataset",abstractKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"datasetLoaderQuery",selections:[{alias:"dataset",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[l,i],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"datasetLoaderQuery",selections:[{alias:"dataset",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},l,i],storageKey:null}]},params:{cacheID:"997dd3d4849cc24ed81f11148c2a5d39",id:null,metadata:{},name:"datasetLoaderQuery",operationKind:"query",text:`query datasetLoaderQuery(
  $id: ID!
) {
  dataset: node(id: $id) {
    __typename
    id
    ... on Dataset {
      id
      name
      description
      exampleCount
      experimentCount
      latestVersions: versions(first: 1, sort: {col: createdAt, dir: desc}) {
        edges {
          version: node {
            id
            description
            createdAt
          }
        }
      }
    }
  }
}
`}}}();Lg.hash="5ff18bc8372a865b84a24396d3b3782a";async function cP(n){const{datasetId:a}=n.params;return await T.fetchQuery(he,Lg,{id:a}).toPromise()}function uP(){const{exampleId:n,datasetId:a}=Qe(),l=ce();return e(Yi,{exampleId:n,onDismiss:()=>{l(`/datasets/${a}/examples`)}})}const _g=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}],l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},i=[{kind:"Literal",name:"first",value:100}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"examplesLoaderQuery",selections:[{alias:"dataset",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[l,{args:null,kind:"FragmentSpread",name:"ExamplesTableFragment"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"examplesLoaderQuery",selections:[{alias:"dataset",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[t,l,{kind:"InlineFragment",selections:[{alias:null,args:i,concreteType:"DatasetExampleConnection",kind:"LinkedField",name:"examples",plural:!1,selections:[{alias:null,args:null,concreteType:"DatasetExampleEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"example",args:null,concreteType:"DatasetExample",kind:"LinkedField",name:"node",plural:!1,selections:[l,{alias:null,args:null,concreteType:"DatasetExampleRevision",kind:"LinkedField",name:"revision",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"input",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"output",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"metadata",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"DatasetExample",kind:"LinkedField",name:"node",plural:!1,selections:[t,l],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:"examples(first:100)"},{alias:null,args:i,filters:["datasetVersionId"],handle:"connection",key:"ExamplesTable_examples",kind:"LinkedHandle",name:"examples"}],type:"Dataset",abstractKey:null}],storageKey:null}]},params:{cacheID:"3199afe500e1707d9a6eda312c67b0f1",id:null,metadata:{},name:"examplesLoaderQuery",operationKind:"query",text:`query examplesLoaderQuery(
  $id: ID!
) {
  dataset: node(id: $id) {
    __typename
    id
    ...ExamplesTableFragment
  }
}

fragment ExamplesTableFragment on Dataset {
  examples(first: 100) {
    edges {
      example: node {
        id
        revision {
          input
          output
          metadata
        }
      }
      cursor
      node {
        __typename
        id
      }
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
  id
}
`}}}();_g.hash="87c9a24e8d6450699d9fd403b3653108";async function mP(n){const{datasetId:a}=n.params;return await T.fetchQuery(he,_g,{id:a}).toPromise()}const Ag=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"after"},{defaultValue:null,kind:"LocalArgument",name:"datasetVersionId"},{defaultValue:100,kind:"LocalArgument",name:"first"},{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}],l=[{kind:"Variable",name:"after",variableName:"after"},{kind:"Variable",name:"datasetVersionId",variableName:"datasetVersionId"},{kind:"Variable",name:"first",variableName:"first"}],t={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ExamplesTableQuery",selections:[{alias:null,args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:l,kind:"FragmentSpread",name:"ExamplesTableFragment"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ExamplesTableQuery",selections:[{alias:null,args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[t,i,{kind:"InlineFragment",selections:[{alias:null,args:l,concreteType:"DatasetExampleConnection",kind:"LinkedField",name:"examples",plural:!1,selections:[{alias:null,args:null,concreteType:"DatasetExampleEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"example",args:null,concreteType:"DatasetExample",kind:"LinkedField",name:"node",plural:!1,selections:[i,{alias:null,args:null,concreteType:"DatasetExampleRevision",kind:"LinkedField",name:"revision",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"input",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"output",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"metadata",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"DatasetExample",kind:"LinkedField",name:"node",plural:!1,selections:[t,i],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:l,filters:["datasetVersionId"],handle:"connection",key:"ExamplesTable_examples",kind:"LinkedHandle",name:"examples"}],type:"Dataset",abstractKey:null}],storageKey:null}]},params:{cacheID:"fd22f70774f5ca11a13a0dabba9adf65",id:null,metadata:{},name:"ExamplesTableQuery",operationKind:"query",text:`query ExamplesTableQuery(
  $after: String = null
  $datasetVersionId: ID
  $first: Int = 100
  $id: ID!
) {
  node(id: $id) {
    __typename
    ...ExamplesTableFragment_4a6F8Z
    id
  }
}

fragment ExamplesTableFragment_4a6F8Z on Dataset {
  examples(datasetVersionId: $datasetVersionId, first: $first, after: $after) {
    edges {
      example: node {
        id
        revision {
          input
          output
          metadata
        }
      }
      cursor
      node {
        __typename
        id
      }
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
  id
}
`}}}();Ag.hash="a042efee74921059872b4d6812ae20be";const wg=function(){var n=["examples"],a={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"after"},{defaultValue:null,kind:"LocalArgument",name:"datasetVersionId"},{defaultValue:100,kind:"LocalArgument",name:"first"}],kind:"Fragment",metadata:{connection:[{count:"first",cursor:"after",direction:"forward",path:n}],refetch:{connection:{forward:{count:"first",cursor:"after"},backward:null,path:n},fragmentPathInResult:["node"],operation:Ag,identifierInfo:{identifierField:"id",identifierQueryVariableName:"id"}}},name:"ExamplesTableFragment",selections:[{alias:"examples",args:[{kind:"Variable",name:"datasetVersionId",variableName:"datasetVersionId"}],concreteType:"DatasetExampleConnection",kind:"LinkedField",name:"__ExamplesTable_examples_connection",plural:!1,selections:[{alias:null,args:null,concreteType:"DatasetExampleEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"example",args:null,concreteType:"DatasetExample",kind:"LinkedField",name:"node",plural:!1,selections:[a,{alias:null,args:null,concreteType:"DatasetExampleRevision",kind:"LinkedField",name:"revision",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"input",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"output",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"metadata",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"DatasetExample",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},a],type:"Dataset",abstractKey:null}}();wg.hash="a042efee74921059872b4d6812ae20be";const Rg=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"DatasetMutationPayload",kind:"LinkedField",name:"deleteDatasetExamples",plural:!1,selections:[{alias:null,args:null,concreteType:"Dataset",kind:"LinkedField",name:"dataset",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ExampleSelectionToolbarDeleteExamplesMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ExampleSelectionToolbarDeleteExamplesMutation",selections:a},params:{cacheID:"b63159f3c325b9af3dc469692f9329e5",id:null,metadata:{},name:"ExampleSelectionToolbarDeleteExamplesMutation",operationKind:"mutation",text:`mutation ExampleSelectionToolbarDeleteExamplesMutation(
  $input: DeleteDatasetExamplesInput!
) {
  deleteDatasetExamples(input: $input) {
    dataset {
      id
    }
  }
}
`}}}();Rg.hash="455bf9e5dc4b9cc655095dc829ef7e12";function aK(n){const a=Ta(y=>y.refreshLatestVersion),{selectedExamples:l,onExamplesDeleted:t,onClearSelection:i}=n,[r,s]=m.useState(null),d=me(),c=be(),[g,f]=T.useMutation(Rg),u=l.length!==1,p=m.useCallback(()=>{g({variables:{input:{exampleIds:l.map(y=>y.id)}},onCompleted:()=>{d({title:"Examples Deleted",message:`${l.length} example${u?"s":""} have been deleted.`}),t(),i(),a()},onError:y=>{const h=De(y);c({title:"An error occurred",message:`Failed to delete examples: ${(h==null?void 0:h[0])??y.message}`})}})},[g,l,d,u,t,i,a,c]);return o("div",{css:K`
        position: absolute;
        bottom: var(--ac-global-dimension-size-400);
        left: 50%;
        transform: translateX(-50%);
      `,children:[e(v,{backgroundColor:"light",padding:"size-200",borderColor:"light",borderWidth:"thin",borderRadius:"medium",minWidth:"size-6000",children:o(b,{direction:"row",justifyContent:"space-between",alignItems:"center",children:[e(F,{children:`${l.length} example${u?"s":""} selected`}),o(b,{direction:"row",gap:"size-100",children:[e(M,{variant:"default",size:"S",onPress:i,children:"Cancel"}),e(M,{variant:"danger",size:"S",leadingVisual:e(I,{svg:f?e(sn,{}):e(Je,{})}),isDisabled:f,onPress:p,children:f?"Deleting...":"Delete Example"+(u?"s":"")})]})]})}),e(ue,{onDismiss:()=>{s(null)},children:r})]})}const lK=100;function tK({dataset:n}){const a=Ta(_=>_.latestVersion),l=m.useRef(null),[t,i]=m.useState({}),{data:r,loadNext:s,hasNext:d,isLoadingNext:c,refetch:g}=T.usePaginationFragment(wg,n);m.useEffect(()=>{m.startTransition(()=>{g({datasetVersionId:(a==null?void 0:a.id)||null},{fetchPolicy:"store-and-network"})})},[a,g]);const f=m.useMemo(()=>r.examples.edges.map(_=>{const w=_.example,V=w.revision;return{id:w.id,input:V.input,output:V.output,metadata:V.metadata}}),[r]),p=Ce({columns:[{id:"select",header:({table:_})=>e(On,{checked:_.getIsAllRowsSelected(),indeterminate:_.getIsSomeRowsSelected(),onChange:_.getToggleAllRowsSelectedHandler()}),cell:({row:_})=>e(On,{checked:_.getIsSelected(),disabled:!_.getCanSelect(),indeterminate:_.getIsSomeSelected(),onChange:_.getToggleSelectedHandler()})},{header:"example id",accessorKey:"id",cell:({getValue:_,row:w})=>{const V=w.original.id;return e(we,{to:`${V}`,children:_()})}},{header:"input",accessorKey:"input",cell:Xa},{header:"output",accessorKey:"output",cell:Xa},{header:"metadata",accessorKey:"metadata",cell:Xa}],data:f,state:{rowSelection:t},onRowSelectionChange:i,getCoreRowModel:Ke()}),y=p.getRowModel().rows,h=y.length===0,k=p.getSelectedRowModel().rows,S=k.map(_=>_.original),C=m.useCallback(()=>{i({})},[i]),P=m.useCallback(_=>{if(_){const{scrollHeight:w,scrollTop:V,clientHeight:Q}=_;w-V-Q<300&&!c&&d&&s(lK)}},[d,c,s]),L=ce();return o("div",{css:K`
        flex: 1 1 auto;
        overflow: auto;
      `,ref:l,onScroll:_=>P(_.target),children:[o("table",{css:Un,children:[e("thead",{children:p.getHeaderGroups().map(_=>e("tr",{children:_.headers.map(w=>e("th",{children:e("div",{children:W(w.column.columnDef.header,w.getContext())})},w.id))},_.id))}),h?e(yn,{}):e("tbody",{children:y.map(_=>e("tr",{onClick:()=>{L(`${_.original.id}`)},children:_.getVisibleCells().map(w=>e("td",{children:W(w.column.columnDef.cell,w.getContext())},w.id))},_.id))})]}),k.length?e(aK,{selectedExamples:S,onClearSelection:C,onExamplesDeleted:()=>{g({},{fetchPolicy:"store-and-network"})}}):null]})}function gP(){const n=Me();return Oe(n),o(J,{children:[e(tK,{dataset:n.dataset})," ",e(m.Suspense,{children:e(ve,{})})]})}const Eg=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}],l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},t=[l],i={alias:"firstExperiment",args:[{kind:"Literal",name:"first",value:1}],concreteType:"ExperimentConnection",kind:"LinkedField",name:"experiments",plural:!1,selections:[{alias:null,args:null,concreteType:"ExperimentEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"Experiment",kind:"LinkedField",name:"node",plural:!1,selections:t,storageKey:null}],storageKey:null}],storageKey:"experiments(first:1)"},r={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},s={alias:null,args:null,kind:"ScalarField",name:"annotationName",storageKey:null},d=[{kind:"Literal",name:"first",value:100}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"experimentsLoaderQuery",selections:[{alias:"dataset",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[l,{kind:"InlineFragment",selections:[{args:null,kind:"FragmentSpread",name:"ExperimentsTableFragment"},i],type:"Dataset",abstractKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"experimentsLoaderQuery",selections:[{alias:"dataset",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[r,l,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"ExperimentAnnotationSummary",kind:"LinkedField",name:"experimentAnnotationSummaries",plural:!0,selections:[s,{alias:null,args:null,kind:"ScalarField",name:"minScore",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"maxScore",storageKey:null}],storageKey:null},{alias:null,args:d,concreteType:"ExperimentConnection",kind:"LinkedField",name:"experiments",plural:!1,selections:[{alias:null,args:null,concreteType:"ExperimentEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"experiment",args:null,concreteType:"Experiment",kind:"LinkedField",name:"node",plural:!1,selections:[l,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"sequenceNumber",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"metadata",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"errorRate",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"runCount",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"averageRunLatencyMs",storageKey:null},{alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"project",plural:!1,selections:t,storageKey:null},{alias:null,args:null,concreteType:"ExperimentAnnotationSummary",kind:"LinkedField",name:"annotationSummaries",plural:!0,selections:[s,{alias:null,args:null,kind:"ScalarField",name:"meanScore",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"Experiment",kind:"LinkedField",name:"node",plural:!1,selections:[r,l],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:"experiments(first:100)"},{alias:null,args:d,filters:null,handle:"connection",key:"ExperimentsTable_experiments",kind:"LinkedHandle",name:"experiments"},i],type:"Dataset",abstractKey:null}],storageKey:null}]},params:{cacheID:"9b6f82293b5d03e1df6d2e1ba93bf21c",id:null,metadata:{},name:"experimentsLoaderQuery",operationKind:"query",text:`query experimentsLoaderQuery(
  $id: ID!
) {
  dataset: node(id: $id) {
    __typename
    id
    ... on Dataset {
      ...ExperimentsTableFragment
      firstExperiment: experiments(first: 1) {
        edges {
          node {
            id
          }
        }
      }
    }
  }
}

fragment ExperimentsTableFragment on Dataset {
  experimentAnnotationSummaries {
    annotationName
    minScore
    maxScore
  }
  experiments(first: 100) {
    edges {
      experiment: node {
        id
        name
        sequenceNumber
        description
        createdAt
        metadata
        errorRate
        runCount
        averageRunLatencyMs
        project {
          id
        }
        annotationSummaries {
          annotationName
          meanScore
        }
      }
      cursor
      node {
        __typename
        id
      }
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
  id
}
`}}}();Eg.hash="c59bc7ec0e8d304bf7c2c46cee4e82d2";async function pP(n){const{datasetId:a}=n.params;return await T.fetchQuery(he,Eg,{id:a}).toPromise()}const Mg=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}],l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},t={kind:"InlineFragment",selections:[{alias:null,args:[{kind:"Literal",name:"first",value:50}],concreteType:"ExperimentConnection",kind:"LinkedField",name:"experiments",plural:!1,selections:[{alias:null,args:null,concreteType:"ExperimentEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"experiment",args:null,concreteType:"Experiment",kind:"LinkedField",name:"node",plural:!1,selections:[l,{alias:null,args:null,kind:"ScalarField",name:"sequenceNumber",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"averageRunLatencyMs",storageKey:null},{alias:null,args:null,concreteType:"ExperimentAnnotationSummary",kind:"LinkedField",name:"annotationSummaries",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"annotationName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"meanScore",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:"experiments(first:50)"}],type:"Dataset",abstractKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ExperimentsLineChartQuery",selections:[{alias:"dataset",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[t],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ExperimentsLineChartQuery",selections:[{alias:"dataset",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},t,l],storageKey:null}]},params:{cacheID:"b4d31338866ff8be645d6601e1e15dc2",id:null,metadata:{},name:"ExperimentsLineChartQuery",operationKind:"query",text:`query ExperimentsLineChartQuery(
  $id: ID!
) {
  dataset: node(id: $id) {
    __typename
    ... on Dataset {
      experiments(first: 50) {
        edges {
          experiment: node {
            id
            sequenceNumber
            averageRunLatencyMs
            annotationSummaries {
              annotationName
              meanScore
            }
          }
        }
      }
    }
    id
  }
}
`}}}();Mg.hash="3eade40b47d598c5387d90e7740a457a";const iK={top:8,right:18,left:18,bottom:58},rK=new Intl.NumberFormat([],{maximumFractionDigits:4}),Vg=n=>typeof n!="number"?"--":`${tt(".1f")(n/1e3)}s`;function oK({active:n,payload:a,label:l}){const{gray300:t}=An();if(n&&a&&a.length){const i=a.filter(r=>r.dataKey!=="avgLatency"&&typeof r.value=="number");return o(qn,{children:[o(b,{direction:"row",alignItems:"center",gap:"size-100",children:[e(F,{weight:"heavy",size:"S",children:"experiment"}),e(Vl,{sequenceNumber:Number(l)})]}),i.map(r=>e(ze,{color:gs(String(r.dataKey)),shape:"line",name:String(r.dataKey),value:typeof r.value=="number"?rK.format(r.value):"--"},String(r.dataKey))),(()=>{const r=a.find(s=>s.dataKey==="avgLatency");return r?e(ze,{color:t,shape:"square",name:"avg latency",value:Vg(r.value)},"avgLatency"):null})()]})}return null}function sK({datasetId:n}){var d,c;const a=T.useLazyLoadQuery(Mg,{id:n}),{chartData:l,scoreKeys:t}=m.useMemo(()=>{var u,p;const g=new Set;return{chartData:(((p=(u=a.dataset)==null?void 0:u.experiments)==null?void 0:p.edges)??[]).map(y=>{const h=y.experiment,k={},S=h.annotationSummaries;for(const C of S)g.add(C.annotationName),k[C.annotationName]=C.meanScore??void 0;return{iteration:h.sequenceNumber,avgLatency:h.averageRunLatencyMs??void 0,...k}}).filter(y=>y!==null).sort((y,h)=>y.iteration-h.iteration),scoreKeys:Array.from(g)}},[(c=(d=a.dataset)==null?void 0:d.experiments)==null?void 0:c.edges]),{gray300:i}=An(),r=m.useMemo(()=>{const g={};for(const f of t)g[f]=gs(f);return g},[t]),s=m.useMemo(()=>{let g=1/0,f=-1/0;for(const u of l)for(const p of t){const y=u[p];typeof y=="number"&&(y<g&&(g=y),y>f&&(f=y))}return g>=0&&f<=1?[0,1]:void 0},[l,t]);return e(wn,{width:"100%",height:"100%",children:o(dl,{data:l,margin:iK,syncId:"dimensionDetails",children:[e("defs",{children:o("linearGradient",{id:"latencyBarColor",x1:"0",y1:"0",x2:"0",y2:"1",children:[e("stop",{offset:"5%",stopColor:i,stopOpacity:.3}),e("stop",{offset:"95%",stopColor:i,stopOpacity:0})]})}),e(Jn,{strokeDasharray:"4 4",stroke:"var(--ac-global-color-grey-500)",strokeOpacity:.5}),e(Wn,{dataKey:"iteration",tick:{fontSize:12,fill:"var(--ac-global-text-color-700)"}}),e(hn,{stroke:"var(--ac-global-color-grey-500)",label:{value:"Score",angle:-90,position:"insideLeft",style:{textAnchor:"middle",fill:"var(--ac-global-text-color-900)"}},style:{fill:"var(--ac-global-text-color-700)"},domain:s}),e(hn,{yAxisId:"right",orientation:"right",stroke:"var(--ac-global-color-grey-500)",label:{value:"avg latency",angle:90,position:"insideRight",style:{textAnchor:"middle",fill:"var(--ac-global-text-color-900)"}},style:{fill:"var(--ac-global-text-color-700)"},tickFormatter:Vg}),e(Fa,{yAxisId:"right",dataKey:"avgLatency",fill:"url(#latencyBarColor)",spacing:3}),t.map(g=>e(ji,{type:"monotone",dataKey:g,stroke:r[g],strokeWidth:2,dot:{r:3},activeDot:{r:5},yAxisId:0},g)),e(Gn,{content:e(oK,{})})]})})}function dK({datasetId:n}){return e(m.Suspense,{fallback:e(ge,{}),children:e(sK,{datasetId:n})})}function cK(){return e(v,{width:"100%",paddingY:"size-400",children:e(b,{direction:"column",width:"100%",alignItems:"center",justifyContent:"center",children:e(v,{width:"100%",maxWidth:"780px",children:o(b,{direction:"column",gap:"size-400",alignItems:"center",children:[e(F,{size:"XL",children:"Run experiments to evaluate and improve your AI applications."}),e(zi,{src:"https://storage.googleapis.com/arize-phoenix-assets/assets/videos/experiments.mp4",autoPlay:!0,muted:!0,loop:!0}),o(b,{direction:"row",gap:"size-200",children:[e(nl,{href:"https://docs.arize.com/phoenix/datasets-and-experiments/how-to-experiments/run-experiments",target:"_blank",leadingVisual:e(I,{svg:e(Ni,{})}),children:"Documentation"}),e(nl,{href:"https://docs.arize.com/phoenix/cookbook/datasets-and-experiments/summarization",target:"_blank",leadingVisual:e(I,{svg:e(fh,{})}),children:"Example"}),e(Dg,{variant:"primary"})]})]})})})})}const zg=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"after"},{defaultValue:100,kind:"LocalArgument",name:"first"},{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}],l=[{kind:"Variable",name:"after",variableName:"after"},{kind:"Variable",name:"first",variableName:"first"}],t={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"annotationName",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ExperimentsTableQuery",selections:[{alias:null,args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:l,kind:"FragmentSpread",name:"ExperimentsTableFragment"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ExperimentsTableQuery",selections:[{alias:null,args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[t,i,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"ExperimentAnnotationSummary",kind:"LinkedField",name:"experimentAnnotationSummaries",plural:!0,selections:[r,{alias:null,args:null,kind:"ScalarField",name:"minScore",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"maxScore",storageKey:null}],storageKey:null},{alias:null,args:l,concreteType:"ExperimentConnection",kind:"LinkedField",name:"experiments",plural:!1,selections:[{alias:null,args:null,concreteType:"ExperimentEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"experiment",args:null,concreteType:"Experiment",kind:"LinkedField",name:"node",plural:!1,selections:[i,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"sequenceNumber",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"metadata",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"errorRate",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"runCount",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"averageRunLatencyMs",storageKey:null},{alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"project",plural:!1,selections:[i],storageKey:null},{alias:null,args:null,concreteType:"ExperimentAnnotationSummary",kind:"LinkedField",name:"annotationSummaries",plural:!0,selections:[r,{alias:null,args:null,kind:"ScalarField",name:"meanScore",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"Experiment",kind:"LinkedField",name:"node",plural:!1,selections:[t,i],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:l,filters:null,handle:"connection",key:"ExperimentsTable_experiments",kind:"LinkedHandle",name:"experiments"}],type:"Dataset",abstractKey:null}],storageKey:null}]},params:{cacheID:"1d386e93c6999945aa9ca5e5c67ed5d9",id:null,metadata:{},name:"ExperimentsTableQuery",operationKind:"query",text:`query ExperimentsTableQuery(
  $after: String = null
  $first: Int = 100
  $id: ID!
) {
  node(id: $id) {
    __typename
    ...ExperimentsTableFragment_2HEEH6
    id
  }
}

fragment ExperimentsTableFragment_2HEEH6 on Dataset {
  experimentAnnotationSummaries {
    annotationName
    minScore
    maxScore
  }
  experiments(first: $first, after: $after) {
    edges {
      experiment: node {
        id
        name
        sequenceNumber
        description
        createdAt
        metadata
        errorRate
        runCount
        averageRunLatencyMs
        project {
          id
        }
        annotationSummaries {
          annotationName
          meanScore
        }
      }
      cursor
      node {
        __typename
        id
      }
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
  id
}
`}}}();zg.hash="c7c7580fe40888ceb86a1701fe4eedf4";const Ng=function(){var n=["experiments"],a={alias:null,args:null,kind:"ScalarField",name:"annotationName",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"after"},{defaultValue:100,kind:"LocalArgument",name:"first"}],kind:"Fragment",metadata:{connection:[{count:"first",cursor:"after",direction:"forward",path:n}],refetch:{connection:{forward:{count:"first",cursor:"after"},backward:null,path:n},fragmentPathInResult:["node"],operation:zg,identifierInfo:{identifierField:"id",identifierQueryVariableName:"id"}}},name:"ExperimentsTableFragment",selections:[{alias:null,args:null,concreteType:"ExperimentAnnotationSummary",kind:"LinkedField",name:"experimentAnnotationSummaries",plural:!0,selections:[a,{alias:null,args:null,kind:"ScalarField",name:"minScore",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"maxScore",storageKey:null}],storageKey:null},{alias:"experiments",args:null,concreteType:"ExperimentConnection",kind:"LinkedField",name:"__ExperimentsTable_experiments_connection",plural:!1,selections:[{alias:null,args:null,concreteType:"ExperimentEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"experiment",args:null,concreteType:"Experiment",kind:"LinkedField",name:"node",plural:!1,selections:[l,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"sequenceNumber",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"metadata",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"errorRate",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"runCount",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"averageRunLatencyMs",storageKey:null},{alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"project",plural:!1,selections:[l],storageKey:null},{alias:null,args:null,concreteType:"ExperimentAnnotationSummary",kind:"LinkedField",name:"annotationSummaries",plural:!0,selections:[a,{alias:null,args:null,kind:"ScalarField",name:"meanScore",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"Experiment",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},l],type:"Dataset",abstractKey:null}}();Ng.hash="c7c7580fe40888ceb86a1701fe4eedf4";function Yn(n){return n.replace(/[^a-zA-Z0-9]/g,"-")}function uK({experimentId:n}){return e(El,{children:o(ra,{buttonSize:"compact",align:"end",icon:e(I,{svg:e(Ri,{})}),onAction:a=>{a==="csv"&&window.open(xn(`/v1/experiments/${n}/csv`),"_blank"),a==="json"&&window.open(xn(`/v1/experiments/${n}/json`),"_blank")},children:[e(xe,{children:"Download CSV"},"csv"),e(xe,{children:"Download JSON"},"json")]})})}function mK({getValue:n}){const a=n(),l=a!==null?a*100:null,t=m.useMemo(()=>{if(l!==null)return l>=80?"red-1100":l>0?"orange-1100":"green-1100"},[l]);return e(F,{color:t,children:Zl(l)})}const $g=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"ExperimentMutationPayload",kind:"LinkedField",name:"deleteExperiments",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ExperimentSelectionToolbarDeleteExperimentsMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ExperimentSelectionToolbarDeleteExperimentsMutation",selections:a},params:{cacheID:"3af24cbaf3208c0d5ad1cd9313dd3823",id:null,metadata:{},name:"ExperimentSelectionToolbarDeleteExperimentsMutation",operationKind:"mutation",text:`mutation ExperimentSelectionToolbarDeleteExperimentsMutation(
  $input: DeleteExperimentsInput!
) {
  deleteExperiments(input: $input) {
    __typename
  }
}
`}}}();$g.hash="4ab310746eb51c6a3fcb799d2c972762";function gK(n){const a=ce(),[l,t]=m.useState(null),[i,r]=T.useMutation($g),{datasetId:s,selectedExperiments:d,onClearSelection:c,onExperimentsDeleted:g}=n,f=d.length!==1,u=me(),p=be(),y=m.useCallback(()=>{i({variables:{input:{experimentIds:d.map(k=>k.id)}},onCompleted:()=>{u({title:"Experiments Deleted",message:`${d.length} experiment${f?"s":""} have been deleted.`}),g(),c()},onError:k=>{const S=De(k);p({title:"An error occurred",message:`Failed to delete experiments: ${(S==null?void 0:S[0])??k.message}`})}})},[i,f,p,u,c,g,d]),h=m.useCallback(()=>{t(o(oe,{size:"S",title:"Delete Experiments",children:[e(v,{padding:"size-200",children:e(F,{color:"danger",children:"Are you sure you want to delete these experiments? This will also delete all associated annotations and traces, and it cannot be undone."})}),e(v,{paddingEnd:"size-200",paddingTop:"size-100",paddingBottom:"size-100",borderTopColor:"light",borderTopWidth:"thin",children:e(b,{direction:"row",justifyContent:"end",children:e(M,{variant:"danger",onPress:()=>{y(),t(null)},children:"Delete Experiments"})})})]}))},[y]);return o("div",{css:K`
        position: absolute;
        bottom: var(--ac-global-dimension-size-400);
        left: 50%;
        transform: translateX(-50%);
      `,children:[e(v,{backgroundColor:"light",padding:"size-200",borderColor:"light",borderWidth:"thin",borderRadius:"medium",minWidth:"size-6000",children:o(b,{direction:"row",justifyContent:"space-between",alignItems:"center",gap:"size-100",children:[e(F,{children:`${d.length} experiment${f?"s":""} selected`}),o(b,{direction:"row",gap:"size-100",children:[e(M,{variant:"default",size:"S",onPress:c,children:"Cancel"}),e(M,{variant:"danger",size:"S",leadingVisual:e(I,{svg:r?e(sn,{}):e(Je,{})}),isDisabled:r,onPress:h,children:r?"Deleting...":"Delete"}),e(M,{variant:"primary",size:"S",onPress:()=>{a(`/datasets/${s}/compare?${d.map(k=>`experimentId=${k.id}`).join("&")}`)},leadingVisual:e(I,{svg:e(hh,{})}),children:"Compare Experiments"})]})]})}),e(ue,{onDismiss:()=>{t(null)},children:l})]})}const ni=100,pK={minSize:100},jg=({table:n,hasNext:a,onLoadNext:l,isLoadingNext:t,dataset:i})=>{const r=ce();return o("tbody",{children:[n.getRowModel().rows.map(s=>e("tr",{onClick:()=>{r(`/datasets/${i.id}/compare?experimentId=${s.original.id}`)},children:s.getVisibleCells().map(d=>{const c=`--col-${Yn(d.column.id)}-size`;return e("td",{style:{width:`calc(var(${c}) * 1px)`,maxWidth:`calc(var(${c}) * 1px)`},children:W(d.column.columnDef.cell,d.getContext())},d.id)})},s.id)),a?e(Vi,{onLoadMore:l,isLoadingNext:t},"load-more"):null]})},yK=m.memo(jg,(n,a)=>n.table.options.data===a.table.options.data);function fK({dataset:n}){const a=m.useRef(null),[l,t]=m.useState({}),[i,r]=m.useState({}),{data:s,loadNext:d,hasNext:c,isLoadingNext:g,refetch:f}=T.usePaginationFragment(Ng,n),u=m.useMemo(()=>s.experiments.edges.map(x=>{const R=x.experiment.annotationSummaries.reduce((A,z)=>(A[z.annotationName]=z,A),{});return{...x.experiment,annotationSummaryMap:R}}),[s.experiments.edges]),p=[{id:"select",maxSize:50,header:({table:x})=>e(On,{checked:x.getIsAllRowsSelected(),indeterminate:x.getIsSomeRowsSelected(),onChange:x.getToggleAllRowsSelectedHandler()}),cell:({row:x})=>e(On,{checked:x.getIsSelected(),disabled:!x.getCanSelect(),indeterminate:x.getIsSomeSelected(),onChange:x.getToggleSelectedHandler()})},{header:"name",accessorKey:"name",minSize:200,cell:({getValue:x,row:R})=>{const A=R.original.id,z=R.original.sequenceNumber;return o(b,{direction:"row",gap:"size-100",alignItems:"center",children:[e(Vl,{sequenceNumber:z}),e(we,{to:`/datasets/${n.id}/compare?experimentId=${A}`,children:x()})]})}},{header:"description",accessorKey:"description",minSize:300,cell:Re},{header:"created at",accessorKey:"createdAt",cell:_e}],y=s.experimentAnnotationSummaries.map(x=>{const{annotationName:R,minScore:A,maxScore:z}=x;return{header:()=>o(b,{direction:"row",gap:"size-100",alignItems:"center",justifyContent:"end",children:[e(F,{children:R}),e(kh,{annotationName:R})]}),id:`annotation-${R}`,meta:{textAlign:"right"},cell:({row:N})=>{const j=N.original.annotationSummaryMap[R];return!j||j.meanScore==null?e("span",{css:K`
                  float: right;
                `,children:"--"}):e(hK,{annotationName:R,value:j.meanScore,min:A,max:z})}}}),h=[{header:"run count",accessorKey:"runCount",meta:{textAlign:"right"},cell:ss},{header:"avg latency",accessorKey:"averageRunLatencyMs",meta:{textAlign:"right"},cell:({getValue:x})=>{const R=x();return R===null||typeof R!="number"?"--":e(je,{latencyMs:R})}},{header:"error rate",accessorKey:"errorRate",meta:{textAlign:"right"},cell:mK},{header:"metadata",accessorKey:"metadata",minSize:200,cell:Xa},{id:"actions",maxSize:120,cell:({row:x})=>{const R=x.original.project,A=x.original.metadata;return o(b,{direction:"row",gap:"size-100",children:[e(uK,{experimentId:x.original.id}),e(ps,{projectId:(R==null?void 0:R.id)||null,experimentId:x.original.id,metadata:A,canDeleteExperiment:!0,onExperimentDeleted:()=>{f({},{fetchPolicy:"store-and-network"})}})]})}}],k=Ce({columns:[...p,...y,...h],data:u,state:{rowSelection:l,columnSizing:i},defaultColumn:pK,columnResizeMode:"onChange",onRowSelectionChange:t,onColumnSizingChange:r,getCoreRowModel:Ke()}),S=k.getSelectedRowModel().rows,C=S.map(x=>x.original),P=m.useCallback(()=>{t({})},[t]),L=m.useCallback(x=>{if(x){const{scrollHeight:R,scrollTop:A,clientHeight:z}=x;R-A-z<300&&!g&&c&&d(ni)}},[c,g,d]),{columnSizingInfo:_,columnSizing:w}=k.getState(),V=k.getFlatHeaders,[Q]=m.useMemo(()=>{const x=V(),R={};for(let A=0;A<x.length;A++){const z=x[A];R[`--header-${Yn(z.id)}-size`]=z.getSize(),R[`--col-${Yn(z.column.id)}-size`]=z.column.getSize()}return[R]},[V,_,w]);return o("div",{css:K`
        height: 100%;
        overflow: auto;
      `,ref:a,onScroll:x=>L(x.target),children:[o("table",{css:Un,style:{...Q,width:k.getTotalSize(),minWidth:"100%"},children:[e("thead",{children:k.getHeaderGroups().map(x=>e("tr",{children:x.headers.map(R=>{var A,z;return e("th",{colSpan:R.colSpan,style:{width:`calc(var(--header-${Yn(R.id)}-size) * 1px)`},align:(z=(A=R.column.columnDef)==null?void 0:A.meta)==null?void 0:z.textAlign,children:R.isPlaceholder?null:o(J,{children:[e("div",{children:e(an,{maxWidth:"100%",children:W(R.column.columnDef.header,R.getContext())})}),e("div",{onMouseDown:R.getResizeHandler(),onTouchStart:R.getResizeHandler(),className:`resizer ${R.column.getIsResizing()?"isResizing":""}`})]})},R.id)})},x.id))}),_.isResizingColumn?e(yK,{table:k,hasNext:c,onLoadNext:()=>d(ni),isLoadingNext:g,dataset:n}):e(jg,{table:k,hasNext:c,onLoadNext:()=>d(ni),isLoadingNext:g,dataset:n})]}),S.length?e(gK,{datasetId:n.id,selectedExperiments:C,onClearSelection:P,onExperimentsDeleted:()=>{f({},{fetchPolicy:"store-and-network"})}}):null]})}function hK({annotationName:n,value:a,min:l,max:t}){const i=No(n),r=m.useMemo(()=>{const s=typeof l=="number"?l:0,d=typeof t=="number"?t:1;if(s===d&&d===a)return 100;const c=d-s||1;return(a-s)/c*100},[a,l,t]);return o(Ee,{children:[e(nn,{children:o("div",{css:K`
            float: right;
            --mod-barloader-fill-color: ${i};
            display: flex;
            flex-direction: row;
            align-items: center;
            gap: var(--ac-global-dimension-size-100);
          `,children:[Ja(a),e(ty,{width:"40px",value:r,"aria-label":"where the mean score lands between overall min max"})]})}),e(oa,{children:o(v,{width:"size-2400",children:[e(ae,{level:3,weight:"heavy",children:n}),o(b,{direction:"column",children:[o(b,{justifyContent:"space-between",children:[e(F,{weight:"heavy",size:"XS",children:"Mean Score"}),e(F,{size:"XS",children:Ja(a)})]}),o(b,{justifyContent:"space-between",children:[e(F,{weight:"heavy",size:"XS",children:"All Experiments Min"}),e(F,{size:"XS",children:Ja(l)})]}),o(b,{justifyContent:"space-between",children:[e(F,{weight:"heavy",size:"XS",children:"All Experiments Max"}),e(F,{size:"XS",children:Ja(t)})]}),o(b,{justifyContent:"space-between",children:[e(F,{weight:"heavy",size:"XS",children:"Mean Score Percentile"}),e(F,{size:"XS",children:zo(r)})]})]})]})})]})}function yP(){var a;const n=Me();return Oe(n),(a=n.dataset.firstExperiment)!=null&&a.edges.length?o(J,{children:[o(Fn,{direction:"vertical",autoSaveId:"experiments-layout",children:[o(Ie,{order:0,minSize:20,maxSize:30,defaultSize:20,collapsible:!0,children:[e(v,{paddingX:"size-200",paddingY:"size-100",children:e(ae,{level:2,children:"Experiments Analysis"})}),e(dK,{datasetId:n.dataset.id})]}),e(Dn,{css:Ba}),e(Ie,{order:1,children:e(v,{height:"100%",overflow:"hidden",flex:"1 1 auto",children:e(fK,{dataset:n.dataset})})})]}),e(m.Suspense,{children:e(ve,{})})]}):e(cK,{})}const Og=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"after"},{defaultValue:null,kind:"LocalArgument",name:"datasetId"},{defaultValue:null,kind:"LocalArgument",name:"experimentIds"},{defaultValue:null,kind:"LocalArgument",name:"filterCondition"},{defaultValue:50,kind:"LocalArgument",name:"first"}],a={kind:"Variable",name:"after",variableName:"after"},l={kind:"Variable",name:"experimentIds",variableName:"experimentIds"},t={kind:"Variable",name:"filterCondition",variableName:"filterCondition"},i={kind:"Variable",name:"first",variableName:"first"},r=[a,l,t,i],s={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},d={alias:null,args:null,concreteType:"Trace",kind:"LinkedField",name:"trace",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"traceId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"projectId",storageKey:null},s],storageKey:null},c={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},g={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ExperimentCompareTableQuery",selections:[{args:[a,{kind:"Variable",name:"datasetId",variableName:"datasetId"},l,t,i],kind:"FragmentSpread",name:"ExperimentCompareTable_comparisons"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ExperimentCompareTableQuery",selections:[{alias:null,args:r,concreteType:"ExperimentComparisonConnection",kind:"LinkedField",name:"compareExperiments",plural:!1,selections:[{alias:null,args:null,concreteType:"ExperimentComparisonEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"comparison",args:null,concreteType:"ExperimentComparison",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,concreteType:"DatasetExample",kind:"LinkedField",name:"example",plural:!1,selections:[s,{alias:null,args:null,concreteType:"DatasetExampleRevision",kind:"LinkedField",name:"revision",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"input",storageKey:null},{alias:"referenceOutput",args:null,kind:"ScalarField",name:"output",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"RunComparisonItem",kind:"LinkedField",name:"runComparisonItems",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"experimentId",storageKey:null},{alias:null,args:null,concreteType:"ExperimentRun",kind:"LinkedField",name:"runs",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"output",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"error",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"endTime",storageKey:null},d,{alias:null,args:null,concreteType:"ExperimentRunAnnotationConnection",kind:"LinkedField",name:"annotations",plural:!1,selections:[{alias:null,args:null,concreteType:"ExperimentRunAnnotationEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"annotation",args:null,concreteType:"ExperimentRunAnnotation",kind:"LinkedField",name:"node",plural:!1,selections:[s,c,{alias:null,args:null,kind:"ScalarField",name:"score",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"annotatorKind",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"explanation",storageKey:null},d],storageKey:null}],storageKey:null}],storageKey:null},s],storageKey:null}],storageKey:null},s],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"ExperimentComparison",kind:"LinkedField",name:"node",plural:!1,selections:[g,s],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:r,filters:["experimentIds","filterCondition"],handle:"connection",key:"ExperimentCompareTable_compareExperiments",kind:"LinkedHandle",name:"compareExperiments"},{alias:"dataset",args:[{kind:"Variable",name:"id",variableName:"datasetId"}],concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[g,s,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"ExperimentConnection",kind:"LinkedField",name:"experiments",plural:!1,selections:[{alias:null,args:null,concreteType:"ExperimentEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"experiment",args:null,concreteType:"Experiment",kind:"LinkedField",name:"node",plural:!1,selections:[s,c,{alias:null,args:null,kind:"ScalarField",name:"sequenceNumber",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"metadata",storageKey:null},{alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"project",plural:!1,selections:[s],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],type:"Dataset",abstractKey:null}],storageKey:null}]},params:{cacheID:"a0c0d3f8f3ccd0fb0e3b8b8e250e4ab9",id:null,metadata:{},name:"ExperimentCompareTableQuery",operationKind:"query",text:`query ExperimentCompareTableQuery(
  $after: String = null
  $datasetId: ID!
  $experimentIds: [ID!]!
  $filterCondition: String = null
  $first: Int = 50
) {
  ...ExperimentCompareTable_comparisons_2j8slP
}

fragment ExperimentCompareTable_comparisons_2j8slP on Query {
  compareExperiments(first: $first, after: $after, experimentIds: $experimentIds, filterCondition: $filterCondition) {
    edges {
      comparison: node {
        example {
          id
          revision {
            input
            referenceOutput: output
          }
        }
        runComparisonItems {
          experimentId
          runs {
            output
            error
            startTime
            endTime
            trace {
              traceId
              projectId
              id
            }
            annotations {
              edges {
                annotation: node {
                  id
                  name
                  score
                  label
                  annotatorKind
                  explanation
                  trace {
                    traceId
                    projectId
                    id
                  }
                }
              }
            }
            id
          }
        }
        id
      }
      cursor
      node {
        __typename
        id
      }
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
  dataset: node(id: $datasetId) {
    __typename
    id
    ... on Dataset {
      experiments {
        edges {
          experiment: node {
            id
            name
            sequenceNumber
            metadata
            project {
              id
            }
          }
        }
      }
    }
  }
}
`}}}();Og.hash="197d8138f2229974e8f32af49e5e4261";const Qg=function(){var n=["compareExperiments"],a={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},l={alias:null,args:null,concreteType:"Trace",kind:"LinkedField",name:"trace",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"traceId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"projectId",storageKey:null}],storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null};return{argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"after"},{defaultValue:null,kind:"LocalArgument",name:"datasetId"},{defaultValue:null,kind:"LocalArgument",name:"experimentIds"},{defaultValue:null,kind:"LocalArgument",name:"filterCondition"},{defaultValue:50,kind:"LocalArgument",name:"first"}],kind:"Fragment",metadata:{connection:[{count:"first",cursor:"after",direction:"forward",path:n}],refetch:{connection:{forward:{count:"first",cursor:"after"},backward:null,path:n},fragmentPathInResult:[],operation:Og}},name:"ExperimentCompareTable_comparisons",selections:[{alias:"compareExperiments",args:[{kind:"Variable",name:"experimentIds",variableName:"experimentIds"},{kind:"Variable",name:"filterCondition",variableName:"filterCondition"}],concreteType:"ExperimentComparisonConnection",kind:"LinkedField",name:"__ExperimentCompareTable_compareExperiments_connection",plural:!1,selections:[{alias:null,args:null,concreteType:"ExperimentComparisonEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"comparison",args:null,concreteType:"ExperimentComparison",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,concreteType:"DatasetExample",kind:"LinkedField",name:"example",plural:!1,selections:[a,{alias:null,args:null,concreteType:"DatasetExampleRevision",kind:"LinkedField",name:"revision",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"input",storageKey:null},{alias:"referenceOutput",args:null,kind:"ScalarField",name:"output",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"RunComparisonItem",kind:"LinkedField",name:"runComparisonItems",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"experimentId",storageKey:null},{alias:null,args:null,concreteType:"ExperimentRun",kind:"LinkedField",name:"runs",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"output",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"error",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"endTime",storageKey:null},l,{alias:null,args:null,concreteType:"ExperimentRunAnnotationConnection",kind:"LinkedField",name:"annotations",plural:!1,selections:[{alias:null,args:null,concreteType:"ExperimentRunAnnotationEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"annotation",args:null,concreteType:"ExperimentRunAnnotation",kind:"LinkedField",name:"node",plural:!1,selections:[a,t,{alias:null,args:null,kind:"ScalarField",name:"score",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"annotatorKind",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"explanation",storageKey:null},l],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"ExperimentComparison",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},{alias:"dataset",args:[{kind:"Variable",name:"id",variableName:"datasetId"}],concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[a,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"ExperimentConnection",kind:"LinkedField",name:"experiments",plural:!1,selections:[{alias:null,args:null,concreteType:"ExperimentEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"experiment",args:null,concreteType:"Experiment",kind:"LinkedField",name:"node",plural:!1,selections:[a,t,{alias:null,args:null,kind:"ScalarField",name:"sequenceNumber",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"metadata",storageKey:null},{alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"project",plural:!1,selections:[a],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],type:"Dataset",abstractKey:null}],storageKey:null}],type:"Query",abstractKey:null}}();Qg.hash="197d8138f2229974e8f32af49e5e4261";const Bg=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"condition"},{defaultValue:null,kind:"LocalArgument",name:"experimentIds"}],a=[{alias:null,args:[{kind:"Variable",name:"condition",variableName:"condition"},{kind:"Variable",name:"experimentIds",variableName:"experimentIds"}],concreteType:"ValidationResult",kind:"LinkedField",name:"validateExperimentRunFilterCondition",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"isValid",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"errorMessage",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ExperimentRunFilterConditionFieldValidationQuery",selections:a,type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ExperimentRunFilterConditionFieldValidationQuery",selections:a},params:{cacheID:"efd70fda1905f639957b01b0d1495895",id:null,metadata:{},name:"ExperimentRunFilterConditionFieldValidationQuery",operationKind:"query",text:`query ExperimentRunFilterConditionFieldValidationQuery(
  $condition: String!
  $experimentIds: [ID!]!
) {
  validateExperimentRunFilterCondition(condition: $condition, experimentIds: $experimentIds) {
    isValid
    errorMessage
  }
}
`}}}();Bg.hash="76143b48e9f598432119ada0e8f29a8f";const qg=m.createContext(null);function kK(){const n=m.useContext(qg);if(n===null)throw new Error("useExperimentRunFilterCondition must be used within a ExperimentRunFilterConditionProvider");return n}function bK(n){const[a,l]=m.useState(""),t=m.useCallback(r=>{m.startTransition(()=>{l(r)})},[]),i=m.useCallback(r=>{m.startTransition(()=>{a.length>0?l(a+" and "+r):l(r)})},[a]);return e(qg.Provider,{value:{filterCondition:a,setFilterCondition:t,appendFilterCondition:i},children:n.children})}const Ug=K`
  flex: 1 1 auto;
  .cm-content {
    padding: var(--ac-global-dimension-static-size-100) 0;
  }
  .cm-editor {
    background-color: transparent !important;
  }
  .cm-focused {
    outline: none;
  }
  .cm-selectionLayer .cm-selectionBackground {
    background: var(--ac-global-color-cyan-400) !important;
  }
`,Hg=K`
  border-width: var(--ac-global-border-size-thin);
  border-style: solid;
  border-color: var(--ac-global-input-field-border-color);
  border-radius: var(--ac-global-rounding-small);
  background-color: var(--ac-global-input-field-background-color);
  transition: all 0.2s ease-in-out;
  overflow-x: hidden;
  &:hover,
  &[data-is-focused="true"] {
    border-color: var(--ac-global-input-field-border-color-active);
    background-color: var(--ac-global-input-field-background-color-active);
  }
  &[data-is-invalid="true"] {
    border-color: var(--ac-global-color-danger);
  }
  box-sizing: border-box;
`;function SK(n){const a=n.matchBefore(/\w*/);return!a||a.from==a.to&&!n.explicit?null:{from:a.from,options:[{label:"input",type:"variable",info:"The input of the dataset example"},{label:"reference_output",type:"variable",info:"The reference output of the dataset example"},{label:"metadata",type:"variable",info:"The metadata of the dataset example"},{label:"output",type:"variable",info:"The output of the experiment run"},{label:"error",type:"variable",info:"The error message of the experiment run (if exists)"},{label:"latency_ms",type:"variable",info:"The duration of the experiment run in milliseconds"},{label:"evals",type:"variable",info:"The evaluations of the experiment run"},{label:"search input",type:"text",apply:"'' in input",detail:"macro"},{label:"search reference output",type:"text",apply:"'' in reference_output",detail:"macro"},{label:"search output",type:"text",apply:"'' in output",detail:"macro"},{label:"has error",type:"text",apply:"error is not None",detail:"macro"},{label:"Latency >= 10s",type:"text",apply:"latency_ms >= 10_000",detail:"macro"},{label:"Hallucinations",type:"text",apply:"evals['hallucination'].label == 'hallucinated'",detail:"macro"},{label:"Metadata",type:"text",apply:"metadata['category'] == 'hard_examples'",detail:"macro"}]}}async function vK(n,a){if(!n)return{isValid:!0,errorMessage:null};const l=await _l.fetchQuery(he,Bg,{condition:n,experimentIds:a}).toPromise();if(!l)throw new Error("Filter condition validation is null");return l.validateExperimentRunFilterCondition}const FK=[$i.of([{key:"Enter",run:n=>!0}]),zl(),hs({override:[SK]})];function CK(n){const{onValidCondition:a,placeholder:l=`filter condition (e.g., evals["Hallucination"].label == 'hallucinated')`}=n,[t,i]=m.useState(!1),[r,s]=m.useState(""),{filterCondition:d,setFilterCondition:c,appendFilterCondition:g}=kK(),f=m.useDeferredValue(d),{theme:u}=ca(),p=u==="light"?_a:Aa,[y]=pn(),h=y.getAll("experimentId");m.useEffect(()=>{vK(f,h).then(C=>{C!=null&&C.isValid?(s(""),m.startTransition(()=>{a(f)})):s((C==null?void 0:C.errorMessage)??"Invalid filter condition")})},[a,f,h]);const k=r!=="";return o("div",{"data-is-focused":t,"data-is-invalid":k,css:Hg,children:[o(b,{direction:"row",children:[e(fi,{children:e(I,{svg:e(Mi,{})})}),e(wa,{css:Ug,indentWithTab:!1,basicSetup:{lineNumbers:!1,foldGutter:!1,bracketMatching:!0,syntaxHighlighting:!0,highlightActiveLine:!1,highlightActiveLineGutter:!1,defaultKeymap:!1},onFocus:()=>i(!0),onBlur:()=>i(!1),value:d,onChange:c,height:"36px",width:"100%",theme:p,placeholder:l,extensions:FK}),e("button",{css:K`
            margin-right: var(--ac-global-dimension-static-size-100);
            color: var(--ac-global-text-color-700);
            visibility: ${d!==""?"visible":"hidden"};
          `,onClick:()=>c(""),className:"button--reset",children:e(I,{svg:e(Dt,{})})}),o(ot,{placement:"bottom right",children:[e(nn,{children:e("button",{css:K`
                color: var(--ac-global-text-color-700);
                background-color: var(--ac-global-color-grey-300);
                padding-left: var(--ac-global-dimension-static-size-100);
                padding-right: var(--ac-global-dimension-static-size-100);
                height: 100%;
              `,className:"button--reset",children:e(I,{svg:e(Bn,{})})})}),e(KK,{onAddFilterConditionSnippet:g})]})]}),o(Ee,{isOpen:k&&t,placement:"bottom",children:[e(nn,{children:e("div",{})}),e(oa,{children:r!=""?e(F,{color:"danger",children:r}):e(F,{color:"success",children:"Valid Expression"})})]})]})}function KK(n){const{onAddFilterConditionSnippet:a}=n;return e(v,{width:"500px",paddingTop:"size-200",paddingStart:"size-200",paddingEnd:"size-200",borderRadius:"medium",borderWidth:"thin",borderColor:"light",backgroundColor:"light",children:o(gn,{children:[e(ga,{label:"filter by substring",initialSnippet:"'search term' in output['key']",onAddFilterConditionSnippet:a},"substring"),e(ga,{label:"filter on errors",initialSnippet:"error is not None",onAddFilterConditionSnippet:a},"errors"),e(ga,{label:"filter by evaluation label",initialSnippet:"evals['hallucination'].label == 'hallucinated'",onAddFilterConditionSnippet:a},"eval_label"),e(ga,{label:"filter by evaluation score",initialSnippet:"evals['hallucination'].score >= 0.5",onAddFilterConditionSnippet:a},"eval_score"),e(ga,{label:"filter by evaluation explanation",initialSnippet:"'search term' in evals['hallucination'].explanation",onAddFilterConditionSnippet:a},"eval_explanation"),e(ga,{label:"filter for lower scores than first experiment",initialSnippet:"evals['hallucination'].score < experiments[0].evals['hallucination'].score",onAddFilterConditionSnippet:a},"compare_experiments"),e(ga,{label:"filter by metadata",initialSnippet:"metadata['category'] == 'hard_examples'",onAddFilterConditionSnippet:a},"metadata"),e(ga,{label:"filter by latency",initialSnippet:"latency_ms >= 10_000",onAddFilterConditionSnippet:a},"latency")]})})}function ga(n){const{initialSnippet:a,onAddFilterConditionSnippet:l}=n,[t,i]=m.useState(a),{theme:r}=ca(),s=r==="light"?_a:Aa;return e(Ia,{label:n.label,children:o(b,{direction:"row",width:"100%",gap:"size-100",children:[e("div",{css:K(Hg,K`
              flex: 1 1 auto;
            `),children:e(wa,{value:t,basicSetup:{lineNumbers:!1,foldGutter:!1,bracketMatching:!0,syntaxHighlighting:!0,highlightActiveLine:!1,highlightActiveLineGutter:!1},extensions:[zl()],editable:!0,onChange:i,theme:s,css:Ug})}),e(M,{"aria-label":"Add to filter condition",variant:"default",onPress:()=>l(t),leadingVisual:e(I,{svg:e(Bn,{})})})]})})}const ai={backgroundColor:"light",borderColor:"light",variant:"compact",collapsible:!0,bodyStyle:{padding:0}},TK=K`
  flex: 1 1 auto;
  overflow: auto;
  // Make sure the table fills up the remaining space
  table {
    min-width: 100%;
    td {
      vertical-align: top;
    }
  }
`,PK=K`
  display: flex;
  flex-direction: row;
  align-items: center;
  color: var(--ac-global-color-primary);
  gap: var(--ac-global-dimension-size-50);
`;function xK(n){const{datasetId:a,experimentIds:l,displayFullText:t}=n,[i,r]=m.useState(""),[,s]=pn(),d=m.useRef(null),{data:c,loadNext:g,hasNext:f,isLoadingNext:u,refetch:p}=T.usePaginationFragment(Qg,n.query),y=m.useMemo(()=>{var R,A;return((A=(R=c.dataset)==null?void 0:R.experiments)==null?void 0:A.edges.reduce((z,N)=>{var j,Z;return z[N.experiment.id]={...N.experiment,projectId:((Z=(j=N.experiment)==null?void 0:j.project)==null?void 0:Z.id)||null},z},{}))||{}},[c]),h=m.useMemo(()=>c.compareExperiments.edges.map(R=>{const A=R.comparison,z=A.runComparisonItems.reduce((N,j)=>(N[j.experimentId]=j,N),{});return{...A,id:A.example.id,input:A.example.revision.input,referenceOutput:A.example.revision.referenceOutput,runComparisonMap:z}}),[c]),[k,S]=m.useState(null),C=m.useMemo(()=>[{header:"input",accessorKey:"input",cell:({row:R})=>e(Pr,{controls:e(M,{size:"S","aria-label":"View example details",leadingVisual:e(I,{svg:e(xl,{})}),onPress:()=>{m.startTransition(()=>{S(e(m.Suspense,{children:e(Yi,{exampleId:R.original.example.id,onDismiss:()=>{S(null)}})}))})},children:"View Example"}),children:e(Ul,{children:e(dr,{children:e(il,{json:R.original.input,disableTitle:!0,space:t?2:0})})})})},{header:"reference output",accessorKey:"referenceOutput",cell:R=>e(Ul,{children:t?_K(R):Xa(R)})}],[t]),P=m.useMemo(()=>l.map(R=>({header:()=>{var Z,se,Ye,kn;const A=(Z=y[R])==null?void 0:Z.name,z=(se=y[R])==null?void 0:se.metadata,N=(Ye=y[R])==null?void 0:Ye.projectId,j=((kn=y[R])==null?void 0:kn.sequenceNumber)||0;return o(b,{direction:"row",gap:"size-100",wrap:!0,alignItems:"center",justifyContent:"space-between",children:[o(b,{direction:"row",gap:"size-100",wrap:!0,alignItems:"center",children:[e(Vl,{sequenceNumber:j}),e(F,{children:A})]}),e(ps,{experimentId:R,metadata:z,isQuiet:!0,projectId:N,canDeleteExperiment:!1})]})},accessorKey:R,minSize:500,cell:({row:A})=>{var ma,Rn;const z=A.original.runComparisonMap[R],N=(z==null?void 0:z.runs.length)||0;if(N===0)return e(oo,{});if(N>1)return e(F,{color:"warning",children:`${N} runs`});const j=z==null?void 0:z.runs[0];let Z=null;const se=(ma=j==null?void 0:j.trace)==null?void 0:ma.traceId,Ye=(Rn=j==null?void 0:j.trace)==null?void 0:Rn.projectId;return se&&Ye&&(Z=e(M,{variant:"default",className:"trace-button",size:"S","aria-label":"View run trace",leadingVisual:e(I,{svg:e(bt,{})}),onPress:()=>{m.startTransition(()=>{S(e(Xg,{traceId:se,projectId:Ye,title:"Experiment Run Trace"}))})},children:"View Trace"})),j?e(Pr,{controls:o(J,{children:[e(M,{variant:"default",className:"expand-button",size:"S","aria-label":"View example run details",leadingVisual:e(I,{svg:e(xl,{})}),onPress:()=>{m.startTransition(()=>{S(e(AK,{selectedExample:A.original,datasetId:a,experimentInfoById:y}))})},children:"Experiment Run"}),Z]}),children:e(Ul,{children:e(LK,{...j,displayFullText:t,setDialog:S})})}):e(Ul,{children:e(oo,{})})}})),[l,y,a,t]),L=m.useMemo(()=>[...C,...P],[C,P]),_=Ce({columns:L,data:h,getCoreRowModel:Ke(),columnResizeMode:"onChange"}),w=fn.useMemo(()=>{const R=_.getFlatHeaders(),A={};for(let z=0;z<R.length;z++){const N=R[z];A[`--header-${Yn(N.id)}-size`]=N.getSize(),A[`--col-${Yn(N.column.id)}-size`]=N.column.getSize()}return A},[_.getState().columnSizingInfo,_.getState().columnSizing]),Q=_.getRowModel().rows.length===0,x=m.useCallback(R=>{if(R){const{scrollHeight:A,scrollTop:z,clientHeight:N}=R;A-z-N<300&&!u&&f&&g(50)}},[f,u,g]);return m.useEffect(()=>{m.startTransition(()=>{p({after:null,first:50,filterCondition:i,experimentIds:l,datasetId:a},{fetchPolicy:"store-and-network"})})},[a,l,i,p]),e(v,{overflow:"auto",children:o(b,{direction:"column",height:"100%",children:[e(v,{paddingTop:"size-100",paddingBottom:"size-100",paddingStart:"size-200",paddingEnd:"size-200",borderBottomColor:"grey-300",borderBottomWidth:"thin",flex:"none",children:e(CK,{onValidCondition:r})}),o("div",{css:TK,onScroll:R=>x(R.target),ref:d,children:[o("table",{css:K(We,Uo),style:{...w,width:_.getTotalSize(),minWidth:"100%"},children:[e("thead",{children:_.getHeaderGroups().map(R=>e("tr",{children:R.headers.map(A=>e("th",{colSpan:A.colSpan,style:{width:`calc(var(--header-${Yn(A==null?void 0:A.id)}-size) * 1px)`},children:A.isPlaceholder?null:o(J,{children:[o("div",{className:A.column.getCanSort()?"sort":"",onClick:A.column.getToggleSortingHandler(),style:{left:A.getStart(),width:"100%"},children:[e(an,{maxWidth:"100%",children:W(A.column.columnDef.header,A.getContext())}),A.column.getIsSorted()?e(I,{className:"sort-icon",svg:A.column.getIsSorted()==="asc"?e(Xe,{}):e(Ze,{})}):null]}),e("div",{onMouseDown:A.getResizeHandler(),onTouchStart:A.getResizeHandler(),className:`resizer ${A.column.getIsResizing()?"isResizing":""}`})]})},A.id))},R.id))}),Q?e(yn,{}):_.getState().columnSizingInfo.isResizingColumn?e(IK,{table:_,hasNext:f,onLoadNext:()=>g(50),isLoadingNext:u}):e(Gg,{table:_,hasNext:f,onLoadNext:()=>g(50),isLoadingNext:u})]}),e(ue,{isDismissable:!0,type:"slideOver",onDismiss:()=>{S(null),s(R=>(R.delete(mn),R))},children:k})]})]})})}function Gg({table:n,hasNext:a,onLoadNext:l,isLoadingNext:t}){return o("tbody",{children:[n.getRowModel().rows.map(i=>e("tr",{children:i.getVisibleCells().map(r=>e("td",{style:{width:`calc(var(--col-${Yn(r.column.id)}-size) * 1px)`,maxWidth:`calc(var(--col-${Yn(r.column.id)}-size) * 1px)`,padding:0},children:W(r.column.columnDef.cell,r.getContext())},r.id))},i.id)),a?e(Vi,{onLoadMore:l,isLoadingNext:t},"load-more"):null]})}const IK=fn.memo(Gg,(n,a)=>n.table.options.data===a.table.options.data);function DK(n){const{datasetId:a,exampleId:l}=n,t=ce();return e("div",{onClick:i=>{i.preventDefault(),i.stopPropagation()},children:e(ra,{buttonSize:"compact",align:"end",onAction:i=>{switch(i){case"gotoExample":return t(`/datasets/${a}/examples/${l}`);default:Te()}},children:e(xe,{children:o(b,{direction:"row",gap:"size-75",justifyContent:"start",alignItems:"center",children:[e(I,{svg:e(Sh,{})}),e(F,{children:"Go to example"})]})},"gotoExample")})})}function LK(n){const{output:a,error:l,startTime:t,endTime:i,annotations:r,displayFullText:s,setDialog:d}=n;if(l)return e(Wg,{error:l});const c=r!=null&&r.edges.length?r.edges.map(g=>g.annotation):[];return o(b,{direction:"column",gap:"size-100",height:"100%",justifyContent:"space-between",children:[e(dr,{children:e(il,{json:a,disableTitle:!0,space:s?2:0})}),o("ul",{css:K`
          display: flex;
          flex-direction: row;
          gap: var(--ac-global-dimension-static-size-100);
          align-items: center;
          flex-wrap: wrap;
        `,children:[e("li",{children:e(Jg,{startTime:t,endTime:i})},"run-latency"),c.map(g=>e("li",{children:e(Eo,{annotation:g,extra:g.trace&&e(v,{paddingTop:"size-100",children:o("div",{css:PK,children:[e(I,{svg:e(ta,{})}),e("span",{children:"Click to view evaluator trace"})]})}),children:e(ll,{annotation:g,onClick:()=>{const f=g.trace;f&&m.startTransition(()=>{d(e(Xg,{traceId:f.traceId,projectId:f.projectId,title:`Evaluator Trace: ${g.name}`}))})}})})},g.id))]})]})}function Wg({error:n}){return o(b,{direction:"row",gap:"size-50",alignItems:"center",children:[e(I,{svg:e(Ti,{}),color:"danger"}),e(F,{color:"danger",children:n})]})}function Jg({startTime:n,endTime:a}){const l=m.useMemo(()=>{let t=null;return n&&a&&(t=new Date(a).getTime()-new Date(n).getTime()),t},[n,a]);return l===null?null:e(je,{latencyMs:l})}function oo(){return o(b,{direction:"row",gap:"size-50",children:[e(I,{svg:e(bh,{}),color:"grey-800"}),e(F,{color:"text-700",children:"not run"})]})}function _K({getValue:n}){const a=n();return e(dr,{children:e(il,{json:a,space:2})})}function dr({children:n}){return e("div",{css:K`
        max-height: 300px;
        overflow-y: auto;
      `,children:n})}function AK({selectedExample:n,datasetId:a,experimentInfoById:l}){return e(oe,{title:`Comparing Experiments for Example: ${n.id}`,size:"fullscreen",extra:e(DK,{datasetId:a,exampleId:n.id}),children:o(Fn,{direction:"vertical",autoSaveId:"example-compare-panel-group",children:[e(Ie,{defaultSize:35,children:e("div",{css:K`
              overflow-y: auto;
              height: 100%;
            `,children:e(v,{overflow:"hidden",padding:"size-200",children:o(b,{direction:"row",gap:"size-200",flex:"1 1 auto",children:[e(v,{width:"50%",children:e(q,{title:"Input",...ai,bodyStyle:{padding:0,maxHeight:"300px",overflowY:"auto"},extra:e(de,{text:JSON.stringify(n.input)}),children:e(Sn,{value:JSON.stringify(n.input,null,2)})})}),e(v,{width:"50%",children:e(q,{title:"Reference Output",...ai,extra:e(de,{text:JSON.stringify(n.referenceOutput)}),bodyStyle:{padding:0,maxHeight:"300px",overflowY:"auto"},children:e(Sn,{value:JSON.stringify(n.referenceOutput,null,2)})})})]})})})}),e(Dn,{css:Ba}),e(Ie,{defaultSize:65,children:o(b,{direction:"column",height:"100%",children:[e(v,{paddingStart:"size-200",paddingEnd:"size-200",paddingTop:"size-100",paddingBottom:"size-100",borderBottomColor:"dark",borderBottomWidth:"thin",flex:"none",children:e(ae,{level:2,children:"Experiments"})}),e("div",{css:K`
                overflow-y: auto;
                height: 100%;
                padding: var(--ac-global-dimension-static-size-200);
              `,children:e("ul",{css:K`
                  display: flex;
                  flex-direction: column;
                  gap: var(--ac-global-dimension-static-size-200);
                `,children:n.runComparisonItems.map(t=>{const i=l[t.experimentId];return e("li",{children:e(q,{...ai,title:i==null?void 0:i.name,titleExtra:e(Vl,{sequenceNumber:(i==null?void 0:i.sequenceNumber)||0}),children:e("ul",{children:t.runs.map((r,s)=>{var d;return e("li",{children:o(b,{direction:"row",children:[e(v,{flex:!0,children:r.error?e(v,{padding:"size-200",children:e(Wg,{error:r.error})}):e(Sn,{value:JSON.stringify(r.output,null,2)})}),o(Ea,{width:"size-3000",children:[e(Jg,{startTime:r.startTime,endTime:r.endTime}),e("ul",{css:K`
                                      margin-top: var(
                                        --ac-global-dimension-static-size-100
                                      );
                                      display: flex;
                                      flex-direction: column;
                                      justify-content: flex-start;
                                      align-items: flex-end;
                                      gap: var(
                                        --ac-global-dimension-static-size-100
                                      );
                                    `,children:(d=r.annotations)==null?void 0:d.edges.map(c=>e("li",{children:e(ll,{annotation:c.annotation})},c.annotation.id))})]})]})},s)})})})},t.experimentId)})})})]})})]})})}function Xg({traceId:n,projectId:a,title:l}){const t=ce();return e(oe,{title:l,size:"fullscreen",extra:e(M,{onPress:()=>t(`/projects/${a}/traces/${n}`),children:"View Trace in Project"}),children:e(ar,{traceId:n,projectId:a})})}function Ul({children:n}){return e(v,{paddingX:"size-200",paddingY:"size-100",children:n})}const Zg={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"ExperimentMultiSelector__experiments",selections:[{alias:null,args:null,concreteType:"ExperimentConnection",kind:"LinkedField",name:"experiments",plural:!1,selections:[{alias:null,args:null,concreteType:"ExperimentEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"experiment",args:null,concreteType:"Experiment",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"sequenceNumber",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],type:"Dataset",abstractKey:null};Zg.hash="1aa376b1e9425f49268ac231dc2c0412";function wK(n){const{dataset:a,selectedExperimentIds:l,onChange:t,label:i,validationState:r,description:s,errorMessage:d,...c}=n,g=T.useFragment(Zg,a),f=m.useMemo(()=>g.experiments.edges.map(y=>y.experiment),[g]),u=f.length===0,p=m.useMemo(()=>{if(u)return"No experiments";const y=l.length;return y>0?`${y} experiment${y>1?"s":""}`:"No experiments selected"},[l,u]);return e(Ia,{label:i,isDisabled:u,validationState:r,description:s,errorMessage:d,children:e(hi,{isDisabled:u,...c,menu:e(ct,{selectionMode:"multiple",onSelectionChange:y=>{t(Array.from(y))},selectedKeys:new Set(l),children:f.map(y=>e(xe,{textValue:y.name,children:o(b,{direction:"column",gap:"size-50",children:[o(b,{direction:"row",gap:"size-100",children:[e(Vl,{sequenceNumber:y.sequenceNumber}),e(F,{children:y.name})]}),e(F,{size:"XS",color:"text-700",children:new Date(y.createdAt).toLocaleString()})]})},y.id))}),triggerProps:{placement:"bottom start"},children:p})})}function fP(){const n=Me();Oe(n);const[a,l]=m.useState(!1),[t,i]=pn(),r=t.getAll("experimentId"),s=r.length>0;return o("main",{css:K`
        height: 100%;
        display: flex;
        flex-direction: column;
        overflow: hidden;
      `,children:[e(v,{padding:"size-200",borderBottomColor:"dark",borderBottomWidth:"thin",flex:"none",children:o(b,{direction:"column",gap:"size-100",children:[e(ae,{level:1,children:"Compare Experiments"}),o(b,{direction:"row",justifyContent:"space-between",alignItems:"end",children:[e(wK,{dataset:n.dataset,selectedExperimentIds:r,label:"experiments",onChange:d=>{m.startTransition(()=>{t.delete("experimentId"),d.forEach(c=>{t.append("experimentId",c)}),i(t)})}}),e(xa,{onChange:d=>{l(d)},defaultSelected:!1,labelPlacement:"start",children:"Full Text"})]})]})}),s?e(bK,{children:e(m.Suspense,{fallback:e(ge,{}),children:e(xK,{query:n,datasetId:n.dataset.id,experimentIds:r,displayFullText:a})})}):e(v,{padding:"size-200",children:e(Fe,{variant:"info",title:"No Experiment Selected",children:"Please select one or more experiments."})})]})}const Yg=function(){var n={defaultValue:null,kind:"LocalArgument",name:"experimentIDs"},a={defaultValue:null,kind:"LocalArgument",name:"id"},l=[{kind:"Variable",name:"id",variableName:"id"}],t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},r={kind:"Variable",name:"experimentIds",variableName:"experimentIDs"},s=[r,{kind:"Literal",name:"first",value:50}],d={alias:null,args:null,concreteType:"Trace",kind:"LinkedField",name:"trace",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"traceId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"projectId",storageKey:null},t],storageKey:null},c={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null};return{fragment:{argumentDefinitions:[n,a],kind:"Fragment",metadata:null,name:"experimentCompareLoaderQuery",selections:[{alias:"dataset",args:l,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[t,{kind:"InlineFragment",selections:[i,{args:null,kind:"FragmentSpread",name:"ExperimentMultiSelector__experiments"}],type:"Dataset",abstractKey:null}],storageKey:null},{args:[{kind:"Variable",name:"datasetId",variableName:"id"},r],kind:"FragmentSpread",name:"ExperimentCompareTable_comparisons"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[a,n],kind:"Operation",name:"experimentCompareLoaderQuery",selections:[{alias:null,args:s,concreteType:"ExperimentComparisonConnection",kind:"LinkedField",name:"compareExperiments",plural:!1,selections:[{alias:null,args:null,concreteType:"ExperimentComparisonEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"comparison",args:null,concreteType:"ExperimentComparison",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,concreteType:"DatasetExample",kind:"LinkedField",name:"example",plural:!1,selections:[t,{alias:null,args:null,concreteType:"DatasetExampleRevision",kind:"LinkedField",name:"revision",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"input",storageKey:null},{alias:"referenceOutput",args:null,kind:"ScalarField",name:"output",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"RunComparisonItem",kind:"LinkedField",name:"runComparisonItems",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"experimentId",storageKey:null},{alias:null,args:null,concreteType:"ExperimentRun",kind:"LinkedField",name:"runs",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"output",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"error",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"endTime",storageKey:null},d,{alias:null,args:null,concreteType:"ExperimentRunAnnotationConnection",kind:"LinkedField",name:"annotations",plural:!1,selections:[{alias:null,args:null,concreteType:"ExperimentRunAnnotationEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"annotation",args:null,concreteType:"ExperimentRunAnnotation",kind:"LinkedField",name:"node",plural:!1,selections:[t,i,{alias:null,args:null,kind:"ScalarField",name:"score",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"annotatorKind",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"explanation",storageKey:null},d],storageKey:null}],storageKey:null}],storageKey:null},t],storageKey:null}],storageKey:null},t],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"ExperimentComparison",kind:"LinkedField",name:"node",plural:!1,selections:[c,t],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:s,filters:["experimentIds","filterCondition"],handle:"connection",key:"ExperimentCompareTable_compareExperiments",kind:"LinkedHandle",name:"compareExperiments"},{alias:"dataset",args:l,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[c,t,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"ExperimentConnection",kind:"LinkedField",name:"experiments",plural:!1,selections:[{alias:null,args:null,concreteType:"ExperimentEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"experiment",args:null,concreteType:"Experiment",kind:"LinkedField",name:"node",plural:!1,selections:[t,i,{alias:null,args:null,kind:"ScalarField",name:"sequenceNumber",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"metadata",storageKey:null},{alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"project",plural:!1,selections:[t],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null},i],type:"Dataset",abstractKey:null}],storageKey:null}]},params:{cacheID:"7678ee2e7aebd26e017f98b54516db01",id:null,metadata:{},name:"experimentCompareLoaderQuery",operationKind:"query",text:`query experimentCompareLoaderQuery(
  $id: ID!
  $experimentIDs: [ID!]!
) {
  ...ExperimentCompareTable_comparisons_2dEeQT
  dataset: node(id: $id) {
    __typename
    id
    ... on Dataset {
      id
      name
      ...ExperimentMultiSelector__experiments
    }
  }
}

fragment ExperimentCompareTable_comparisons_2dEeQT on Query {
  compareExperiments(first: 50, experimentIds: $experimentIDs) {
    edges {
      comparison: node {
        example {
          id
          revision {
            input
            referenceOutput: output
          }
        }
        runComparisonItems {
          experimentId
          runs {
            output
            error
            startTime
            endTime
            trace {
              traceId
              projectId
              id
            }
            annotations {
              edges {
                annotation: node {
                  id
                  name
                  score
                  label
                  annotatorKind
                  explanation
                  trace {
                    traceId
                    projectId
                    id
                  }
                }
              }
            }
            id
          }
        }
        id
      }
      cursor
      node {
        __typename
        id
      }
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
  dataset: node(id: $id) {
    __typename
    id
    ... on Dataset {
      experiments {
        edges {
          experiment: node {
            id
            name
            sequenceNumber
            metadata
            project {
              id
            }
          }
        }
      }
    }
  }
}

fragment ExperimentMultiSelector__experiments on Dataset {
  experiments {
    edges {
      experiment: node {
        id
        name
        sequenceNumber
        createdAt
      }
    }
  }
}
`}}}();Yg.hash="2be4ec323f33281011a426b2b5973d3b";async function hP(n){const{datasetId:a}=n.params,t=new URL(n.request.url).searchParams.getAll("experimentId");return await T.fetchQuery(he,Yg,{id:a,experimentIDs:t}).toPromise()}const RK=K`
  overflow-y: auto;
  height: 100%;
`,EK=K`
  padding: var(--ac-global-dimension-size-100);
  max-width: 1000px;
  min-width: 500px;
  box-sizing: border-box;
  width: 100%;
  margin-left: auto;
  margin-right: auto;
`;function kP(){const{pathname:n}=al(),a=ce(),l=n.split("/settings")[1].replace("/",""),t=m.useCallback(i=>{typeof i=="string"&&a(`/settings/${i}`,{replace:!0})},[a]);return l?e("main",{css:RK,children:e("div",{css:EK,children:o(cn,{selectedKey:l,onSelectionChange:t,children:[o(dn,{children:[e(le,{id:"general",children:"General"}),e(le,{id:"providers",children:"AI Providers"}),e(le,{id:"annotations",children:"Annotations"}),e(le,{id:"data",children:"Data Retention"})]}),e(re,{id:"general",padded:!0,children:e(ve,{})}),e(re,{id:"providers",padded:!0,children:e(ve,{})}),e(re,{id:"annotations",padded:!0,children:e(ve,{})}),e(re,{id:"data",padded:!0,children:e(ve,{})})]})})}):e(yo,{to:"/settings/general",replace:!0})}const ep={fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"settingsGeneralPageLoaderQuery",selections:[{args:null,kind:"FragmentSpread",name:"DBUsagePieChart_data"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"settingsGeneralPageLoaderQuery",selections:[{alias:null,args:null,concreteType:"DbTableStats",kind:"LinkedField",name:"dbTableStats",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"tableName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"numBytes",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"dbStorageCapacityBytes",storageKey:null}]},params:{cacheID:"b23054c72be2f3ddc335774d54407667",id:null,metadata:{},name:"settingsGeneralPageLoaderQuery",operationKind:"query",text:`query settingsGeneralPageLoaderQuery {
  ...DBUsagePieChart_data
}

fragment DBUsagePieChart_data on Query {
  dbTableStats {
    tableName
    numBytes
  }
  dbStorageCapacityBytes
}
`}};ep.hash="567b82d32463e4ba410f49c53bc9dcf2";async function bP(){return await T.fetchQuery(he,ep,{}).toPromise()}const so=window.Config.basename,co={width:"100%",height:"100%",border:"none",backgroundColor:"white"};function SP(){return o("div",{css:K`
        display: flex;
        flex-direction: column;
        flex: 1 1 auto;
        height: 100%;
        .ac-tabs {
          flex: 1 1 auto;
        }
        .ac-tabs__pane-container,
        .ac-tabs__pane-container > div {
          flex: 1 1 auto;
          height: 100%;
        }
      `,children:[e(Fe,{variant:"info",banner:!0,icon:e(I,{svg:e(vh,{})}),children:"These APIs are under active development and are subject to change."}),o(cn,{children:[o(dn,{children:[e(le,{id:"rest",children:"REST"}),e(le,{id:"graphql",children:"GraphQL"})]}),e(re,{id:"rest",children:e("iframe",{src:`${so}/docs`,style:co})}),e(re,{id:"graphql",children:e("iframe",{src:`${so}/graphql`,style:co})})]})]})}function jl({children:n}){return o("main",{css:K`
        padding-top: 200px;
        width: 100%;
        height: 100vh;
        overflow: hidden;
        background: radial-gradient(
          90% 60% at 50% 30%,
          rgba(5, 145, 193, 0.4) 0%,
          transparent 100%
        );
        display: flex;
        flex-direction: column;
        justify-content: space-between;
        box-sizing: border-box;
      `,children:[e(v,{borderColor:"light",borderWidth:"thin",width:"size-5000",padding:"size-400",backgroundColor:"dark",marginStart:"auto",marginEnd:"auto",borderRadius:"medium",overflow:"auto",children:n}),o("footer",{css:K`
          display: flex;
          justify-content: center;
          padding: var(--ac-global-dimension-size-400);
          gap: var(--ac-global-dimension-size-200);
          a {
            color: var(--ac-global-text-color-700);
            transition: color 0.2s ease-in-out;
            text-decoration: none;
            &:hover {
              color: var(--ac-global-text-color-900);
              text-decoration: underline;
            }
          }
        `,children:[e("a",{href:"https://arize.com/docs/phoenix",children:"Documentation"}),"|",e("a",{href:"https://arize-ai.slack.com/join/shared_invite/zt-2w57bhem8-hq24MB6u7yE_ZF_ilOYSBw#/shared-invite/email",children:"Community"}),"|",e("a",{href:"https://twitter.com/ArizePhoenix",children:"Social"}),"|",e("a",{href:"https://github.com/Arize-ai/phoenix",children:"GitHub"}),"|",e("a",{href:"https://github.com/Arize-ai/phoenix/releases",children:`arize-phoenix v${window.Config.platformVersion}`})]})]})}function MK(n){const a=ce(),{initialError:l,onSubmit:t}=n,[i,r]=m.useState(l),[s,d]=m.useState(!1),c=m.useCallback(async u=>{t==null||t(),r(null),d(!0);try{const y=await fetch(xn("/auth/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(u)});if(!y.ok){const h=y.status===429?"Too many requests. Please try again later.":"Invalid login";r(h);return}}catch{r("Invalid login");return}finally{d(()=>!1)}const p=Fh();a(p)},[a,t,r]),{control:g,handleSubmit:f}=Ve({defaultValues:{email:"",password:""}});return o(J,{children:[i?o(v,{paddingBottom:"size-100",children:[e(Fe,{variant:"danger",children:i})," "]}):null,e(gn,{children:o(b,{direction:"column",gap:"size-100",children:[e(G,{name:"email",control:g,render:({field:{onChange:u,value:p}})=>o(ee,{name:"email",isRequired:!0,type:"email",onChange:u,value:p,autoComplete:"email",children:[e(H,{children:"Email"}),e(X,{placeholder:"your email address"})]})}),o("div",{css:K`
              position: relative;
              a {
                position: absolute;
                float: right;
                right: 0;
                top: var(--ac-global-dimension-size-50);
                font-size: 12px;
              }
            `,children:[e(G,{name:"password",control:g,render:({field:{onChange:u,value:p}})=>o(ee,{name:"password",type:"password",isRequired:!0,onChange:u,value:p,onKeyDown:y=>{y.key==="Enter"&&f(c)()},autoComplete:"password",children:[e(H,{children:"Password"}),e(X,{placeholder:"your password"})]})}),e(we,{to:"/forgot-password",children:"Forgot your password?"})]}),e(M,{variant:"primary",isDisabled:s,leadingVisual:s?e(I,{svg:e(sn,{})}):void 0,onPress:()=>f(c)(),children:s?"Logging In":"Log In"})]})})]})}const VK=K`
  button {
    width: 100%;
  }
  i {
    display: block;
    width: 20px;
    height: 20px;
    padding-right: var(--ac-global-dimension-size-50);
  }
  &[data-provider^="aws"],
  &[data-provider^="google"],
  &[data-provider^="arize"] {
    button {
      background-color: white;
      color: black;
      &:hover {
        background-color: #ececec !important;
      }
    }
  }
`,np=m.forwardRef(function({idpName:a,idpDisplayName:l,returnUrl:t},i){return e("form",{ref:i,action:xn(`/oauth2/${a}/login${t?`?returnUrl=${t}`:""}`),method:"post",css:VK,"data-provider":a,children:o(M,{variant:"default",type:"submit",leadingVisual:e(zK,{idpName:a}),children:["Login with ",l]})})});function zK({idpName:n}){return n==="github"||n==="google"||n==="microsoft_entra_id"||n==="arize"||n.startsWith("aws")?e("i",{children:e("div",{css:K`
          display: inline-block;
          width: 20px;
          height: 20px;
          position: relative;
          background-size: contain;
          background-repeat: no-repeat;
          background-position: 50%;
          &[data-provider^="github"] {
            background-image: url("data:image/svg+xml;charset=utf-8,%3Csvg width='20' height='20' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M10 0C4.477 0 0 4.36 0 9.74c0 4.304 2.865 7.955 6.839 9.243.5.09.682-.211.682-.47 0-.23-.008-.843-.013-1.656-2.782.588-3.369-1.306-3.369-1.306-.454-1.125-1.11-1.425-1.11-1.425-.908-.604.069-.592.069-.592 1.003.069 1.531 1.004 1.531 1.004.892 1.488 2.341 1.059 2.91.81.092-.63.35-1.06.636-1.303-2.22-.245-4.555-1.081-4.555-4.814 0-1.063.39-1.933 1.029-2.613-.103-.247-.446-1.238.098-2.578 0 0 .84-.262 2.75.998A9.818 9.818 0 0 1 10 4.71c.85.004 1.705.112 2.504.328 1.909-1.26 2.747-.998 2.747-.998.546 1.34.203 2.331.1 2.578.64.68 1.028 1.55 1.028 2.613 0 3.742-2.339 4.566-4.566 4.807.359.3.678.895.678 1.804 0 1.301-.012 2.352-.012 2.671 0 .261.18.564.688.47C17.137 17.69 20 14.042 20 9.74 20 4.36 15.522 0 10 0z' fill='%23161514' fill-rule='evenodd'/%3E%3C/svg%3E");
          }

          &[data-provider^="google"] {
            background-image: url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 48 48'%3E%3Cdefs%3E%3Cpath id='a' d='M44.5 20H24v8.5h11.8C34.7 33.9 30.1 37 24 37c-7.2 0-13-5.8-13-13s5.8-13 13-13c3.1 0 5.9 1.1 8.1 2.9l6.4-6.4C34.6 4.1 29.6 2 24 2 11.8 2 2 11.8 2 24s9.8 22 22 22c11 0 21-8 21-22 0-1.3-.2-2.7-.5-4z'/%3E%3C/defs%3E%3CclipPath id='b'%3E%3Cuse xlink:href='%23a' overflow='visible'/%3E%3C/clipPath%3E%3Cpath clip-path='url(%23b)' fill='%23FBBC05' d='M0 37V11l17 13z'/%3E%3Cpath clip-path='url(%23b)' fill='%23EA4335' d='M0 11l17 13 7-6.1L48 14V0H0z'/%3E%3Cpath clip-path='url(%23b)' fill='%2334A853' d='M0 37l30-23 7.9 1L48 0v48H0z'/%3E%3Cpath clip-path='url(%23b)' fill='%234285F4' d='M48 48L17 24l-4-3 35-10z'/%3E%3C/svg%3E");
          }
          &[data-provider^="microsoft"] {
            background-image: url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='21' height='21'%3E%3Cpath fill='%23f25022' d='M1 1h9v9H1z'/%3E%3Cpath fill='%2300a4ef' d='M1 11h9v9H1z'/%3E%3Cpath fill='%237fba00' d='M11 1h9v9h-9z'/%3E%3Cpath fill='%23ffb900' d='M11 11h9v9h-9z'/%3E%3C/svg%3E");
          }
          &[data-provider^="aws"] {
            background-image: url("data:image/svg+xml;charset=utf-8,%3Csvg width='400' height='334' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M236.578 94.824c-9.683.765-20.854 1.502-32.021 3.006-17.12 2.211-34.24 5.219-48.386 11.907-27.544 11.208-46.163 35.053-46.163 70.114 0 44.018 28.298 66.354 64.026 66.354 11.93 0 21.606-1.466 30.522-3.71 14.156-4.481 26.07-12.67 40.209-27.596 8.192 11.205 10.413 16.428 24.575 28.338 3.725 1.502 7.448 1.502 10.413-.742 8.932-7.458 24.561-20.873 32.773-28.33 3.71-3.012 2.955-7.463.739-11.204-8.198-10.435-16.381-19.401-16.381-39.506V96.324c0-28.359 2.214-54.453-18.614-73.822C261.147 6.815 234.34.86 213.5.86h-8.947c-37.965 2.247-78.169 18.635-87.122 65.629-1.462 5.955 3.012 8.198 5.989 8.962l41.677 5.224c4.471-.773 6.691-4.491 7.432-8.233 3.74-16.388 17.136-24.583 32.024-26.087h2.998c8.905 0 18.586 3.743 23.813 11.168 5.932 8.965 5.21 20.904 5.21 31.339v5.961h.004v.001zm0 43.278c0 17.162.723 30.571-8.195 45.461-5.208 10.437-14.141 17.154-23.827 19.4-1.481 0-3.698.766-5.947.766-16.371 0-26.077-12.673-26.077-31.334 0-23.856 14.159-35.056 32.023-40.277 9.687-2.241 20.86-2.982 32.021-2.982v8.966h.002z'/%3E%3Cpath d='M373.71 315.303c18.201-15.398 25.89-43.349 26.29-57.939v-2.44c0-3.255-.803-5.661-1.6-6.88-3.646-4.445-30.369-8.523-53.402-1.627-6.468 2.045-12.146 4.865-17.396 8.507-4.051 2.854-3.238 6.464.802 6.08 4.447-.823 10.126-1.208 16.594-2.048 14.159-1.18 30.742-1.592 34.784 3.662 5.642 6.87-6.468 36.868-11.749 49.838-1.593 4.065 2.03 5.696 5.677 2.847z' fill='%23FE9900'/%3E%3Cpath d='M2.008 257.364c52.17 47.404 120.925 75.775 197.791 75.775 47.725 0 102.727-13.381 145.199-38.899 5.676-3.27 11.316-6.912 16.565-10.952 7.286-5.25.817-13.38-6.463-10.147-3.229 1.215-6.873 2.857-10.103 4.066-46.539 18.248-95.441 26.76-140.762 26.76-72.008 0-141.56-19.87-197.786-52.684-5.259-2.822-8.907 2.428-4.441 6.081z' fill='%23FE9900'/%3E%3C/svg%3E");
          }
          &[data-provider^="arize"] {
            background-image: url("data:image/svg+xml,%3Csvg%20width%3D%2224%22%20height%3D%2224%22%20viewBox%3D%220%200%2024%2024%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%3Cpath%20d%3D%22M11.9884%2017.7389C11.5829%2017.7414%2011.1872%2017.8689%2010.8513%2018.1051C10.5155%2018.3414%2010.2547%2018.6758%2010.1018%2019.0661C9.94885%2019.4564%209.91077%2019.8851%209.99233%2020.2979C10.0739%2020.7107%2010.2714%2021.0891%2010.56%2021.3853C10.8485%2021.6814%2011.2151%2021.882%2011.6133%2021.9616C12.0115%2022.0413%2012.4236%2021.9964%2012.7973%2021.8327C13.171%2021.669%2013.4896%2021.3938%2013.7127%2021.0419C13.9359%2020.6901%2014.0537%2020.2773%2014.0511%2019.8559C14.0502%2019.576%2013.9961%2019.2989%2013.8918%2019.0408C13.7875%2018.7826%2013.6351%2018.5484%2013.4434%2018.3517C13.2517%2018.155%2013.0245%2017.9995%2012.7748%2017.8944C12.5251%2017.7892%2012.2578%2017.7363%2011.9884%2017.7389V17.7389Z%22%20fill%3D%22%23CA2A76%22%2F%3E%3Cpath%20d%3D%22M21.6973%2014.9994L13.3945%202.7484C13.1657%202.4149%2012.8317%202.17533%2012.4505%202.07142L12.3272%202.0401C12.2202%202.01604%2012.1112%202.00269%2012.0018%202.00024C11.891%201.99795%2011.7805%202.01209%2011.6736%202.04224V2.04224L11.5476%202.07142C11.1668%202.1746%2010.8328%202.41312%2010.6036%202.74555L2.30008%2014.9994C2.17431%2015.1869%202.08541%2015.3983%202.03848%2015.6215C1.99155%2015.8448%201.9875%2016.0755%202.02659%2016.3004C2.06567%2016.5252%202.1471%2016.7399%202.26622%2016.932C2.38533%2017.1241%202.53978%2017.2898%202.7207%2017.4197C3.09016%2017.6822%203.54364%2017.7844%203.98456%2017.7047C4.42549%2017.6249%204.81903%2017.3694%205.08138%2016.9926L11.055%208.17558C11.1493%207.99991%2011.287%207.85358%2011.4539%207.75172C11.6209%207.64985%2011.8109%207.59615%2012.0045%207.59615C12.1981%207.59615%2012.3881%207.64985%2012.555%207.75172C12.722%207.85358%2012.8597%207.99991%2012.954%208.17558V8.17558L18.9262%2016.9926C19.1864%2017.3722%2019.5798%2017.6302%2020.0214%2017.711C20.4631%2017.7919%2020.9176%2017.689%2021.2869%2017.4247C21.6504%2017.1593%2021.8977%2016.7549%2021.9746%2016.3002C22.0516%2015.8456%2021.9518%2015.3778%2021.6973%2014.9994V14.9994Z%22%20fill%3D%22%23CA2A76%22%2F%3E%3C%2Fsvg%3E");
          }
        `,"data-provider":n})}):null}function Nt(){return o("svg",{width:"253",height:"63",viewBox:"0 0 682 169",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[o("g",{clipPath:"url(#clip0_290_1904)",children:[e("path",{d:"M147.458 105.593C147.022 103.63 146.028 101.824 144.492 100.222C143.901 99.6064 143.244 99.0233 142.529 98.4978C142.184 98.2432 141.815 98.005 141.437 97.7669C140.969 97.4712 140.484 97.192 139.95 96.921C137.995 95.9191 136.328 94.909 134.866 93.825C134.274 93.3897 133.699 92.9299 133.157 92.4535C131.851 91.312 130.972 90.3348 130.315 89.3C130.102 88.9715 129.913 88.6102 129.732 88.2653C129.658 88.1175 129.543 87.9943 129.412 87.8957C129.173 87.7233 128.869 87.6494 128.565 87.6986C128.097 87.789 127.736 88.1667 127.678 88.6431C127.637 89.0126 127.637 89.4068 127.687 89.8092C127.719 90.0474 127.588 90.2773 127.366 90.3758C127.317 90.4005 127.259 90.4087 127.21 90.4169C126.898 90.4498 126.619 90.6222 126.438 90.885C126.257 91.1478 126.208 91.4681 126.282 91.7719C126.348 92.0347 126.438 92.2236 126.512 92.3714L126.578 92.5028C126.627 92.5931 126.676 92.6917 126.726 92.782C126.873 93.0612 127.021 93.3405 127.202 93.6033C127.547 94.1042 127.933 94.6052 128.393 95.1389C128.541 95.3114 128.565 95.5578 128.459 95.7549C128.352 95.952 128.13 96.0669 127.908 96.0341C125.321 95.681 122.996 95.0979 120.836 94.3013C120.59 94.211 120.335 94.1206 120.097 94.0221C118.158 93.2009 121.658 89.7189 123.259 87.247C130.282 76.4479 131.736 64.0802 131.794 51.5647C131.851 39.4681 130.545 27.5357 128.138 15.7593V15.7429C126.569 5.87173 125.239 2.168 124.401 0.796558C124.22 0.435219 124.023 0.205276 123.818 0.0985162C123.588 -0.0575166 123.465 0.0163937 123.465 0.0163937C123.013 0.0328182 122.495 0.435219 121.871 1.08399C119.251 3.83509 119.399 7.11178 120.122 10.5363C123.432 26.0903 125.921 41.7346 124.787 57.7157C124.007 68.7365 121.953 79.3468 114.248 87.9779C113.789 88.4952 113.287 88.9798 112.786 89.4725C112.211 90.0391 111.316 91.1396 110.651 90.6797C109.764 90.0638 110.552 88.7991 110.831 88.1421C115.341 77.5729 116.639 66.5275 115.949 55.1453C115.932 54.8825 115.908 54.6197 115.891 54.3569V54.3405C115.883 54.1269 115.858 53.9298 115.842 53.7245C115.727 52.2217 115.587 50.7189 115.398 49.2242C113.46 31.1655 111.127 29.9911 111.127 29.9911C110.971 29.8515 110.782 29.7448 110.528 29.6955C109.304 29.4409 108.638 30.5167 108.096 31.3297C105.648 34.9924 106.733 38.8932 107.521 42.753C110.289 56.2703 110.33 69.6645 105.583 82.8124C105.147 84.0113 104.63 85.1775 104.08 86.3272C103.496 87.5508 103.119 89.0783 101.131 88.4213C99.2662 87.8054 99.7918 86.3929 100.03 85.1036C100.654 81.8269 101.155 78.542 101.467 75.2489V75.2653C101.509 74.9368 101.525 74.6247 101.55 74.3127C101.599 73.746 101.632 73.1712 101.665 72.6045C101.689 72.1282 101.714 71.6601 101.739 71.2002C101.747 70.9621 101.763 70.7321 101.763 70.494C102.141 60.0562 100.383 55.3095 99.7179 53.9052C99.644 53.7328 99.5619 53.5767 99.4715 53.4371C98.7815 52.4024 97.6398 52.5256 96.6541 53.5028C94.8388 55.2931 93.8367 57.4118 94.2967 60.0808C95.6438 67.8496 94.8552 75.5445 93.4096 83.1983C93.2124 84.2249 92.7524 86.0973 90.5593 85.6127C89.0644 85.2842 88.7194 84.6437 88.6372 83.3461C88.6537 82.3689 88.6372 81.3916 88.6044 80.4144C88.6044 80.3897 88.6044 80.3651 88.6044 80.3405C88.6044 80.2009 88.588 80.0612 88.588 79.9299C88.588 79.8559 88.5797 79.7902 88.5715 79.7245C88.5058 78.3942 88.399 77.0556 88.2347 75.717C88.2183 75.5856 88.1937 75.4624 88.1773 75.331C87.3394 67.7921 86.247 67.0612 86.247 67.0612C85.5488 66.1497 84.4563 66.3057 83.5117 67.2419C81.6964 69.0322 80.7764 71.1427 81.1543 73.8199C81.4336 75.7745 81.3596 75.175 81.5568 76.8831C81.7128 77.7618 81.8771 79.3632 81.8935 79.8724C81.8525 80.324 81.7375 80.7182 81.4582 81.0139C80.53 82.0076 79.0351 80.9892 77.9015 80.5211C55.9209 71.4302 37.1108 58.6683 20.691 42.523C14.2513 35.945 3.25273 22.6329 3.25273 22.6329C2.84203 22.1566 2.33276 21.8856 1.55243 22.2223C0.114982 22.8383 0.156052 24.6778 0.0246278 26.2217C-0.23822 29.3177 1.42101 31.5597 3.21987 33.662C28.0179 62.5856 58.2783 83.3708 94.8059 93.7675L101.377 95.5085C101.451 95.5249 101.533 95.5496 101.607 95.566C101.624 95.566 101.632 95.566 101.64 95.5742L107.299 97.077L107.456 97.1181C107.267 97.1756 107.061 97.2167 106.839 97.2577C100.613 98.4895 88.2923 96.223 78.3944 93.9153C73.4988 92.8888 68.6854 91.6405 63.9788 90.1541C63.7653 90.0884 63.642 90.0556 63.642 90.0556C45.3577 84.2331 28.6093 74.7972 13.9556 60.4093C12.5674 59.0461 11.286 57.5761 10.0211 56.0897C8.86289 54.71 6.47262 51.8275 5.643 50.8338C5.55265 50.7024 5.45408 50.5875 5.35551 50.4807C5.10909 50.2261 4.80517 50.0619 4.36983 50.1604C3.3513 50.3986 3.05559 51.4498 2.86667 52.3367C2.1192 55.9008 3.25273 58.8983 5.65122 61.5755C20.6582 78.3942 39.4929 89.1358 60.6439 96.1819C72.6528 100.181 85.0067 102.612 97.6069 104.164C90.0911 106.595 82.3617 107.334 74.5667 107.137C59.4775 106.759 45.3248 103.138 32.0264 96.6746C27.1226 94.1535 22.5556 91.3449 21.3564 90.5894C20.6664 90.1213 19.9518 89.8338 19.2454 90.3758C17.9229 91.4024 18.8347 93.2009 19.2618 94.6051C20.075 97.307 21.956 99.1712 24.3956 100.46C46.0641 111.917 68.9401 116.499 93.2946 112.434C95.7588 112.023 98.0998 111.572 100.679 110.701C96.6048 114.224 91.89 116.524 86.9369 118.339C71.6835 123.915 56.5287 123.693 41.4314 119.915C36.5851 118.618 30.9668 116.507 30.9668 116.507C30.1536 116.154 29.3486 116.031 28.7243 116.926C27.6237 118.503 28.5847 120.145 29.5375 121.632C31.7882 125.138 36.1416 125.483 39.5832 126.674C40.7578 127.052 37.5544 129.187 36.5276 129.975C31.5335 133.794 26.6462 137.284 21.6767 140.98L18.424 143.378C17.8654 143.764 17.3726 144.199 17.6272 145.004C17.9229 145.915 18.8675 146.08 19.7875 146.268C23.3442 147.008 26.3833 145.825 29.1925 143.723C35.2134 139.214 41.3493 134.837 47.2387 130.156C49.4811 128.374 51.5182 128.522 54.582 129.31C46.9183 135.083 39.7475 140.495 32.5685 145.899C25.2827 151.376 17.9969 156.854 10.711 162.323L5.89764 165.888C5.82371 165.937 5.758 165.986 5.69229 166.044L5.61836 166.093C5.20766 166.421 4.90374 166.791 4.9941 167.267C5.19123 168.351 6.4644 168.622 7.50758 168.803C11.8117 169.542 14.4813 167.924 17.4219 165.715C32.1496 154.661 46.9266 143.682 61.5721 132.521C64.8577 130.016 68.2337 128.604 72.9731 129.138C68.9401 132.152 65.0631 135.051 61.2436 137.908L50.8611 145.587C50.7871 145.636 50.7132 145.694 50.6475 145.751C50.0972 146.186 49.7111 146.695 49.9247 147.451C50.3189 148.822 51.97 148.987 53.3745 149.2C55.9537 149.586 58.1387 148.675 60.1675 147.164C61.3339 146.293 62.5085 145.439 63.6831 144.593L79.5361 132.004C79.5361 132.004 83.2817 129.327 87.6187 126.871C88.0048 126.633 88.3908 126.387 88.7851 126.148C88.9494 126.075 89.3601 125.886 89.9843 125.59C90.4525 125.352 90.9207 125.114 91.3807 124.892C92.0625 124.547 92.851 124.128 93.7381 123.644C96.2927 122.584 103.611 119.168 109.657 112.73C112.532 110.512 116.581 107.613 119.735 106.217H119.752C119.99 106.111 120.228 106.012 120.458 105.93C120.458 105.93 120.475 105.93 120.483 105.922C120.639 105.864 120.787 105.815 120.935 105.766L121.337 105.61C122.479 105.289 124.335 105.166 124.582 107.679C124.623 108.295 124.615 108.927 124.541 109.593C124.491 110.093 124.393 110.627 124.319 111.054C124.245 111.465 124.417 111.876 124.746 112.122C124.795 112.163 124.853 112.196 124.91 112.22C125.346 112.434 125.871 112.335 126.2 111.974C126.323 111.834 126.446 111.703 126.569 111.572C128.122 109.937 129.699 108.804 131.375 108.114C133.822 107.104 136.303 107.096 138.94 108.106C140.197 108.582 141.379 109.239 142.554 110.102C143.055 110.471 143.556 110.882 144.057 111.334C144.353 111.605 144.648 111.9 144.911 112.163L144.952 112.204L145.166 112.418C145.166 112.418 145.248 112.491 145.289 112.524C145.536 112.705 145.856 112.779 146.168 112.713C146.529 112.631 146.825 112.376 146.957 112.032C146.981 111.966 147.006 111.9 147.031 111.834C147.778 109.617 147.934 107.581 147.499 105.593H147.458Z",fill:"url(#paint0_linear_290_1904)"}),e("path",{d:"M120.113 94.0303C120.195 94.0632 120.269 94.096 120.351 94.1207C120.269 94.0878 120.187 94.0632 120.113 94.0303Z",fill:"#FEDBB5"}),e("path",{d:"M111.283 87.1238C111.283 87.1238 111.267 87.1567 111.267 87.1731C111.267 87.1567 111.283 87.1402 111.283 87.1238Z",fill:"#FEDBB5"}),e("path",{d:"M123.383 87.1074C123.383 87.1074 123.358 87.1487 123.341 87.1652C123.358 87.1487 123.366 87.1239 123.383 87.1074Z",fill:"#FEDBB5"}),e("path",{d:"M104.104 86.3354C103.965 86.6229 103.841 86.9267 103.71 87.2142C103.85 86.9267 103.973 86.6229 104.104 86.3354Z",fill:"#FEDBB5"}),e("path",{d:"M89.0233 84.7422C89.0233 84.7422 89.0233 84.7505 89.0316 84.7588C89.0316 84.7588 89.0316 84.7505 89.0233 84.7422Z",fill:"#FEDBB5"}),e("path",{d:"M89.0644 84.7998C89.1876 84.964 89.3437 85.1118 89.5408 85.235C89.3437 85.1118 89.1876 84.9722 89.0644 84.7998ZM89.0644 84.7833C89.0644 84.7833 89.0644 84.7833 89.0644 84.7915C89.0644 84.7915 89.0644 84.7915 89.0644 84.7833ZM89.0562 84.7751C89.0562 84.7751 89.0562 84.7751 89.0562 84.7833C89.0562 84.7833 89.0562 84.7833 89.0562 84.7751ZM88.6947 83.3626C88.6947 83.3626 88.6947 83.3708 88.6947 83.379C88.6947 83.379 88.6947 83.3708 88.6947 83.3626ZM79.1665 81.0878C79.1665 81.0878 79.1829 81.0878 79.1829 81.096C79.6429 81.2931 80.1029 81.4492 80.53 81.4492C80.7107 81.4492 80.8832 81.4245 81.0393 81.3588C80.875 81.4245 80.7025 81.4492 80.53 81.4492C80.0947 81.4492 79.6265 81.2849 79.1665 81.0878ZM88.629 79.6507C88.629 79.6507 88.629 79.6507 88.629 79.6589C88.629 79.6589 88.629 79.6589 88.629 79.6507Z",fill:"#E5B4A6"}),e("path",{d:"M120.36 94.1206C120.36 94.1206 120.434 94.1535 120.475 94.1617C120.475 94.1617 120.401 94.1289 120.36 94.1206ZM110.273 89.8749C110.273 90.187 110.38 90.4662 110.684 90.6797C110.79 90.7536 110.905 90.7865 111.029 90.7865C111.209 90.7865 111.398 90.7126 111.595 90.5894C111.406 90.7126 111.218 90.7865 111.029 90.7865C110.905 90.7865 110.79 90.7536 110.684 90.6797C110.38 90.4744 110.273 90.187 110.273 89.8749ZM110.914 88.0189C110.914 88.0189 110.881 88.1011 110.864 88.1421C110.881 88.1011 110.897 88.06 110.914 88.0189ZM111.226 87.2798C111.127 87.5262 111.02 87.7726 110.914 88.0189C111.02 87.7726 111.119 87.5262 111.226 87.2798ZM111.267 87.1731C111.267 87.1731 111.234 87.2388 111.226 87.2798C111.242 87.247 111.259 87.2141 111.267 87.1731ZM123.341 87.1731C123.341 87.1731 123.341 87.1813 123.333 87.1895C123.333 87.1895 123.333 87.1813 123.341 87.1731ZM123.391 87.0992C123.391 87.0992 123.391 87.1074 123.382 87.1156C123.382 87.1156 123.382 87.1074 123.391 87.0992ZM111.308 87.0992C111.308 87.0992 111.3 87.132 111.291 87.1402C111.291 87.1238 111.3 87.1074 111.308 87.0992ZM99.8001 86.7707C99.8001 87.4769 100.079 88.0928 101.155 88.446C101.484 88.5527 101.771 88.602 102.026 88.602C102.93 88.602 103.365 87.9615 103.71 87.2306C103.357 87.9697 102.921 88.602 102.026 88.602C101.78 88.602 101.492 88.5527 101.155 88.446C100.088 88.0928 99.8001 87.4769 99.8001 86.7707ZM92.7689 84.9886C92.4486 85.4074 91.9722 85.7195 91.2575 85.7195C91.1836 85.7195 91.1097 85.7195 91.0358 85.7113C91.1097 85.7113 91.1836 85.7195 91.2575 85.7195C91.9722 85.7195 92.4486 85.4157 92.7689 84.9886ZM106.651 79.7081C106.651 79.7081 106.651 79.7081 106.642 79.7081C106.322 80.7511 105.985 81.8023 105.616 82.8452C105.993 81.8023 106.338 80.7593 106.659 79.7081M94.1571 79.1251C93.9846 80.2748 93.7875 81.4163 93.5739 82.566C93.7875 81.4245 93.9846 80.2748 94.1571 79.1251ZM122.191 73.6311C120.623 78.7884 118.175 83.65 114.29 88.0025C113.83 88.5199 113.329 89.0044 112.828 89.4972C113.329 89.0126 113.821 88.5199 114.29 88.0025C118.175 83.65 120.623 78.7884 122.2 73.6311",fill:"#E5B4A6"}),e("path",{opacity:"0.4",d:"M2.20136 22.0745C2.00423 22.0745 1.79066 22.1238 1.55246 22.2223C0.53392 22.6658 0.254644 23.7252 0.139648 24.8503C5.61017 32.0196 27.213 58.4548 61.1943 76.5875C61.1943 76.5875 94.4692 94.1453 127.933 96.0423C125.346 95.6892 123.021 95.1061 120.861 94.3095C120.729 94.2602 120.606 94.2192 120.475 94.1699C108.318 91.542 97.9519 88.2571 90.6168 85.6292C90.7565 85.662 90.8961 85.6784 91.0193 85.6949C90.8879 85.6867 90.7401 85.662 90.5922 85.6292C90.1486 85.5306 89.8037 85.4074 89.5408 85.2432C83.7417 83.1244 80.0454 81.4984 79.1583 81.096C78.7312 80.9153 78.3123 80.6936 77.9344 80.5376C55.9538 71.4466 37.1437 58.6848 20.7239 42.5395C14.2513 35.945 3.25275 22.633 3.25275 22.633C2.97348 22.3045 2.6367 22.0745 2.20136 22.0745Z",fill:"url(#paint1_linear_290_1904)"}),e("path",{opacity:"0.4",d:"M4.62448 50.1358C4.55056 50.1358 4.46842 50.144 4.37806 50.1687C3.35953 50.4068 3.06382 51.458 2.8749 52.3449C2.84204 52.5009 2.80919 52.6652 2.78455 52.8212C19.7711 75.832 42.5732 85.235 42.5732 85.235C65.3341 95.952 84.0128 98.12 95.3892 98.12C100.096 98.12 103.554 97.7505 105.533 97.463C104.63 97.5616 103.636 97.6109 102.568 97.6109C95.8984 97.6109 86.362 95.7795 78.4026 93.9235C73.5071 92.897 68.6937 91.6488 63.987 90.1623C63.7735 90.0966 63.6503 90.0638 63.6503 90.0638C45.3659 84.2413 28.6176 74.8054 13.9638 60.4175C12.5756 59.0543 11.2942 57.5843 10.0293 56.0979C8.87112 54.7182 6.48084 51.8357 5.65123 50.8421C5.56088 50.7107 5.46231 50.5957 5.36374 50.4889C5.16661 50.2836 4.9284 50.1358 4.62448 50.1358Z",fill:"url(#paint2_linear_290_1904)"}),e("path",{opacity:"0.4",d:"M20.0669 90.1049C19.7958 90.1049 19.5247 90.187 19.2537 90.4005C18.1037 91.2874 18.6458 92.7738 19.0812 94.0632C27.5991 99.2287 47.132 109.289 70.2626 109.289C79.0023 109.289 88.243 107.86 97.607 104.189C90.8469 106.382 83.9061 107.195 76.9077 107.195C76.1274 107.195 75.3471 107.186 74.5667 107.162C59.4776 106.784 45.3249 103.162 32.0264 96.6993C27.1227 94.1781 22.5557 91.3695 21.3565 90.614C20.9293 90.3266 20.5022 90.1049 20.0669 90.1049Z",fill:"url(#paint3_linear_290_1904)"}),e("path",{opacity:"0.4",d:"M99.1759 111.949C95.4632 114.791 91.2987 116.762 86.937 118.355C78.7559 121.344 70.5994 122.666 62.4675 122.666C55.4363 122.666 48.4298 121.681 41.4315 119.932C36.5852 118.634 30.9668 116.524 30.9668 116.524C30.6136 116.368 30.2604 116.261 29.9237 116.261C29.4883 116.261 29.0776 116.442 28.7326 116.951C28.2234 117.682 28.1577 118.429 28.3219 119.168C33.6939 121.665 45.2181 126.099 59.2723 126.099C71.4536 126.099 85.5406 122.765 99.1759 111.949Z",fill:"url(#paint4_linear_290_1904)"}),e("path",{opacity:"0.4",d:"M62.9356 129.368C49.7358 129.368 39.7557 126.699 38.4908 126.346C38.8604 126.452 39.2218 126.567 39.5833 126.69C40.7579 127.068 37.5544 129.203 36.5276 129.992C32.8396 132.817 29.2008 135.461 25.5537 138.138H36.7576C40.2897 135.527 43.8052 132.907 47.2387 130.172C48.5119 129.154 49.7275 128.768 51.0993 128.768C52.1342 128.768 53.2678 128.99 54.582 129.335C46.9184 135.108 39.7475 140.52 32.5685 145.924C28.3711 149.077 24.1738 152.231 19.9764 155.384H31.246C41.3821 147.804 51.51 140.216 61.5721 132.546C63.8967 130.78 66.2623 129.557 69.1208 129.179C67.0016 129.318 64.9316 129.376 62.9439 129.376L62.9356 129.368Z",fill:"url(#paint5_linear_290_1904)"}),e("path",{opacity:"0.4",d:"M60.5782 138.409H71.47L79.5115 132.02C79.5115 132.02 83.2571 129.343 87.5941 126.888C87.9801 126.649 88.3662 126.403 88.7605 126.165C88.9248 126.091 89.3354 125.902 89.9597 125.606C90.4279 125.368 90.8961 125.13 91.3561 124.908C92.0625 124.547 92.8921 124.112 93.8121 123.603C86.0499 126.855 78.0987 128.44 70.739 129.056C70.8375 129.056 70.9443 129.056 71.0429 129.056C71.6589 129.056 72.2996 129.088 72.965 129.162C68.9319 132.176 65.0549 135.075 61.2354 137.933L60.5782 138.418V138.409Z",fill:"url(#paint6_linear_290_1904)"}),e("path",{opacity:"0.4",d:"M88.6701 83.3544C88.6865 82.3771 88.6701 81.3999 88.6373 80.4226V80.3487C88.6373 80.2091 88.6208 80.0695 88.6208 79.9381L88.6044 79.7328C88.5633 78.9115 88.4976 78.0903 88.4237 77.2609C85.8281 76.1687 83.3803 74.7726 81.1215 73.1301C81.1379 73.3601 81.1461 73.59 81.179 73.8364C81.4582 75.7909 81.3843 75.1914 81.5814 76.8995C81.7375 77.7783 81.9018 79.3797 81.9182 79.8888C81.8771 80.3405 81.7621 80.7347 81.4829 81.0303C81.1954 81.3342 80.8586 81.4491 80.4972 81.4491C80.0619 81.4491 79.5937 81.2849 79.1337 81.0878C79.9961 81.4738 83.7007 83.108 89.5408 85.2432C88.9165 84.8572 88.7194 84.2742 88.6619 83.3626L88.6701 83.3544Z",fill:"url(#paint7_linear_290_1904)"}),e("path",{opacity:"0.4",d:"M131.022 64.885C128.59 68.2685 125.6 71.2331 122.175 73.6146C120.606 78.7719 118.158 83.6336 114.273 87.9861C113.813 88.5035 113.312 88.988 112.811 89.4807C112.326 89.9488 111.628 90.8029 111.02 90.8029C110.897 90.8029 110.782 90.77 110.675 90.6961C109.788 90.0802 110.577 88.8155 110.856 88.1585C112.31 84.7505 113.427 81.2931 114.257 77.7865C111.825 78.698 109.271 79.3386 106.634 79.6999C106.314 80.7429 105.977 81.794 105.607 82.837C105.172 84.036 104.655 85.2021 104.104 86.3518C103.62 87.3702 103.275 88.602 102.018 88.602C101.771 88.602 101.484 88.5527 101.147 88.446C99.2827 87.83 99.8084 86.4175 100.047 85.1282C100.367 83.4201 100.663 81.7119 100.909 79.9956C98.5927 79.9217 96.3256 79.626 94.1325 79.1168C93.9271 80.4883 93.6889 81.8515 93.4261 83.2148C93.2536 84.1263 92.8675 85.7113 91.2412 85.7113C91.044 85.7113 90.8305 85.6867 90.6005 85.6374C97.9356 88.2735 108.293 91.5584 120.458 94.1863C120.335 94.1371 120.22 94.096 120.105 94.0467C118.167 93.2255 121.666 89.7435 123.268 87.2716C127.777 80.3323 129.987 72.7523 131.005 64.8932L131.022 64.885Z",fill:"url(#paint8_linear_290_1904)"}),e("path",{opacity:"0.5",d:"M129.206 102.497C127.687 102.497 126.151 102.645 124.647 102.916C124.36 102.965 124.081 102.99 123.818 102.99C123.391 102.99 122.988 102.924 122.61 102.809C122.668 102.883 122.734 102.957 122.791 103.039C123.448 103.959 123.793 104.961 123.925 106.004C124.089 106.184 124.229 106.406 124.344 106.694C124.344 106.694 124.344 106.694 124.344 106.71C124.344 106.71 124.344 106.71 124.344 106.718C124.344 106.718 124.344 106.718 124.344 106.726C124.344 106.726 124.344 106.726 124.344 106.735C124.344 106.735 124.344 106.735 124.344 106.743C124.344 106.743 124.344 106.743 124.344 106.751C124.344 106.751 124.344 106.751 124.344 106.759C124.344 106.759 124.344 106.759 124.344 106.768V106.784C124.344 106.784 124.344 106.784 124.344 106.792C124.344 106.792 124.344 106.792 124.344 106.8C124.344 106.8 124.344 106.8 124.344 106.809C124.344 106.809 124.344 106.809 124.344 106.817C124.344 106.817 124.344 106.817 124.344 106.825C124.344 106.825 124.344 106.833 124.344 106.841C124.344 106.841 124.344 106.841 124.344 106.858C124.344 106.858 124.344 106.858 124.344 106.866C124.344 106.866 124.344 106.866 124.344 106.874C124.344 106.874 124.344 106.874 124.344 106.882C124.344 106.882 124.344 106.883 124.344 106.891C124.344 106.891 124.344 106.891 124.344 106.899C124.344 106.899 124.344 106.899 124.344 106.907C124.344 106.907 124.344 106.907 124.344 106.915C124.344 106.915 124.344 106.915 124.344 106.924C124.344 106.924 124.344 106.924 124.344 106.932C124.344 106.932 124.344 106.932 124.344 106.94C124.344 106.94 124.344 106.94 124.344 106.948C124.344 106.948 124.344 106.948 124.344 106.965C124.344 106.965 124.344 106.973 124.344 106.981C124.344 106.981 124.344 106.989 124.344 106.997V107.014C124.344 107.014 124.344 107.022 124.344 107.03C124.344 107.03 124.344 107.039 124.344 107.047C124.344 107.047 124.344 107.055 124.344 107.063C124.344 107.063 124.344 107.071 124.344 107.08C124.344 107.08 124.344 107.088 124.344 107.096C124.344 107.096 124.344 107.104 124.344 107.112C124.344 107.112 124.344 107.121 124.344 107.129C124.344 107.145 124.344 107.162 124.344 107.178C124.344 107.178 124.344 107.186 124.344 107.195C124.344 107.195 124.344 107.227 124.344 107.244C124.344 107.244 124.344 107.252 124.344 107.26V107.277C124.344 107.277 124.344 107.301 124.344 107.31C124.344 107.31 124.344 107.318 124.344 107.326V107.342V107.359C124.36 107.597 124.368 107.843 124.368 108.09C124.368 108.476 124.344 108.87 124.302 109.272C124.253 109.773 124.155 110.307 124.081 110.734C124.072 110.8 124.064 110.865 124.064 110.923C124.064 111.268 124.229 111.588 124.508 111.793L124.672 111.892C124.828 111.966 124.992 112.007 125.157 112.007C125.461 112.007 125.748 111.884 125.962 111.654C126.085 111.514 126.208 111.383 126.331 111.251C127.884 109.617 129.461 108.484 131.136 107.794C132.369 107.285 133.601 107.03 134.857 107.03C136.114 107.03 137.387 107.285 138.702 107.786C139.958 108.262 141.141 108.919 142.316 109.781C142.817 110.151 143.318 110.562 143.819 111.013C144.115 111.284 144.41 111.58 144.673 111.843L144.714 111.884L144.928 112.097L145.051 112.204C145.232 112.335 145.453 112.409 145.675 112.418C144.632 110.192 143.318 108.123 141.461 106.513C137.946 103.466 133.51 102.177 129.001 102.177",fill:"url(#paint9_linear_290_1904)"}),e("path",{opacity:"0.4",d:"M128.779 87.6905L128.582 87.7069C128.114 87.7972 127.752 88.175 127.695 88.6513C127.654 89.0208 127.654 89.415 127.703 89.8174C127.72 89.9488 127.687 90.072 127.629 90.1706C129.51 92.9627 133.584 97.9065 139.769 99.7789C139.769 99.7789 149.331 104.78 146.916 112.032L146.99 111.834C147.737 109.617 147.893 107.581 147.458 105.593C147.022 103.63 146.029 101.824 144.492 100.222C143.901 99.6064 143.244 99.0234 142.529 98.4978C142.184 98.2432 141.815 98.0051 141.437 97.7669C140.969 97.4713 140.484 97.192 139.95 96.921C137.995 95.9191 136.328 94.909 134.866 93.825C134.274 93.3898 133.699 92.9299 133.157 92.4536C131.851 91.3121 130.972 90.3348 130.315 89.3001C130.102 88.9716 129.913 88.6102 129.732 88.2653C129.658 88.1175 129.543 87.9943 129.412 87.8958C129.231 87.7562 129.001 87.6823 128.763 87.6823",fill:"url(#paint10_linear_290_1904)"}),e("path",{opacity:"0.5",d:"M116.647 107.893L118.586 106.768L126.734 95.8535C126.734 95.8535 122.274 95.0076 120.122 94.0303C120.122 94.0303 117.887 104.222 109.632 112.738L112.672 110.488C113.887 109.634 114.988 108.903 116.647 107.893Z",fill:"url(#paint11_linear_290_1904)"}),e("path",{d:"M209.416 49.9962H230.197C245.221 49.9962 252.104 57.7157 252.104 73.5818V81.4409C252.104 97.307 245.221 105.027 230.197 105.027H218.123V148.264H209.416V49.9962ZM230.197 97.0196C239.323 97.0196 243.397 92.9463 243.397 81.8598V73.0152C243.397 62.0682 239.323 57.8553 230.197 57.8553H218.123V97.0196H230.197Z",fill:"var(--ac-global-text-color-900)"}),e("path",{d:"M284.114 49.9962H292.821V93.0941H319.64V49.9962H328.346V148.256H319.64V100.953H292.821V148.256H284.114V49.9962Z",fill:"var(--ac-global-text-color-900)"}),e("path",{d:"M362.451 125.656V72.5963C362.451 57.0177 370.312 48.5919 384.497 48.5919C398.683 48.5919 406.544 57.0177 406.544 72.5963V125.656C406.544 141.234 398.683 149.66 384.497 149.66C370.312 149.66 362.451 141.234 362.451 125.656ZM397.829 126.214V72.0297C397.829 61.5016 393.056 56.451 384.489 56.451C375.922 56.451 371.15 61.5016 371.15 72.0297V126.214C371.15 136.742 375.922 141.653 384.489 141.653C393.056 141.653 397.829 136.742 397.829 126.214Z",fill:"var(--ac-global-text-color-900)"}),e("path",{d:"M440.796 49.9962H480.108V57.8553H449.503V93.0859H474.638V100.945H449.503V140.249H480.108V148.248H440.796V49.9962Z",fill:"var(--ac-global-text-color-900)"}),e("path",{d:"M511.56 49.9962H523.076L548.629 125.935V49.9962H556.769V148.256H547.504L519.56 64.458V148.256H511.56V49.9962Z",fill:"var(--ac-global-text-color-900)"}),e("path",{d:"M592.007 49.9962H600.714V148.256H592.007V49.9962Z",fill:"var(--ac-global-text-color-900)"}),e("path",{d:"M651.674 98.1447L632.437 49.9962H641.702L657.144 89.0209L672.726 49.9962H681.154L661.917 98.1447L681.992 148.256H672.726L656.438 106.989L640.01 148.256H631.591L651.666 98.1447H651.674Z",fill:"var(--ac-global-text-color-900)"})]}),o("defs",{children:[o("linearGradient",{id:"paint0_linear_290_1904",x1:"22.0956",y1:"10.3474",x2:"97.4433",y2:"140.879",gradientUnits:"userSpaceOnUse",children:[e("stop",{stopColor:"#14BAB6"}),e("stop",{offset:"0.5",stopColor:"#00ADEE"}),e("stop",{offset:"1",stopColor:"#0095C4"})]}),o("linearGradient",{id:"paint1_linear_290_1904",x1:"95.422",y1:"114.807",x2:"31.8741",y2:"4.70214",gradientUnits:"userSpaceOnUse",children:[e("stop",{stopColor:"#FDFDFE",stopOpacity:"0"}),e("stop",{offset:"0.11",stopColor:"#FDFDFE",stopOpacity:"0.17"}),e("stop",{offset:"0.3",stopColor:"#FDFDFE",stopOpacity:"0.42"}),e("stop",{offset:"0.47",stopColor:"#FDFDFE",stopOpacity:"0.63"}),e("stop",{offset:"0.64",stopColor:"#FDFDFE",stopOpacity:"0.79"}),e("stop",{offset:"0.78",stopColor:"#FDFDFE",stopOpacity:"0.9"}),e("stop",{offset:"0.91",stopColor:"#FDFDFE",stopOpacity:"0.97"}),e("stop",{offset:"1",stopColor:"#FDFDFE"})]}),o("linearGradient",{id:"paint2_linear_290_1904",x1:"76.6695",y1:"114.126",x2:"30.8746",y2:"34.7951",gradientUnits:"userSpaceOnUse",children:[e("stop",{stopColor:"#FDFDFE",stopOpacity:"0"}),e("stop",{offset:"0.11",stopColor:"#FDFDFE",stopOpacity:"0.17"}),e("stop",{offset:"0.3",stopColor:"#FDFDFE",stopOpacity:"0.42"}),e("stop",{offset:"0.47",stopColor:"#FDFDFE",stopOpacity:"0.63"}),e("stop",{offset:"0.64",stopColor:"#FDFDFE",stopOpacity:"0.79"}),e("stop",{offset:"0.78",stopColor:"#FDFDFE",stopOpacity:"0.9"}),e("stop",{offset:"0.91",stopColor:"#FDFDFE",stopOpacity:"0.97"}),e("stop",{offset:"1",stopColor:"#FDFDFE"})]}),o("linearGradient",{id:"paint3_linear_290_1904",x1:"70.3612",y1:"119.915",x2:"44.7991",y2:"75.6384",gradientUnits:"userSpaceOnUse",children:[e("stop",{stopColor:"#FDFDFE",stopOpacity:"0"}),e("stop",{offset:"0.11",stopColor:"#FDFDFE",stopOpacity:"0.17"}),e("stop",{offset:"0.3",stopColor:"#FDFDFE",stopOpacity:"0.42"}),e("stop",{offset:"0.47",stopColor:"#FDFDFE",stopOpacity:"0.63"}),e("stop",{offset:"0.64",stopColor:"#FDFDFE",stopOpacity:"0.79"}),e("stop",{offset:"0.78",stopColor:"#FDFDFE",stopOpacity:"0.9"}),e("stop",{offset:"0.91",stopColor:"#FDFDFE",stopOpacity:"0.97"}),e("stop",{offset:"1",stopColor:"#FDFDFE"})]}),o("linearGradient",{id:"paint4_linear_290_1904",x1:"71.4208",y1:"128.85",x2:"55.5071",y2:"101.279",gradientUnits:"userSpaceOnUse",children:[e("stop",{stopColor:"#FDFDFE",stopOpacity:"0"}),e("stop",{offset:"0.11",stopColor:"#FDFDFE",stopOpacity:"0.17"}),e("stop",{offset:"0.3",stopColor:"#FDFDFE",stopOpacity:"0.42"}),e("stop",{offset:"0.47",stopColor:"#FDFDFE",stopOpacity:"0.63"}),e("stop",{offset:"0.64",stopColor:"#FDFDFE",stopOpacity:"0.79"}),e("stop",{offset:"0.78",stopColor:"#FDFDFE",stopOpacity:"0.9"}),e("stop",{offset:"0.91",stopColor:"#FDFDFE",stopOpacity:"0.97"}),e("stop",{offset:"1",stopColor:"#FDFDFE"})]}),o("linearGradient",{id:"paint5_linear_290_1904",x1:"44.5363",y1:"126.346",x2:"44.5363",y2:"155.384",gradientUnits:"userSpaceOnUse",children:[e("stop",{stopColor:"#231F20"}),e("stop",{offset:"0.03",stopColor:"#231F20",stopOpacity:"0.9"}),e("stop",{offset:"0.22",stopColor:"#231F20",stopOpacity:"0.4"}),e("stop",{offset:"0.42",stopColor:"#231F20",stopOpacity:"0.1"}),e("stop",{offset:"0.65",stopColor:"#231F20",stopOpacity:"0"})]}),o("linearGradient",{id:"paint6_linear_290_1904",x1:"77.1952",y1:"123.603",x2:"77.1952",y2:"138.409",gradientUnits:"userSpaceOnUse",children:[e("stop",{stopColor:"#231F20"}),e("stop",{offset:"1",stopColor:"#231F20",stopOpacity:"0"})]}),o("linearGradient",{id:"paint7_linear_290_1904",x1:"84.3413",y1:"85.235",x2:"84.3413",y2:"73.1301",gradientUnits:"userSpaceOnUse",children:[e("stop",{stopColor:"#231F20"}),e("stop",{offset:"0.03",stopColor:"#231F20",stopOpacity:"0.95"}),e("stop",{offset:"0.51",stopColor:"#231F20",stopOpacity:"0.26"}),e("stop",{offset:"0.81",stopColor:"#231F20",stopOpacity:"0"})]}),o("linearGradient",{id:"paint8_linear_290_1904",x1:"110.815",y1:"94.1699",x2:"110.815",y2:"64.885",gradientUnits:"userSpaceOnUse",children:[e("stop",{stopColor:"#231F20"}),e("stop",{offset:"0.18",stopColor:"#231F20",stopOpacity:"0.48"}),e("stop",{offset:"0.38",stopColor:"#231F20",stopOpacity:"0.12"}),e("stop",{offset:"0.58",stopColor:"#231F20",stopOpacity:"0"})]}),o("linearGradient",{id:"paint9_linear_290_1904",x1:"138.077",y1:"117.246",x2:"127.969",y2:"99.7278",gradientUnits:"userSpaceOnUse",children:[e("stop",{stopColor:"#231F20"}),e("stop",{offset:"1",stopColor:"#231F20",stopOpacity:"0"})]}),o("linearGradient",{id:"paint10_linear_290_1904",x1:"146.226",y1:"112.434",x2:"131.084",y2:"86.1931",gradientUnits:"userSpaceOnUse",children:[e("stop",{stopColor:"#FDFDFE",stopOpacity:"0"}),e("stop",{offset:"0.11",stopColor:"#FDFDFE",stopOpacity:"0.17"}),e("stop",{offset:"0.3",stopColor:"#FDFDFE",stopOpacity:"0.42"}),e("stop",{offset:"0.47",stopColor:"#FDFDFE",stopOpacity:"0.63"}),e("stop",{offset:"0.64",stopColor:"#FDFDFE",stopOpacity:"0.79"}),e("stop",{offset:"0.78",stopColor:"#FDFDFE",stopOpacity:"0.9"}),e("stop",{offset:"0.91",stopColor:"#FDFDFE",stopOpacity:"0.97"}),e("stop",{offset:"1",stopColor:"#FDFDFE"})]}),o("linearGradient",{id:"paint11_linear_290_1904",x1:"106.889",y1:"107.999",x2:"128.941",y2:"95.2581",gradientUnits:"userSpaceOnUse",children:[e("stop",{stopColor:"#231F20"}),e("stop",{offset:"0.31",stopColor:"#231F20",stopOpacity:"0.5"}),e("stop",{offset:"0.67",stopColor:"#231F20",stopOpacity:"0.13"}),e("stop",{offset:"1",stopColor:"#231F20",stopOpacity:"0"})]}),e("clipPath",{id:"clip0_290_1904",children:e("rect",{width:"682",height:"169",fill:"white"})})]})]})}const NK=K`
  text-align: center;
  margin-top: var(--ac-global-dimension-size-200);
  margin-bottom: var(--ac-global-dimension-size-200);
  color: var(--ac-global-text-color-700);
`,$K=K`
  display: flex;
  flex-direction: column;
  gap: var(--ac-global-dimension-size-100);
  flex-wrap: wrap;
  justify-content: center;
`;function vP(){const n=!window.Config.basicAuthDisabled,a=window.Config.oAuth2Idps,l=a.length>0,[t,i]=pn(),r=t.get("returnUrl"),s=t.get("message"),d=t.get("trigger"),c=m.useRef({});return m.useEffect(()=>{var g;if(d&&l){const f=a.find(u=>u.name.toLowerCase()===d.toLowerCase());f&&c.current[f.name]&&((g=c.current[f.name])==null||g.submit())}},[d,l,a]),o(jl,{children:[e(b,{direction:"column",gap:"size-200",alignItems:"center",children:e(v,{paddingBottom:"size-200",children:e(Nt,{})})}),s&&e(v,{paddingBottom:"size-100",children:e(Fe,{variant:"success",children:s})}),n&&e(MK,{initialError:t.get("error"),onSubmit:()=>{i(g=>{const f=new URLSearchParams(g);return f.delete("message"),f.delete("error"),f})}}),n&&l?e("div",{css:NK,children:"or"}):null,l&&e(J,{children:e("ul",{css:$K,children:a.map(g=>e("li",{children:e(np,{idpName:g.name,idpDisplayName:g.displayName,returnUrl:r,ref:f=>{c.current[g.name]=f}},g.name)},g.name))})})]})}const ap=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"UserMutationPayload",kind:"LinkedField",name:"patchViewer",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ResetPasswordFormMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ResetPasswordFormMutation",selections:a},params:{cacheID:"d09af5e3a2a3d10f117373e25bef11e6",id:null,metadata:{},name:"ResetPasswordFormMutation",operationKind:"mutation",text:`mutation ResetPasswordFormMutation(
  $input: PatchViewerInput!
) {
  patchViewer(input: $input) {
    __typename
  }
}
`}}}();ap.hash="f8f5c30b0e00c17cdda7557c73c3c2d3";const lp={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"ResetPasswordFormQuery",selections:[{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"viewer",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"email",storageKey:null}],storageKey:null}],type:"Query",abstractKey:null};lp.hash="1161643b76edb6ef437d8f136038cf21";const hl=4;function jK(n){var g;const a=ce(),l=be(),t=T.useFragment(lp,n.query),[i,r]=T.useMutation(ap),{control:s,handleSubmit:d}=Ve({defaultValues:{currentPassword:"",newPassword:"",confirmPassword:""}}),c=m.useCallback(f=>{i({variables:{input:{currentPassword:f.currentPassword,newPassword:f.newPassword}},onCompleted:()=>{const u=ys({path:"/login",searchParams:{message:"Password has been reset."}});a(u)},onError:u=>{l({title:"Failed to reset password",message:u.message})}})},[i,a,l]);return o(dt,{onSubmit:d(c),children:[e(si,{children:o(ee,{name:"email",type:"email",autoComplete:"email",isRequired:!0,isReadOnly:!0,value:(g=t.viewer)==null?void 0:g.email,children:[e(H,{children:"Email"}),e(X,{})]})}),e(G,{name:"currentPassword",control:s,rules:{required:"the current is required"},render:({field:{name:f,onChange:u,onBlur:p,value:y},fieldState:{invalid:h,error:k}})=>o(ee,{type:"password",name:f,isRequired:!0,isInvalid:h,onChange:u,onBlur:p,value:y,id:"current-password",autoComplete:"current-password",children:[e(H,{children:"Old Password"}),e(X,{}),k?e(ke,{children:k==null?void 0:k.message}):e(F,{slot:"description",children:"The current password"})]})}),e(G,{name:"newPassword",control:s,rules:{required:"Password is required",minLength:{value:hl,message:`Password must be at least ${hl} characters`},validate:(f,u)=>f!==u.currentPassword||"New password must be different"},render:({field:{name:f,onChange:u,onBlur:p,value:y},fieldState:{invalid:h,error:k}})=>o(ee,{type:"password",isRequired:!0,name:f,isInvalid:h,onChange:u,onBlur:p,defaultValue:y,id:"new-password",autoComplete:"new-password",children:[e(H,{children:"New Password"}),e(X,{}),k?e(ke,{children:k==null?void 0:k.message}):o(F,{slot:"description",children:["Password must be at least ",hl," characters"]})]})}),e(G,{name:"confirmPassword",control:s,rules:{required:"Password is required",minLength:{value:hl,message:`Password must be at least ${hl} characters`},validate:(f,u)=>f===u.newPassword||"Passwords do not match"},render:({field:{name:f,onChange:u,onBlur:p,value:y},fieldState:{invalid:h,error:k}})=>o(ee,{isRequired:!0,type:"password",name:f,isInvalid:h,onChange:u,onBlur:p,defaultValue:y,autoComplete:"new-password",children:[e(H,{children:"Confirm Password"}),e(X,{}),k?e(ke,{children:k==null?void 0:k.message}):e(F,{slot:"description",children:"Confirm the new password"})]})}),o("div",{css:K`
          display: flex;
          flex-direction: row;
          gap: var(--ac-global-dimension-size-200);
          padding-top: var(--ac-global-dimension-size-100);
          & > * {
            width: 50%;
          }
        `,children:[e(M,{onPress:()=>{a(-1)},children:"Cancel"}),e(M,{variant:"primary",type:"submit",isDisabled:r,children:r?"Resetting...":"Reset Password"})]})]})}function FP(){const n=Me();return o(jl,{children:[e(b,{direction:"column",gap:"size-200",alignItems:"center",children:e(v,{paddingBottom:"size-200",children:e(Nt,{})})}),e(jK,{query:n})]})}const kl=4,OK="An error occurred. Please try resetting again.";function QK({resetToken:n}){const a=ce(),[l,t]=m.useState(null),[i,r]=m.useState(!1),s=m.useCallback(async({resetToken:f,newPassword:u})=>{t(null),r(!0);try{const p=await fetch(xn("/auth/password-reset"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:f,password:u})});if(!p.ok){const y=await p.text();t(y);return}}catch{t(OK);return}finally{r(()=>!1)}a(`/login?message=${encodeURIComponent("Password has been reset.")}`)},[t,a]),{control:d,handleSubmit:c,formState:{isDirty:g}}=Ve({defaultValues:{resetToken:n,newPassword:"",confirmPassword:""}});return o(J,{children:[l?e(v,{paddingBottom:"size-100",children:e(Fe,{variant:"danger",children:l})}):null,o(dt,{onSubmit:c(s),children:[e(G,{name:"newPassword",control:d,rules:{required:"Password is required",minLength:{value:kl,message:`Password must be at least ${kl} characters`}},render:({field:{name:f,onChange:u,onBlur:p,value:y},fieldState:{invalid:h,error:k}})=>o(ee,{type:"password",isRequired:!0,name:f,isInvalid:h,id:"new-password",autoComplete:"new-password",onChange:u,onBlur:p,defaultValue:y,children:[e(H,{children:"New Password"}),e(X,{}),k?e(ke,{children:k==null?void 0:k.message}):o(F,{slot:"description",children:["Password must be at least ",kl," characters"]})]})}),e(G,{name:"confirmPassword",control:d,rules:{required:"Password is required",minLength:{value:kl,message:`Password must be at least ${kl} characters`},validate:(f,u)=>f===u.newPassword||"Passwords do not match"},render:({field:{name:f,onChange:u,onBlur:p,value:y},fieldState:{invalid:h,error:k}})=>o(ee,{type:"password",isRequired:!0,name:f,isInvalid:h,onChange:u,onBlur:p,defaultValue:y,children:[e(H,{children:"Confirm Password"}),e(X,{}),k?e(ke,{children:k==null?void 0:k.message}):e(F,{slot:"description",children:"Confirm the new password"})]})}),e("div",{css:K`
            margin-top: var(--ac-global-dimension-size-200);
            margin-bottom: var(--ac-global-dimension-size-50);
            button {
              width: 100%;
            }
          `,children:e(M,{variant:g?"primary":"default",type:"submit",isDisabled:i,children:i?"Resetting...":"Reset Password"})})]})]})}function CP(){const n=ce(),[a]=pn(),l=a.get("token");return l?o(jl,{children:[e(b,{direction:"column",gap:"size-200",alignItems:"center",children:e(v,{paddingBottom:"size-200",children:e(Nt,{})})}),e(QK,{resetToken:l}),e(v,{paddingTop:"size-200",children:e(b,{direction:"column",alignItems:"center",justifyContent:"center",children:e(we,{to:"/login",children:"Back to Login"})})})]}):(n("/login"),null)}const tp=function(){var n={alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"viewer",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"email",storageKey:null}],storageKey:null};return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"resetPasswordLoaderQuery",selections:[n,{args:null,kind:"FragmentSpread",name:"ResetPasswordFormQuery"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"resetPasswordLoaderQuery",selections:[n]},params:{cacheID:"3f2aa2ea2629970ac6ca3c4fa86f1f7b",id:null,metadata:{},name:"resetPasswordLoaderQuery",operationKind:"query",text:`query resetPasswordLoaderQuery {
  viewer {
    id
    email
  }
  ...ResetPasswordFormQuery
}

fragment ResetPasswordFormQuery on Query {
  viewer {
    email
    id
  }
}
`}}}();tp.hash="17bb397eaa3a44dd33996854e538f2ef";async function KP(){const n=await T.fetchQuery(he,tp,{}).toPromise();return n!=null&&n.viewer?n:Kl("/login")}function BK({onResetSent:n}){const[a,l]=m.useState(null),[t,i]=m.useState(!1),r=m.useCallback(async c=>{l(null),i(!0);try{const g=await fetch(xn("/auth/password-reset-email"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(c)});if(!g.ok){const f=await g.text();l(f);return}n()}finally{i(()=>!1)}},[n,l]),{control:s,handleSubmit:d}=Ve({defaultValues:{email:""}});return o(J,{children:[a?e(v,{paddingBottom:"size-100",children:e(Fe,{variant:"danger",children:a})}):null,o(gn,{onSubmit:d(r),children:[e(G,{name:"email",control:s,render:({field:{onChange:c,value:g}})=>o(ee,{name:"email",isRequired:!0,type:"email",onChange:c,value:g,children:[e(H,{children:"Email"}),e(X,{placeholder:"your email address"}),e(F,{slot:"description",children:"Enter the email address associated with your account."})]})}),e("div",{css:K`
            margin-top: var(--ac-global-dimension-size-200);
            margin-bottom: var(--ac-global-dimension-size-50);
            button {
              width: 100%;
            }
          `,children:e(M,{variant:"primary",type:"submit",isDisabled:t,children:t?"Sending...":"Send"})})]})]})}function TP(){const[n,a]=m.useState(!1),l=n?o(b,{direction:"column",alignItems:"center",justifyContent:"center",gap:"size-100",children:[e(ae,{level:1,children:"Check your email"}),e("p",{children:"Thanks! If an account with that email address exists, we sent you a link to reset your password."})]}):o(J,{children:[o(b,{direction:"column",alignItems:"center",justifyContent:"center",gap:"size-100",children:[e(ae,{level:1,children:"Forgot Password"}),e("p",{children:`Enter the email address associated with your account and we'll send you
        a link to reset your password.`})]}),e(BK,{onResetSent:()=>a(!0)})]});return e(jl,{children:o("div",{css:K`
          & a {
            text-align: center;
            width: 100%;
            display: block;
            text-align: center;
            padding-top: var(--ac-global-dimension-size-200);
          }
        `,children:[l,e(b,{direction:"column",alignItems:"center",justifyContent:"center",gap:"size-200",children:e(we,{to:"/login",children:"Back to Login"})})]})})}const qK=K`
  display: flex;
  flex-direction: column;
  gap: var(--ac-global-dimension-size-100);
  flex-wrap: wrap;
  justify-content: center;
`;function PP(){const n=window.Config.oAuth2Idps,a=n.length>0,[l]=pn(),t=l.get("returnUrl"),i=!window.Config.basicAuthDisabled,r=l.get("error");return o(jl,{children:[e(b,{direction:"column",gap:"size-200",alignItems:"center",children:e(v,{paddingBottom:"size-200",children:e(Nt,{})})}),e(v,{paddingBottom:"size-100",children:e(Fe,{variant:r?"danger":"success",children:r||"You have been logged out"})}),i&&e(v,{paddingY:"size-100",children:e(sa,{to:"/login",children:"Back to login"})}),a&&e("ul",{css:qK,children:n.slice(0,1).map(s=>e("li",{children:e(np,{idpName:s.name,idpDisplayName:s.displayName,returnUrl:t},s.name)},s.name))})]})}const ip=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{kind:"Variable",name:"input",variableName:"input"}],l={alias:null,args:null,kind:"ScalarField",name:"jwt",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ViewerAPIKeysCreateUserAPIKeyMutation",selections:[{alias:null,args:a,concreteType:"CreateUserApiKeyMutationPayload",kind:"LinkedField",name:"createUserApiKey",plural:!1,selections:[l,{alias:null,args:null,concreteType:"UserApiKey",kind:"LinkedField",name:"apiKey",plural:!1,selections:[t,{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"user",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"APIKeysTableFragment"}],storageKey:null}],storageKey:null}],storageKey:null}],type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ViewerAPIKeysCreateUserAPIKeyMutation",selections:[{alias:null,args:a,concreteType:"CreateUserApiKeyMutationPayload",kind:"LinkedField",name:"createUserApiKey",plural:!1,selections:[l,{alias:null,args:null,concreteType:"UserApiKey",kind:"LinkedField",name:"apiKey",plural:!1,selections:[t,{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"user",plural:!1,selections:[{alias:null,args:null,concreteType:"UserApiKey",kind:"LinkedField",name:"apiKeys",plural:!0,selections:[t,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"expiresAt",storageKey:null}],storageKey:null},t],storageKey:null}],storageKey:null}],storageKey:null}]},params:{cacheID:"500fa7541c393ca91d6fa184c5626b44",id:null,metadata:{},name:"ViewerAPIKeysCreateUserAPIKeyMutation",operationKind:"mutation",text:`mutation ViewerAPIKeysCreateUserAPIKeyMutation(
  $input: CreateUserApiKeyInput!
) {
  createUserApiKey(input: $input) {
    jwt
    apiKey {
      id
      user {
        ...APIKeysTableFragment
        id
      }
    }
  }
}

fragment APIKeysTableFragment on User {
  apiKeys {
    id
    name
    description
    createdAt
    expiresAt
  }
  id
}
`}}}();ip.hash="28061ae008e197468be6fd5f2775ccb0";const rp=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{kind:"Variable",name:"input",variableName:"input"}],l={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"apiKeyId",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"APIKeysTableDeleteAPIKeyMutation",selections:[{alias:null,args:a,concreteType:"DeleteApiKeyMutationPayload",kind:"LinkedField",name:"deleteUserApiKey",plural:!1,selections:[l,t,{alias:null,args:null,concreteType:"Query",kind:"LinkedField",name:"query",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"UserAPIKeysTableFragment"}],storageKey:null}],storageKey:null}],type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"APIKeysTableDeleteAPIKeyMutation",selections:[{alias:null,args:a,concreteType:"DeleteApiKeyMutationPayload",kind:"LinkedField",name:"deleteUserApiKey",plural:!1,selections:[l,t,{alias:null,args:null,concreteType:"Query",kind:"LinkedField",name:"query",plural:!1,selections:[{alias:null,args:null,concreteType:"UserApiKey",kind:"LinkedField",name:"userApiKeys",plural:!0,selections:[i,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"expiresAt",storageKey:null},{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"user",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"email",storageKey:null},i],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}]},params:{cacheID:"510641f5bceb5958f37618a9f54095c3",id:null,metadata:{},name:"APIKeysTableDeleteAPIKeyMutation",operationKind:"mutation",text:`mutation APIKeysTableDeleteAPIKeyMutation(
  $input: DeleteApiKeyInput!
) {
  deleteUserApiKey(input: $input) {
    __typename
    apiKeyId
    query {
      ...UserAPIKeysTableFragment
    }
  }
}

fragment UserAPIKeysTableFragment on Query {
  userApiKeys {
    id
    name
    description
    createdAt
    expiresAt
    user {
      email
      id
    }
  }
}
`}}}();rp.hash="3a505d9d13944798a57fc873ddf0992d";const op=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}],l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"APIKeysTableQuery",selections:[{alias:null,args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"APIKeysTableFragment"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"APIKeysTableQuery",selections:[{alias:null,args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},l,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"UserApiKey",kind:"LinkedField",name:"apiKeys",plural:!0,selections:[l,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"expiresAt",storageKey:null}],storageKey:null}],type:"User",abstractKey:null}],storageKey:null}]},params:{cacheID:"cdfdedf08fd777fb83fabe0bce5ab3db",id:null,metadata:{},name:"APIKeysTableQuery",operationKind:"query",text:`query APIKeysTableQuery(
  $id: ID!
) {
  node(id: $id) {
    __typename
    ...APIKeysTableFragment
    id
  }
}

fragment APIKeysTableFragment on User {
  apiKeys {
    id
    name
    description
    createdAt
    expiresAt
  }
  id
}
`}}}();op.hash="6c32098d55e4cba859dcec73f3ccd28c";const sp=function(){var n={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{argumentDefinitions:[],kind:"Fragment",metadata:{refetch:{connection:null,fragmentPathInResult:["node"],operation:op,identifierInfo:{identifierField:"id",identifierQueryVariableName:"id"}}},name:"APIKeysTableFragment",selections:[{alias:null,args:null,concreteType:"UserApiKey",kind:"LinkedField",name:"apiKeys",plural:!0,selections:[n,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"expiresAt",storageKey:null}],storageKey:null},n],type:"User",abstractKey:null}}();sp.hash="6c32098d55e4cba859dcec73f3ccd28c";const uo=70;function UK({query:n}){const[a,l]=T.useRefetchableFragment(sp,n),t=me(),[i]=T.useMutation(rp),r=m.useCallback(u=>{i({variables:{input:{id:u}},onCompleted:()=>{t({title:"API key deleted",message:"The key has been deleted and is no longer active."}),m.startTransition(()=>{l({},{fetchPolicy:"network-only"})})}})},[i,t,l]),s=m.useMemo(()=>[...a.apiKeys],[a]),d=m.useMemo(()=>[{header:"Name",accessorKey:"name",size:100,cell:Re},{header:"Description",accessorKey:"description",cell:Re},{header:"Created At",accessorKey:"createdAt",size:uo,cell:_e},{header:"Expires At",accessorKey:"expiresAt",size:uo,cell:_e},{header:"",accessorKey:"id",size:10,cell:({row:p})=>e(b,{direction:"row",justifyContent:"end",width:"100%",children:e(vi,{handleDelete:()=>{r(p.original.id)}})}),meta:{textAlign:"right"}}],[r]),c=Ce({columns:d,data:s,getCoreRowModel:Ke()}),g=c.getRowModel().rows,f=c.getRowModel().rows.length===0;return o("table",{css:We,children:[e("thead",{children:c.getHeaderGroups().map(u=>e("tr",{children:u.headers.map(p=>e("th",{colSpan:p.colSpan,children:p.isPlaceholder?null:o("div",{className:p.column.getCanSort()?"sort":"",onClick:p.column.getToggleSortingHandler(),style:{left:p.getStart(),width:p.getSize()},children:[W(p.column.columnDef.header,p.getContext()),p.column.getIsSorted()?e(I,{className:"sort-icon",svg:p.column.getIsSorted()==="asc"?e(Xe,{}):e(Ze,{})}):null]})},p.id))},u.id))}),f?e(yn,{message:"No Keys"}):e("tbody",{children:g.map(u=>e("tr",{children:u.getVisibleCells().map(p=>e("td",{children:W(p.column.columnDef.cell,p.getContext())},p.id))},u.id))})]})}function HK({viewer:n}){const[a,l]=m.useState(null),t=be(),[i,r]=T.useMutation(ip),s=m.useCallback(d=>{var c;i({variables:{input:{...d,expiresAt:((c=d.expiresAt)==null?void 0:c.toDate(pi()).toISOString())||null}},onCompleted:g=>{l(e(Ko,{jwt:g.createUserApiKey.jwt}))},onError:g=>{t({title:"Error creating API key",message:g.message})}})},[i,t]);return o(q,{title:"API Keys",variant:"compact",bodyStyle:{padding:0},extra:e(M,{size:"S",leadingVisual:e(I,{svg:e(Bn,{})}),onPress:()=>l(e(To,{onSubmit:s,isCommitting:r})),children:"New Key"}),children:[e(UK,{query:n}),e(ue,{onDismiss:()=>{l(null)},children:a})]})}const dp=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"UserMutationPayload",kind:"LinkedField",name:"patchViewer",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ViewerProfileCardMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ViewerProfileCardMutation",selections:a},params:{cacheID:"03f161df42c71b5924a8ee665e01cdce",id:null,metadata:{},name:"ViewerProfileCardMutation",operationKind:"mutation",text:`mutation ViewerProfileCardMutation(
  $input: PatchViewerInput!
) {
  patchViewer(input: $input) {
    __typename
  }
}
`}}}();dp.hash="4a11ca65151d84fe95f636763c91dc68";function GK(){const{viewer:n,refetchViewer:a}=Fi(),l=be(),t=me(),[i,r]=T.useMutation(dp),{control:s,handleSubmit:d,formState:{isDirty:c},reset:g}=Ve({defaultValues:{username:(n==null?void 0:n.username)||""}}),f=m.useCallback(u=>{i({variables:{input:{newUsername:u.username}},onCompleted:()=>{t({title:"Profile updated",message:"Your profile has been updated"}),g({username:u.username}),a()},onError:p=>{l({title:"Failed update profile",message:p.message})}})},[i,t,g,a,l]);return n?o(q,{title:"Profile",variant:"compact",bodyStyle:{padding:0},extra:n.authMethod==="LOCAL"&&e(sa,{size:"S",to:"/reset-password",children:"Reset Password"}),children:[e(v,{paddingTop:"size-200",paddingStart:"size-200",paddingEnd:"size-200",children:o(b,{direction:"row",gap:"size-200",alignItems:"center",children:[e(ut,{name:n.username||n.email,profilePictureUrl:n.profilePictureUrl}),o(b,{direction:"column",gap:"size-50",children:[e(ae,{level:2,weight:"heavy",children:n.username||n.email}),e(F,{children:n.role.name.toLocaleLowerCase()})]})]})}),e(v,{children:o(gn,{onSubmit:d(f),children:[e(v,{padding:"size-200",children:o(b,{direction:"column",gap:"size-100",children:[o(ee,{value:n.email,isReadOnly:!0,size:"S",children:[e(H,{children:"Email"}),e(X,{})]}),e(G,{name:"username",control:s,rules:{required:"A username is required as it needs to be unique"},render:({field:{name:u,onChange:p,onBlur:y,value:h},fieldState:{invalid:k,error:S}})=>o(ee,{isRequired:!0,name:u,isInvalid:k,onChange:p,onBlur:y,defaultValue:h,size:"S",children:[e(H,{children:"Username"}),e(X,{}),S?e(ke,{children:S.message}):e(F,{slot:"description",children:"A unique username"})]})})]})}),e(v,{paddingTop:"size-100",paddingBottom:"size-100",paddingStart:"size-200",paddingEnd:"size-200",borderTopColor:"dark",borderTopWidth:"thin",children:e(b,{direction:"row",gap:"size-100",justifyContent:"end",children:e(M,{variant:c?"primary":"default",size:"S",isDisabled:!c,onPress:()=>{d(f)()},children:r?"Saving...":"Save"})})})]})})]}):null}const WK=K`
  overflow-y: auto;
`,JK=K`
  padding: var(--ac-global-dimension-size-400);
  max-width: 800px;
  min-width: 500px;
  box-sizing: border-box;
  width: 100%;
  margin-left: auto;
  margin-right: auto;
`;function xP(){const{viewer:n}=Fi();return n?e("main",{css:WK,children:e("div",{css:JK,children:o(b,{direction:"column",gap:"size-200",children:[e(GK,{}),e(HK,{viewer:n})]})})}):null}function IP(){return e(ir,{})}function DP(){const n=Me();Oe(n);const a=m.useMemo(()=>n.span.__typename==="Span"?n.span:null,[n.span]);if(!a)throw new Error("Span not found");const{playgroundInstance:l,parsingErrors:t,playgroundInput:i}=m.useMemo(()=>g0(a),[a]),r=i!=null?{input:i}:{};return o(b,{direction:"column",height:"100%",children:[e(XK,{span:a,parsingErrors:t}),e(ir,{instances:[l],...r},a.id)]})}function XK({span:n,parsingErrors:a}){const l=ce(),t=a&&a.length>0,[i,r]=m.useState(!0),[s,d]=m.useState(t);return o(b,{direction:"column",children:[i&&e(Fe,{variant:"info",title:"LLM Span Replay",banner:!0,dismissable:!0,onDismissClick:()=>{r(!1)},extra:e(M,{leadingVisual:e(I,{svg:e(Ch,{})}),onPress:()=>{l(`/projects/${n.project.id}/traces/${n.trace.traceId}?${mn}=${n.id}`)},children:"Back to Trace"}),children:`Replay and iterate on your LLM call from your ${n.project.name} project`}),s&&t&&e(Fe,{variant:"warning",banner:!0,dismissable:!0,onDismissClick:()=>{d(!1)},title:"The following errors occurred when parsing span attributes:",children:e("ul",{children:a.map(c=>e("li",{children:c},c))})})]})}const cp=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"spanId"}],a=[{kind:"Variable",name:"id",variableName:"spanId"}],l={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},i={alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"project",plural:!1,selections:[t,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"spanId",storageKey:null},s={alias:null,args:null,concreteType:"Trace",kind:"LinkedField",name:"trace",plural:!1,selections:[t,{alias:null,args:null,kind:"ScalarField",name:"traceId",storageKey:null}],storageKey:null},d={alias:null,args:null,kind:"ScalarField",name:"attributes",storageKey:null},c=[{alias:null,args:null,kind:"ScalarField",name:"invocationInputField",storageKey:null}],g={alias:null,args:null,concreteType:null,kind:"LinkedField",name:"invocationParameters",plural:!0,selections:[l,{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"invocationName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"canonicalName",storageKey:null}],type:"InvocationParameterBase",abstractKey:"__isInvocationParameterBase"},{kind:"InlineFragment",selections:c,type:"BooleanInvocationParameter",abstractKey:null},{kind:"InlineFragment",selections:c,type:"StringInvocationParameter",abstractKey:null},{kind:"InlineFragment",selections:c,type:"BoundedFloatInvocationParameter",abstractKey:null},{kind:"InlineFragment",selections:c,type:"FloatInvocationParameter",abstractKey:null},{kind:"InlineFragment",selections:c,type:"IntInvocationParameter",abstractKey:null},{kind:"InlineFragment",selections:c,type:"JSONInvocationParameter",abstractKey:null},{kind:"InlineFragment",selections:c,type:"StringListInvocationParameter",abstractKey:null}],storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"spanPlaygroundPageLoaderQuery",selections:[{alias:"span",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[l,{kind:"InlineFragment",selections:[t,i,r,s,d,g],type:"Span",abstractKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"spanPlaygroundPageLoaderQuery",selections:[{alias:"span",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[l,t,{kind:"InlineFragment",selections:[i,r,s,d,g],type:"Span",abstractKey:null}],storageKey:null}]},params:{cacheID:"15db907b4e1020d0625053f7530561ad",id:null,metadata:{},name:"spanPlaygroundPageLoaderQuery",operationKind:"query",text:`query spanPlaygroundPageLoaderQuery(
  $spanId: ID!
) {
  span: node(id: $spanId) {
    __typename
    ... on Span {
      id
      project {
        id
        name
      }
      spanId
      trace {
        id
        traceId
      }
      attributes
      invocationParameters {
        __typename
        ... on InvocationParameterBase {
          __isInvocationParameterBase: __typename
          invocationName
          canonicalName
        }
        ... on BooleanInvocationParameter {
          invocationInputField
        }
        ... on StringInvocationParameter {
          invocationInputField
        }
        ... on BoundedFloatInvocationParameter {
          invocationInputField
        }
        ... on FloatInvocationParameter {
          invocationInputField
        }
        ... on IntInvocationParameter {
          invocationInputField
        }
        ... on JSONInvocationParameter {
          invocationInputField
        }
        ... on StringListInvocationParameter {
          invocationInputField
        }
      }
    }
    id
  }
}
`}}}();cp.hash="ab0e72402c34ac0eaf7cf39a14427121";async function LP(n){const{spanId:a}=n.params;if(!a||typeof a!="string")throw new Error("Invalid spanId");return await T.fetchQuery(he,cp,{spanId:a}).toPromise()}const up=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"after"},{defaultValue:100,kind:"LocalArgument",name:"first"}],a=[{kind:"Variable",name:"after",variableName:"after"},{kind:"Variable",name:"first",variableName:"first"}],l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"PromptsTablePromptsQuery",selections:[{args:a,kind:"FragmentSpread",name:"PromptsTable_prompts"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"PromptsTablePromptsQuery",selections:[{alias:null,args:a,concreteType:"PromptConnection",kind:"LinkedField",name:"prompts",plural:!1,selections:[{alias:null,args:null,concreteType:"PromptEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"prompt",args:null,concreteType:"Prompt",kind:"LinkedField",name:"node",plural:!1,selections:[l,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},t,{alias:null,args:null,concreteType:"PromptVersion",kind:"LinkedField",name:"version",plural:!1,selections:[t,l],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"Prompt",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},l],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:a,filters:null,handle:"connection",key:"PromptsTable_prompts",kind:"LinkedHandle",name:"prompts"}]},params:{cacheID:"d34de7b5cd9490100a935debc9b71892",id:null,metadata:{},name:"PromptsTablePromptsQuery",operationKind:"query",text:`query PromptsTablePromptsQuery(
  $after: String = null
  $first: Int = 100
) {
  ...PromptsTable_prompts_2HEEH6
}

fragment PromptsTable_prompts_2HEEH6 on Query {
  prompts(first: $first, after: $after) {
    edges {
      prompt: node {
        id
        name
        description
        createdAt
        version {
          createdAt
          id
        }
      }
      cursor
      node {
        __typename
        id
      }
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
}
`}}}();up.hash="829c7cff273e0ebcfba1c0606c052d8b";const mp=function(){var n=["prompts"],a={alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null};return{argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"after"},{defaultValue:100,kind:"LocalArgument",name:"first"}],kind:"Fragment",metadata:{connection:[{count:"first",cursor:"after",direction:"forward",path:n}],refetch:{connection:{forward:{count:"first",cursor:"after"},backward:null,path:n},fragmentPathInResult:[],operation:up}},name:"PromptsTable_prompts",selections:[{alias:"prompts",args:null,concreteType:"PromptConnection",kind:"LinkedField",name:"__PromptsTable_prompts_connection",plural:!1,selections:[{alias:null,args:null,concreteType:"PromptEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"prompt",args:null,concreteType:"Prompt",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},a,{alias:null,args:null,concreteType:"PromptVersion",kind:"LinkedField",name:"version",plural:!1,selections:[a],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"Prompt",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null}],type:"Query",abstractKey:null}}();mp.hash="829c7cff273e0ebcfba1c0606c052d8b";const gp=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"promptId"}],a=[{fields:[{kind:"Variable",name:"promptId",variableName:"promptId"}],kind:"ObjectValue",name:"input"}],l=[{kind:"Literal",name:"first",value:100}],t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"DeletePromptDialogMutation",selections:[{alias:null,args:a,concreteType:"DeletePromptMutationPayload",kind:"LinkedField",name:"deletePrompt",plural:!1,selections:[{alias:null,args:null,concreteType:"Query",kind:"LinkedField",name:"query",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"PromptsTable_prompts"}],storageKey:null}],storageKey:null}],type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"DeletePromptDialogMutation",selections:[{alias:null,args:a,concreteType:"DeletePromptMutationPayload",kind:"LinkedField",name:"deletePrompt",plural:!1,selections:[{alias:null,args:null,concreteType:"Query",kind:"LinkedField",name:"query",plural:!1,selections:[{alias:null,args:l,concreteType:"PromptConnection",kind:"LinkedField",name:"prompts",plural:!1,selections:[{alias:null,args:null,concreteType:"PromptEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"prompt",args:null,concreteType:"Prompt",kind:"LinkedField",name:"node",plural:!1,selections:[t,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},i,{alias:null,args:null,concreteType:"PromptVersion",kind:"LinkedField",name:"version",plural:!1,selections:[i,t],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"Prompt",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},t],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:"prompts(first:100)"},{alias:null,args:l,filters:null,handle:"connection",key:"PromptsTable_prompts",kind:"LinkedHandle",name:"prompts"}],storageKey:null}],storageKey:null}]},params:{cacheID:"cfb74b6d989fbe5c38c302d7e6dc5c51",id:null,metadata:{},name:"DeletePromptDialogMutation",operationKind:"mutation",text:`mutation DeletePromptDialogMutation(
  $promptId: ID!
) {
  deletePrompt(input: {promptId: $promptId}) {
    query {
      ...PromptsTable_prompts
    }
  }
}

fragment PromptsTable_prompts on Query {
  prompts(first: 100) {
    edges {
      prompt: node {
        id
        name
        description
        createdAt
        version {
          createdAt
          id
        }
      }
      cursor
      node {
        __typename
        id
      }
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
}
`}}}();gp.hash="af218c6f8442ad552dd44771a2d55275";function ZK({promptId:n,onDeleted:a,onClose:l}){const[t,i]=T.useMutation(gp),r=me(),s=be(),d=m.useCallback(()=>{t({variables:{promptId:n},onCompleted:()=>{r({title:"Delete Successful",message:"Prompt has been deleted."}),a(),l()},onError:c=>{s({title:"Failed to delete prompt",message:c.message})}})},[t,s,r,l,a,n]);return o(oe,{title:"Delete Prompt",isDismissable:!0,onDismiss:l,children:[e(v,{padding:"size-200",children:e(F,{color:"danger",children:"Are you sure you want to delete this prompt? This action cannot be undone and all services dependent on this prompt will be affected."})}),e(v,{paddingEnd:"size-200",paddingTop:"size-100",paddingBottom:"size-100",borderTopColor:"light",borderTopWidth:"thin",children:o(b,{direction:"row",justifyContent:"end",gap:"size-100",children:[e(M,{variant:"default",onPress:l,size:"S",children:"Cancel"}),e(M,{variant:"danger",onPress:()=>{d()},size:"S",isDisabled:i,children:"Delete Prompt"})]})})]})}function YK({onDeleted:n,promptId:a}){const[l,t]=m.useState(null),i=m.useCallback(()=>{t(e(ZK,{promptId:a,onClose:()=>t(null),onDeleted:()=>{n(),t(null)}}))},[a,n]);return o(El,{children:[e(ra,{align:"end","aria-label":"User Actions",buttonSize:"compact",onAction:r=>{switch(r){case"DELETE":i();break}},children:e(xe,{children:o(b,{direction:"row",gap:"size-75",justifyContent:"start",alignItems:"center",children:[e(I,{svg:e(Je,{})}),e(J,{children:"Delete"})]})},"DELETE")}),e(ue,{type:"modal",isDismissable:!0,onDismiss:()=>t(null),children:l})]})}function eT(){const n=ce();return e(v,{width:"100%",paddingY:"size-400",children:e(b,{direction:"column",width:"100%",alignItems:"center",justifyContent:"center",children:e(v,{width:"100%",maxWidth:"780px",children:o(b,{direction:"column",gap:"size-400",alignItems:"center",children:[e(F,{size:"XL",children:"Create and manage prompt templates for your AI applications."}),e(zi,{src:"https://storage.googleapis.com/arize-phoenix-assets/assets/videos/prompts.mp4",autoPlay:!0,muted:!0,loop:!0}),o(b,{direction:"row",gap:"size-200",children:[e(nl,{href:"https://arize.com/docs/phoenix/prompt-engineering/quickstart-prompts/quickstart-prompts-ui",target:"_blank",leadingVisual:e(I,{svg:e(Ni,{})}),children:"Documentation"}),e(M,{variant:"primary",leadingVisual:e(I,{svg:e(Da,{})}),onPress:()=>n("/playground"),children:"Playground"})]})]})})})})}const nT=100;function aT(n){const a=ce(),l=m.useRef(null),{data:t,loadNext:i,hasNext:r,isLoadingNext:s,refetch:d}=T.usePaginationFragment(mp,n.query),c=m.useMemo(()=>t.prompts.edges.map(h=>({lastUpdatedAt:h.prompt.version.createdAt,...h.prompt})),[t]),g=m.useCallback(h=>{if(h){const{scrollHeight:k,scrollTop:S,clientHeight:C}=h;k-S-C<300&&!s&&r&&i(nT)}},[r,s,i]),f=m.useMemo(()=>[{header:"name",accessorKey:"name",cell:({row:k})=>e(we,{to:`${k.original.id}`,children:k.original.name})},{header:"description",accessorKey:"description",cell:Re},{header:"created at",accessorKey:"createdAt",cell:_e},{header:"last updated",accessorKey:"lastUpdatedAt",cell:_e},{id:"actions",header:"",size:5,accessorKey:"id",cell:({row:k})=>o(b,{direction:"row",gap:"size-100",justifyContent:"end",width:"100%",children:[e(El,{children:e(sa,{leadingVisual:e(I,{svg:e(Da,{})}),size:"S","aria-label":"Open in playground",to:`${k.original.id}/playground`,children:"Playground"})}),e(YK,{promptId:k.original.id,onDeleted:()=>{d({},{fetchPolicy:"network-only"})}})]})}],[d]),u=Ce({columns:f,data:c,getCoreRowModel:Ke(),getSortedRowModel:ln()}),p=u.getRowModel().rows;return p.length===0?e(eT,{}):e("div",{css:K`
        flex: 1 1 auto;
        overflow: auto;
      `,onScroll:h=>g(h.target),ref:l,children:o("table",{css:Un,children:[e("thead",{children:u.getHeaderGroups().map(h=>e("tr",{children:h.headers.map(k=>{var S;return e("th",{colSpan:k.colSpan,children:k.isPlaceholder?null:o("div",{className:k.column.getCanSort()?"sort":"","aria-role":k.column.getCanSort()?"button":null,onClick:k.column.getToggleSortingHandler(),style:{textAlign:(S=k.column.columnDef.meta)==null?void 0:S.textAlign},children:[W(k.column.columnDef.header,k.getContext()),k.column.getIsSorted()?e(I,{className:"sort-icon",svg:k.column.getIsSorted()==="asc"?e(Xe,{}):e(Ze,{})}):null]})},k.id)})},h.id))}),e("tbody",{children:p.map(h=>e("tr",{onClick:()=>{a(`${h.original.id}`)},children:h.getVisibleCells().map(k=>{var S;return e("td",{align:(S=k.column.columnDef.meta)==null?void 0:S.textAlign,children:W(k.column.columnDef.cell,k.getContext())},k.id)})},h.id))})]})})}function _P(){const n=Me();return Oe(n),o(b,{direction:"column",height:"100%",children:[e(v,{padding:"size-200",borderBottomWidth:"thin",borderBottomColor:"dark",flex:"none",children:o(b,{direction:"row",justifyContent:"space-between",alignItems:"center",children:[e(ae,{level:1,children:"Prompts"}),e(sa,{size:"M",leadingVisual:e(I,{svg:e(Ci,{})}),variant:"primary",to:"/playground",children:"Create Prompt"})]})}),e(aT,{query:n})]})}const pp=function(){var n=[{kind:"Literal",name:"first",value:100}],a={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null};return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"promptsLoaderQuery",selections:[{args:null,kind:"FragmentSpread",name:"PromptsTable_prompts"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"promptsLoaderQuery",selections:[{alias:null,args:n,concreteType:"PromptConnection",kind:"LinkedField",name:"prompts",plural:!1,selections:[{alias:null,args:null,concreteType:"PromptEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"prompt",args:null,concreteType:"Prompt",kind:"LinkedField",name:"node",plural:!1,selections:[a,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},l,{alias:null,args:null,concreteType:"PromptVersion",kind:"LinkedField",name:"version",plural:!1,selections:[l,a],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"Prompt",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},a],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:"prompts(first:100)"},{alias:null,args:n,filters:null,handle:"connection",key:"PromptsTable_prompts",kind:"LinkedHandle",name:"prompts"}]},params:{cacheID:"9a3e6a185a7a63d9d2c115e80e22b495",id:null,metadata:{},name:"promptsLoaderQuery",operationKind:"query",text:`query promptsLoaderQuery {
  ...PromptsTable_prompts
}

fragment PromptsTable_prompts on Query {
  prompts(first: 100) {
    edges {
      prompt: node {
        id
        name
        description
        createdAt
        version {
          createdAt
          id
        }
      }
      cursor
      node {
        __typename
        id
      }
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
}
`}}}();pp.hash="ed4295f193bd2a6d2402a82966d45a7f";async function AP(n){return await T.fetchQuery(he,pp,{}).toPromise()}const yp=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}],l={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"toolCallId",storageKey:null},s=[{alias:null,args:null,kind:"ScalarField",name:"definition",storageKey:null}],d={alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},c={alias:null,args:null,kind:"ScalarField",name:"sequenceNumber",storageKey:null},g={alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},f={alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"user",plural:!1,selections:[t,{alias:null,args:null,kind:"ScalarField",name:"username",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"profilePictureUrl",storageKey:null}],storageKey:null},u=[t,i],p={alias:null,args:null,concreteType:"PromptVersionTag",kind:"LinkedField",name:"tags",plural:!0,selections:u,storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"promptLoaderQuery",selections:[{alias:"prompt",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[l,t,{kind:"InlineFragment",selections:[i,{args:null,kind:"FragmentSpread",name:"PromptIndexPage__main"},{args:null,kind:"FragmentSpread",name:"PromptVersionsPageContent__main"},{args:null,kind:"FragmentSpread",name:"PromptLayout__main"}],type:"Prompt",abstractKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"promptLoaderQuery",selections:[{alias:"prompt",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[l,t,{kind:"InlineFragment",selections:[i,{alias:null,args:null,concreteType:"PromptVersionConnection",kind:"LinkedField",name:"promptVersions",plural:!1,selections:[{alias:null,args:null,concreteType:"PromptVersionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"PromptVersion",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"invocationParameters",storageKey:null},{alias:"provider",args:null,kind:"ScalarField",name:"modelProvider",storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"template",plural:!1,selections:[l,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"PromptMessage",kind:"LinkedField",name:"messages",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"role",storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"content",plural:!0,selections:[l,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"TextContentValue",kind:"LinkedField",name:"text",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"text",storageKey:null}],storageKey:null}],type:"TextContentPart",abstractKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"ToolCallContentValue",kind:"LinkedField",name:"toolCall",plural:!1,selections:[r,{alias:null,args:null,concreteType:"ToolCallFunction",kind:"LinkedField",name:"toolCall",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"arguments",storageKey:null},i],storageKey:null}],storageKey:null}],type:"ToolCallContentPart",abstractKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"ToolResultContentValue",kind:"LinkedField",name:"toolResult",plural:!1,selections:[r,{alias:null,args:null,kind:"ScalarField",name:"result",storageKey:null}],storageKey:null}],type:"ToolResultContentPart",abstractKey:null}],storageKey:null}],storageKey:null}],type:"PromptChatTemplate",abstractKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"template",storageKey:null}],type:"PromptStringTemplate",abstractKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"templateType",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"templateFormat",storageKey:null},t,{alias:null,args:null,kind:"ScalarField",name:"modelName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"modelProvider",storageKey:null},{alias:null,args:null,concreteType:"ResponseFormat",kind:"LinkedField",name:"responseFormat",plural:!1,selections:s,storageKey:null},{alias:null,args:null,concreteType:"ToolDefinition",kind:"LinkedField",name:"tools",plural:!0,selections:s,storageKey:null},{alias:"model",args:null,kind:"ScalarField",name:"modelName",storageKey:null}],storageKey:null},{alias:"version",args:null,concreteType:"PromptVersion",kind:"LinkedField",name:"node",plural:!1,selections:[t,d,c,g,f,p],storageKey:null}],storageKey:null}],storageKey:null},d,{alias:"latestVersions",args:[{kind:"Literal",name:"first",value:5}],concreteType:"PromptVersionConnection",kind:"LinkedField",name:"promptVersions",plural:!1,selections:[{alias:null,args:null,concreteType:"PromptVersionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"version",args:null,concreteType:"PromptVersion",kind:"LinkedField",name:"node",plural:!1,selections:[t,d,g,c,f,p],storageKey:null}],storageKey:null}],storageKey:"promptVersions(first:5)"},{alias:null,args:null,concreteType:"Prompt",kind:"LinkedField",name:"sourcePrompt",plural:!1,selections:u,storageKey:null}],type:"Prompt",abstractKey:null}],storageKey:null}]},params:{cacheID:"24ab780c15f1ca153edf38dc98d48034",id:null,metadata:{},name:"promptLoaderQuery",operationKind:"query",text:`query promptLoaderQuery(
  $id: ID!
) {
  prompt: node(id: $id) {
    __typename
    id
    ... on Prompt {
      name
      ...PromptIndexPage__main
      ...PromptVersionsPageContent__main
      ...PromptLayout__main
    }
  }
}

fragment EditPromptButton_data on Prompt {
  id
  description
}

fragment PromptChatMessagesCard__main on PromptVersion {
  provider: modelProvider
  template {
    __typename
    ... on PromptChatTemplate {
      messages {
        role
        content {
          __typename
          ... on TextContentPart {
            text {
              text
            }
          }
          ... on ToolCallContentPart {
            toolCall {
              toolCallId
              toolCall {
                arguments
                name
              }
            }
          }
          ... on ToolResultContentPart {
            toolResult {
              toolCallId
              result
            }
          }
        }
      }
    }
    ... on PromptStringTemplate {
      template
    }
  }
  templateType
  templateFormat
}

fragment PromptCodeExportCard__main on PromptVersion {
  id
  invocationParameters
  modelName
  modelProvider
  responseFormat {
    definition
  }
  tools {
    definition
  }
  template {
    __typename
    ... on PromptChatTemplate {
      messages {
        role
        content {
          __typename
          ... on TextContentPart {
            __typename
            text {
              text
            }
          }
          ... on ToolCallContentPart {
            __typename
            toolCall {
              toolCallId
              toolCall {
                name
                arguments
              }
            }
          }
          ... on ToolResultContentPart {
            __typename
            toolResult {
              toolCallId
              result
            }
          }
        }
      }
    }
    ... on PromptStringTemplate {
      template
    }
  }
  templateFormat
  templateType
}

fragment PromptIndexPage__aside on Prompt {
  description
  ...PromptLatestVersionsListFragment
  ...EditPromptButton_data
}

fragment PromptIndexPage__main on Prompt {
  promptVersions {
    edges {
      node {
        ...PromptInvocationParameters__main
        ...PromptChatMessagesCard__main
        ...PromptCodeExportCard__main
        ...PromptModelConfigurationCard__main
        id
      }
    }
  }
  ...PromptIndexPage__aside
}

fragment PromptInvocationParameters__main on PromptVersion {
  invocationParameters
}

fragment PromptLLM__main on PromptVersion {
  model: modelName
  provider: modelProvider
}

fragment PromptLatestVersionsListFragment on Prompt {
  latestVersions: promptVersions(first: 5) {
    edges {
      version: node {
        id
        description
        createdAt
        sequenceNumber
        ...PromptVersionSummaryFragment
      }
    }
  }
}

fragment PromptLayout__main on Prompt {
  id
  name
  description
  sourcePrompt {
    id
    name
  }
  promptVersions {
    edges {
      node {
        id
      }
    }
  }
}

fragment PromptModelConfigurationCard__main on PromptVersion {
  model: modelName
  provider: modelProvider
  ...PromptLLM__main
  ...PromptInvocationParameters__main
  ...PromptTools__main
  ...PromptResponseFormatFragment
}

fragment PromptResponseFormatFragment on PromptVersion {
  responseFormat {
    definition
  }
}

fragment PromptTools__main on PromptVersion {
  tools {
    definition
  }
}

fragment PromptVersionSummaryFragment on PromptVersion {
  id
  description
  sequenceNumber
  createdAt
  user {
    id
    username
    profilePictureUrl
  }
  ...PromptVersionTagsList_data
}

fragment PromptVersionTagsList_data on PromptVersion {
  tags {
    id
    name
  }
}

fragment PromptVersionsList__main on Prompt {
  promptVersions {
    edges {
      version: node {
        id
        ...PromptVersionSummaryFragment
      }
    }
  }
}

fragment PromptVersionsPageContent__main on Prompt {
  ...PromptVersionsList__main
}
`}}}();yp.hash="c19209c9d3b9df985746493df3a97b49";async function wP(n){const{promptId:a}=n.params;return await T.fetchQuery(he,yp,{id:a}).toPromise().catch(()=>{throw new Error("Prompt not found")})}const fp=function(){var n={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"PromptVersionTagsConfigCard_data",selections:[n,{alias:null,args:null,concreteType:"PromptVersionTag",kind:"LinkedField",name:"versionTags",plural:!0,selections:[n,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"promptVersionId",storageKey:null}],storageKey:null}],type:"Prompt",abstractKey:null}}();fp.hash="3650e60f18eb8d95b707df7bdbce99a9";const hp=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"},{defaultValue:null,kind:"LocalArgument",name:"promptId"}],a=[{kind:"Variable",name:"input",variableName:"input"}],l=[{kind:"Variable",name:"id",variableName:"promptId"}],t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"DeletePromptVersionTagButtonMutation",selections:[{alias:null,args:a,concreteType:"PromptVersionTagMutationPayload",kind:"LinkedField",name:"deletePromptVersionTag",plural:!1,selections:[{alias:null,args:null,concreteType:"Query",kind:"LinkedField",name:"query",plural:!1,selections:[{alias:null,args:l,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"PromptVersionTagsConfigCard_data"}],storageKey:null}],storageKey:null}],storageKey:null}],type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"DeletePromptVersionTagButtonMutation",selections:[{alias:null,args:a,concreteType:"PromptVersionTagMutationPayload",kind:"LinkedField",name:"deletePromptVersionTag",plural:!1,selections:[{alias:null,args:null,concreteType:"Query",kind:"LinkedField",name:"query",plural:!1,selections:[{alias:null,args:l,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},t,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"PromptVersionTag",kind:"LinkedField",name:"versionTags",plural:!0,selections:[t,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"promptVersionId",storageKey:null}],storageKey:null}],type:"Prompt",abstractKey:null}],storageKey:null}],storageKey:null}],storageKey:null}]},params:{cacheID:"387e2e286ff86ad049a2b4afbd189b22",id:null,metadata:{},name:"DeletePromptVersionTagButtonMutation",operationKind:"mutation",text:`mutation DeletePromptVersionTagButtonMutation(
  $input: DeletePromptVersionTagInput!
  $promptId: ID!
) {
  deletePromptVersionTag(input: $input) {
    query {
      node(id: $promptId) {
        __typename
        ...PromptVersionTagsConfigCard_data
        id
      }
    }
  }
}

fragment PromptVersionTagsConfigCard_data on Prompt {
  id
  versionTags {
    id
    name
    description
    promptVersionId
  }
}
`}}}();hp.hash="58fa5b2b6e7af186229c70b90082644a";function lT({promptVersionTagId:n,promptId:a}){const[l,t]=m.useState(!1),i=me(),[r,s]=T.useMutation(hp);return o(Ne,{isOpen:l,onOpenChange:t,children:[e(M,{"aria-label":"Delete tag",size:"S",leadingVisual:e(I,{svg:e(Je,{})})}),e(on,{children:e(Ge,{size:"S",children:o(He,{children:[e(ae,{slot:"title",children:"Delete Tag"}),e(v,{padding:"size-200",children:e(v,{paddingBottom:"size-100",children:e(F,{color:"danger",size:"XS",children:"Are you sure you want to delete this tag? This will make pulling prompts by this tag no longer possible. Make sure this tag is not used before deleting."})})}),e(v,{paddingX:"size-200",paddingY:"size-100",borderTopWidth:"thin",borderColor:"light",children:o(b,{gap:"size-100",justifyContent:"end",children:[e(M,{size:"S",onPress:()=>t(!1),children:"Cancel"}),e(M,{variant:"danger",size:"S",onPress:()=>r({variables:{input:{promptVersionTagId:n},promptId:a},onCompleted:()=>{i({title:"Tag Deleted",message:"The tag has been deleted"})}}),children:s?"Deleting...":"Delete Tag"})]})})]})})})]})}function tT({prompt:n}){const a=T.useFragment(fp,n),l=m.useMemo(()=>[{header:"Name",accessorKey:"name"},{header:"Description",accessorKey:"description",cell:Re},{header:"Version",accessorKey:"promptVersionId",cell:({row:d})=>{const{promptId:c,promptVersionId:g}=d.original;return e(we,{to:`/prompts/${c}/versions/${g}`,children:d.original.promptVersionId})}},{id:"actions",header:"",size:5,accessorKey:"id",cell:({row:d})=>e(b,{direction:"row",gap:"size-100",justifyContent:"end",width:"100%",children:e(lT,{promptVersionTagId:d.original.id,promptId:d.original.promptId},d.original.id)})}],[]),t=m.useMemo(()=>a.versionTags.map(d=>({id:d.id,name:d.name,description:d.description,promptId:a.id,promptVersionId:d.promptVersionId})),[a]),i=Ce({columns:l,data:t,getCoreRowModel:Ke(),getSortedRowModel:ln()}),r=i.getRowModel().rows,s=r.length===0;return e(q,{title:"Tags",variant:"compact",bodyStyle:{padding:0},children:o("table",{css:We,children:[e("thead",{children:i.getHeaderGroups().map(d=>e("tr",{children:d.headers.map(c=>e("th",{colSpan:c.colSpan,children:c.isPlaceholder?null:o("div",{className:c.column.getCanSort()?"sort":"",onClick:c.column.getToggleSortingHandler(),style:{left:c.getStart(),width:c.getSize()},children:[W(c.column.columnDef.header,c.getContext()),c.column.getIsSorted()?e(I,{className:"sort-icon",svg:c.column.getIsSorted()==="asc"?e(Xe,{}):e(Ze,{})}):null]})},c.id))},d.id))}),s?e(yn,{message:"No Tags"}):e("tbody",{children:r.map(d=>e("tr",{children:d.getVisibleCells().map(c=>e("td",{children:W(c.column.columnDef.cell,c.getContext())},c.id))},d.id))})]})})}function RP(){const n=Me();return Oe(n),e(b,{direction:"row",height:"100%",children:e(v,{height:"100%",overflow:"auto",width:"100%","data-testid":"scroll-container",children:e(v,{padding:"size-200",children:e(b,{direction:"column",gap:"size-200",marginStart:"auto",marginEnd:"auto",maxWidth:900,children:e(tT,{prompt:n.prompt})})})})})}function EP(){const n=Me();return Oe(n),e(Kh,{query:n,children:e(ve,{})})}const kp=function(){var n={alias:null,args:null,kind:"ScalarField",name:"passwordNeedsReset",storageKey:null},a={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null};return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"authenticatedRootLoaderQuery",selections:[{args:null,kind:"FragmentSpread",name:"ViewerContext_viewer"},{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"viewer",plural:!1,selections:[n],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"authenticatedRootLoaderQuery",selections:[{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"viewer",plural:!1,selections:[a,{alias:null,args:null,kind:"ScalarField",name:"username",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"email",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"profilePictureUrl",storageKey:null},{alias:null,args:null,concreteType:"UserRole",kind:"LinkedField",name:"role",plural:!1,selections:[l,a],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"authMethod",storageKey:null},{alias:null,args:null,concreteType:"UserApiKey",kind:"LinkedField",name:"apiKeys",plural:!0,selections:[a,l,{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"expiresAt",storageKey:null}],storageKey:null},n],storageKey:null}]},params:{cacheID:"9a44f89c9ef9c0c136d78242e89b66e3",id:null,metadata:{},name:"authenticatedRootLoaderQuery",operationKind:"query",text:`query authenticatedRootLoaderQuery {
  ...ViewerContext_viewer
  viewer {
    passwordNeedsReset
    id
  }
}

fragment APIKeysTableFragment on User {
  apiKeys {
    id
    name
    description
    createdAt
    expiresAt
  }
  id
}

fragment ViewerContext_viewer on Query {
  viewer {
    id
    username
    email
    profilePictureUrl
    role {
      name
      id
    }
    authMethod
    ...APIKeysTableFragment
  }
}
`}}}();kp.hash="d30a68846023740517243e9394be73a8";async function MP(){var a;const n=await T.fetchQuery(he,kp,{}).toPromise();if((a=n==null?void 0:n.viewer)!=null&&a.passwordNeedsReset){const l=ys({path:"/reset-password"});return Kl(l)}return n}const iT=K`
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(400px, 1fr));
  gap: var(--ac-global-dimension-size-200);
  padding: var(--ac-global-dimension-size-200);
`;function VP(){return e("main",{children:o(b,{direction:"column",width:"100%",children:[e(v,{padding:"size-200",borderBottomColor:"dark",borderBottomWidth:"thin",children:o(b,{direction:"column",gap:"size-50",children:[e(ae,{level:1,children:"Support"}),e(F,{color:"text-700",children:"We are here to help. Pick a channel below to get in touch with us."})]})}),o("div",{css:iT,children:[e(bl,{leadingVisual:e(I,{svg:e(Th,{})}),href:"https://arize.com/docs/phoenix",title:"Documentation",description:"Visit our documentation for tutorials and AI support."}),e(bl,{leadingVisual:e(I,{svg:e(xr,{})}),href:"https://github.com/Arize-ai/phoenix/issues",title:"GitHub Issues",description:"Create an issue on Github to report bugs or request new features."}),e(bl,{leadingVisual:e(I,{svg:e(xr,{})}),href:"https://github.com/Arize-ai/phoenix/discussions",title:"GitHub Discussions",description:"Create a discussion on Github to ask questions or share feedback."}),e(bl,{leadingVisual:e(I,{svg:e(Ir,{})}),href:"https://arize-ai.slack.com/join/shared_invite/zt-11t1vbu4x-xkBIHmOREQnYnYDH1GDfCg?__hstc=259489365.a667dfafcfa0169c8aee4178d115dc81.1733501603539.1733501603539.1733501603539.1&__hssc=259489365.1.1733501603539&__hsfp=3822854628&submissionGuid=381a0676-8f38-437b-96f2-fc10875658df#/shared-invite/email",title:"Slack",description:"Join our Slack community to chat with other users and the team."}),e(bl,{leadingVisual:e(I,{svg:e(Ir,{})}),href:"mailto:phoenix-support@arize.com?subject=Slack%20Connect%20Request",title:"Slack Connect",description:"Get a dedicated support channel for you and your team."})]})]})})}const rT=K`
  padding: var(--ac-global-dimension-size-200)
    var(--ac-global-dimension-size-200) var(--ac-global-dimension-size-200);
  border: var(--ac-global-border-size-thin) solid
    var(--ac-global-border-color-dark);
  border-radius: var(--ac-global-dimension-size-100);
  cursor: pointer;
  background-color: var(--ac-global-background-color-dark);
  display: flex;
  flex-direction: column;
  gap: var(--ac-global-dimension-size-50);
  color: var(--ac-global-color-text-700);
  transition: border-color 0.2s ease-in-out;
  text-decoration: none;
  &:hover {
    border-color: var(--ac-global-color-primary);
  }
`,bl=({leadingVisual:n,href:a,title:l,description:t})=>o("a",{css:rT,href:a,target:"_blank",rel:"noreferrer",children:[o(b,{direction:"row",gap:"size-100",alignItems:"center",children:[n,e(ae,{level:2,children:l})]}),e(F,{color:"text-700",children:t})]});export{dP as $,ET as A,DT as B,YT as C,JT as D,GT as E,TP as F,LT as G,rP as H,PT as I,TT as J,KT as K,vP as L,HT as M,CT as N,FT as O,xP as P,xT as Q,Nn as R,yb as S,ba as T,sP as U,cP as V,pP as W,yP as X,mP as Y,uP as Z,gP as _,Ca as a,hP as a0,fP as a1,IP as a2,LP as a3,DP as a4,AP as a5,_P as a6,wP as a7,AT as a8,jT as a9,$T as aa,NT as ab,OT as ac,_T as ad,RP as ae,wT as af,RT as ag,zT as ah,SP as ai,VP as aj,bP as ak,vT as al,hT as am,fT as an,bT as ao,kT as ap,QT as aq,ST as ar,kP as as,IT as at,EP as au,tP as av,yT as aw,pT as ax,gT as ay,Vn as b,f0 as c,fb as d,hb as e,MT as f,PP as g,FP as h,CP as i,MP as j,UT as k,XT as l,mT as m,WT as n,iP as o,oP as p,lP as q,KP as r,ZT as s,VT as t,Wv as u,aP as v,nP as w,BT as x,qT as y,eP as z};
